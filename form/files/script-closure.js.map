{
"version":3,
"file":"form/files/script-closure.js",
"lineCount":79,
"mappings":"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,ED5ZR,OAAIvH,OAAAE,UAAA+G,eAAA7G,KAAA,CAAqCkH,CAArC,CAFyCb,CAEzC,CAAJ,CACSa,CAAA,CAHoCb,CAGpC,CADT,CAIQa,CAAA,CANqCb,CAMrC,CAJR,CAI8BY,CAAA,CAAQZ,CAAR,CAPiC,C,CCNjE,IAAAe,GLq6BoC,EKr6BpCA,EJhDSpB,CDq9BAvE,QAAA,CMr/BwCoD,ONq/BxC,CKr6BT,CASAwC,EL45BoC,EK55BpCA,EJzDSrB,CDq9BAvE,QAAA,CM5+BwCoD,SN4+BxC,CK55BTwC,EL45BoC,EK55BpCA,EJzDSrB,CDq9BAvE,QAAA,CM3+BqCoD,MN2+BrC,CKr6BT,CAkBAyC,ELm5BoC,EKn5BpCA,EJlEStB,CDq9BAvE,QAAA,CO7+BwCoD,MP6+BxC,CKr6BT,CAmCA0C,ELk4BoC,EKl4BpCA,EJnFSvB,CDq9BAvE,QAAA,CO59BwCoD,OP49BxC,CKl4BT0C,EEzFM,EP29B8B,EO39B9B,ENMGvB,CDg+BqBwB,YAAA3C,EAXrBpD,QAAA,CAWwCgG,QAXxC,CO39BH,EP29B8B,EO39B9B,ENMGzB,CDq9BAvE,QAAA,CO7+BwCoD,MP6+BxC,CO39BH,CFyFN0C,EExFM,EP09B8B,EO19B9B,ENKGvB,CDq9BAvE,QAAA,COt/BwCoD,SPs/BxC,CO19BH,EP09B8B,EO19B9B,ENKGmB,CDq9BAvE,QAAA,COr/BqCoD,MPq/BrC,CO19BH,CFwFN0C,ELk4BoC,EKl4BpCA,EJnFSvB,CDq9BAvE,QAAA,CO7+BwCoD,MP6+BxC,CKr6BT,CA6CA6C,ELw3BoC,EKx3BpCA,EJ7FS1B,CDg+BqBwB,YAAA3C,EAXrBpD,QAAA,CAWwCgG,QAXxC,CKx3BTC,ELw3BoC,EKx3BpCA,EJ7FS1B,CDq9BAvE,QAAA,CO7+BwCoD,MP6+BxC,CKr6BT,CAqLA8C,ELgvBoC,EKhvBpCA,EJrOS3B,CDq9BAvE,QAAA,CQn9BwCoD,WRm9BxC,CK1jByB+C,SAAA,GAAQ,EAAG,CAE3C,IAAIC,EAAMvI,CAAA,SACV,OAAOuI,EAAA,CAAMA,CAAA,aAAN,CAA4BC,IAAAA,EAHQ,CAY7C,IAAAC,CA3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",
"sources":["form/files/upload.js"," [synthetic:es6/util/arrayiterator] "," [synthetic:es6/util/makeiterator] "," [synthetic:es6/util/arrayfromiterable] "," [synthetic:es6/util/arrayfromiterator] "," [synthetic:util/global] "," [synthetic:util/defineproperty] "," [synthetic:util/polyfill] "," [synthetic:es6/promise/promise] "," [synthetic:es6/symbol] "," [synthetic:es6/generator_engine] "," [synthetic:es6/execute_async_generator] ","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/dom/dom.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/ui/component.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/ui/progressbar.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/ui/rangemodel.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/base.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/debug/error.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/dom/nodetype.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/asserts/asserts.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/array/array.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/string/string.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/labs/useragent/util.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/object/object.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/fx/anim/anim.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/reflect/reflect.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/useragent/useragent.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/labs/useragent/browser.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/labs/useragent/engine.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/labs/useragent/platform.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/dom/browserfeature.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/dom/tags.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/string/const.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/html/trustedresourceurl.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/i18n/bidi.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/html/safeurl.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/html/safestyle.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/html/safehtml.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/disposable/disposable.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/debug/debug.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/browserfeature.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/event.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/browserevent.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/eventtype.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/listenable.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/listener.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/listenermap.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/events.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/eventtarget.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/json/json.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/debug/logrecord.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/debug/logger.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/log/log.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/net/xhrio.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/string/stringformat.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/format/jsonprettyprinter.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/eventhandler.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/filedrophandler.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/a11y/aria/roles.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/fx/transitionbase.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/async/delay.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/timer/timer.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/async/animationdelay.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/fx/animation.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/fx/transition.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/a11y/aria/aria.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/a11y/aria/datatables.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/a11y/aria/attributes.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/dom/classlist.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/keycodes.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/events/keyhandler.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/ui/zippy.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/style/style.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/ui/animatedzippy.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/fx/easing.js","/Users/zavr/demimonde/node_modules/google-closure-library/closure/goog/ui/idgenerator.js","form/files/script.js"],
"sourcesContent":["/* eslint-env browser */\n/* global exif2css */\n/* global goog */\n\nconst IGNORE = ['SourceFile', 'Directory', 'FileName', 'FileModifyDate', 'FileAccessDate', 'FileInodeChangeDate', 'FilePermissions']\n\nconst encode = async (file) => {\n  return await new Promise((r) => {\n    const reader = new FileReader()\n    reader.addEventListener('load', () => {\n      const base64encoded = reader.result\n      r(base64encoded)\n    })\n    reader.readAsDataURL(file)\n  })\n}\n\n\nexport default\nasync function upload(file) {\n  const el = goog.dom.getElement('d')\n  el.style.visibility = ''\n  const pb = new goog.ui.ProgressBar\n  pb.render(el)\n  const res = await upload2(file, (percent) => {\n    pb.setValue(percent)\n  })\n  el.style.visibility = 'hidden'\n  const dem = new goog.format.JsonPrettyPrinter.SafeHtmlDelimiters()\n  dem.lineBreak = goog.html.SafeHtml.BR\n  dem.space = '&nbsp;'\n  const f = new goog.format.JsonPrettyPrinter(dem)\n  IGNORE.forEach(p => {\n    delete res[p]\n  })\n  const mapHolder = goog.dom.createDom(goog.dom.TagName.DIV, {\n    style: 'position: relative; display: inline-block; width: 250px; height: 250px;',\n  })\n  let add\n  const { 'GPSLatitude': lat, 'GPSLongitude': long } = res\n  if (lat && long) {\n    const Lat = parseFloat(lat)\n    const Long = parseFloat(long)\n    const la = Lat.toFixed(3)\n    const lo = Long.toFixed(3)\n    const map = goog.dom.createDom(goog.dom.TagName.IMG, {\n      src: `/map?center=${lo},${la}`,\n    })\n    mapHolder.appendChild(map)\n    mapHolder.appendChild(goog.dom.createDom(goog.dom.TagName.DIV, {\n      style: 'position: absolute; top: 123px; left: 123px; background:red; border-radius: 3px; width: 6px; height: 6px;',\n    }))\n  }\n  if (res['Location'] && res['Location']['addresses'].length) {\n    const address = res['Location']['addresses'][0]['address']\n    // const { streetName, municipalitySubdivision, municipality } = address\n    add = goog.dom.createDom(goog.dom.TagName.EM, {\n      style: 'display: block',\n    }, [address['streetName'], address['municipalitySubdivision'] || address['municipality']].filter(a => a).join(', '))\n  }\n  const re = exif2css(res['Orientation'])\n  const { 'transform-origin': transformOrigin,\n    'transform': transform  } = re\n  const html = f.format(res)\n  const style = [\n    'vertical-align: top',\n    'max-height: 250px',\n    ...(res['Orientation'] > 4 ? ['max-width: 250px'] : []),\n    ...(transform ? [`transform: ${transform}`] : []),\n    ...(transformOrigin ? [`transform-origin: ${transformOrigin}`] : []),\n  ].join(';')\n  const src = await encode(file)\n  const img = goog.dom.createDom(goog.dom.TagName.IMG, {\n    src,\n    style,\n  })\n  const result = goog.dom.createDom(goog.dom.TagName.DIV, {\n    'class': 'Result',\n    style: 'display: inline-block;font-family:monospace;',\n  })\n  result.innerHTML = html\n  const header = goog.dom.createDom(goog.dom.TagName.H2)\n  header.innerHTML = '<img src=\"images/blank.gif\"> Metadata'\n  const metadata = goog.dom.createDom(goog.dom.TagName.DIV, {\n    'class': 'Metadata',\n  })\n  metadata.appendChild(header)\n  metadata.appendChild(result)\n  const id = document.getElementById('info')\n  id.innerHTML = ''\n  id.appendChild(img)\n  if (mapHolder) id.appendChild(mapHolder)\n  if (add) id.appendChild(add)\n  id.appendChild(metadata)\n  new goog.ui.AnimatedZippy(header, result, true)\n}\n\nasync function executeUpload(base64encoded) {\n  const res = await new Promise((r) => {\n    const xhr = goog.net.XhrIo.send('/api/mnp', () => {\n      var obj = xhr.getResponseJson()\n      r(obj)\n    }, 'POST', base64encoded)\n    goog.events.listen(xhr.xhr_.upload, 'progress', ({ event_ }) => {\n      console.log('Uploaded ' + event_.loaded + '/' + event_.total)\n    })\n  })\n  return res\n}\n\n// export default\nasync function upload2(file, progressCallback) {\n  return await new Promise((r, j) => {\n    const xhr = new XMLHttpRequest()\n    const fd = new FormData()\n    fd.append('file', file)\n    xhr.open('POST', '/api/mnp', true)\n    if (progressCallback) {\n      xhr.upload.onprogress = function(e){\n        const percentComplete = Math.ceil((e.loaded / e.total) * 100)\n        progressCallback(percentComplete)\n      }\n    }\n    xhr.onload = function () {\n      if (this.status == 200) {\n        try {\n          const js = JSON.parse(this.response)\n          r(js)\n        } catch (err) {\n          j('Could not parse JSON:' + err.message)\n        }\n      } else {\n        j('status code was not 200')\n      }\n    }\n    xhr.send(fd)\n  })\n}","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utility method for creating an iterator for Arrays.\n */\n'require base';\n\n/**\n * Returns an internal iterator from the given array.\n * @param {!Array<T>} array\n * @return {function():!IIterableResult<T>}\n * @template T\n */\n$jscomp.arrayIteratorImpl = function(array) {\n  var index = 0;\n  return function() {\n    if (index < array.length) {\n      return {\n        done: false,\n        value: array[index++],\n      };\n    } else {\n      return {done: true};\n    }\n  };\n};\n\n/**\n * Returns an internal iterator from the given array.\n * @param {!Array<T>} array\n * @return {!Iterator<T>}\n * @template T\n */\n$jscomp.arrayIterator = function(array) {\n  return /** @type {!Iterator<T>} */ ({next: $jscomp.arrayIteratorImpl(array)});\n};\n\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Polyfill for for-of loops.\n */\n'require es6/util/arrayiterator';\n\n/**\n * Creates an iterator for the given iterable.  This iterator should never\n * be exposed to user code.\n *\n * @param {string|!Iterable<T>|!Iterator<T>|!Arguments<T>} iterable\n * @return {!Iterator<T>}\n * @template T\n * @suppress {reportUnknownTypes}\n */\n$jscomp.makeIterator = function(iterable) {\n  // NOTE: Disabling typechecking because [] not allowed on @struct.\n  var iteratorFunction = typeof Symbol != 'undefined' && Symbol.iterator &&\n      (/** @type {?} */ (iterable)[Symbol.iterator]);\n  return iteratorFunction ? iteratorFunction.call(iterable) :\n      $jscomp.arrayIterator(/** @type {!Array} */ (iterable));\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Polyfill for array destructuring.\n */\n'require es6/util/makeiterator';\n'require es6/util/arrayfromiterator';\n\n\n/**\n * Copies the values from an Iterable into an Array.\n * @param {string|!Array<T>|!Iterable<T>|!Arguments<T>} iterable\n * @return {!Array<T>}\n * @template T\n */\n$jscomp.arrayFromIterable = function(iterable) {\n  if (iterable instanceof Array) {\n    return iterable;\n  } else {\n    return $jscomp.arrayFromIterator($jscomp.makeIterator(iterable));\n  }\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Polyfill for array destructuring.\n */\n'require base';\n\n\n/**\n * Copies the values from an Iterator into an Array. The important difference\n * between this and $jscomp.arrayFromIterable is that if the iterator's\n * next() method has already been called one or more times, this method returns\n * only the values that haven't been yielded yet.\n * @param {!Iterator<T>} iterator\n * @return {!Array<T>}\n * @template T\n * @suppress {reportUnknownTypes}\n */\n$jscomp.arrayFromIterator = function(iterator) {\n  var i;\n  var arr = [];\n  while (!(i = iterator.next()).done) {\n    arr.push(i.value);\n  }\n  return arr;\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Runtime code to store the global object.\n */\n'require base';\n'declare global';\n'declare window';\n\n\n/**\n * @param {!Object} maybeGlobal\n * @return {!Object} The global object.\n * @suppress {undefinedVars|reportUnknownTypes}\n */\n$jscomp.getGlobal = function(maybeGlobal) {\n  // This logic can be simplified to be made more optimizable.\n  return (typeof window != 'undefined' && window === maybeGlobal) ?\n      maybeGlobal :\n      (typeof global != 'undefined' && global != null) ?\n      /** @type {!Object} */ (global) :\n      maybeGlobal;\n};\n\n\n// TODO(sdh): This should be typed as \"the global object\" now that the type\n// of \"Global\" has landed in the type system.\n/**\n * The global object. For browsers we could just use `this` but in Node that\n * doesn't work.\n * @const {?}\n */\n$jscomp.global = $jscomp.getGlobal(this);\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Provides methods to polyfill native objects.\n * @suppress {reportUnknownTypes}\n */\n'require util/defines';\n\n\n/**\n * Polyfill for Object.defineProperty() method:\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty\n *\n * Refuses to define properties on Array.prototype and Object.prototype,\n * since we can't make them non-enumerable and this messes up peoples' for\n * loops.  Beyond this, we simply assign values and not worry\n * about enumerability or writeability.\n * @param {?} target\n * @param {string} property\n * @param {?} descriptor\n * @suppress {reportUnknownTypes}\n */\n$jscomp.defineProperty =\n    $jscomp.ASSUME_ES5 || typeof Object.defineProperties == 'function' ?\n    Object.defineProperty :\n    function(target, property, descriptor) {\n      descriptor = /** @type {!ObjectPropertyDescriptor} */ (descriptor);\n      // NOTE: This is currently never called with a descriptor outside\n      // the control of the compiler.  If we ever decide to polyfill either\n      // Object.defineProperty or Reflect.defineProperty for ES3, we should\n      // explicitly check for `get` or `set` on the descriptor and throw a\n      // TypeError, since it's impossible to properly polyfill it.\n      if (target == Array.prototype || target == Object.prototype) return;\n      target[property] = descriptor.value;\n    };\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Provides methods to polyfill native objects.\n */\n'require util/defineproperty';\n'require util/global';\n\n\n/**\n * @param {string} target Qualified name of the class or method to polyfill,\n *     e.g. 'Array.prototype.includes' or 'Map'.\n * @param {?function(*): *} polyfill A function that takes the current browser\n *     implementation of the target and returns an optional new polyfill\n *     implementation.  If null is returned, then no polyfill will be added.  A\n *     null argument for this parameter indicates that the function will not be\n *     polyfilled, and is only useful for `build_polyfill_table.js` bookkeeping.\n * @param {string} fromLang The language level in which the target is expected\n *     to already be present in the browser.  The compiler requires that\n *     `languageOut < fromLang` before injecting a polyfill (i.e. if the\n *     specified output language already includes the feature then there's no\n *     need to polyfill it).\n * @param {string} toLang The language level required by the polyfill\n *     implementation.  The compiler will issue an error if a polyfill is\n *     required, but `languageOut < toLang`.  Additionally, the\n *     `build_polyfill_table.js` script audits the polyfill dependency tree to\n *     ensure that no polyfill with a lower `toLang` depends on one with a\n *     higher `toLang`.\n * @suppress {reportUnknownTypes}\n * @noinline\n * NOTE: We prevent inlining so RemoveUnusedPolyfills can always recognize this\n * call.\n */\n$jscomp.polyfill = function(target, polyfill, fromLang, toLang) {\n  if (!polyfill) return;\n  var obj = $jscomp.global;\n  var split = target.split('.');\n  for (var i = 0; i < split.length - 1; i++) {\n    var key = split[i];\n    if (!(key in obj)) obj[key] = {};  // Might want to be defineProperty.\n    obj = obj[key];\n  }\n  var property = split[split.length - 1];\n  var orig = obj[property];\n  var impl = polyfill(orig);\n  if (impl == orig || impl == null) return;\n  $jscomp.defineProperty(\n      obj, property, {configurable: true, writable: true, value: impl});\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require base';\n'require es6/util/makeiterator';\n'require util/global';\n'require util/polyfill';\n\n/**\n * Should we unconditionally override a native Promise implementation with our\n * own?\n * @define {boolean}\n */\n$jscomp.FORCE_POLYFILL_PROMISE = false;\n\n\n$jscomp.polyfill('Promise',\n    /**\n     * @param {*} NativePromise\n     * @return {*}\n     * @suppress {reportUnknownTypes}\n     */\n    function(NativePromise) {\n  // TODO(bradfordcsmith): Do we need to add checks for standards conformance?\n  //     e.g. The version of FireFox we currently use for testing has a Promise\n  //     that fails to reject attempts to fulfill it with itself, but that\n  //     isn't reasonably testable here.\n  if (NativePromise && !$jscomp.FORCE_POLYFILL_PROMISE) {\n    return NativePromise;\n  }\n\n  /**\n    * Schedules code to be executed asynchronously.\n    * @constructor\n    * @struct\n    */\n  function AsyncExecutor() {\n    /**\n     * Batch of functions to execute.\n     *\n     * Will be `null` initially and immediately after a batch finishes\n     * executing.\n     * @private {?Array<function()>}\n     */\n    this.batch_ = null;\n  }\n\n  /**\n   * Schedule a function to execute asynchronously.\n   *\n   * -   The function will execute:\n   *     -   After the current call stack has completed executing.\n   *     -   After any functions previously scheduled using this object.\n   * -   The return value will be ignored.\n   * -   An exception thrown by the method will be caught and asynchronously\n   *     rethrown when it cannot interrupt any other code. This class provides\n   *     no way to catch such exceptions.\n   * @param {function():?} f\n   * @return {!AsyncExecutor} this object\n   */\n  AsyncExecutor.prototype.asyncExecute = function(f) {\n    if (this.batch_ == null) {\n      // no batch created yet, or last batch was fully executed\n      this.batch_ = [];\n      this.asyncExecuteBatch_();\n    }\n    this.batch_.push(f);\n    return this;\n  };\n\n  /**\n   * Schedule execution of the jobs in `this.batch_`.\n   * @private\n   */\n  AsyncExecutor.prototype.asyncExecuteBatch_ = function() {\n    var self = this;\n    this.asyncExecuteFunction(function() { self.executeBatch_(); });\n  };\n\n  // NOTE: We want to make sure AsyncExecutor will work as expected even if\n  // testing code should override setTimeout()\n  /** @const {function(!Function, number)} */\n  var nativeSetTimeout = $jscomp.global['setTimeout'];\n\n  /**\n   * Schedule a function to execute asynchronously as soon as possible.\n   *\n   * NOTE: May be overridden for testing.\n   * @package\n   * @param {function()} f\n   */\n  AsyncExecutor.prototype.asyncExecuteFunction = function(f) {\n    nativeSetTimeout(f, 0);\n  };\n\n  /**\n   * Execute scheduled jobs in a batch until all are executed or the batch\n   * execution time limit has been reached.\n   * @private\n   */\n  AsyncExecutor.prototype.executeBatch_ = function() {\n    while (this.batch_ && this.batch_.length) {\n      var /** !Array<?function()> */ executingBatch = this.batch_;\n      // Executions scheduled while executing this batch go into a new one to\n      // avoid the batch array getting too big.\n      this.batch_ = [];\n      for (var i = 0; i < executingBatch.length; ++i) {\n        var f = /** @type {function()} */ (executingBatch[i]);\n        executingBatch[i] = null;  // free memory\n        try {\n          f();\n        } catch (error) {\n          this.asyncThrow_(error);\n        }\n      }\n    }\n    // All jobs finished executing, so force scheduling a new batch next\n    // time asyncExecute() is called.\n    this.batch_ = null;\n  };\n\n  /**\n   * @private\n   * @param {*} exception\n   */\n  AsyncExecutor.prototype.asyncThrow_ = function(exception) {\n    this.asyncExecuteFunction(function() { throw exception; });\n  };\n\n  /**\n   * @enum {number}\n   */\n  var PromiseState = {\n    /** The Promise is waiting for resolution. */\n    PENDING: 0,\n\n    /** The Promise has been resolved with a fulfillment value. */\n    FULFILLED: 1,\n\n    /** The Promise has been resolved with a rejection reason. */\n    REJECTED: 2\n  };\n\n\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\n   * @param {function(\n   *             function((TYPE|IThenable<TYPE>|Thenable|null)=),\n   *             function(*=))} executor\n   * @constructor\n   * @extends {Promise<TYPE>}\n   * @template TYPE\n   */\n  var PolyfillPromise = function(executor) {\n    /** @private {PromiseState} */\n    this.state_ = PromiseState.PENDING;\n\n    /**\n     * The settled result of the Promise. Immutable once set with either a\n     * fulfillment value or rejection reason.\n     * @private {*}\n     */\n    this.result_ = undefined;\n\n    /**\n     * These functions must be asynchronously executed when this promise\n     * settles.\n     * @private {?Array<function()>}\n     */\n    this.onSettledCallbacks_ = [];\n\n    var resolveAndReject = this.createResolveAndReject_();\n    try {\n      executor(resolveAndReject.resolve, resolveAndReject.reject);\n    } catch (e) {\n      resolveAndReject.reject(e);\n    }\n  };\n\n\n  /**\n   * Create a pair of functions for resolving or rejecting this Promise.\n   *\n   * <p>After the resolve or reject function has been called once, later calls\n   * do nothing.\n   * @private\n   * @return {{\n   *     resolve: function((TYPE|IThenable<TYPE>|Thenable|null)=),\n   *     reject:  function(*=)\n   * }}\n   */\n  PolyfillPromise.prototype.createResolveAndReject_ = function() {\n    var thisPromise = this;\n    var alreadyCalled = false;\n    /**\n     * @param {function(this:PolyfillPromise<TYPE>, T)} method\n     * @return {function(T)}\n     * @template T\n     */\n    function firstCallWins(method) {\n      return function(x) {\n        if (!alreadyCalled) {\n          alreadyCalled = true;\n          method.call(thisPromise, x);\n        }\n      };\n    }\n    return {\n      resolve: firstCallWins(this.resolveTo_),\n      reject: firstCallWins(this.reject_)\n    };\n  };\n\n\n  /**\n   * @private\n   * @param {*} value\n   */\n  PolyfillPromise.prototype.resolveTo_ = function(value) {\n    if (value === this) {\n      this.reject_(new TypeError('A Promise cannot resolve to itself'));\n    } else if (value instanceof PolyfillPromise) {\n      this.settleSameAsPromise_(/** @type {!PolyfillPromise} */ (value));\n    } else if (isObject(value)) {\n      this.resolveToNonPromiseObj_(/** @type {!Object} */ (value));\n    } else {\n      this.fulfill_(value);\n    }\n  };\n\n\n  /**\n   * @private\n   * @param {!Object} obj\n   * @suppress {strictMissingProperties} obj.then\n   */\n  PolyfillPromise.prototype.resolveToNonPromiseObj_ = function(obj) {\n    var thenMethod = undefined;\n\n    try {\n      thenMethod = obj.then;\n    } catch (error) {\n      this.reject_(error);\n      return;\n    }\n    if (typeof thenMethod == 'function') {\n      this.settleSameAsThenable_(thenMethod, /** @type {!Thenable} */ (obj));\n    } else {\n      this.fulfill_(obj);\n    }\n  };\n\n\n  /**\n   * @param {*} value anything\n   * @return {boolean}\n   */\n  function isObject(value) {\n    switch (typeof value) {\n      case 'object':\n        return value != null;\n      case 'function':\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  /**\n   * Reject this promise for the given reason.\n   * @private\n   * @param {*} reason\n   * @throws {!Error} if this promise is already fulfilled or rejected.\n   */\n  PolyfillPromise.prototype.reject_ = function(reason) {\n    this.settle_(PromiseState.REJECTED, reason);\n  };\n\n  /**\n   * Fulfill this promise with the given value.\n   * @private\n   * @param {!TYPE} value\n   * @throws {!Error} when this promise is already fulfilled or rejected.\n   */\n  PolyfillPromise.prototype.fulfill_ = function(value) {\n    this.settle_(PromiseState.FULFILLED, value);\n  };\n\n  /**\n   * Fulfill or reject this promise with the given value/reason.\n   * @private\n   * @param {!PromiseState} settledState (FULFILLED or REJECTED)\n   * @param {*} valueOrReason\n   * @throws {!Error} when this promise is already fulfilled or rejected.\n   */\n  PolyfillPromise.prototype.settle_ = function(settledState, valueOrReason) {\n    if (this.state_ != PromiseState.PENDING) {\n      throw new Error(\n          'Cannot settle(' + settledState + ', ' + valueOrReason +\n          '): Promise already settled in state' + this.state_);\n    }\n    this.state_ = settledState;\n    this.result_ = valueOrReason;\n    this.executeOnSettledCallbacks_();\n  };\n\n  PolyfillPromise.prototype.executeOnSettledCallbacks_ = function() {\n    if (this.onSettledCallbacks_ != null) {\n      for (var i = 0; i < this.onSettledCallbacks_.length; ++i) {\n        asyncExecutor.asyncExecute(this.onSettledCallbacks_[i]);\n      }\n      this.onSettledCallbacks_ = null;  // free memory\n    }\n  };\n\n  /**\n   * All promise async execution is managed by a single executor for the\n   * sake of efficiency.\n   * @const {!AsyncExecutor}\n   */\n  var asyncExecutor = new AsyncExecutor();\n\n  /**\n   * Arrange to settle this promise in the same way as the given thenable.\n   * @private\n   * @param {!PolyfillPromise} promise\n   */\n  PolyfillPromise.prototype.settleSameAsPromise_ = function(promise) {\n    var methods = this.createResolveAndReject_();\n\n    // Calling then() would create an unnecessary extra promise.\n    promise.callWhenSettled_(methods.resolve, methods.reject);\n  };\n\n  /**\n   * Arrange to settle this promise in the same way as the given thenable.\n   * @private\n   * @param {function(\n   *     function((TYPE|IThenable<TYPE>|Thenable|null)=),\n   *     function(*=))\n   * } thenMethod\n   * @param {!Thenable} thenable\n   */\n  PolyfillPromise.prototype.settleSameAsThenable_ = function(\n      thenMethod, thenable) {\n    var methods = this.createResolveAndReject_();\n\n    // Don't trust an unknown thenable implementation not to throw exceptions.\n    try {\n      thenMethod.call(thenable, methods.resolve, methods.reject);\n    } catch (error) {\n      methods.reject(error);\n    }\n  };\n\n  /** @override */\n  PolyfillPromise.prototype.then = function(onFulfilled, onRejected) {\n    var resolveChild;\n    var rejectChild;\n    var childPromise = new PolyfillPromise(function(resolve, reject) {\n      resolveChild = resolve;\n      rejectChild = reject;\n    });\n    function createCallback(paramF, defaultF) {\n      // The spec says to ignore non-function values for onFulfilled and\n      // onRejected\n      if (typeof paramF == 'function') {\n        return function(x) {\n          try {\n            resolveChild(paramF(x));\n          } catch (error) {\n            rejectChild(error);\n          }\n        };\n      } else {\n        return defaultF;\n      }\n    }\n\n    this.callWhenSettled_(\n        createCallback(onFulfilled, resolveChild),\n        createCallback(onRejected, rejectChild));\n    return childPromise;\n  };\n\n  /** @override */\n  PolyfillPromise.prototype.catch = function(onRejected) {\n    return this.then(undefined, onRejected);\n  };\n\n\n  PolyfillPromise.prototype.callWhenSettled_ = function(\n      onFulfilled, onRejected) {\n    var /** !PolyfillPromise */ thisPromise = this;\n    function callback() {\n      switch (thisPromise.state_) {\n        case PromiseState.FULFILLED:\n          onFulfilled(thisPromise.result_);\n          break;\n        case PromiseState.REJECTED:\n          onRejected(thisPromise.result_);\n          break;\n        default:\n          throw new Error('Unexpected state: ' + thisPromise.state_);\n      }\n    }\n    if (this.onSettledCallbacks_ == null) {\n      // we've already settled\n      asyncExecutor.asyncExecute(callback);\n    } else {\n      this.onSettledCallbacks_.push(callback);\n    }\n  };\n\n  // called locally, so give it a name\n  function resolvingPromise(opt_value) {\n    if (opt_value instanceof PolyfillPromise) {\n      return opt_value;\n    } else {\n      return new PolyfillPromise(function(resolve, reject) {\n        resolve(opt_value);\n      });\n    }\n  }\n  PolyfillPromise['resolve'] = resolvingPromise;\n\n\n  PolyfillPromise['reject'] = function(opt_reason) {\n    return new PolyfillPromise(function(resolve, reject) {\n      reject(opt_reason);\n    });\n  };\n\n\n  PolyfillPromise['race'] = function(thenablesOrValues) {\n    return new PolyfillPromise(function(resolve, reject) {\n      var /** !Iterator<*> */ iterator =\n          $jscomp.makeIterator(thenablesOrValues);\n      for (var /** !IIterableResult<*> */ iterRec = iterator.next();\n           !iterRec.done;\n           iterRec = iterator.next()) {\n        // Using resolvingPromise() allows us to treat all elements the same\n        // way.\n        // NOTE: resolvingPromise(promise) always returns the argument\n        // unchanged.\n        // Using .callWhenSettled_() instead of .then() avoids creating an\n        // unnecessary extra promise.\n        resolvingPromise(iterRec.value).callWhenSettled_(resolve, reject);\n      }\n    });\n  };\n\n\n  PolyfillPromise['all'] = function(thenablesOrValues) {\n    var /** !Iterator<*> */ iterator = $jscomp.makeIterator(thenablesOrValues);\n    var /** !IIterableResult<*> */ iterRec = iterator.next();\n\n    if (iterRec.done) {\n      return resolvingPromise([]);\n    } else {\n      return new PolyfillPromise(function(resolveAll, rejectAll) {\n        var resultsArray = [];\n        var unresolvedCount = 0;\n\n        function onFulfilled(i) {\n          return function(ithResult) {\n            resultsArray[i] = ithResult;\n            unresolvedCount--;\n            if (unresolvedCount == 0) {\n              resolveAll(resultsArray);\n            }\n          };\n        }\n\n        do {\n          resultsArray.push(undefined);\n          unresolvedCount++;\n          // Using resolvingPromise() allows us to treat all elements the same\n          // way.\n          // NOTE: resolvingPromise(promise) always returns the argument\n          // unchanged. Using .callWhenSettled_() instead of .then() avoids\n          // creating an unnecessary extra promise.\n          resolvingPromise(iterRec.value)\n              .callWhenSettled_(\n                  onFulfilled(resultsArray.length - 1), rejectAll);\n          iterRec = iterator.next();\n        } while (!iterRec.done);\n      });\n    }\n  };\n\n  return PolyfillPromise;\n}, 'es6', 'es3');\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require es6/util/arrayiterator';\n'require util/defineproperty';\n'require util/global';\n\n/** @const {string} */\n$jscomp.SYMBOL_PREFIX = 'jscomp_symbol_';\n\n\n/**\n * Initializes the Symbol function.\n * @suppress {reportUnknownTypes}\n */\n$jscomp.initSymbol = function() {\n  // Only need to do this once. All future calls are no-ops.\n  $jscomp.initSymbol = function() {};\n\n  if (!$jscomp.global['Symbol']) {\n    $jscomp.global['Symbol'] = $jscomp.Symbol;\n  }\n};\n\n\n/**\n * Produces \"symbols\" (actually just unique strings).\n * @param {string=} opt_description\n * @return {symbol}\n */\n$jscomp.Symbol = /** @type {function(): !Function} */ (function() {\n  var counter = 0;\n  /**\n   * @param {string=} opt_description\n   * @return {symbol}\n   * @suppress {reportUnknownTypes}\n   */\n  function Symbol(opt_description) {\n    return /** @type {?} */ (\n        $jscomp.SYMBOL_PREFIX + (opt_description || '') + (counter++));\n  }\n  return Symbol;\n})();\n\n\n/**\n * Initializes Symbol.iterator (if it's not already defined) and adds a\n * Symbol.iterator property to the Array prototype.\n * @suppress {reportUnknownTypes}\n */\n$jscomp.initSymbolIterator = function() {\n  $jscomp.initSymbol();\n  var symbolIterator = $jscomp.global['Symbol'].iterator;\n  if (!symbolIterator) {\n    symbolIterator = $jscomp.global['Symbol'].iterator =\n        $jscomp.global['Symbol']('iterator');\n  }\n\n  if (typeof Array.prototype[symbolIterator] != 'function') {\n    $jscomp.defineProperty(\n        Array.prototype, symbolIterator, {\n          configurable: true,\n          writable: true,\n          /**\n           * @this {Array}\n           * @return {!IteratorIterable}\n           */\n          value: function() {\n            return $jscomp.iteratorPrototype(\n                $jscomp.arrayIteratorImpl(this));\n          }\n        });\n  }\n\n  // Only need to do this once. All future calls are no-ops.\n  $jscomp.initSymbolIterator = function() {};\n};\n\n\n/**\n * Initializes Symbol.asyncIterator (if it's not already defined)\n * @suppress {reportUnknownTypes}\n */\n$jscomp.initSymbolAsyncIterator = function() {\n  $jscomp.initSymbol();\n  var symbolAsyncIterator = $jscomp.global['Symbol'].asyncIterator;\n  if (!symbolAsyncIterator) {\n    symbolAsyncIterator = $jscomp.global['Symbol'].asyncIterator =\n        $jscomp.global['Symbol']('asyncIterator');\n  }\n\n  // Only need to do this once. All future calls are no-ops.\n  $jscomp.initSymbolAsyncIterator = function() {};\n};\n\n\n/**\n * Returns an iterator with the given `next` method.  Passing\n * all iterators through this function allows easily extending\n * the definition of `%IteratorPrototype%` if methods are ever\n * added to it in the future.\n *\n * @param {function(this: Iterator<T>): T} next\n * @return {!IteratorIterable<T>}\n * @template T\n * @suppress {reportUnknownTypes}\n */\n$jscomp.iteratorPrototype = function(next) {\n  $jscomp.initSymbolIterator();\n\n  var iterator = {next: next};\n  /**\n   * @this {IteratorIterable}\n   * @return {!IteratorIterable}\n   */\n  iterator[$jscomp.global['Symbol'].iterator] = function() { return this; };\n  return /** @type {!IteratorIterable} */ (iterator);\n};\n","/*\n * Copyright 2018 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require base';\n'require es6/symbol';\n'require es6/util/setprototypeof';\n'require es6/util/makeiterator';\n\n/**\n * @fileoverview Implementation for $jscomp.generator\n *\n * This closure-compiler internal JavaScript library provides an ES3-compatible\n * API for writing generator functions using a minimum of boilerplate.\n *\n * Example:\n * ```javascript\n * // yields numbers starting with the given value, then incrementing by the\n * // value supplied to the next() method until the computed value is <= min or\n * // >= max. Then it returns the total number of times it yielded.\n * // If the client code calls throw(), the error will be logged and then\n * // yielded, but the generator won't terminate.\n * function *es6Definition(start, min, max) {\n *   let currentValue = start;\n *   let yieldCount = 0;\n *   while (currentValue > min && currentValue < max) {\n *     try {\n *       currentValue += yield(currentValue);\n *     } catch (e) {\n *       yield(e);\n *       console.log('client threw error', e);\n *     } finally {\n *       yieldCount++;\n *     }\n *   }\n *   return [yieldCount, currentValue];\n * }\n *\n * function es3Definition(start, min, max) {\n *   var currentValue;\n *   var yieldCount;\n *   var e;\n *\n *   return $jscomp.generator.createGenerator(\n *       es3Definition,\n *       function (context$) {\n *         switch (context$.nextAddress) {\n *           case 1: // execution always starts with 1\n *             currentValue = start;\n *             yieldCount = 0;\n *             // fall-through\n *\n *           case 2:\n *             if (!(currentValue > min && currentValue < max)) {\n *               // exit while loop:\n *               return context$.jumpTo(3);\n *             }\n *             // try {\n *             JSCompiler_temp_const$jscomp$1 = currentValue;\n *             context$.setCatchFinallyBlocks(4, 5);\n *             return context$.yield(currentValue, 7);\n *\n *           case 7:\n *             currentValue =\n *                 JSCompiler_temp_const$jscomp$1 + context$.yieldResult;\n *             // fall-through: execute finally block\n *\n *           case 5: // finally block start\n *             context$.enterFinallyBlock();\n *             yieldCount++;\n *             return context$.leaveFinallyBlock(6);\n *\n *           case 4: // catch block start\n *             e = context$.enterCatchBlock();\n *             return context$.yield(e, 8);\n *\n *           case 8: // finish catch block\n *             console.log('client threw error', e);\n *             return context$.jumpTo(5);\n *\n *           case 6:\n *             context$.jumpTo(2);\n *             break;\n *\n *           case 3:\n *             // come back here when while loop block exits\n *             return context$.return([yieldCount, currentValue]);\n *         }\n *       }\n *   });\n * };\n * ```\n */\n\n/** @const */\n$jscomp.generator = {};\n\n/**\n * Ensures that the iterator result is actually an object.\n *\n * @private\n * @final\n * @param {*} result\n * @return {void}\n * @throws {TypeError} if the result is not an instenace of Object.\n */\n$jscomp.generator.ensureIteratorResultIsObject_ = function(result) {\n  if (result instanceof Object) {\n    return;\n  }\n  throw new TypeError('Iterator result ' + result + ' is not an object');\n};\n\n\n/**\n * Tracks state machine state used by generator.Engine.\n *\n * @template VALUE\n * @constructor\n * @final\n * @struct\n */\n$jscomp.generator.Context = function() {\n  /**\n   * Whether the generator program is being executed at the moment in the\n   * current context. Is used to prevent reentrancy.\n   *\n   * @private\n   * @type {boolean}\n   */\n  this.isRunning_ = false;\n\n  /**\n   * An iterator that should yield all its values before the main program can\n   * continue.\n   *\n   * @private\n   * @type {?Iterator<VALUE>}\n   */\n  this.yieldAllIterator_ = null;\n\n  /**\n   * The value that will be sent to the program as the result of suspended\n   * yield expression.\n   *\n   * @type {?}\n   */\n  this.yieldResult = undefined;\n\n  /**\n   * The next address where the state machine execution should be resumed.\n   *\n   * <p>Program execution starts at 1 and ends at 0.\n   *\n   * @type {number}\n   */\n  this.nextAddress = 1;\n\n  /**\n   * The address that should be executed once an exception is thrown.\n   *\n   * <p>Value of 0 means no catch block exist that would handles an exception.\n   *\n   * @private\n   * @type {number}\n   */\n  this.catchAddress_ = 0;\n\n  /**\n   * The address that should be executed once the result is being returned\n   * or if the exception is thrown and there is no catchAddress specified.\n   *\n   * <p>Value of 0 means no finally block is set.\n   *\n   * @private\n   * @type {number}\n   */\n  this.finallyAddress_ = 0;\n\n  /**\n   * Stores information for the runtime propagation of values and control\n   * flow such as the behaviour of statements (break, continue, return and\n   * throw) that perform nonlocal transfers of control.\n   *\n   * @private\n   * @type {null|{return: VALUE}|{exception, isException: boolean}|{jumpTo: number}}.\n   */\n  this.abruptCompletion_ = null;\n\n  /**\n   * The preserved abruptCompletion_ when entering a `finally` block. If\n   * the `finally` block completes normally the preserved abruptCompletion_ is\n   * restored:\n   * <pre>\n   * try {\n   * } finally {  // nesting level 0\n   *   // abruptCompletion_ is saved in finallyContexts_[0]\n   *   try {\n   *   } finally {  // nesting level 1\n   *     // abruptCompletion_ is saved in finallyContexts_[1]\n   *     ...\n   *     // abruptCompletion_ is restored from finallyContexts_[1]\n   *   }\n   *   // abruptCompletion_ is restored from finallyContexts_[0]\n   * }\n   * <pre>\n   *\n   * @private\n   * @type {?Array<null|{return: VALUE}|{exception, isException: boolean}|{jumpTo: number}>}.\n   */\n  this.finallyContexts_ = null;\n};\n\n/**\n * Marks generator program as being run.\n *\n * @private\n * @final\n * @return {void}\n * @throws {TypeError} if generator is already running.\n */\n$jscomp.generator.Context.prototype.start_ = function() {\n  if (this.isRunning_) {\n    throw new TypeError('Generator is already running');\n  }\n  this.isRunning_ = true;\n};\n\n/**\n *\n *\n * @private\n * @final\n * @return {void}\n */\n$jscomp.generator.Context.prototype.stop_ = function() {\n  this.isRunning_ = false;\n};\n\n/**\n * Transfers program execution to an appropriate catch/finally block that\n * should be executed if exception occurs.\n *\n * @private\n * @final\n * @return {void}\n */\n$jscomp.generator.Context.prototype.jumpToErrorHandler_ = function() {\n  this.nextAddress = this.catchAddress_ || this.finallyAddress_;\n};\n\n/**\n * Sets the result of suspended yield expression.\n *\n * @private\n * @final\n * @param {?=} value The value to send to the generator.\n * @return {void}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Context.prototype.next_ = function(value) {\n  this.yieldResult = value;\n};\n\n/**\n * Throws exception as the result of suspended yield.\n *\n * @private\n * @final\n * @param {?} e\n * @return {void}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Context.prototype.throw_ = function(e) {\n  this.abruptCompletion_ = {exception: e, isException: true};\n  this.jumpToErrorHandler_();\n};\n\n/**\n * Returns a value as the result of generator function.\n *\n * @final\n * @param {VALUE=} value\n * @return {void}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Context.prototype.return = function(value) {\n  this.abruptCompletion_ = {return: /** @type {VALUE} */ (value)};\n  this.nextAddress = this.finallyAddress_;\n};\n\n/**\n * Changes the context so the program execution will continue from the given\n * state after executing nessesary pending finally blocks first.\n *\n * @final\n * @param {number} nextAddress The state that should be run.\n * @return {void}\n */\n$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks = function(\n    nextAddress) {\n  this.abruptCompletion_ = {jumpTo: nextAddress};\n  this.nextAddress = this.finallyAddress_;\n};\n\n/**\n * Pauses the state machine program assosiated with generator function to yield\n * a value.\n *\n * @final\n * @param {VALUE} value The value to return from the generator function via\n *     the iterator protocol.\n * @param {number} resumeAddress The address where the program should resume.\n * @return {{value: VALUE}}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Context.prototype.yield = function(value, resumeAddress) {\n  this.nextAddress = resumeAddress;\n  return {value: value};\n};\n\n/**\n * Causes the state machine program to yield all values from an iterator.\n *\n * @final\n * @param {string|!Iterator<VALUE>|!Iterable<VALUE>|!Arguments<VALUE>} iterable\n *     Iterator to yeild all values from.\n * @param {number} resumeAddress The address where the program should resume.\n * @return {void | {value: VALUE}}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Context.prototype.yieldAll = function(\n    iterable, resumeAddress) {\n  /** @const @type {!Iterator<VALUE>} */ var iterator =\n      $jscomp.makeIterator(iterable);\n  /** @const */ var result = iterator.next();\n  $jscomp.generator.ensureIteratorResultIsObject_(result);\n  if (result.done) {\n    // If `someGenerator` in `x = yield *someGenerator` completes immediately,\n    // x is the return value of that generator.\n    this.yieldResult = result.value;\n    this.nextAddress = resumeAddress;\n    return;\n  }\n  this.yieldAllIterator_ = iterator;\n  return this.yield(result.value, resumeAddress);\n};\n\n/**\n * Changes the context so the program execution will continue from the given\n * state.\n *\n * @final\n * @param {number} nextAddress The state the program should continue\n * @return {void}\n */\n$jscomp.generator.Context.prototype.jumpTo = function(nextAddress) {\n  this.nextAddress = nextAddress;\n};\n\n/**\n * Changes the context so the program execution ends.\n *\n * @final\n * @return {void}\n */\n$jscomp.generator.Context.prototype.jumpToEnd = function() {\n  this.nextAddress = 0;\n};\n\n/**\n * Sets catch / finally handlers.\n * Used for try statements with catch blocks.\n *\n * @final\n * @param {number} catchAddress The address of the catch block.\n * @param {number=} finallyAddress The address of the finally block.\n * @return {void}\n */\n$jscomp.generator.Context.prototype.setCatchFinallyBlocks = function(\n    catchAddress, finallyAddress) {\n  this.catchAddress_ = catchAddress;\n  if (finallyAddress != undefined) {\n    this.finallyAddress_ = finallyAddress;\n  }\n};\n\n/**\n * Sets finally handler.\n * Used for try statements without catch blocks.\n *\n * @const\n * @param {number=} finallyAddress The address of the finally block or 0.\n * @return {void}\n */\n$jscomp.generator.Context.prototype.setFinallyBlock = function(finallyAddress) {\n  this.catchAddress_ = 0;\n  this.finallyAddress_ = finallyAddress || 0;\n};\n\n/**\n * Sets a catch handler and jumps to the next address.\n * Used for try statements without finally blocks.\n *\n * @final\n * @param {number} nextAddress The state that should be run next.\n * @param {number=} catchAddress The address of the catch block or 0.\n * @return {void}\n */\n$jscomp.generator.Context.prototype.leaveTryBlock = function(\n    nextAddress, catchAddress) {\n  this.nextAddress = nextAddress;\n  this.catchAddress_ = catchAddress || 0;\n};\n\n/**\n * Initializes exception variable in the beginning of catch block.\n *\n * @final\n * @param {number=} nextCatchBlockAddress The address of the next catch block\n *     that is preceded by no finally blocks.\n * @return {?} Returns an exception that was thrown from \"try\" block.\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Context.prototype.enterCatchBlock = function(\n    nextCatchBlockAddress) {\n  this.catchAddress_ = nextCatchBlockAddress || 0;\n  /** @const */ var exception =\n      /** @type {{exception, isException: boolean}} */ (this.abruptCompletion_)\n          .exception;\n  this.abruptCompletion_ = null;\n  return exception;\n};\n\n/**\n * Saves the current throw context which will be restored at the end of finally\n * block.\n *\n * @final\n * @param {number=} nextCatchAddress\n * @param {number=} nextFinallyAddress\n * @param {number=} finallyDepth The nesting level of current \"finally\" block.\n * @return {void}\n */\n$jscomp.generator.Context.prototype.enterFinallyBlock = function(\n    nextCatchAddress, nextFinallyAddress, finallyDepth) {\n  if (!finallyDepth) {\n    this.finallyContexts_ = [this.abruptCompletion_];\n  } else {\n    /**\n     * @type {!Array<null|{return: VALUE}|{exception, isException: boolean}|{jumpTo: number}>}\n     */\n    (this.finallyContexts_)[finallyDepth] = this.abruptCompletion_;\n  }\n  this.catchAddress_ = nextCatchAddress || 0;\n  this.finallyAddress_ = nextFinallyAddress || 0;\n};\n\n/**\n * Figures out whether the program execution should continue normally, or jump\n * to the closest catch/finally block.\n *\n * @final\n * @param {number} nextAddress The state that should be run next.\n * @param {number=} finallyDepth The nesting level of current \"finally\" block.\n * @return {void}\n * @suppress {strictMissingProperties}\n */\n$jscomp.generator.Context.prototype.leaveFinallyBlock = function(\n    nextAddress, finallyDepth) {\n  // There could be trailing finally contexts if a nested finally throws an\n  // exception or return.\n  // e.g.\n  // try {\n  //   ...\n  //   return 1;\n  // } finally {\n  //   // finallyDepth == 0\n  //   // finallyContext == [{return: 1}]\n  //   try {\n  //     ...\n  //     try {\n  //       throw new Error(2);\n  //     } finally {\n  //       // finallyDepth == 1\n  //       // finallyContext == [{return: 1}, {exception: Error(2)}]\n  //       try {\n  //         throw new Error(3);\n  //       } finally {\n  //         // finallyDepth == 2\n  //         // finallyContext == [\n  //         //     {return: 1},\n  //         //     {exception: Error(2)},\n  //         //     {exception: Error(3)}\n  //         // ]\n  //         throw new Error(4); // gets written in abruptCompletion_\n  //         // leaveFinallyBlock() never gets called here\n  //       }\n  //       // leaveFinallyBlock() never gets called here\n  //     }\n  //   } catch (e) {\n  //      // swallow error\n  //      // abruptCompletion becomes null\n  //   } finally {\n  //     // finallyDepth == 1\n  //     // finallyContext == [\n  //     //     {return: 1},\n  //     //     null, // overwritten, because catch swallowed the error\n  //     //     {exception: Error(3)}  // left over\n  //     // ]\n  //     // leaveFinallyBlock() called here\n  //     // finallyContext == [{return: 1}]\n  //     // abruptCompletion == null\n  //   }\n  //   // leaveFinallyBlock() called here\n  //   // finallyContext = []\n  //   // abruptCompletion == {return: 1};\n  // }\n  /** @const */ var preservedContext =\n      /**\n       * @type {!Array<null|{return: VALUE}|{exception, isException: boolean}|{jumpTo: number}>}\n       */\n      (this.finallyContexts_).splice(finallyDepth || 0)[0];\n  /** @const */ var abruptCompletion = this.abruptCompletion_ =\n      this.abruptCompletion_ || preservedContext;\n  if (abruptCompletion) {\n    if (abruptCompletion.isException) {\n      return this.jumpToErrorHandler_();\n    }\n    // Check if there is a pending break/continue jump that is not preceded by\n    // finally blocks that should be executed before.\n    // We always generate case numbers for the start and end of loops before\n    // numbers for anything they contain, so any finally blocks within will be\n    // guaranteed to have higher addresses than the loop break and continue\n    // positions.\n    // e.g.\n    // l1: while (...) {            // generated addresses: 100: break l1;\n    //       try {                  // generated addresses: 101: finally,\n    //         try {                // generated addresses: 102: finally,\n    //           l2: while (...) {  // generated addresses: 103: break l2;\n    //\n    //                 if (...) {\n    //                   break l1;  // becomes\n    //                              // $context.jumpThroughFinallyBlocks(101),\n    //                              // since 2 finally blocks must be crossed\n    //                 }\n    //                 break l2;    // becomes $context.jumpTo(103)\n    //               }\n    //         } finally {\n    //           // When leaving this finally block:\n    //           // 1. We keep the abrupt completion indicating 'break l1'\n    //           // 2. We jump to the enclosing finally block.\n    //         }\n    //       } finally {\n    //         // When leaving this finally block:\n    //         // 1. We complete the abruptCompletion indicating 'break l1' by\n    //         //   jumping to the loop start address.\n    //         // 2. Abrupt completion is now null, so normal execution\n    //         //   continues from there.\n    //       }\n    //     }\n    if (abruptCompletion.jumpTo != undefined &&\n        this.finallyAddress_ < abruptCompletion.jumpTo) {\n      this.nextAddress = abruptCompletion.jumpTo;\n      this.abruptCompletion_ = null;\n    } else {\n      this.nextAddress = this.finallyAddress_;\n    }\n  } else {\n    this.nextAddress = nextAddress;\n  }\n};\n\n/**\n * Is used in transpilation of `for in` statements.\n *\n * <p><code>for (var i in obj) {...}</code> becomes:\n * <pre>\n * for (var i, $for$in = context$.forIn(obj);\n *      (i = $for$in.getNext()) != null;\n *      ) {\n *   ...\n * }\n * </pre>\n *\n * @final\n * @param {?} object\n * @return {!$jscomp.generator.Context.PropertyIterator}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Context.prototype.forIn = function(object) {\n  return new $jscomp.generator.Context.PropertyIterator(object);\n};\n\n/**\n * @constructor\n * @final\n * @struct\n * @param {?} object\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Context.PropertyIterator = function(object) {\n  /**\n   * @private\n   * @const\n   * @type {?}\n   */\n  this.object_ = object;\n\n  /**\n   * @private\n   * @const\n   * @type {!Array<string>}\n   */\n  this.properties_ = [];\n\n  for (var property in /** @type {!Object} */ (object)) {\n    this.properties_.push(property);\n  }\n  this.properties_.reverse();\n};\n\n/**\n * Returns the next object's property that is still valid.\n *\n * @final\n * @return {?string}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Context.PropertyIterator.prototype.getNext = function() {\n  // The JS spec does not require that properties added after the loop begins\n  // be included in the loop, but it does require that the current property\n  // must still exist on the object when the loop iteration starts.\n  while (this.properties_.length > 0) {\n    /** @const */ var property = this.properties_.pop();\n    if (property in /** @type {!Object} */ (this.object_)) {\n      return property;\n    }\n  }\n  return null;\n};\n\n/**\n * Engine handling execution of a state machine associated with the generator\n * program and its context.\n *\n * @private\n * @template VALUE\n * @constructor\n * @final\n * @struct\n * @param {function(!$jscomp.generator.Context<VALUE>): (void|{value: VALUE})} program\n */\n$jscomp.generator.Engine_ = function(program) {\n  /**\n   * @private\n   * @const\n   * @type {!$jscomp.generator.Context<VALUE>}\n   */\n  this.context_ = new $jscomp.generator.Context();\n\n  /**\n   * @private\n   * @const\n   * @type {function(!$jscomp.generator.Context<VALUE>): (void|{value: VALUE})}\n   */\n  this.program_ = program;\n};\n\n/**\n * Returns an object with two properties done and value.\n * You can also provide a parameter to the next method to send a value to the\n * generator.\n *\n * @private\n * @final\n * @param {?=} value The value to send to the generator.\n * @return {!IIterableResult<VALUE>}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Engine_.prototype.next_ = function(value) {\n  this.context_.start_();\n  if (this.context_.yieldAllIterator_) {\n    return this.yieldAllStep_(\n        this.context_.yieldAllIterator_.next, value, this.context_.next_);\n  }\n  this.context_.next_(value);\n  return this.nextStep_();\n};\n\n/**\n * Attempts to finish the generator with a given value.\n *\n * @private\n * @final\n * @param {VALUE} value The value to return.\n * @return {!IIterableResult<VALUE>}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Engine_.prototype.return_ = function(value) {\n  this.context_.start_();\n  /** @const */ var yieldAllIterator = this.context_.yieldAllIterator_;\n  if (yieldAllIterator) {\n    /** @const @type {function(VALUE): !IIterableResult<VALUE>} */ var\n        returnFunction =\n            'return' in yieldAllIterator ? yieldAllIterator['return'] :\n                                           function(v) {\n                                             return {value: v, done: true};\n                                           };\n    return this.yieldAllStep_(returnFunction, value, this.context_.return);\n  }\n  this.context_.return(value);\n  return this.nextStep_();\n};\n\n/**\n * Resumes the execution of a generator by throwing an error into it and\n * returns an object with two properties done and value.\n *\n * @private\n * @final\n * @param {?} exception The exception to throw.\n * @return {!IIterableResult<VALUE>}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Engine_.prototype.throw_ = function(exception) {\n  this.context_.start_();\n  if (this.context_.yieldAllIterator_) {\n    return this.yieldAllStep_(\n        this.context_.yieldAllIterator_['throw'], exception,\n        this.context_.next_);\n  }\n  this.context_.throw_(exception);\n  return this.nextStep_();\n};\n\n/**\n * Redirects next/throw/return method calls to an iterator passed to \"yield *\".\n *\n * @private\n * @final\n * @template T\n * @param {function(this:Iterator<VALUE>, T): !IIterableResult<VALUE>} action\n * @param {T} value\n * @param {function(this:$jscomp.generator.Context, VALUE): void} nextAction\n * @return {!IIterableResult<VALUE>}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Engine_.prototype.yieldAllStep_ = function(\n    action, value, nextAction) {\n  try {\n    /** @const */ var result = action.call(\n        /** @type {!Iterator<VALUE>} */ (this.context_.yieldAllIterator_),\n        value);\n    $jscomp.generator.ensureIteratorResultIsObject_(result);\n    if (!result.done) {\n      this.context_.stop_();\n      return result;\n    }\n    // After `x = yield *someGenerator()` x is the return value of the\n    // generator, not a value passed to this generator by the next() method.\n    /** @const */ var resultValue = result.value;\n  } catch (e) {\n    this.context_.yieldAllIterator_ = null;\n    this.context_.throw_(e);\n    return this.nextStep_();\n  }\n  this.context_.yieldAllIterator_ = null;\n  nextAction.call(this.context_, resultValue);\n  return this.nextStep_();\n};\n\n/**\n * Continues/resumes program execution until the next suspension point (yield).\n *\n * @private\n * @final\n * @return {!IIterableResult<VALUE>}\n * @suppress {reportUnknownTypes, strictMissingProperties}\n */\n$jscomp.generator.Engine_.prototype.nextStep_ = function() {\n  while (this.context_.nextAddress) {\n    try {\n      /** @const */ var yieldValue = this.program_(this.context_);\n      if (yieldValue) {\n        this.context_.stop_();\n        return {value: yieldValue.value, done: false};\n      }\n    } catch (e) {\n      this.context_.yieldResult = undefined;\n      this.context_.throw_(e);\n    }\n  }\n\n  this.context_.stop_();\n  if (this.context_.abruptCompletion_) {\n    /** @const */ var abruptCompletion = this.context_.abruptCompletion_;\n    this.context_.abruptCompletion_ = null;\n    if (abruptCompletion.isException) {\n      throw abruptCompletion.exception;\n    }\n    return {value: abruptCompletion.return, done: true};\n  }\n  return {value: /** @type {?} */ (undefined), done: true};\n};\n\n/**\n * The Generator object that is returned by a generator function and it\n * conforms to both the iterable protocol and the iterator protocol.\n *\n * @private\n * @template VALUE\n * @constructor\n * @final\n * @implements {Generator<VALUE>}\n * @param {!$jscomp.generator.Engine_<VALUE>} engine\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.Generator_ = function(engine) {\n  /** @const @override */\n  this.next = function(opt_value) {\n    return engine.next_(opt_value);\n  };\n\n  /** @const @override */\n  this.throw = function(exception) {\n    return engine.throw_(exception);\n  };\n\n  /** @const @override */\n  this.return = function(value) {\n    return engine.return_(value);\n  };\n\n  $jscomp.initSymbolIterator();\n\n  /** @this {$jscomp.generator.Generator_<VALUE>} */\n  this[Symbol.iterator] = function() {\n    return this;\n  };\n\n  // TODO(skill): uncomment once Symbol.toStringTag is polyfilled:\n  // this[Symbol.toStringTag] = 'Generator';\n};\n\n/**\n * Creates a generator backed up by Engine running a given program.\n *\n * @final\n * @template VALUE\n * @param {function(this:?, ...): (!Iterator<VALUE>|!Iterable<VALUE>)} generator\n * @param {function(!$jscomp.generator.Context<VALUE>): (void|{value: VALUE})} program\n * @return {!Generator<VALUE>}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.generator.createGenerator = function(generator, program) {\n  /** @const */ var result =\n      new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(program));\n  // The spec says that `myGenFunc() instanceof myGenFunc` must be true.\n  // We'll make this work by setting the prototype before calling the\n  // constructor every time. All of the methods of the object are defined on the\n  // instance by the constructor, so this does no harm.\n  // We also cast Generator_ to Object to hide dynamic inheritance from\n  // jscompiler, it makes ConformanceRules$BanUnknownThis happy.\n  if ($jscomp.setPrototypeOf) {\n    /** @type {function(!Object, ?Object): !Object} */ ($jscomp.setPrototypeOf)(\n        result, generator.prototype);\n  }\n  return result;\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require base';\n'require es6/promise';\n'require es6/generator_engine';\n\n/**\n * Handles the execution of an async function.\n *\n * An async function, foo(a, b), will be rewritten as:\n *\n * ```\n * function foo(a, b) {\n *   let $jscomp$async$this = this;\n *   let $jscomp$async$arguments = arguments;\n *   let $jscomp$async$super$get$x = () => super.x;\n *   function* $jscomp$async$generator() {\n *     // original body of foo() with:\n *     // - await (x) replaced with yield (x)\n *     // - arguments replaced with $jscomp$async$arguments\n *     // - this replaced with $jscomp$async$this\n *     // - super.x replaced with $jscomp$async$super$get$x()\n *     // - super.x(5) replaced with  $jscomp$async$super$get$x()\n *     //      .call($jscomp$async$this, 5)\n *   }\n *   return $jscomp.executeAsyncGenerator($jscomp$async$generator());\n * }\n * ```\n * @param {!Generator<?>} generator\n * @return {!Promise<?>}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.asyncExecutePromiseGenerator = function(generator) {\n  function passValueToGenerator(value) {\n    return generator.next(value);\n  }\n\n  function passErrorToGenerator(error) {\n    return generator.throw(error);\n  }\n\n  return new Promise(function(resolve, reject) {\n    function handleGeneratorRecord(/** !IIterableResult<*> */ genRec) {\n      if (genRec.done) {\n        resolve(genRec.value);\n      } else {\n        // One can await a non-promise, so genRec.value\n        // might not already be a promise.\n        Promise.resolve(genRec.value)\n            .then(passValueToGenerator, passErrorToGenerator)\n            .then(handleGeneratorRecord, reject);\n      }\n    }\n\n    handleGeneratorRecord(generator.next());\n  });\n};\n\n/**\n * Handles the execution of a generator function returning promises.\n *\n * An async function, foo(a, b), will be rewritten as:\n *\n * ```\n * function foo(a, b) {\n *   let $jscomp$async$this = this;\n *   let $jscomp$async$arguments = arguments;\n *   let $jscomp$async$super$get$x = () => super.x;\n *   return $jscomp.asyncExecutePromiseGeneratorFunction(\n *       function* () {\n *         // original body of foo() with:\n *         // - await (x) replaced with yield (x)\n *         // - arguments replaced with $jscomp$async$arguments\n *         // - this replaced with $jscomp$async$this\n *         // - super.x replaced with $jscomp$async$super$get$x()\n *         // - super.x(5) replaced with  $jscomp$async$super$get$x()\n *         //      .call($jscomp$async$this, 5)\n *       });\n * }\n * ```\n * @param {function(): !Generator<?>} generatorFunction\n * @return {!Promise<?>}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.asyncExecutePromiseGeneratorFunction = function(generatorFunction) {\n  return $jscomp.asyncExecutePromiseGenerator(generatorFunction());\n};\n\n/**\n * Handles the execution of a state machine program that represents transpiled\n * async function.\n *\n * @final\n * @param {function(!$jscomp.generator.Context<?>): (void|{value: ?})} program\n * @return {!Promise<?>}\n * @suppress {reportUnknownTypes, visibility}\n */\n$jscomp.asyncExecutePromiseGeneratorProgram = function(program) {\n  return $jscomp.asyncExecutePromiseGenerator(\n      new $jscomp.generator.Generator_(\n          new $jscomp.generator.Engine_(\n              program)));\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for manipulating the browser's Document Object Model\n * Inspiration taken *heavily* from mochikit (http://mochikit.com/).\n *\n * You can use {@link goog.dom.DomHelper} to create new dom helpers that refer\n * to a different document object.  This is useful if you are working with\n * frames or multiple windows.\n *\n * @author arv@google.com (Erik Arvidsson)\n * @suppress {strictMissingProperties}\n */\n\n\n// TODO(arv): Rename/refactor getTextContent and getRawTextContent. The problem\n// is that getTextContent should mimic the DOM3 textContent. We should add a\n// getInnerText (or getText) which tries to return the visible text, innerText.\n\n\ngoog.provide('goog.dom');\ngoog.provide('goog.dom.Appendable');\ngoog.provide('goog.dom.DomHelper');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom.BrowserFeature');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.safe');\ngoog.require('goog.html.SafeHtml');\ngoog.require('goog.html.uncheckedconversions');\ngoog.require('goog.math.Coordinate');\ngoog.require('goog.math.Size');\ngoog.require('goog.object');\ngoog.require('goog.string');\ngoog.require('goog.string.Unicode');\ngoog.require('goog.userAgent');\n\n\n/**\n * @define {boolean} Whether we know at compile time that the browser is in\n * quirks mode.\n */\ngoog.define('goog.dom.ASSUME_QUIRKS_MODE', false);\n\n\n/**\n * @define {boolean} Whether we know at compile time that the browser is in\n * standards compliance mode.\n */\ngoog.define('goog.dom.ASSUME_STANDARDS_MODE', false);\n\n\n/**\n * Whether we know the compatibility mode at compile time.\n * @type {boolean}\n * @private\n */\ngoog.dom.COMPAT_MODE_KNOWN_ =\n    goog.dom.ASSUME_QUIRKS_MODE || goog.dom.ASSUME_STANDARDS_MODE;\n\n\n/**\n * Gets the DomHelper object for the document where the element resides.\n * @param {(Node|Window)=} opt_element If present, gets the DomHelper for this\n *     element.\n * @return {!goog.dom.DomHelper} The DomHelper.\n */\ngoog.dom.getDomHelper = function(opt_element) {\n  return opt_element ?\n      new goog.dom.DomHelper(goog.dom.getOwnerDocument(opt_element)) :\n      (goog.dom.defaultDomHelper_ ||\n       (goog.dom.defaultDomHelper_ = new goog.dom.DomHelper()));\n};\n\n\n/**\n * Cached default DOM helper.\n * @type {!goog.dom.DomHelper|undefined}\n * @private\n */\ngoog.dom.defaultDomHelper_;\n\n\n/**\n * Gets the document object being used by the dom library.\n * @return {!Document} Document object.\n */\ngoog.dom.getDocument = function() {\n  return document;\n};\n\n\n/**\n * Gets an element from the current document by element id.\n *\n * If an Element is passed in, it is returned.\n *\n * @param {string|Element} element Element ID or a DOM node.\n * @return {Element} The element with the given ID, or the node passed in.\n */\ngoog.dom.getElement = function(element) {\n  return goog.dom.getElementHelper_(document, element);\n};\n\n\n/**\n * Gets an element by id from the given document (if present).\n * If an element is given, it is returned.\n * @param {!Document} doc\n * @param {string|Element} element Element ID or a DOM node.\n * @return {Element} The resulting element.\n * @private\n */\ngoog.dom.getElementHelper_ = function(doc, element) {\n  return goog.isString(element) ? doc.getElementById(element) : element;\n};\n\n\n/**\n * Gets an element by id, asserting that the element is found.\n *\n * This is used when an element is expected to exist, and should fail with\n * an assertion error if it does not (if assertions are enabled).\n *\n * @param {string} id Element ID.\n * @return {!Element} The element with the given ID, if it exists.\n */\ngoog.dom.getRequiredElement = function(id) {\n  return goog.dom.getRequiredElementHelper_(document, id);\n};\n\n\n/**\n * Helper function for getRequiredElementHelper functions, both static and\n * on DomHelper.  Asserts the element with the given id exists.\n * @param {!Document} doc\n * @param {string} id\n * @return {!Element} The element with the given ID, if it exists.\n * @private\n */\ngoog.dom.getRequiredElementHelper_ = function(doc, id) {\n  // To prevent users passing in Elements as is permitted in getElement().\n  goog.asserts.assertString(id);\n  var element = goog.dom.getElementHelper_(doc, id);\n  element =\n      goog.asserts.assertElement(element, 'No element found with id: ' + id);\n  return element;\n};\n\n\n/**\n * Alias for getElement.\n * @param {string|Element} element Element ID or a DOM node.\n * @return {Element} The element with the given ID, or the node passed in.\n * @deprecated Use {@link goog.dom.getElement} instead.\n */\ngoog.dom.$ = goog.dom.getElement;\n\n\n/**\n * Gets elements by tag name.\n * @param {!goog.dom.TagName<T>} tagName\n * @param {(!Document|!Element)=} opt_parent Parent element or document where to\n *     look for elements. Defaults to document.\n * @return {!NodeList<R>} List of elements. The members of the list are\n *     {!Element} if tagName is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.getElementsByTagName = function(tagName, opt_parent) {\n  var parent = opt_parent || document;\n  return parent.getElementsByTagName(String(tagName));\n};\n\n\n/**\n * Looks up elements by both tag and class name, using browser native functions\n * (`querySelectorAll`, `getElementsByTagName` or\n * `getElementsByClassName`) where possible. This function\n * is a useful, if limited, way of collecting a list of DOM elements\n * with certain characteristics.  `goog.dom.query` offers a\n * more powerful and general solution which allows matching on CSS3\n * selector expressions, but at increased cost in code size. If all you\n * need is particular tags belonging to a single class, this function\n * is fast and sleek.\n *\n * Note that tag names are case sensitive in the SVG namespace, and this\n * function converts opt_tag to uppercase for comparisons. For queries in the\n * SVG namespace you should use querySelector or querySelectorAll instead.\n * https://bugzilla.mozilla.org/show_bug.cgi?id=963870\n * https://bugs.webkit.org/show_bug.cgi?id=83438\n *\n * @see {goog.dom.query}\n *\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name.\n * @param {?string=} opt_class Optional class name.\n * @param {(Document|Element)=} opt_el Optional element to look in.\n * @return {!IArrayLike<R>} Array-like list of elements (only a length property\n *     and numerical indices are guaranteed to exist). The members of the array\n *     are {!Element} if opt_tag is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.getElementsByTagNameAndClass = function(opt_tag, opt_class, opt_el) {\n  return goog.dom.getElementsByTagNameAndClass_(\n      document, opt_tag, opt_class, opt_el);\n};\n\n\n/**\n * Gets the first element matching the tag and the class.\n *\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name.\n * @param {?string=} opt_class Optional class name.\n * @param {(Document|Element)=} opt_el Optional element to look in.\n * @return {?R} Reference to a DOM node. The return type is {?Element} if\n *     tagName is a string or a more specific type if it is a member of\n *     goog.dom.TagName (e.g. {?HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.getElementByTagNameAndClass = function(opt_tag, opt_class, opt_el) {\n  return goog.dom.getElementByTagNameAndClass_(\n      document, opt_tag, opt_class, opt_el);\n};\n\n\n/**\n * Returns a static, array-like list of the elements with the provided\n * className.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {(Document|Element)=} opt_el Optional element to look in.\n * @return {!IArrayLike<!Element>} The items found with the class name provided.\n */\ngoog.dom.getElementsByClass = function(className, opt_el) {\n  var parent = opt_el || document;\n  if (goog.dom.canUseQuerySelector_(parent)) {\n    return parent.querySelectorAll('.' + className);\n  }\n  return goog.dom.getElementsByTagNameAndClass_(\n      document, '*', className, opt_el);\n};\n\n\n/**\n * Returns the first element with the provided className.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {Element|Document=} opt_el Optional element to look in.\n * @return {Element} The first item with the class name provided.\n */\ngoog.dom.getElementByClass = function(className, opt_el) {\n  var parent = opt_el || document;\n  var retVal = null;\n  if (parent.getElementsByClassName) {\n    retVal = parent.getElementsByClassName(className)[0];\n  } else {\n    retVal =\n        goog.dom.getElementByTagNameAndClass_(document, '*', className, opt_el);\n  }\n  return retVal || null;\n};\n\n\n/**\n * Ensures an element with the given className exists, and then returns the\n * first element with the provided className.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {!Element|!Document=} opt_root Optional element or document to look\n *     in.\n * @return {!Element} The first item with the class name provided.\n * @throws {goog.asserts.AssertionError} Thrown if no element is found.\n */\ngoog.dom.getRequiredElementByClass = function(className, opt_root) {\n  var retValue = goog.dom.getElementByClass(className, opt_root);\n  return goog.asserts.assert(\n      retValue, 'No element found with className: ' + className);\n};\n\n\n/**\n * Prefer the standardized (http://www.w3.org/TR/selectors-api/), native and\n * fast W3C Selectors API.\n * @param {!(Element|Document)} parent The parent document object.\n * @return {boolean} whether or not we can use parent.querySelector* APIs.\n * @private\n */\ngoog.dom.canUseQuerySelector_ = function(parent) {\n  return !!(parent.querySelectorAll && parent.querySelector);\n};\n\n\n/**\n * Helper for `getElementsByTagNameAndClass`.\n * @param {!Document} doc The document to get the elements in.\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name.\n * @param {?string=} opt_class Optional class name.\n * @param {(Document|Element)=} opt_el Optional element to look in.\n * @return {!IArrayLike<R>} Array-like list of elements (only a length property\n *     and numerical indices are guaranteed to exist). The members of the array\n *     are {!Element} if opt_tag is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n * @private\n */\ngoog.dom.getElementsByTagNameAndClass_ = function(\n    doc, opt_tag, opt_class, opt_el) {\n  var parent = opt_el || doc;\n  var tagName =\n      (opt_tag && opt_tag != '*') ? String(opt_tag).toUpperCase() : '';\n\n  if (goog.dom.canUseQuerySelector_(parent) && (tagName || opt_class)) {\n    var query = tagName + (opt_class ? '.' + opt_class : '');\n    return parent.querySelectorAll(query);\n  }\n\n  // Use the native getElementsByClassName if available, under the assumption\n  // that even when the tag name is specified, there will be fewer elements to\n  // filter through when going by class than by tag name\n  if (opt_class && parent.getElementsByClassName) {\n    var els = parent.getElementsByClassName(opt_class);\n\n    if (tagName) {\n      var arrayLike = {};\n      var len = 0;\n\n      // Filter for specific tags if requested.\n      for (var i = 0, el; el = els[i]; i++) {\n        if (tagName == el.nodeName) {\n          arrayLike[len++] = el;\n        }\n      }\n      arrayLike.length = len;\n\n      return /** @type {!IArrayLike<!Element>} */ (arrayLike);\n    } else {\n      return els;\n    }\n  }\n\n  var els = parent.getElementsByTagName(tagName || '*');\n\n  if (opt_class) {\n    var arrayLike = {};\n    var len = 0;\n    for (var i = 0, el; el = els[i]; i++) {\n      var className = el.className;\n      // Check if className has a split function since SVG className does not.\n      if (typeof className.split == 'function' &&\n          goog.array.contains(className.split(/\\s+/), opt_class)) {\n        arrayLike[len++] = el;\n      }\n    }\n    arrayLike.length = len;\n    return /** @type {!IArrayLike<!Element>} */ (arrayLike);\n  } else {\n    return els;\n  }\n};\n\n\n/**\n * Helper for goog.dom.getElementByTagNameAndClass.\n *\n * @param {!Document} doc The document to get the elements in.\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name.\n * @param {?string=} opt_class Optional class name.\n * @param {(Document|Element)=} opt_el Optional element to look in.\n * @return {?R} Reference to a DOM node. The return type is {?Element} if\n *     tagName is a string or a more specific type if it is a member of\n *     goog.dom.TagName (e.g. {?HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n * @private\n */\ngoog.dom.getElementByTagNameAndClass_ = function(\n    doc, opt_tag, opt_class, opt_el) {\n  var parent = opt_el || doc;\n  var tag = (opt_tag && opt_tag != '*') ? String(opt_tag).toUpperCase() : '';\n  if (goog.dom.canUseQuerySelector_(parent) && (tag || opt_class)) {\n    return parent.querySelector(tag + (opt_class ? '.' + opt_class : ''));\n  }\n  var elements =\n      goog.dom.getElementsByTagNameAndClass_(doc, opt_tag, opt_class, opt_el);\n  return elements[0] || null;\n};\n\n\n\n/**\n * Alias for `getElementsByTagNameAndClass`.\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name.\n * @param {?string=} opt_class Optional class name.\n * @param {Element=} opt_el Optional element to look in.\n * @return {!IArrayLike<R>} Array-like list of elements (only a length property\n *     and numerical indices are guaranteed to exist). The members of the array\n *     are {!Element} if opt_tag is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n * @deprecated Use {@link goog.dom.getElementsByTagNameAndClass} instead.\n */\ngoog.dom.$$ = goog.dom.getElementsByTagNameAndClass;\n\n\n/**\n * Sets multiple properties, and sometimes attributes, on an element. Note that\n * properties are simply object properties on the element instance, while\n * attributes are visible in the DOM. Many properties map to attributes with the\n * same names, some with different names, and there are also unmappable cases.\n *\n * This method sets properties by default (which means that custom attributes\n * are not supported). These are the exeptions (some of which is legacy):\n * - \"style\": Even though this is an attribute name, it is translated to a\n *   property, \"style.cssText\". Note that this property sanitizes and formats\n *   its value, unlike the attribute.\n * - \"class\": This is an attribute name, it is translated to the \"className\"\n *   property.\n * - \"for\": This is an attribute name, it is translated to the \"htmlFor\"\n *   property.\n * - Entries in {@see goog.dom.DIRECT_ATTRIBUTE_MAP_} are set as attributes,\n *   this is probably due to browser quirks.\n * - \"aria-*\", \"data-*\": Always set as attributes, they have no property\n *   counterparts.\n *\n * @param {Element} element DOM node to set properties on.\n * @param {Object} properties Hash of property:value pairs.\n *     Property values can be strings or goog.string.TypedString values (such as\n *     goog.html.SafeUrl).\n */\ngoog.dom.setProperties = function(element, properties) {\n  goog.object.forEach(properties, function(val, key) {\n    if (val && typeof val == 'object' && val.implementsGoogStringTypedString) {\n      val = val.getTypedStringValue();\n    }\n    if (key == 'style') {\n      element.style.cssText = val;\n    } else if (key == 'class') {\n      element.className = val;\n    } else if (key == 'for') {\n      element.htmlFor = val;\n    } else if (goog.dom.DIRECT_ATTRIBUTE_MAP_.hasOwnProperty(key)) {\n      element.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[key], val);\n    } else if (\n        goog.string.startsWith(key, 'aria-') ||\n        goog.string.startsWith(key, 'data-')) {\n      element.setAttribute(key, val);\n    } else {\n      element[key] = val;\n    }\n  });\n};\n\n\n/**\n * Map of attributes that should be set using\n * element.setAttribute(key, val) instead of element[key] = val.  Used\n * by goog.dom.setProperties.\n *\n * @private {!Object<string, string>}\n * @const\n */\ngoog.dom.DIRECT_ATTRIBUTE_MAP_ = {\n  'cellpadding': 'cellPadding',\n  'cellspacing': 'cellSpacing',\n  'colspan': 'colSpan',\n  'frameborder': 'frameBorder',\n  'height': 'height',\n  'maxlength': 'maxLength',\n  'nonce': 'nonce',\n  'role': 'role',\n  'rowspan': 'rowSpan',\n  'type': 'type',\n  'usemap': 'useMap',\n  'valign': 'vAlign',\n  'width': 'width'\n};\n\n\n/**\n * Gets the dimensions of the viewport.\n *\n * Gecko Standards mode:\n * docEl.clientWidth  Width of viewport excluding scrollbar.\n * win.innerWidth     Width of viewport including scrollbar.\n * body.clientWidth   Width of body element.\n *\n * docEl.clientHeight Height of viewport excluding scrollbar.\n * win.innerHeight    Height of viewport including scrollbar.\n * body.clientHeight  Height of document.\n *\n * Gecko Backwards compatible mode:\n * docEl.clientWidth  Width of viewport excluding scrollbar.\n * win.innerWidth     Width of viewport including scrollbar.\n * body.clientWidth   Width of viewport excluding scrollbar.\n *\n * docEl.clientHeight Height of document.\n * win.innerHeight    Height of viewport including scrollbar.\n * body.clientHeight  Height of viewport excluding scrollbar.\n *\n * IE6/7 Standards mode:\n * docEl.clientWidth  Width of viewport excluding scrollbar.\n * win.innerWidth     Undefined.\n * body.clientWidth   Width of body element.\n *\n * docEl.clientHeight Height of viewport excluding scrollbar.\n * win.innerHeight    Undefined.\n * body.clientHeight  Height of document element.\n *\n * IE5 + IE6/7 Backwards compatible mode:\n * docEl.clientWidth  0.\n * win.innerWidth     Undefined.\n * body.clientWidth   Width of viewport excluding scrollbar.\n *\n * docEl.clientHeight 0.\n * win.innerHeight    Undefined.\n * body.clientHeight  Height of viewport excluding scrollbar.\n *\n * Opera 9 Standards and backwards compatible mode:\n * docEl.clientWidth  Width of viewport excluding scrollbar.\n * win.innerWidth     Width of viewport including scrollbar.\n * body.clientWidth   Width of viewport excluding scrollbar.\n *\n * docEl.clientHeight Height of document.\n * win.innerHeight    Height of viewport including scrollbar.\n * body.clientHeight  Height of viewport excluding scrollbar.\n *\n * WebKit:\n * Safari 2\n * docEl.clientHeight Same as scrollHeight.\n * docEl.clientWidth  Same as innerWidth.\n * win.innerWidth     Width of viewport excluding scrollbar.\n * win.innerHeight    Height of the viewport including scrollbar.\n * frame.innerHeight  Height of the viewport exluding scrollbar.\n *\n * Safari 3 (tested in 522)\n *\n * docEl.clientWidth  Width of viewport excluding scrollbar.\n * docEl.clientHeight Height of viewport excluding scrollbar in strict mode.\n * body.clientHeight  Height of viewport excluding scrollbar in quirks mode.\n *\n * @param {Window=} opt_window Optional window element to test.\n * @return {!goog.math.Size} Object with values 'width' and 'height'.\n */\ngoog.dom.getViewportSize = function(opt_window) {\n  // TODO(arv): This should not take an argument\n  return goog.dom.getViewportSize_(opt_window || window);\n};\n\n\n/**\n * Helper for `getViewportSize`.\n * @param {Window} win The window to get the view port size for.\n * @return {!goog.math.Size} Object with values 'width' and 'height'.\n * @private\n */\ngoog.dom.getViewportSize_ = function(win) {\n  var doc = win.document;\n  var el = goog.dom.isCss1CompatMode_(doc) ? doc.documentElement : doc.body;\n  return new goog.math.Size(el.clientWidth, el.clientHeight);\n};\n\n\n/**\n * Calculates the height of the document.\n *\n * @return {number} The height of the current document.\n */\ngoog.dom.getDocumentHeight = function() {\n  return goog.dom.getDocumentHeight_(window);\n};\n\n/**\n * Calculates the height of the document of the given window.\n *\n * @param {!Window} win The window whose document height to retrieve.\n * @return {number} The height of the document of the given window.\n */\ngoog.dom.getDocumentHeightForWindow = function(win) {\n  return goog.dom.getDocumentHeight_(win);\n};\n\n/**\n * Calculates the height of the document of the given window.\n *\n * Function code copied from the opensocial gadget api:\n *   gadgets.window.adjustHeight(opt_height)\n *\n * @private\n * @param {!Window} win The window whose document height to retrieve.\n * @return {number} The height of the document of the given window.\n */\ngoog.dom.getDocumentHeight_ = function(win) {\n  // NOTE(eae): This method will return the window size rather than the document\n  // size in webkit quirks mode.\n  var doc = win.document;\n  var height = 0;\n\n  if (doc) {\n    // Calculating inner content height is hard and different between\n    // browsers rendering in Strict vs. Quirks mode.  We use a combination of\n    // three properties within document.body and document.documentElement:\n    // - scrollHeight\n    // - offsetHeight\n    // - clientHeight\n    // These values differ significantly between browsers and rendering modes.\n    // But there are patterns.  It just takes a lot of time and persistence\n    // to figure out.\n\n    var body = doc.body;\n    var docEl = /** @type {!HTMLElement} */ (doc.documentElement);\n    if (!(docEl && body)) {\n      return 0;\n    }\n\n    // Get the height of the viewport\n    var vh = goog.dom.getViewportSize_(win).height;\n    if (goog.dom.isCss1CompatMode_(doc) && docEl.scrollHeight) {\n      // In Strict mode:\n      // The inner content height is contained in either:\n      //    document.documentElement.scrollHeight\n      //    document.documentElement.offsetHeight\n      // Based on studying the values output by different browsers,\n      // use the value that's NOT equal to the viewport height found above.\n      height =\n          docEl.scrollHeight != vh ? docEl.scrollHeight : docEl.offsetHeight;\n    } else {\n      // In Quirks mode:\n      // documentElement.clientHeight is equal to documentElement.offsetHeight\n      // except in IE.  In most browsers, document.documentElement can be used\n      // to calculate the inner content height.\n      // However, in other browsers (e.g. IE), document.body must be used\n      // instead.  How do we know which one to use?\n      // If document.documentElement.clientHeight does NOT equal\n      // document.documentElement.offsetHeight, then use document.body.\n      var sh = docEl.scrollHeight;\n      var oh = docEl.offsetHeight;\n      if (docEl.clientHeight != oh) {\n        sh = body.scrollHeight;\n        oh = body.offsetHeight;\n      }\n\n      // Detect whether the inner content height is bigger or smaller\n      // than the bounding box (viewport).  If bigger, take the larger\n      // value.  If smaller, take the smaller value.\n      if (sh > vh) {\n        // Content is larger\n        height = sh > oh ? sh : oh;\n      } else {\n        // Content is smaller\n        height = sh < oh ? sh : oh;\n      }\n    }\n  }\n\n  return height;\n};\n\n\n/**\n * Gets the page scroll distance as a coordinate object.\n *\n * @param {Window=} opt_window Optional window element to test.\n * @return {!goog.math.Coordinate} Object with values 'x' and 'y'.\n * @deprecated Use {@link goog.dom.getDocumentScroll} instead.\n */\ngoog.dom.getPageScroll = function(opt_window) {\n  var win = opt_window || goog.global || window;\n  return goog.dom.getDomHelper(win.document).getDocumentScroll();\n};\n\n\n/**\n * Gets the document scroll distance as a coordinate object.\n *\n * @return {!goog.math.Coordinate} Object with values 'x' and 'y'.\n */\ngoog.dom.getDocumentScroll = function() {\n  return goog.dom.getDocumentScroll_(document);\n};\n\n\n/**\n * Helper for `getDocumentScroll`.\n *\n * @param {!Document} doc The document to get the scroll for.\n * @return {!goog.math.Coordinate} Object with values 'x' and 'y'.\n * @private\n */\ngoog.dom.getDocumentScroll_ = function(doc) {\n  var el = goog.dom.getDocumentScrollElement_(doc);\n  var win = goog.dom.getWindow_(doc);\n  if (goog.userAgent.IE && goog.userAgent.isVersionOrHigher('10') &&\n      win.pageYOffset != el.scrollTop) {\n    // The keyboard on IE10 touch devices shifts the page using the pageYOffset\n    // without modifying scrollTop. For this case, we want the body scroll\n    // offsets.\n    return new goog.math.Coordinate(el.scrollLeft, el.scrollTop);\n  }\n  return new goog.math.Coordinate(\n      win.pageXOffset || el.scrollLeft, win.pageYOffset || el.scrollTop);\n};\n\n\n/**\n * Gets the document scroll element.\n * @return {!Element} Scrolling element.\n */\ngoog.dom.getDocumentScrollElement = function() {\n  return goog.dom.getDocumentScrollElement_(document);\n};\n\n\n/**\n * Helper for `getDocumentScrollElement`.\n * @param {!Document} doc The document to get the scroll element for.\n * @return {!Element} Scrolling element.\n * @private\n */\ngoog.dom.getDocumentScrollElement_ = function(doc) {\n  // Old WebKit needs body.scrollLeft in both quirks mode and strict mode. We\n  // also default to the documentElement if the document does not have a body\n  // (e.g. a SVG document).\n  // Uses http://dev.w3.org/csswg/cssom-view/#dom-document-scrollingelement to\n  // avoid trying to guess about browser behavior from the UA string.\n  if (doc.scrollingElement) {\n    return doc.scrollingElement;\n  }\n  if (!goog.userAgent.WEBKIT && goog.dom.isCss1CompatMode_(doc)) {\n    return doc.documentElement;\n  }\n  return doc.body || doc.documentElement;\n};\n\n\n/**\n * Gets the window object associated with the given document.\n *\n * @param {Document=} opt_doc  Document object to get window for.\n * @return {!Window} The window associated with the given document.\n */\ngoog.dom.getWindow = function(opt_doc) {\n  // TODO(arv): This should not take an argument.\n  return opt_doc ? goog.dom.getWindow_(opt_doc) : window;\n};\n\n\n/**\n * Helper for `getWindow`.\n *\n * @param {!Document} doc  Document object to get window for.\n * @return {!Window} The window associated with the given document.\n * @private\n */\ngoog.dom.getWindow_ = function(doc) {\n  return /** @type {!Window} */ (doc.parentWindow || doc.defaultView);\n};\n\n\n/**\n * Returns a dom node with a set of attributes.  This function accepts varargs\n * for subsequent nodes to be added.  Subsequent nodes will be added to the\n * first node as childNodes.\n *\n * So:\n * <code>createDom(goog.dom.TagName.DIV, null, createDom(goog.dom.TagName.P),\n * createDom(goog.dom.TagName.P));</code> would return a div with two child\n * paragraphs\n *\n * For passing properties, please see {@link goog.dom.setProperties} for more\n * information.\n *\n * @param {string|!goog.dom.TagName<T>} tagName Tag to create.\n * @param {?Object|?Array<string>|string=} opt_attributes If object, then a map\n *     of name-value pairs for attributes. If a string, then this is the\n *     className of the new element. If an array, the elements will be joined\n *     together as the className of the new element.\n * @param {...(Object|string|Array|NodeList|null|undefined)} var_args Further\n *     DOM nodes or strings for text nodes. If one of the var_args is an array\n *     or NodeList, its elements will be added as childNodes instead.\n * @return {R} Reference to a DOM node. The return type is {!Element} if tagName\n *     is a string or a more specific type if it is a member of\n *     goog.dom.TagName (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.createDom = function(tagName, opt_attributes, var_args) {\n  return goog.dom.createDom_(document, arguments);\n};\n\n\n/**\n * Helper for `createDom`.\n * @param {!Document} doc The document to create the DOM in.\n * @param {!Arguments} args Argument object passed from the callers. See\n *     `goog.dom.createDom` for details.\n * @return {!Element} Reference to a DOM node.\n * @private\n */\ngoog.dom.createDom_ = function(doc, args) {\n  var tagName = String(args[0]);\n  var attributes = args[1];\n\n  // Internet Explorer is dumb:\n  // name: https://msdn.microsoft.com/en-us/library/ms534184(v=vs.85).aspx\n  // type: https://msdn.microsoft.com/en-us/library/ms534700(v=vs.85).aspx\n  // Also does not allow setting of 'type' attribute on 'input' or 'button'.\n  if (!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES && attributes &&\n      (attributes.name || attributes.type)) {\n    var tagNameArr = ['<', tagName];\n    if (attributes.name) {\n      tagNameArr.push(' name=\"', goog.string.htmlEscape(attributes.name), '\"');\n    }\n    if (attributes.type) {\n      tagNameArr.push(' type=\"', goog.string.htmlEscape(attributes.type), '\"');\n\n      // Clone attributes map to remove 'type' without mutating the input.\n      var clone = {};\n      goog.object.extend(clone, attributes);\n\n      // JSCompiler can't see how goog.object.extend added this property,\n      // because it was essentially added by reflection.\n      // So it needs to be quoted.\n      delete clone['type'];\n\n      attributes = clone;\n    }\n    tagNameArr.push('>');\n    tagName = tagNameArr.join('');\n  }\n\n  var element = doc.createElement(tagName);\n\n  if (attributes) {\n    if (goog.isString(attributes)) {\n      element.className = attributes;\n    } else if (goog.isArray(attributes)) {\n      element.className = attributes.join(' ');\n    } else {\n      goog.dom.setProperties(element, attributes);\n    }\n  }\n\n  if (args.length > 2) {\n    goog.dom.append_(doc, element, args, 2);\n  }\n\n  return element;\n};\n\n\n/**\n * Appends a node with text or other nodes.\n * @param {!Document} doc The document to create new nodes in.\n * @param {!Node} parent The node to append nodes to.\n * @param {!Arguments} args The values to add. See `goog.dom.append`.\n * @param {number} startIndex The index of the array to start from.\n * @private\n */\ngoog.dom.append_ = function(doc, parent, args, startIndex) {\n  function childHandler(child) {\n    // TODO(user): More coercion, ala MochiKit?\n    if (child) {\n      parent.appendChild(\n          goog.isString(child) ? doc.createTextNode(child) : child);\n    }\n  }\n\n  for (var i = startIndex; i < args.length; i++) {\n    var arg = args[i];\n    // TODO(attila): Fix isArrayLike to return false for a text node.\n    if (goog.isArrayLike(arg) && !goog.dom.isNodeLike(arg)) {\n      // If the argument is a node list, not a real array, use a clone,\n      // because forEach can't be used to mutate a NodeList.\n      goog.array.forEach(\n          goog.dom.isNodeList(arg) ? goog.array.toArray(arg) : arg,\n          childHandler);\n    } else {\n      childHandler(arg);\n    }\n  }\n};\n\n\n/**\n * Alias for `createDom`.\n * @param {string|!goog.dom.TagName<T>} tagName Tag to create.\n * @param {?Object|?Array<string>|string=} opt_attributes If object, then a map\n *     of name-value pairs for attributes. If a string, then this is the\n *     className of the new element. If an array, the elements will be joined\n *     together as the className of the new element.\n * @param {...(Object|string|Array|NodeList|null|undefined)} var_args Further\n *     DOM nodes or strings for text nodes. If one of the var_args is an array,\n *     its children will be added as childNodes instead.\n * @return {R} Reference to a DOM node. The return type is {!Element} if tagName\n *     is a string or a more specific type if it is a member of\n *     goog.dom.TagName (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n * @deprecated Use {@link goog.dom.createDom} instead.\n */\ngoog.dom.$dom = goog.dom.createDom;\n\n\n/**\n * Creates a new element.\n * @param {string|!goog.dom.TagName<T>} name Tag to create.\n * @return {R} The new element. The return type is {!Element} if name is\n *     a string or a more specific type if it is a member of goog.dom.TagName\n *     (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.createElement = function(name) {\n  return goog.dom.createElement_(document, name);\n};\n\n\n/**\n * Creates a new element.\n * @param {!Document} doc The document to create the element in.\n * @param {string|!goog.dom.TagName<T>} name Tag to create.\n * @return {R} The new element. The return type is {!Element} if name is\n *     a string or a more specific type if it is a member of goog.dom.TagName\n *     (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n * @private\n */\ngoog.dom.createElement_ = function(doc, name) {\n  return doc.createElement(String(name));\n};\n\n\n/**\n * Creates a new text node.\n * @param {number|string} content Content.\n * @return {!Text} The new text node.\n */\ngoog.dom.createTextNode = function(content) {\n  return document.createTextNode(String(content));\n};\n\n\n/**\n * Create a table.\n * @param {number} rows The number of rows in the table.  Must be >= 1.\n * @param {number} columns The number of columns in the table.  Must be >= 1.\n * @param {boolean=} opt_fillWithNbsp If true, fills table entries with\n *     `goog.string.Unicode.NBSP` characters.\n * @return {!Element} The created table.\n */\ngoog.dom.createTable = function(rows, columns, opt_fillWithNbsp) {\n  // TODO(mlourenco): Return HTMLTableElement, also in prototype function.\n  // Callers need to be updated to e.g. not assign numbers to table.cellSpacing.\n  return goog.dom.createTable_(document, rows, columns, !!opt_fillWithNbsp);\n};\n\n\n/**\n * Create a table.\n * @param {!Document} doc Document object to use to create the table.\n * @param {number} rows The number of rows in the table.  Must be >= 1.\n * @param {number} columns The number of columns in the table.  Must be >= 1.\n * @param {boolean} fillWithNbsp If true, fills table entries with\n *     `goog.string.Unicode.NBSP` characters.\n * @return {!HTMLTableElement} The created table.\n * @private\n */\ngoog.dom.createTable_ = function(doc, rows, columns, fillWithNbsp) {\n  var table = goog.dom.createElement_(doc, goog.dom.TagName.TABLE);\n  var tbody =\n      table.appendChild(goog.dom.createElement_(doc, goog.dom.TagName.TBODY));\n  for (var i = 0; i < rows; i++) {\n    var tr = goog.dom.createElement_(doc, goog.dom.TagName.TR);\n    for (var j = 0; j < columns; j++) {\n      var td = goog.dom.createElement_(doc, goog.dom.TagName.TD);\n      // IE <= 9 will create a text node if we set text content to the empty\n      // string, so we avoid doing it unless necessary. This ensures that the\n      // same DOM tree is returned on all browsers.\n      if (fillWithNbsp) {\n        goog.dom.setTextContent(td, goog.string.Unicode.NBSP);\n      }\n      tr.appendChild(td);\n    }\n    tbody.appendChild(tr);\n  }\n  return table;\n};\n\n\n\n/**\n * Creates a new Node from constant strings of HTML markup.\n * @param {...!goog.string.Const} var_args The HTML strings to concatenate then\n *     convert into a node.\n * @return {!Node}\n */\ngoog.dom.constHtmlToNode = function(var_args) {\n  var stringArray = goog.array.map(arguments, goog.string.Const.unwrap);\n  var safeHtml =\n      goog.html.uncheckedconversions\n          .safeHtmlFromStringKnownToSatisfyTypeContract(\n              goog.string.Const.from(\n                  'Constant HTML string, that gets turned into a ' +\n                  'Node later, so it will be automatically balanced.'),\n              stringArray.join(''));\n  return goog.dom.safeHtmlToNode(safeHtml);\n};\n\n\n/**\n * Converts HTML markup into a node. This is a safe version of\n * `goog.dom.htmlToDocumentFragment` which is now deleted.\n * @param {!goog.html.SafeHtml} html The HTML markup to convert.\n * @return {!Node} The resulting node.\n */\ngoog.dom.safeHtmlToNode = function(html) {\n  return goog.dom.safeHtmlToNode_(document, html);\n};\n\n\n/**\n * Helper for `safeHtmlToNode`.\n * @param {!Document} doc The document.\n * @param {!goog.html.SafeHtml} html The HTML markup to convert.\n * @return {!Node} The resulting node.\n * @private\n */\ngoog.dom.safeHtmlToNode_ = function(doc, html) {\n  var tempDiv = goog.dom.createElement_(doc, goog.dom.TagName.DIV);\n  if (goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT) {\n    goog.dom.safe.setInnerHtml(\n        tempDiv, goog.html.SafeHtml.concat(goog.html.SafeHtml.BR, html));\n    tempDiv.removeChild(tempDiv.firstChild);\n  } else {\n    goog.dom.safe.setInnerHtml(tempDiv, html);\n  }\n  return goog.dom.childrenToNode_(doc, tempDiv);\n};\n\n\n/**\n * Helper for `safeHtmlToNode_`.\n * @param {!Document} doc The document.\n * @param {!Node} tempDiv The input node.\n * @return {!Node} The resulting node.\n * @private\n */\ngoog.dom.childrenToNode_ = function(doc, tempDiv) {\n  if (tempDiv.childNodes.length == 1) {\n    return tempDiv.removeChild(tempDiv.firstChild);\n  } else {\n    var fragment = doc.createDocumentFragment();\n    while (tempDiv.firstChild) {\n      fragment.appendChild(tempDiv.firstChild);\n    }\n    return fragment;\n  }\n};\n\n\n/**\n * Returns true if the browser is in \"CSS1-compatible\" (standards-compliant)\n * mode, false otherwise.\n * @return {boolean} True if in CSS1-compatible mode.\n */\ngoog.dom.isCss1CompatMode = function() {\n  return goog.dom.isCss1CompatMode_(document);\n};\n\n\n/**\n * Returns true if the browser is in \"CSS1-compatible\" (standards-compliant)\n * mode, false otherwise.\n * @param {!Document} doc The document to check.\n * @return {boolean} True if in CSS1-compatible mode.\n * @private\n */\ngoog.dom.isCss1CompatMode_ = function(doc) {\n  if (goog.dom.COMPAT_MODE_KNOWN_) {\n    return goog.dom.ASSUME_STANDARDS_MODE;\n  }\n\n  return doc.compatMode == 'CSS1Compat';\n};\n\n\n/**\n * Determines if the given node can contain children, intended to be used for\n * HTML generation.\n *\n * IE natively supports node.canHaveChildren but has inconsistent behavior.\n * Prior to IE8 the base tag allows children and in IE9 all nodes return true\n * for canHaveChildren.\n *\n * In practice all non-IE browsers allow you to add children to any node, but\n * the behavior is inconsistent:\n *\n * <pre>\n *   var a = goog.dom.createElement(goog.dom.TagName.BR);\n *   a.appendChild(document.createTextNode('foo'));\n *   a.appendChild(document.createTextNode('bar'));\n *   console.log(a.childNodes.length);  // 2\n *   console.log(a.innerHTML);  // Chrome: \"\", IE9: \"foobar\", FF3.5: \"foobar\"\n * </pre>\n *\n * For more information, see:\n * http://dev.w3.org/html5/markup/syntax.html#syntax-elements\n *\n * TODO(user): Rename shouldAllowChildren() ?\n *\n * @param {Node} node The node to check.\n * @return {boolean} Whether the node can contain children.\n */\ngoog.dom.canHaveChildren = function(node) {\n  if (node.nodeType != goog.dom.NodeType.ELEMENT) {\n    return false;\n  }\n  switch (/** @type {!Element} */ (node).tagName) {\n    case String(goog.dom.TagName.APPLET):\n    case String(goog.dom.TagName.AREA):\n    case String(goog.dom.TagName.BASE):\n    case String(goog.dom.TagName.BR):\n    case String(goog.dom.TagName.COL):\n    case String(goog.dom.TagName.COMMAND):\n    case String(goog.dom.TagName.EMBED):\n    case String(goog.dom.TagName.FRAME):\n    case String(goog.dom.TagName.HR):\n    case String(goog.dom.TagName.IMG):\n    case String(goog.dom.TagName.INPUT):\n    case String(goog.dom.TagName.IFRAME):\n    case String(goog.dom.TagName.ISINDEX):\n    case String(goog.dom.TagName.KEYGEN):\n    case String(goog.dom.TagName.LINK):\n    case String(goog.dom.TagName.NOFRAMES):\n    case String(goog.dom.TagName.NOSCRIPT):\n    case String(goog.dom.TagName.META):\n    case String(goog.dom.TagName.OBJECT):\n    case String(goog.dom.TagName.PARAM):\n    case String(goog.dom.TagName.SCRIPT):\n    case String(goog.dom.TagName.SOURCE):\n    case String(goog.dom.TagName.STYLE):\n    case String(goog.dom.TagName.TRACK):\n    case String(goog.dom.TagName.WBR):\n      return false;\n  }\n  return true;\n};\n\n\n/**\n * Appends a child to a node.\n * @param {Node} parent Parent.\n * @param {Node} child Child.\n */\ngoog.dom.appendChild = function(parent, child) {\n  parent.appendChild(child);\n};\n\n\n/**\n * Appends a node with text or other nodes.\n * @param {!Node} parent The node to append nodes to.\n * @param {...goog.dom.Appendable} var_args The things to append to the node.\n *     If this is a Node it is appended as is.\n *     If this is a string then a text node is appended.\n *     If this is an array like object then fields 0 to length - 1 are appended.\n */\ngoog.dom.append = function(parent, var_args) {\n  goog.dom.append_(goog.dom.getOwnerDocument(parent), parent, arguments, 1);\n};\n\n\n/**\n * Removes all the child nodes on a DOM node.\n * @param {Node} node Node to remove children from.\n */\ngoog.dom.removeChildren = function(node) {\n  // Note: Iterations over live collections can be slow, this is the fastest\n  // we could find. The double parenthesis are used to prevent JsCompiler and\n  // strict warnings.\n  var child;\n  while ((child = node.firstChild)) {\n    node.removeChild(child);\n  }\n};\n\n\n/**\n * Inserts a new node before an existing reference node (i.e. as the previous\n * sibling). If the reference node has no parent, then does nothing.\n * @param {Node} newNode Node to insert.\n * @param {Node} refNode Reference node to insert before.\n */\ngoog.dom.insertSiblingBefore = function(newNode, refNode) {\n  if (refNode.parentNode) {\n    refNode.parentNode.insertBefore(newNode, refNode);\n  }\n};\n\n\n/**\n * Inserts a new node after an existing reference node (i.e. as the next\n * sibling). If the reference node has no parent, then does nothing.\n * @param {Node} newNode Node to insert.\n * @param {Node} refNode Reference node to insert after.\n */\ngoog.dom.insertSiblingAfter = function(newNode, refNode) {\n  if (refNode.parentNode) {\n    refNode.parentNode.insertBefore(newNode, refNode.nextSibling);\n  }\n};\n\n\n/**\n * Insert a child at a given index. If index is larger than the number of child\n * nodes that the parent currently has, the node is inserted as the last child\n * node.\n * @param {Element} parent The element into which to insert the child.\n * @param {Node} child The element to insert.\n * @param {number} index The index at which to insert the new child node. Must\n *     not be negative.\n */\ngoog.dom.insertChildAt = function(parent, child, index) {\n  // Note that if the second argument is null, insertBefore\n  // will append the child at the end of the list of children.\n  parent.insertBefore(child, parent.childNodes[index] || null);\n};\n\n\n/**\n * Removes a node from its parent.\n * @param {Node} node The node to remove.\n * @return {Node} The node removed if removed; else, null.\n */\ngoog.dom.removeNode = function(node) {\n  return node && node.parentNode ? node.parentNode.removeChild(node) : null;\n};\n\n\n/**\n * Replaces a node in the DOM tree. Will do nothing if `oldNode` has no\n * parent.\n * @param {Node} newNode Node to insert.\n * @param {Node} oldNode Node to replace.\n */\ngoog.dom.replaceNode = function(newNode, oldNode) {\n  var parent = oldNode.parentNode;\n  if (parent) {\n    parent.replaceChild(newNode, oldNode);\n  }\n};\n\n\n/**\n * Flattens an element. That is, removes it and replace it with its children.\n * Does nothing if the element is not in the document.\n * @param {Element} element The element to flatten.\n * @return {Element|undefined} The original element, detached from the document\n *     tree, sans children; or undefined, if the element was not in the document\n *     to begin with.\n */\ngoog.dom.flattenElement = function(element) {\n  var child, parent = element.parentNode;\n  if (parent && parent.nodeType != goog.dom.NodeType.DOCUMENT_FRAGMENT) {\n    // Use IE DOM method (supported by Opera too) if available\n    if (element.removeNode) {\n      return /** @type {Element} */ (element.removeNode(false));\n    } else {\n      // Move all children of the original node up one level.\n      while ((child = element.firstChild)) {\n        parent.insertBefore(child, element);\n      }\n\n      // Detach the original element.\n      return /** @type {Element} */ (goog.dom.removeNode(element));\n    }\n  }\n};\n\n\n/**\n * Returns an array containing just the element children of the given element.\n * @param {Element} element The element whose element children we want.\n * @return {!(Array<!Element>|NodeList<!Element>)} An array or array-like list\n *     of just the element children of the given element.\n */\ngoog.dom.getChildren = function(element) {\n  // We check if the children attribute is supported for child elements\n  // since IE8 misuses the attribute by also including comments.\n  if (goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE &&\n      element.children != undefined) {\n    return element.children;\n  }\n  // Fall back to manually filtering the element's child nodes.\n  return goog.array.filter(element.childNodes, function(node) {\n    return node.nodeType == goog.dom.NodeType.ELEMENT;\n  });\n};\n\n\n/**\n * Returns the first child node that is an element.\n * @param {Node} node The node to get the first child element of.\n * @return {Element} The first child node of `node` that is an element.\n */\ngoog.dom.getFirstElementChild = function(node) {\n  if (goog.isDef(node.firstElementChild)) {\n    return /** @type {!Element} */ (node).firstElementChild;\n  }\n  return goog.dom.getNextElementNode_(node.firstChild, true);\n};\n\n\n/**\n * Returns the last child node that is an element.\n * @param {Node} node The node to get the last child element of.\n * @return {Element} The last child node of `node` that is an element.\n */\ngoog.dom.getLastElementChild = function(node) {\n  if (goog.isDef(node.lastElementChild)) {\n    return /** @type {!Element} */ (node).lastElementChild;\n  }\n  return goog.dom.getNextElementNode_(node.lastChild, false);\n};\n\n\n/**\n * Returns the first next sibling that is an element.\n * @param {Node} node The node to get the next sibling element of.\n * @return {Element} The next sibling of `node` that is an element.\n */\ngoog.dom.getNextElementSibling = function(node) {\n  if (goog.isDef(node.nextElementSibling)) {\n    return /** @type {!Element} */ (node).nextElementSibling;\n  }\n  return goog.dom.getNextElementNode_(node.nextSibling, true);\n};\n\n\n/**\n * Returns the first previous sibling that is an element.\n * @param {Node} node The node to get the previous sibling element of.\n * @return {Element} The first previous sibling of `node` that is\n *     an element.\n */\ngoog.dom.getPreviousElementSibling = function(node) {\n  if (goog.isDef(node.previousElementSibling)) {\n    return /** @type {!Element} */ (node).previousElementSibling;\n  }\n  return goog.dom.getNextElementNode_(node.previousSibling, false);\n};\n\n\n/**\n * Returns the first node that is an element in the specified direction,\n * starting with `node`.\n * @param {Node} node The node to get the next element from.\n * @param {boolean} forward Whether to look forwards or backwards.\n * @return {Element} The first element.\n * @private\n */\ngoog.dom.getNextElementNode_ = function(node, forward) {\n  while (node && node.nodeType != goog.dom.NodeType.ELEMENT) {\n    node = forward ? node.nextSibling : node.previousSibling;\n  }\n\n  return /** @type {Element} */ (node);\n};\n\n\n/**\n * Returns the next node in source order from the given node.\n * @param {Node} node The node.\n * @return {Node} The next node in the DOM tree, or null if this was the last\n *     node.\n */\ngoog.dom.getNextNode = function(node) {\n  if (!node) {\n    return null;\n  }\n\n  if (node.firstChild) {\n    return node.firstChild;\n  }\n\n  while (node && !node.nextSibling) {\n    node = node.parentNode;\n  }\n\n  return node ? node.nextSibling : null;\n};\n\n\n/**\n * Returns the previous node in source order from the given node.\n * @param {Node} node The node.\n * @return {Node} The previous node in the DOM tree, or null if this was the\n *     first node.\n */\ngoog.dom.getPreviousNode = function(node) {\n  if (!node) {\n    return null;\n  }\n\n  if (!node.previousSibling) {\n    return node.parentNode;\n  }\n\n  node = node.previousSibling;\n  while (node && node.lastChild) {\n    node = node.lastChild;\n  }\n\n  return node;\n};\n\n\n/**\n * Whether the object looks like a DOM node.\n * @param {?} obj The object being tested for node likeness.\n * @return {boolean} Whether the object looks like a DOM node.\n */\ngoog.dom.isNodeLike = function(obj) {\n  return goog.isObject(obj) && obj.nodeType > 0;\n};\n\n\n/**\n * Whether the object looks like an Element.\n * @param {?} obj The object being tested for Element likeness.\n * @return {boolean} Whether the object looks like an Element.\n */\ngoog.dom.isElement = function(obj) {\n  return goog.isObject(obj) && obj.nodeType == goog.dom.NodeType.ELEMENT;\n};\n\n\n/**\n * Returns true if the specified value is a Window object. This includes the\n * global window for HTML pages, and iframe windows.\n * @param {?} obj Variable to test.\n * @return {boolean} Whether the variable is a window.\n */\ngoog.dom.isWindow = function(obj) {\n  return goog.isObject(obj) && obj['window'] == obj;\n};\n\n\n/**\n * Returns an element's parent, if it's an Element.\n * @param {Element} element The DOM element.\n * @return {Element} The parent, or null if not an Element.\n */\ngoog.dom.getParentElement = function(element) {\n  var parent;\n  if (goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY) {\n    var isIe9 = goog.userAgent.IE && goog.userAgent.isVersionOrHigher('9') &&\n        !goog.userAgent.isVersionOrHigher('10');\n    // SVG elements in IE9 can't use the parentElement property.\n    // goog.global['SVGElement'] is not defined in IE9 quirks mode.\n    if (!(isIe9 && goog.global['SVGElement'] &&\n          element instanceof goog.global['SVGElement'])) {\n      parent = element.parentElement;\n      if (parent) {\n        return parent;\n      }\n    }\n  }\n  parent = element.parentNode;\n  return goog.dom.isElement(parent) ? /** @type {!Element} */ (parent) : null;\n};\n\n\n/**\n * Whether a node contains another node.\n * @param {?Node|undefined} parent The node that should contain the other node.\n * @param {?Node|undefined} descendant The node to test presence of.\n * @return {boolean} Whether the parent node contains the descendant node.\n */\ngoog.dom.contains = function(parent, descendant) {\n  if (!parent || !descendant) {\n    return false;\n  }\n  // We use browser specific methods for this if available since it is faster\n  // that way.\n\n  // IE DOM\n  if (parent.contains && descendant.nodeType == goog.dom.NodeType.ELEMENT) {\n    return parent == descendant || parent.contains(descendant);\n  }\n\n  // W3C DOM Level 3\n  if (typeof parent.compareDocumentPosition != 'undefined') {\n    return parent == descendant ||\n        Boolean(parent.compareDocumentPosition(descendant) & 16);\n  }\n\n  // W3C DOM Level 1\n  while (descendant && parent != descendant) {\n    descendant = descendant.parentNode;\n  }\n  return descendant == parent;\n};\n\n\n/**\n * Compares the document order of two nodes, returning 0 if they are the same\n * node, a negative number if node1 is before node2, and a positive number if\n * node2 is before node1.  Note that we compare the order the tags appear in the\n * document so in the tree <b><i>text</i></b> the B node is considered to be\n * before the I node.\n *\n * @param {Node} node1 The first node to compare.\n * @param {Node} node2 The second node to compare.\n * @return {number} 0 if the nodes are the same node, a negative number if node1\n *     is before node2, and a positive number if node2 is before node1.\n */\ngoog.dom.compareNodeOrder = function(node1, node2) {\n  // Fall out quickly for equality.\n  if (node1 == node2) {\n    return 0;\n  }\n\n  // Use compareDocumentPosition where available\n  if (node1.compareDocumentPosition) {\n    // 4 is the bitmask for FOLLOWS.\n    return node1.compareDocumentPosition(node2) & 2 ? 1 : -1;\n  }\n\n  // Special case for document nodes on IE 7 and 8.\n  if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(9)) {\n    if (node1.nodeType == goog.dom.NodeType.DOCUMENT) {\n      return -1;\n    }\n    if (node2.nodeType == goog.dom.NodeType.DOCUMENT) {\n      return 1;\n    }\n  }\n\n  // Process in IE using sourceIndex - we check to see if the first node has\n  // a source index or if its parent has one.\n  if ('sourceIndex' in node1 ||\n      (node1.parentNode && 'sourceIndex' in node1.parentNode)) {\n    var isElement1 = node1.nodeType == goog.dom.NodeType.ELEMENT;\n    var isElement2 = node2.nodeType == goog.dom.NodeType.ELEMENT;\n\n    if (isElement1 && isElement2) {\n      return node1.sourceIndex - node2.sourceIndex;\n    } else {\n      var parent1 = node1.parentNode;\n      var parent2 = node2.parentNode;\n\n      if (parent1 == parent2) {\n        return goog.dom.compareSiblingOrder_(node1, node2);\n      }\n\n      if (!isElement1 && goog.dom.contains(parent1, node2)) {\n        return -1 * goog.dom.compareParentsDescendantNodeIe_(node1, node2);\n      }\n\n\n      if (!isElement2 && goog.dom.contains(parent2, node1)) {\n        return goog.dom.compareParentsDescendantNodeIe_(node2, node1);\n      }\n\n      return (isElement1 ? node1.sourceIndex : parent1.sourceIndex) -\n          (isElement2 ? node2.sourceIndex : parent2.sourceIndex);\n    }\n  }\n\n  // For Safari, we compare ranges.\n  var doc = goog.dom.getOwnerDocument(node1);\n\n  var range1, range2;\n  range1 = doc.createRange();\n  range1.selectNode(node1);\n  range1.collapse(true);\n\n  range2 = doc.createRange();\n  range2.selectNode(node2);\n  range2.collapse(true);\n\n  return range1.compareBoundaryPoints(\n      goog.global['Range'].START_TO_END, range2);\n};\n\n\n/**\n * Utility function to compare the position of two nodes, when\n * `textNode`'s parent is an ancestor of `node`.  If this entry\n * condition is not met, this function will attempt to reference a null object.\n * @param {!Node} textNode The textNode to compare.\n * @param {Node} node The node to compare.\n * @return {number} -1 if node is before textNode, +1 otherwise.\n * @private\n */\ngoog.dom.compareParentsDescendantNodeIe_ = function(textNode, node) {\n  var parent = textNode.parentNode;\n  if (parent == node) {\n    // If textNode is a child of node, then node comes first.\n    return -1;\n  }\n  var sibling = node;\n  while (sibling.parentNode != parent) {\n    sibling = sibling.parentNode;\n  }\n  return goog.dom.compareSiblingOrder_(sibling, textNode);\n};\n\n\n/**\n * Utility function to compare the position of two nodes known to be non-equal\n * siblings.\n * @param {Node} node1 The first node to compare.\n * @param {!Node} node2 The second node to compare.\n * @return {number} -1 if node1 is before node2, +1 otherwise.\n * @private\n */\ngoog.dom.compareSiblingOrder_ = function(node1, node2) {\n  var s = node2;\n  while ((s = s.previousSibling)) {\n    if (s == node1) {\n      // We just found node1 before node2.\n      return -1;\n    }\n  }\n\n  // Since we didn't find it, node1 must be after node2.\n  return 1;\n};\n\n\n/**\n * Find the deepest common ancestor of the given nodes.\n * @param {...Node} var_args The nodes to find a common ancestor of.\n * @return {Node} The common ancestor of the nodes, or null if there is none.\n *     null will only be returned if two or more of the nodes are from different\n *     documents.\n */\ngoog.dom.findCommonAncestor = function(var_args) {\n  var i, count = arguments.length;\n  if (!count) {\n    return null;\n  } else if (count == 1) {\n    return arguments[0];\n  }\n\n  var paths = [];\n  var minLength = Infinity;\n  for (i = 0; i < count; i++) {\n    // Compute the list of ancestors.\n    var ancestors = [];\n    var node = arguments[i];\n    while (node) {\n      ancestors.unshift(node);\n      node = node.parentNode;\n    }\n\n    // Save the list for comparison.\n    paths.push(ancestors);\n    minLength = Math.min(minLength, ancestors.length);\n  }\n  var output = null;\n  for (i = 0; i < minLength; i++) {\n    var first = paths[0][i];\n    for (var j = 1; j < count; j++) {\n      if (first != paths[j][i]) {\n        return output;\n      }\n    }\n    output = first;\n  }\n  return output;\n};\n\n\n/**\n * Returns the owner document for a node.\n * @param {Node|Window} node The node to get the document for.\n * @return {!Document} The document owning the node.\n */\ngoog.dom.getOwnerDocument = function(node) {\n  // TODO(nnaze): Update param signature to be non-nullable.\n  goog.asserts.assert(node, 'Node cannot be null or undefined.');\n  return /** @type {!Document} */ (\n      node.nodeType == goog.dom.NodeType.DOCUMENT ? node : node.ownerDocument ||\n              node.document);\n};\n\n\n/**\n * Cross-browser function for getting the document element of a frame or iframe.\n * @param {Element} frame Frame element.\n * @return {!Document} The frame content document.\n */\ngoog.dom.getFrameContentDocument = function(frame) {\n  return frame.contentDocument ||\n      /** @type {!HTMLFrameElement} */ (frame).contentWindow.document;\n};\n\n\n/**\n * Cross-browser function for getting the window of a frame or iframe.\n * @param {Element} frame Frame element.\n * @return {Window} The window associated with the given frame, or null if none\n *     exists.\n */\ngoog.dom.getFrameContentWindow = function(frame) {\n  try {\n    return frame.contentWindow ||\n        (frame.contentDocument ? goog.dom.getWindow(frame.contentDocument) :\n                                 null);\n  } catch (e) {\n    // NOTE(user): In IE8, checking the contentWindow or contentDocument\n    // properties will throw a \"Unspecified Error\" exception if the iframe is\n    // not inserted in the DOM. If we get this we can be sure that no window\n    // exists, so return null.\n  }\n  return null;\n};\n\n\n/**\n * Sets the text content of a node, with cross-browser support.\n * @param {Node} node The node to change the text content of.\n * @param {string|number} text The value that should replace the node's content.\n */\ngoog.dom.setTextContent = function(node, text) {\n  goog.asserts.assert(\n      node != null,\n      'goog.dom.setTextContent expects a non-null value for node');\n\n  if ('textContent' in node) {\n    node.textContent = text;\n  } else if (node.nodeType == goog.dom.NodeType.TEXT) {\n    /** @type {!Text} */ (node).data = String(text);\n  } else if (\n      node.firstChild && node.firstChild.nodeType == goog.dom.NodeType.TEXT) {\n    // If the first child is a text node we just change its data and remove the\n    // rest of the children.\n    while (node.lastChild != node.firstChild) {\n      node.removeChild(node.lastChild);\n    }\n    /** @type {!Text} */ (node.firstChild).data = String(text);\n  } else {\n    goog.dom.removeChildren(node);\n    var doc = goog.dom.getOwnerDocument(node);\n    node.appendChild(doc.createTextNode(String(text)));\n  }\n};\n\n\n/**\n * Gets the outerHTML of a node, which islike innerHTML, except that it\n * actually contains the HTML of the node itself.\n * @param {Element} element The element to get the HTML of.\n * @return {string} The outerHTML of the given element.\n */\ngoog.dom.getOuterHtml = function(element) {\n  goog.asserts.assert(\n      element !== null,\n      'goog.dom.getOuterHtml expects a non-null value for element');\n  // IE, Opera and WebKit all have outerHTML.\n  if ('outerHTML' in element) {\n    return element.outerHTML;\n  } else {\n    var doc = goog.dom.getOwnerDocument(element);\n    var div = goog.dom.createElement_(doc, goog.dom.TagName.DIV);\n    div.appendChild(element.cloneNode(true));\n    return div.innerHTML;\n  }\n};\n\n\n/**\n * Finds the first descendant node that matches the filter function, using\n * a depth first search. This function offers the most general purpose way\n * of finding a matching element. You may also wish to consider\n * `goog.dom.query` which can express many matching criteria using\n * CSS selector expressions. These expressions often result in a more\n * compact representation of the desired result.\n * @see goog.dom.query\n *\n * @param {Node} root The root of the tree to search.\n * @param {function(Node) : boolean} p The filter function.\n * @return {Node|undefined} The found node or undefined if none is found.\n */\ngoog.dom.findNode = function(root, p) {\n  var rv = [];\n  var found = goog.dom.findNodes_(root, p, rv, true);\n  return found ? rv[0] : undefined;\n};\n\n\n/**\n * Finds all the descendant nodes that match the filter function, using a\n * a depth first search. This function offers the most general-purpose way\n * of finding a set of matching elements. You may also wish to consider\n * `goog.dom.query` which can express many matching criteria using\n * CSS selector expressions. These expressions often result in a more\n * compact representation of the desired result.\n\n * @param {Node} root The root of the tree to search.\n * @param {function(Node) : boolean} p The filter function.\n * @return {!Array<!Node>} The found nodes or an empty array if none are found.\n */\ngoog.dom.findNodes = function(root, p) {\n  var rv = [];\n  goog.dom.findNodes_(root, p, rv, false);\n  return rv;\n};\n\n\n/**\n * Finds the first or all the descendant nodes that match the filter function,\n * using a depth first search.\n * @param {Node} root The root of the tree to search.\n * @param {function(Node) : boolean} p The filter function.\n * @param {!Array<!Node>} rv The found nodes are added to this array.\n * @param {boolean} findOne If true we exit after the first found node.\n * @return {boolean} Whether the search is complete or not. True in case findOne\n *     is true and the node is found. False otherwise.\n * @private\n */\ngoog.dom.findNodes_ = function(root, p, rv, findOne) {\n  if (root != null) {\n    var child = root.firstChild;\n    while (child) {\n      if (p(child)) {\n        rv.push(child);\n        if (findOne) {\n          return true;\n        }\n      }\n      if (goog.dom.findNodes_(child, p, rv, findOne)) {\n        return true;\n      }\n      child = child.nextSibling;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Map of tags whose content to ignore when calculating text length.\n * @private {!Object<string, number>}\n * @const\n */\ngoog.dom.TAGS_TO_IGNORE_ = {\n  'SCRIPT': 1,\n  'STYLE': 1,\n  'HEAD': 1,\n  'IFRAME': 1,\n  'OBJECT': 1\n};\n\n\n/**\n * Map of tags which have predefined values with regard to whitespace.\n * @private {!Object<string, string>}\n * @const\n */\ngoog.dom.PREDEFINED_TAG_VALUES_ = {\n  'IMG': ' ',\n  'BR': '\\n'\n};\n\n\n/**\n * Returns true if the element has a tab index that allows it to receive\n * keyboard focus (tabIndex >= 0), false otherwise.  Note that some elements\n * natively support keyboard focus, even if they have no tab index.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element has a tab index that allows keyboard\n *     focus.\n */\ngoog.dom.isFocusableTabIndex = function(element) {\n  return goog.dom.hasSpecifiedTabIndex_(element) &&\n      goog.dom.isTabIndexFocusable_(element);\n};\n\n\n/**\n * Enables or disables keyboard focus support on the element via its tab index.\n * Only elements for which {@link goog.dom.isFocusableTabIndex} returns true\n * (or elements that natively support keyboard focus, like form elements) can\n * receive keyboard focus.  See http://go/tabindex for more info.\n * @param {Element} element Element whose tab index is to be changed.\n * @param {boolean} enable Whether to set or remove a tab index on the element\n *     that supports keyboard focus.\n */\ngoog.dom.setFocusableTabIndex = function(element, enable) {\n  if (enable) {\n    element.tabIndex = 0;\n  } else {\n    // Set tabIndex to -1 first, then remove it. This is a workaround for\n    // Safari (confirmed in version 4 on Windows). When removing the attribute\n    // without setting it to -1 first, the element remains keyboard focusable\n    // despite not having a tabIndex attribute anymore.\n    element.tabIndex = -1;\n    element.removeAttribute('tabIndex');  // Must be camelCase!\n  }\n};\n\n\n/**\n * Returns true if the element can be focused, i.e. it has a tab index that\n * allows it to receive keyboard focus (tabIndex >= 0), or it is an element\n * that natively supports keyboard focus.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element allows keyboard focus.\n */\ngoog.dom.isFocusable = function(element) {\n  var focusable;\n  // Some elements can have unspecified tab index and still receive focus.\n  if (goog.dom.nativelySupportsFocus_(element)) {\n    // Make sure the element is not disabled ...\n    focusable = !element.disabled &&\n        // ... and if a tab index is specified, it allows focus.\n        (!goog.dom.hasSpecifiedTabIndex_(element) ||\n         goog.dom.isTabIndexFocusable_(element));\n  } else {\n    focusable = goog.dom.isFocusableTabIndex(element);\n  }\n\n  // IE requires elements to be visible in order to focus them.\n  return focusable && goog.userAgent.IE ?\n      goog.dom.hasNonZeroBoundingRect_(/** @type {!HTMLElement} */ (element)) :\n      focusable;\n};\n\n\n/**\n * Returns true if the element has a specified tab index.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element has a specified tab index.\n * @private\n */\ngoog.dom.hasSpecifiedTabIndex_ = function(element) {\n  // IE8 and below don't support hasAttribute(), instead check whether the\n  // 'tabindex' attributeNode is specified. Otherwise check hasAttribute().\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('9')) {\n    var attrNode = element.getAttributeNode('tabindex');  // Must be lowercase!\n    return goog.isDefAndNotNull(attrNode) && attrNode.specified;\n  } else {\n    return element.hasAttribute('tabindex');\n  }\n};\n\n\n/**\n * Returns true if the element's tab index allows the element to be focused.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element's tab index allows focus.\n * @private\n */\ngoog.dom.isTabIndexFocusable_ = function(element) {\n  var index = /** @type {!HTMLElement} */ (element).tabIndex;\n  // NOTE: IE9 puts tabIndex in 16-bit int, e.g. -2 is 65534.\n  return goog.isNumber(index) && index >= 0 && index < 32768;\n};\n\n\n/**\n * Returns true if the element is focusable even when tabIndex is not set.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element natively supports focus.\n * @private\n */\ngoog.dom.nativelySupportsFocus_ = function(element) {\n  return element.tagName == goog.dom.TagName.A ||\n      element.tagName == goog.dom.TagName.INPUT ||\n      element.tagName == goog.dom.TagName.TEXTAREA ||\n      element.tagName == goog.dom.TagName.SELECT ||\n      element.tagName == goog.dom.TagName.BUTTON;\n};\n\n\n/**\n * Returns true if the element has a bounding rectangle that would be visible\n * (i.e. its width and height are greater than zero).\n * @param {!HTMLElement} element Element to check.\n * @return {boolean} Whether the element has a non-zero bounding rectangle.\n * @private\n */\ngoog.dom.hasNonZeroBoundingRect_ = function(element) {\n  var rect;\n  if (!goog.isFunction(element['getBoundingClientRect']) ||\n      // In IE, getBoundingClientRect throws on detached nodes.\n      (goog.userAgent.IE && element.parentElement == null)) {\n    rect = {'height': element.offsetHeight, 'width': element.offsetWidth};\n  } else {\n    rect = element.getBoundingClientRect();\n  }\n  return goog.isDefAndNotNull(rect) && rect.height > 0 && rect.width > 0;\n};\n\n\n/**\n * Returns the text content of the current node, without markup and invisible\n * symbols. New lines are stripped and whitespace is collapsed,\n * such that each character would be visible.\n *\n * In browsers that support it, innerText is used.  Other browsers attempt to\n * simulate it via node traversal.  Line breaks are canonicalized in IE.\n *\n * @param {Node} node The node from which we are getting content.\n * @return {string} The text content.\n */\ngoog.dom.getTextContent = function(node) {\n  var textContent;\n  // Note(arv): IE9, Opera, and Safari 3 support innerText but they include\n  // text nodes in script tags. So we revert to use a user agent test here.\n  if (goog.dom.BrowserFeature.CAN_USE_INNER_TEXT && node !== null &&\n      ('innerText' in node)) {\n    textContent = goog.string.canonicalizeNewlines(node.innerText);\n    // Unfortunately .innerText() returns text with &shy; symbols\n    // We need to filter it out and then remove duplicate whitespaces\n  } else {\n    var buf = [];\n    goog.dom.getTextContent_(node, buf, true);\n    textContent = buf.join('');\n  }\n\n  // Strip &shy; entities. goog.format.insertWordBreaks inserts them in Opera.\n  textContent = textContent.replace(/ \\xAD /g, ' ').replace(/\\xAD/g, '');\n  // Strip &#8203; entities. goog.format.insertWordBreaks inserts them in IE8.\n  textContent = textContent.replace(/\\u200B/g, '');\n\n  // Skip this replacement on old browsers with working innerText, which\n  // automatically turns &nbsp; into ' ' and / +/ into ' ' when reading\n  // innerText.\n  if (!goog.dom.BrowserFeature.CAN_USE_INNER_TEXT) {\n    textContent = textContent.replace(/ +/g, ' ');\n  }\n  if (textContent != ' ') {\n    textContent = textContent.replace(/^\\s*/, '');\n  }\n\n  return textContent;\n};\n\n\n/**\n * Returns the text content of the current node, without markup.\n *\n * Unlike `getTextContent` this method does not collapse whitespaces\n * or normalize lines breaks.\n *\n * @param {Node} node The node from which we are getting content.\n * @return {string} The raw text content.\n */\ngoog.dom.getRawTextContent = function(node) {\n  var buf = [];\n  goog.dom.getTextContent_(node, buf, false);\n\n  return buf.join('');\n};\n\n\n/**\n * Recursive support function for text content retrieval.\n *\n * @param {Node} node The node from which we are getting content.\n * @param {Array<string>} buf string buffer.\n * @param {boolean} normalizeWhitespace Whether to normalize whitespace.\n * @private\n */\ngoog.dom.getTextContent_ = function(node, buf, normalizeWhitespace) {\n  if (node.nodeName in goog.dom.TAGS_TO_IGNORE_) {\n    // ignore certain tags\n  } else if (node.nodeType == goog.dom.NodeType.TEXT) {\n    if (normalizeWhitespace) {\n      buf.push(String(node.nodeValue).replace(/(\\r\\n|\\r|\\n)/g, ''));\n    } else {\n      buf.push(node.nodeValue);\n    }\n  } else if (node.nodeName in goog.dom.PREDEFINED_TAG_VALUES_) {\n    buf.push(goog.dom.PREDEFINED_TAG_VALUES_[node.nodeName]);\n  } else {\n    var child = node.firstChild;\n    while (child) {\n      goog.dom.getTextContent_(child, buf, normalizeWhitespace);\n      child = child.nextSibling;\n    }\n  }\n};\n\n\n/**\n * Returns the text length of the text contained in a node, without markup. This\n * is equivalent to the selection length if the node was selected, or the number\n * of cursor movements to traverse the node. Images & BRs take one space.  New\n * lines are ignored.\n *\n * @param {Node} node The node whose text content length is being calculated.\n * @return {number} The length of `node`'s text content.\n */\ngoog.dom.getNodeTextLength = function(node) {\n  return goog.dom.getTextContent(node).length;\n};\n\n\n/**\n * Returns the text offset of a node relative to one of its ancestors. The text\n * length is the same as the length calculated by goog.dom.getNodeTextLength.\n *\n * @param {Node} node The node whose offset is being calculated.\n * @param {Node=} opt_offsetParent The node relative to which the offset will\n *     be calculated. Defaults to the node's owner document's body.\n * @return {number} The text offset.\n */\ngoog.dom.getNodeTextOffset = function(node, opt_offsetParent) {\n  var root = opt_offsetParent || goog.dom.getOwnerDocument(node).body;\n  var buf = [];\n  while (node && node != root) {\n    var cur = node;\n    while ((cur = cur.previousSibling)) {\n      buf.unshift(goog.dom.getTextContent(cur));\n    }\n    node = node.parentNode;\n  }\n  // Trim left to deal with FF cases when there might be line breaks and empty\n  // nodes at the front of the text\n  return goog.string.trimLeft(buf.join('')).replace(/ +/g, ' ').length;\n};\n\n\n/**\n * Returns the node at a given offset in a parent node.  If an object is\n * provided for the optional third parameter, the node and the remainder of the\n * offset will stored as properties of this object.\n * @param {Node} parent The parent node.\n * @param {number} offset The offset into the parent node.\n * @param {Object=} opt_result Object to be used to store the return value. The\n *     return value will be stored in the form {node: Node, remainder: number}\n *     if this object is provided.\n * @return {Node} The node at the given offset.\n */\ngoog.dom.getNodeAtOffset = function(parent, offset, opt_result) {\n  var stack = [parent], pos = 0, cur = null;\n  while (stack.length > 0 && pos < offset) {\n    cur = stack.pop();\n    if (cur.nodeName in goog.dom.TAGS_TO_IGNORE_) {\n      // ignore certain tags\n    } else if (cur.nodeType == goog.dom.NodeType.TEXT) {\n      var text = cur.nodeValue.replace(/(\\r\\n|\\r|\\n)/g, '').replace(/ +/g, ' ');\n      pos += text.length;\n    } else if (cur.nodeName in goog.dom.PREDEFINED_TAG_VALUES_) {\n      pos += goog.dom.PREDEFINED_TAG_VALUES_[cur.nodeName].length;\n    } else {\n      for (var i = cur.childNodes.length - 1; i >= 0; i--) {\n        stack.push(cur.childNodes[i]);\n      }\n    }\n  }\n  if (goog.isObject(opt_result)) {\n    opt_result.remainder = cur ? cur.nodeValue.length + offset - pos - 1 : 0;\n    opt_result.node = cur;\n  }\n\n  return cur;\n};\n\n\n/**\n * Returns true if the object is a `NodeList`.  To qualify as a NodeList,\n * the object must have a numeric length property and an item function (which\n * has type 'string' on IE for some reason).\n * @param {Object} val Object to test.\n * @return {boolean} Whether the object is a NodeList.\n */\ngoog.dom.isNodeList = function(val) {\n  // TODO(attila): Now the isNodeList is part of goog.dom we can use\n  // goog.userAgent to make this simpler.\n  // A NodeList must have a length property of type 'number' on all platforms.\n  if (val && typeof val.length == 'number') {\n    // A NodeList is an object everywhere except Safari, where it's a function.\n    if (goog.isObject(val)) {\n      // A NodeList must have an item function (on non-IE platforms) or an item\n      // property of type 'string' (on IE).\n      return typeof val.item == 'function' || typeof val.item == 'string';\n    } else if (goog.isFunction(val)) {\n      // On Safari, a NodeList is a function with an item property that is also\n      // a function.\n      return typeof /** @type {?} */ (val.item) == 'function';\n    }\n  }\n\n  // Not a NodeList.\n  return false;\n};\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that has the passed\n * tag name and/or class name. If the passed element matches the specified\n * criteria, the element itself is returned.\n * @param {Node} element The DOM node to start with.\n * @param {?(goog.dom.TagName<T>|string)=} opt_tag The tag name to match (or\n *     null/undefined to match only based on class name).\n * @param {?string=} opt_class The class name to match (or null/undefined to\n *     match only based on tag name).\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {?R} The first ancestor that matches the passed criteria, or\n *     null if no match is found. The return type is {?Element} if opt_tag is\n *     not a member of goog.dom.TagName or a more specific type if it is (e.g.\n *     {?HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.getAncestorByTagNameAndClass = function(\n    element, opt_tag, opt_class, opt_maxSearchSteps) {\n  if (!opt_tag && !opt_class) {\n    return null;\n  }\n  var tagName = opt_tag ? String(opt_tag).toUpperCase() : null;\n  return /** @type {Element} */ (goog.dom.getAncestor(element, function(node) {\n    return (!tagName || node.nodeName == tagName) &&\n        (!opt_class ||\n         goog.isString(node.className) &&\n             goog.array.contains(node.className.split(/\\s+/), opt_class));\n  }, true, opt_maxSearchSteps));\n};\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that has the passed\n * class name. If the passed element matches the specified criteria, the\n * element itself is returned.\n * @param {Node} element The DOM node to start with.\n * @param {string} className The class name to match.\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {Element} The first ancestor that matches the passed criteria, or\n *     null if none match.\n */\ngoog.dom.getAncestorByClass = function(element, className, opt_maxSearchSteps) {\n  return goog.dom.getAncestorByTagNameAndClass(\n      element, null, className, opt_maxSearchSteps);\n};\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that passes the\n * matcher function.\n * @param {Node} element The DOM node to start with.\n * @param {function(Node) : boolean} matcher A function that returns true if the\n *     passed node matches the desired criteria.\n * @param {boolean=} opt_includeNode If true, the node itself is included in\n *     the search (the first call to the matcher will pass startElement as\n *     the node to test).\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {Node} DOM node that matched the matcher, or null if there was\n *     no match.\n */\ngoog.dom.getAncestor = function(\n    element, matcher, opt_includeNode, opt_maxSearchSteps) {\n  if (element && !opt_includeNode) {\n    element = element.parentNode;\n  }\n  var steps = 0;\n  while (element &&\n         (opt_maxSearchSteps == null || steps <= opt_maxSearchSteps)) {\n    goog.asserts.assert(element.name != 'parentNode');\n    if (matcher(element)) {\n      return element;\n    }\n    element = element.parentNode;\n    steps++;\n  }\n  // Reached the root of the DOM without a match\n  return null;\n};\n\n\n/**\n * Determines the active element in the given document.\n * @param {Document} doc The document to look in.\n * @return {Element} The active element.\n */\ngoog.dom.getActiveElement = function(doc) {\n  // While in an iframe, IE9 will throw \"Unspecified error\" when accessing\n  // activeElement.\n  try {\n    var activeElement = doc && doc.activeElement;\n    // While not in an iframe, IE9-11 sometimes gives null.\n    // While in an iframe, IE11 sometimes returns an empty object.\n    return activeElement && activeElement.nodeName ? activeElement : null;\n  } catch (e) {\n    return null;\n  }\n};\n\n\n/**\n * Gives the current devicePixelRatio.\n *\n * By default, this is the value of window.devicePixelRatio (which should be\n * preferred if present).\n *\n * If window.devicePixelRatio is not present, the ratio is calculated with\n * window.matchMedia, if present. Otherwise, gives 1.0.\n *\n * Some browsers (including Chrome) consider the browser zoom level in the pixel\n * ratio, so the value may change across multiple calls.\n *\n * @return {number} The number of actual pixels per virtual pixel.\n */\ngoog.dom.getPixelRatio = function() {\n  var win = goog.dom.getWindow();\n  if (goog.isDef(win.devicePixelRatio)) {\n    return win.devicePixelRatio;\n  } else if (win.matchMedia) {\n    // Should be for IE10 and FF6-17 (this basically clamps to lower)\n    // Note that the order of these statements is important\n    return goog.dom.matchesPixelRatio_(3) || goog.dom.matchesPixelRatio_(2) ||\n           goog.dom.matchesPixelRatio_(1.5) || goog.dom.matchesPixelRatio_(1) ||\n           .75;\n  }\n  return 1;\n};\n\n\n/**\n * Calculates a mediaQuery to check if the current device supports the\n * given actual to virtual pixel ratio.\n * @param {number} pixelRatio The ratio of actual pixels to virtual pixels.\n * @return {number} pixelRatio if applicable, otherwise 0.\n * @private\n */\ngoog.dom.matchesPixelRatio_ = function(pixelRatio) {\n  var win = goog.dom.getWindow();\n  /**\n   * Due to the 1:96 fixed ratio of CSS in to CSS px, 1dppx is equivalent to\n   * 96dpi.\n   * @const {number}\n   */\n  var dpiPerDppx = 96;\n  var query =\n      // FF16-17\n      '(min-resolution: ' + pixelRatio + 'dppx),' +\n      // FF6-15\n      '(min--moz-device-pixel-ratio: ' + pixelRatio + '),' +\n      // IE10 (this works for the two browsers above too but I don't want to\n      // trust the 1:96 fixed ratio magic)\n      '(min-resolution: ' + (pixelRatio * dpiPerDppx) + 'dpi)';\n  return win.matchMedia(query).matches ? pixelRatio : 0;\n};\n\n\n/**\n * Gets '2d' context of a canvas. Shortcut for canvas.getContext('2d') with a\n * type information.\n * @param {!HTMLCanvasElement} canvas\n * @return {!CanvasRenderingContext2D}\n */\ngoog.dom.getCanvasContext2D = function(canvas) {\n  return /** @type {!CanvasRenderingContext2D} */ (canvas.getContext('2d'));\n};\n\n\n\n/**\n * Create an instance of a DOM helper with a new document object.\n * @param {Document=} opt_document Document object to associate with this\n *     DOM helper.\n * @constructor\n */\ngoog.dom.DomHelper = function(opt_document) {\n  /**\n   * Reference to the document object to use\n   * @type {!Document}\n   * @private\n   */\n  this.document_ = opt_document || goog.global.document || document;\n};\n\n\n/**\n * Gets the dom helper object for the document where the element resides.\n * @param {Node=} opt_node If present, gets the DomHelper for this node.\n * @return {!goog.dom.DomHelper} The DomHelper.\n */\ngoog.dom.DomHelper.prototype.getDomHelper = goog.dom.getDomHelper;\n\n\n/**\n * Sets the document object.\n * @param {!Document} document Document object.\n */\ngoog.dom.DomHelper.prototype.setDocument = function(document) {\n  this.document_ = document;\n};\n\n\n/**\n * Gets the document object being used by the dom library.\n * @return {!Document} Document object.\n */\ngoog.dom.DomHelper.prototype.getDocument = function() {\n  return this.document_;\n};\n\n\n/**\n * Alias for `getElementById`. If a DOM node is passed in then we just\n * return that.\n * @param {string|Element} element Element ID or a DOM node.\n * @return {Element} The element with the given ID, or the node passed in.\n */\ngoog.dom.DomHelper.prototype.getElement = function(element) {\n  return goog.dom.getElementHelper_(this.document_, element);\n};\n\n\n/**\n * Gets an element by id, asserting that the element is found.\n *\n * This is used when an element is expected to exist, and should fail with\n * an assertion error if it does not (if assertions are enabled).\n *\n * @param {string} id Element ID.\n * @return {!Element} The element with the given ID, if it exists.\n */\ngoog.dom.DomHelper.prototype.getRequiredElement = function(id) {\n  return goog.dom.getRequiredElementHelper_(this.document_, id);\n};\n\n\n/**\n * Alias for `getElement`.\n * @param {string|Element} element Element ID or a DOM node.\n * @return {Element} The element with the given ID, or the node passed in.\n * @deprecated Use {@link goog.dom.DomHelper.prototype.getElement} instead.\n */\ngoog.dom.DomHelper.prototype.$ = goog.dom.DomHelper.prototype.getElement;\n\n\n/**\n * Gets elements by tag name.\n * @param {!goog.dom.TagName<T>} tagName\n * @param {(!Document|!Element)=} opt_parent Parent element or document where to\n *     look for elements. Defaults to document of this DomHelper.\n * @return {!NodeList<R>} List of elements. The members of the list are\n *     {!Element} if tagName is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.getElementsByTagName =\n    function(tagName, opt_parent) {\n  var parent = opt_parent || this.document_;\n  return parent.getElementsByTagName(String(tagName));\n};\n\n\n/**\n * Looks up elements by both tag and class name, using browser native functions\n * (`querySelectorAll`, `getElementsByTagName` or\n * `getElementsByClassName`) where possible. The returned array is a live\n * NodeList or a static list depending on the code path taken.\n *\n * @see goog.dom.query\n *\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name or * for all\n *     tags.\n * @param {?string=} opt_class Optional class name.\n * @param {(Document|Element)=} opt_el Optional element to look in.\n * @return {!IArrayLike<R>} Array-like list of elements (only a length property\n *     and numerical indices are guaranteed to exist). The members of the array\n *     are {!Element} if opt_tag is not a member of goog.dom.TagName or more\n *     specific types if it is (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.getElementsByTagNameAndClass = function(\n    opt_tag, opt_class, opt_el) {\n  return goog.dom.getElementsByTagNameAndClass_(\n      this.document_, opt_tag, opt_class, opt_el);\n};\n\n\n/**\n * Gets the first element matching the tag and the class.\n *\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name.\n * @param {?string=} opt_class Optional class name.\n * @param {(Document|Element)=} opt_el Optional element to look in.\n * @return {?R} Reference to a DOM node. The return type is {?Element} if\n *     tagName is a string or a more specific type if it is a member of\n *     goog.dom.TagName (e.g. {?HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.getElementByTagNameAndClass = function(\n    opt_tag, opt_class, opt_el) {\n  return goog.dom.getElementByTagNameAndClass_(\n      this.document_, opt_tag, opt_class, opt_el);\n};\n\n\n/**\n * Returns an array of all the elements with the provided className.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {Element|Document=} opt_el Optional element to look in.\n * @return {!IArrayLike<!Element>} The items found with the class name provided.\n */\ngoog.dom.DomHelper.prototype.getElementsByClass = function(className, opt_el) {\n  var doc = opt_el || this.document_;\n  return goog.dom.getElementsByClass(className, doc);\n};\n\n\n/**\n * Returns the first element we find matching the provided class name.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {(Element|Document)=} opt_el Optional element to look in.\n * @return {Element} The first item found with the class name provided.\n */\ngoog.dom.DomHelper.prototype.getElementByClass = function(className, opt_el) {\n  var doc = opt_el || this.document_;\n  return goog.dom.getElementByClass(className, doc);\n};\n\n\n/**\n * Ensures an element with the given className exists, and then returns the\n * first element with the provided className.\n * @see {goog.dom.query}\n * @param {string} className the name of the class to look for.\n * @param {(!Element|!Document)=} opt_root Optional element or document to look\n *     in.\n * @return {!Element} The first item found with the class name provided.\n * @throws {goog.asserts.AssertionError} Thrown if no element is found.\n */\ngoog.dom.DomHelper.prototype.getRequiredElementByClass = function(\n    className, opt_root) {\n  var root = opt_root || this.document_;\n  return goog.dom.getRequiredElementByClass(className, root);\n};\n\n\n/**\n * Alias for `getElementsByTagNameAndClass`.\n * @deprecated Use DomHelper getElementsByTagNameAndClass.\n * @see goog.dom.query\n *\n * @param {(string|?goog.dom.TagName<T>)=} opt_tag Element tag name.\n * @param {?string=} opt_class Optional class name.\n * @param {Element=} opt_el Optional element to look in.\n * @return {!IArrayLike<R>} Array-like list of elements (only a length property\n *     and numerical indices are guaranteed to exist). The members of the array\n *     are {!Element} if opt_tag is a string or more specific types if it is\n *     a member of goog.dom.TagName (e.g. {!HTMLAnchorElement} for\n *     goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.$$ =\n    goog.dom.DomHelper.prototype.getElementsByTagNameAndClass;\n\n\n/**\n * Sets a number of properties on a node.\n * @param {Element} element DOM node to set properties on.\n * @param {Object} properties Hash of property:value pairs.\n */\ngoog.dom.DomHelper.prototype.setProperties = goog.dom.setProperties;\n\n\n/**\n * Gets the dimensions of the viewport.\n * @param {Window=} opt_window Optional window element to test. Defaults to\n *     the window of the Dom Helper.\n * @return {!goog.math.Size} Object with values 'width' and 'height'.\n */\ngoog.dom.DomHelper.prototype.getViewportSize = function(opt_window) {\n  // TODO(arv): This should not take an argument. That breaks the rule of a\n  // a DomHelper representing a single frame/window/document.\n  return goog.dom.getViewportSize(opt_window || this.getWindow());\n};\n\n\n/**\n * Calculates the height of the document.\n *\n * @return {number} The height of the document.\n */\ngoog.dom.DomHelper.prototype.getDocumentHeight = function() {\n  return goog.dom.getDocumentHeight_(this.getWindow());\n};\n\n\n/**\n * Typedef for use with goog.dom.createDom and goog.dom.append.\n * @typedef {Object|string|Array|NodeList}\n */\ngoog.dom.Appendable;\n\n\n/**\n * Returns a dom node with a set of attributes.  This function accepts varargs\n * for subsequent nodes to be added.  Subsequent nodes will be added to the\n * first node as childNodes.\n *\n * So:\n * <code>createDom(goog.dom.TagName.DIV, null, createDom(goog.dom.TagName.P),\n * createDom(goog.dom.TagName.P));</code> would return a div with two child\n * paragraphs\n *\n * An easy way to move all child nodes of an existing element to a new parent\n * element is:\n * <code>createDom(goog.dom.TagName.DIV, null, oldElement.childNodes);</code>\n * which will remove all child nodes from the old element and add them as\n * child nodes of the new DIV.\n *\n * @param {string|!goog.dom.TagName<T>} tagName Tag to create.\n * @param {?Object|?Array<string>|string=} opt_attributes If object, then a map\n *     of name-value pairs for attributes. If a string, then this is the\n *     className of the new element. If an array, the elements will be joined\n *     together as the className of the new element.\n * @param {...(goog.dom.Appendable|undefined)} var_args Further DOM nodes or\n *     strings for text nodes. If one of the var_args is an array or\n *     NodeList, its elements will be added as childNodes instead.\n * @return {R} Reference to a DOM node. The return type is {!Element} if tagName\n *     is a string or a more specific type if it is a member of\n *     goog.dom.TagName (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.createDom = function(\n    tagName, opt_attributes, var_args) {\n  return goog.dom.createDom_(this.document_, arguments);\n};\n\n\n/**\n * Alias for `createDom`.\n * @param {string|!goog.dom.TagName<T>} tagName Tag to create.\n * @param {?Object|?Array<string>|string=} opt_attributes If object, then a map\n *     of name-value pairs for attributes. If a string, then this is the\n *     className of the new element. If an array, the elements will be joined\n *     together as the className of the new element.\n * @param {...(goog.dom.Appendable|undefined)} var_args Further DOM nodes or\n *     strings for text nodes.  If one of the var_args is an array, its children\n *     will be added as childNodes instead.\n * @return {R} Reference to a DOM node. The return type is {!Element} if tagName\n *     is a string or a more specific type if it is a member of\n *     goog.dom.TagName (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n * @deprecated Use {@link goog.dom.DomHelper.prototype.createDom} instead.\n */\ngoog.dom.DomHelper.prototype.$dom = goog.dom.DomHelper.prototype.createDom;\n\n\n/**\n * Creates a new element.\n * @param {string|!goog.dom.TagName<T>} name Tag to create.\n * @return {R} The new element. The return type is {!Element} if name is\n *     a string or a more specific type if it is a member of goog.dom.TagName\n *     (e.g. {!HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.createElement = function(name) {\n  return goog.dom.createElement_(this.document_, name);\n};\n\n\n/**\n * Creates a new text node.\n * @param {number|string} content Content.\n * @return {!Text} The new text node.\n */\ngoog.dom.DomHelper.prototype.createTextNode = function(content) {\n  return this.document_.createTextNode(String(content));\n};\n\n\n/**\n * Create a table.\n * @param {number} rows The number of rows in the table.  Must be >= 1.\n * @param {number} columns The number of columns in the table.  Must be >= 1.\n * @param {boolean=} opt_fillWithNbsp If true, fills table entries with\n *     `goog.string.Unicode.NBSP` characters.\n * @return {!HTMLElement} The created table.\n */\ngoog.dom.DomHelper.prototype.createTable = function(\n    rows, columns, opt_fillWithNbsp) {\n  return goog.dom.createTable_(\n      this.document_, rows, columns, !!opt_fillWithNbsp);\n};\n\n\n/**\n * Converts an HTML into a node or a document fragment. A single Node is used if\n * `html` only generates a single node. If `html` generates multiple\n * nodes then these are put inside a `DocumentFragment`. This is a safe\n * version of `goog.dom.DomHelper#htmlToDocumentFragment` which is now\n * deleted.\n * @param {!goog.html.SafeHtml} html The HTML markup to convert.\n * @return {!Node} The resulting node.\n */\ngoog.dom.DomHelper.prototype.safeHtmlToNode = function(html) {\n  return goog.dom.safeHtmlToNode_(this.document_, html);\n};\n\n\n/**\n * Returns true if the browser is in \"CSS1-compatible\" (standards-compliant)\n * mode, false otherwise.\n * @return {boolean} True if in CSS1-compatible mode.\n */\ngoog.dom.DomHelper.prototype.isCss1CompatMode = function() {\n  return goog.dom.isCss1CompatMode_(this.document_);\n};\n\n\n/**\n * Gets the window object associated with the document.\n * @return {!Window} The window associated with the given document.\n */\ngoog.dom.DomHelper.prototype.getWindow = function() {\n  return goog.dom.getWindow_(this.document_);\n};\n\n\n/**\n * Gets the document scroll element.\n * @return {!Element} Scrolling element.\n */\ngoog.dom.DomHelper.prototype.getDocumentScrollElement = function() {\n  return goog.dom.getDocumentScrollElement_(this.document_);\n};\n\n\n/**\n * Gets the document scroll distance as a coordinate object.\n * @return {!goog.math.Coordinate} Object with properties 'x' and 'y'.\n */\ngoog.dom.DomHelper.prototype.getDocumentScroll = function() {\n  return goog.dom.getDocumentScroll_(this.document_);\n};\n\n\n/**\n * Determines the active element in the given document.\n * @param {Document=} opt_doc The document to look in.\n * @return {Element} The active element.\n */\ngoog.dom.DomHelper.prototype.getActiveElement = function(opt_doc) {\n  return goog.dom.getActiveElement(opt_doc || this.document_);\n};\n\n\n/**\n * Appends a child to a node.\n * @param {Node} parent Parent.\n * @param {Node} child Child.\n */\ngoog.dom.DomHelper.prototype.appendChild = goog.dom.appendChild;\n\n\n/**\n * Appends a node with text or other nodes.\n * @param {!Node} parent The node to append nodes to.\n * @param {...goog.dom.Appendable} var_args The things to append to the node.\n *     If this is a Node it is appended as is.\n *     If this is a string then a text node is appended.\n *     If this is an array like object then fields 0 to length - 1 are appended.\n */\ngoog.dom.DomHelper.prototype.append = goog.dom.append;\n\n\n/**\n * Determines if the given node can contain children, intended to be used for\n * HTML generation.\n *\n * @param {Node} node The node to check.\n * @return {boolean} Whether the node can contain children.\n */\ngoog.dom.DomHelper.prototype.canHaveChildren = goog.dom.canHaveChildren;\n\n\n/**\n * Removes all the child nodes on a DOM node.\n * @param {Node} node Node to remove children from.\n */\ngoog.dom.DomHelper.prototype.removeChildren = goog.dom.removeChildren;\n\n\n/**\n * Inserts a new node before an existing reference node (i.e., as the previous\n * sibling). If the reference node has no parent, then does nothing.\n * @param {Node} newNode Node to insert.\n * @param {Node} refNode Reference node to insert before.\n */\ngoog.dom.DomHelper.prototype.insertSiblingBefore = goog.dom.insertSiblingBefore;\n\n\n/**\n * Inserts a new node after an existing reference node (i.e., as the next\n * sibling). If the reference node has no parent, then does nothing.\n * @param {Node} newNode Node to insert.\n * @param {Node} refNode Reference node to insert after.\n */\ngoog.dom.DomHelper.prototype.insertSiblingAfter = goog.dom.insertSiblingAfter;\n\n\n/**\n * Insert a child at a given index. If index is larger than the number of child\n * nodes that the parent currently has, the node is inserted as the last child\n * node.\n * @param {Element} parent The element into which to insert the child.\n * @param {Node} child The element to insert.\n * @param {number} index The index at which to insert the new child node. Must\n *     not be negative.\n */\ngoog.dom.DomHelper.prototype.insertChildAt = goog.dom.insertChildAt;\n\n\n/**\n * Removes a node from its parent.\n * @param {Node} node The node to remove.\n * @return {Node} The node removed if removed; else, null.\n */\ngoog.dom.DomHelper.prototype.removeNode = goog.dom.removeNode;\n\n\n/**\n * Replaces a node in the DOM tree. Will do nothing if `oldNode` has no\n * parent.\n * @param {Node} newNode Node to insert.\n * @param {Node} oldNode Node to replace.\n */\ngoog.dom.DomHelper.prototype.replaceNode = goog.dom.replaceNode;\n\n\n/**\n * Flattens an element. That is, removes it and replace it with its children.\n * @param {Element} element The element to flatten.\n * @return {Element|undefined} The original element, detached from the document\n *     tree, sans children, or undefined if the element was already not in the\n *     document.\n */\ngoog.dom.DomHelper.prototype.flattenElement = goog.dom.flattenElement;\n\n\n/**\n * Returns an array containing just the element children of the given element.\n * @param {Element} element The element whose element children we want.\n * @return {!(Array<!Element>|NodeList<!Element>)} An array or array-like list\n *     of just the element children of the given element.\n */\ngoog.dom.DomHelper.prototype.getChildren = goog.dom.getChildren;\n\n\n/**\n * Returns the first child node that is an element.\n * @param {Node} node The node to get the first child element of.\n * @return {Element} The first child node of `node` that is an element.\n */\ngoog.dom.DomHelper.prototype.getFirstElementChild =\n    goog.dom.getFirstElementChild;\n\n\n/**\n * Returns the last child node that is an element.\n * @param {Node} node The node to get the last child element of.\n * @return {Element} The last child node of `node` that is an element.\n */\ngoog.dom.DomHelper.prototype.getLastElementChild = goog.dom.getLastElementChild;\n\n\n/**\n * Returns the first next sibling that is an element.\n * @param {Node} node The node to get the next sibling element of.\n * @return {Element} The next sibling of `node` that is an element.\n */\ngoog.dom.DomHelper.prototype.getNextElementSibling =\n    goog.dom.getNextElementSibling;\n\n\n/**\n * Returns the first previous sibling that is an element.\n * @param {Node} node The node to get the previous sibling element of.\n * @return {Element} The first previous sibling of `node` that is\n *     an element.\n */\ngoog.dom.DomHelper.prototype.getPreviousElementSibling =\n    goog.dom.getPreviousElementSibling;\n\n\n/**\n * Returns the next node in source order from the given node.\n * @param {Node} node The node.\n * @return {Node} The next node in the DOM tree, or null if this was the last\n *     node.\n */\ngoog.dom.DomHelper.prototype.getNextNode = goog.dom.getNextNode;\n\n\n/**\n * Returns the previous node in source order from the given node.\n * @param {Node} node The node.\n * @return {Node} The previous node in the DOM tree, or null if this was the\n *     first node.\n */\ngoog.dom.DomHelper.prototype.getPreviousNode = goog.dom.getPreviousNode;\n\n\n/**\n * Whether the object looks like a DOM node.\n * @param {?} obj The object being tested for node likeness.\n * @return {boolean} Whether the object looks like a DOM node.\n */\ngoog.dom.DomHelper.prototype.isNodeLike = goog.dom.isNodeLike;\n\n\n/**\n * Whether the object looks like an Element.\n * @param {?} obj The object being tested for Element likeness.\n * @return {boolean} Whether the object looks like an Element.\n */\ngoog.dom.DomHelper.prototype.isElement = goog.dom.isElement;\n\n\n/**\n * Returns true if the specified value is a Window object. This includes the\n * global window for HTML pages, and iframe windows.\n * @param {?} obj Variable to test.\n * @return {boolean} Whether the variable is a window.\n */\ngoog.dom.DomHelper.prototype.isWindow = goog.dom.isWindow;\n\n\n/**\n * Returns an element's parent, if it's an Element.\n * @param {Element} element The DOM element.\n * @return {Element} The parent, or null if not an Element.\n */\ngoog.dom.DomHelper.prototype.getParentElement = goog.dom.getParentElement;\n\n\n/**\n * Whether a node contains another node.\n * @param {Node} parent The node that should contain the other node.\n * @param {Node} descendant The node to test presence of.\n * @return {boolean} Whether the parent node contains the descendant node.\n */\ngoog.dom.DomHelper.prototype.contains = goog.dom.contains;\n\n\n/**\n * Compares the document order of two nodes, returning 0 if they are the same\n * node, a negative number if node1 is before node2, and a positive number if\n * node2 is before node1.  Note that we compare the order the tags appear in the\n * document so in the tree <b><i>text</i></b> the B node is considered to be\n * before the I node.\n *\n * @param {Node} node1 The first node to compare.\n * @param {Node} node2 The second node to compare.\n * @return {number} 0 if the nodes are the same node, a negative number if node1\n *     is before node2, and a positive number if node2 is before node1.\n */\ngoog.dom.DomHelper.prototype.compareNodeOrder = goog.dom.compareNodeOrder;\n\n\n/**\n * Find the deepest common ancestor of the given nodes.\n * @param {...Node} var_args The nodes to find a common ancestor of.\n * @return {Node} The common ancestor of the nodes, or null if there is none.\n *     null will only be returned if two or more of the nodes are from different\n *     documents.\n */\ngoog.dom.DomHelper.prototype.findCommonAncestor = goog.dom.findCommonAncestor;\n\n\n/**\n * Returns the owner document for a node.\n * @param {Node} node The node to get the document for.\n * @return {!Document} The document owning the node.\n */\ngoog.dom.DomHelper.prototype.getOwnerDocument = goog.dom.getOwnerDocument;\n\n\n/**\n * Cross browser function for getting the document element of an iframe.\n * @param {Element} iframe Iframe element.\n * @return {!Document} The frame content document.\n */\ngoog.dom.DomHelper.prototype.getFrameContentDocument =\n    goog.dom.getFrameContentDocument;\n\n\n/**\n * Cross browser function for getting the window of a frame or iframe.\n * @param {Element} frame Frame element.\n * @return {Window} The window associated with the given frame.\n */\ngoog.dom.DomHelper.prototype.getFrameContentWindow =\n    goog.dom.getFrameContentWindow;\n\n\n/**\n * Sets the text content of a node, with cross-browser support.\n * @param {Node} node The node to change the text content of.\n * @param {string|number} text The value that should replace the node's content.\n */\ngoog.dom.DomHelper.prototype.setTextContent = goog.dom.setTextContent;\n\n\n/**\n * Gets the outerHTML of a node, which islike innerHTML, except that it\n * actually contains the HTML of the node itself.\n * @param {Element} element The element to get the HTML of.\n * @return {string} The outerHTML of the given element.\n */\ngoog.dom.DomHelper.prototype.getOuterHtml = goog.dom.getOuterHtml;\n\n\n/**\n * Finds the first descendant node that matches the filter function. This does\n * a depth first search.\n * @param {Node} root The root of the tree to search.\n * @param {function(Node) : boolean} p The filter function.\n * @return {Node|undefined} The found node or undefined if none is found.\n */\ngoog.dom.DomHelper.prototype.findNode = goog.dom.findNode;\n\n\n/**\n * Finds all the descendant nodes that matches the filter function. This does a\n * depth first search.\n * @param {Node} root The root of the tree to search.\n * @param {function(Node) : boolean} p The filter function.\n * @return {Array<Node>} The found nodes or an empty array if none are found.\n */\ngoog.dom.DomHelper.prototype.findNodes = goog.dom.findNodes;\n\n\n/**\n * Returns true if the element has a tab index that allows it to receive\n * keyboard focus (tabIndex >= 0), false otherwise.  Note that some elements\n * natively support keyboard focus, even if they have no tab index.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element has a tab index that allows keyboard\n *     focus.\n */\ngoog.dom.DomHelper.prototype.isFocusableTabIndex = goog.dom.isFocusableTabIndex;\n\n\n/**\n * Enables or disables keyboard focus support on the element via its tab index.\n * Only elements for which {@link goog.dom.isFocusableTabIndex} returns true\n * (or elements that natively support keyboard focus, like form elements) can\n * receive keyboard focus.  See http://go/tabindex for more info.\n * @param {Element} element Element whose tab index is to be changed.\n * @param {boolean} enable Whether to set or remove a tab index on the element\n *     that supports keyboard focus.\n */\ngoog.dom.DomHelper.prototype.setFocusableTabIndex =\n    goog.dom.setFocusableTabIndex;\n\n\n/**\n * Returns true if the element can be focused, i.e. it has a tab index that\n * allows it to receive keyboard focus (tabIndex >= 0), or it is an element\n * that natively supports keyboard focus.\n * @param {!Element} element Element to check.\n * @return {boolean} Whether the element allows keyboard focus.\n */\ngoog.dom.DomHelper.prototype.isFocusable = goog.dom.isFocusable;\n\n\n/**\n * Returns the text contents of the current node, without markup. New lines are\n * stripped and whitespace is collapsed, such that each character would be\n * visible.\n *\n * In browsers that support it, innerText is used.  Other browsers attempt to\n * simulate it via node traversal.  Line breaks are canonicalized in IE.\n *\n * @param {Node} node The node from which we are getting content.\n * @return {string} The text content.\n */\ngoog.dom.DomHelper.prototype.getTextContent = goog.dom.getTextContent;\n\n\n/**\n * Returns the text length of the text contained in a node, without markup. This\n * is equivalent to the selection length if the node was selected, or the number\n * of cursor movements to traverse the node. Images & BRs take one space.  New\n * lines are ignored.\n *\n * @param {Node} node The node whose text content length is being calculated.\n * @return {number} The length of `node`'s text content.\n */\ngoog.dom.DomHelper.prototype.getNodeTextLength = goog.dom.getNodeTextLength;\n\n\n/**\n * Returns the text offset of a node relative to one of its ancestors. The text\n * length is the same as the length calculated by\n * `goog.dom.getNodeTextLength`.\n *\n * @param {Node} node The node whose offset is being calculated.\n * @param {Node=} opt_offsetParent Defaults to the node's owner document's body.\n * @return {number} The text offset.\n */\ngoog.dom.DomHelper.prototype.getNodeTextOffset = goog.dom.getNodeTextOffset;\n\n\n/**\n * Returns the node at a given offset in a parent node.  If an object is\n * provided for the optional third parameter, the node and the remainder of the\n * offset will stored as properties of this object.\n * @param {Node} parent The parent node.\n * @param {number} offset The offset into the parent node.\n * @param {Object=} opt_result Object to be used to store the return value. The\n *     return value will be stored in the form {node: Node, remainder: number}\n *     if this object is provided.\n * @return {Node} The node at the given offset.\n */\ngoog.dom.DomHelper.prototype.getNodeAtOffset = goog.dom.getNodeAtOffset;\n\n\n/**\n * Returns true if the object is a `NodeList`.  To qualify as a NodeList,\n * the object must have a numeric length property and an item function (which\n * has type 'string' on IE for some reason).\n * @param {Object} val Object to test.\n * @return {boolean} Whether the object is a NodeList.\n */\ngoog.dom.DomHelper.prototype.isNodeList = goog.dom.isNodeList;\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that has the passed\n * tag name and/or class name. If the passed element matches the specified\n * criteria, the element itself is returned.\n * @param {Node} element The DOM node to start with.\n * @param {?(goog.dom.TagName<T>|string)=} opt_tag The tag name to match (or\n *     null/undefined to match only based on class name).\n * @param {?string=} opt_class The class name to match (or null/undefined to\n *     match only based on tag name).\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {?R} The first ancestor that matches the passed criteria, or\n *     null if no match is found. The return type is {?Element} if opt_tag is\n *     not a member of goog.dom.TagName or a more specific type if it is (e.g.\n *     {?HTMLAnchorElement} for goog.dom.TagName.A).\n * @template T\n * @template R := cond(isUnknown(T), 'Element', T) =:\n */\ngoog.dom.DomHelper.prototype.getAncestorByTagNameAndClass =\n    goog.dom.getAncestorByTagNameAndClass;\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that has the passed\n * class name. If the passed element matches the specified criteria, the\n * element itself is returned.\n * @param {Node} element The DOM node to start with.\n * @param {string} class The class name to match.\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {Element} The first ancestor that matches the passed criteria, or\n *     null if none match.\n */\ngoog.dom.DomHelper.prototype.getAncestorByClass = goog.dom.getAncestorByClass;\n\n\n/**\n * Walks up the DOM hierarchy returning the first ancestor that passes the\n * matcher function.\n * @param {Node} element The DOM node to start with.\n * @param {function(Node) : boolean} matcher A function that returns true if the\n *     passed node matches the desired criteria.\n * @param {boolean=} opt_includeNode If true, the node itself is included in\n *     the search (the first call to the matcher will pass startElement as\n *     the node to test).\n * @param {number=} opt_maxSearchSteps Maximum number of levels to search up the\n *     dom.\n * @return {Node} DOM node that matched the matcher, or null if there was\n *     no match.\n */\ngoog.dom.DomHelper.prototype.getAncestor = goog.dom.getAncestor;\n\n\n/**\n * Gets '2d' context of a canvas. Shortcut for canvas.getContext('2d') with a\n * type information.\n * @param {!HTMLCanvasElement} canvas\n * @return {!CanvasRenderingContext2D}\n */\ngoog.dom.DomHelper.prototype.getCanvasContext2D = goog.dom.getCanvasContext2D;\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Abstract class for all UI components. This defines the standard\n * design pattern that all UI components should follow.\n *\n * @author attila@google.com (Attila Bodis)\n * @see ../demos/samplecomponent.html\n * @see http://code.google.com/p/closure-library/wiki/IntroToComponents\n */\n\ngoog.provide('goog.ui.Component');\ngoog.provide('goog.ui.Component.Error');\ngoog.provide('goog.ui.Component.EventType');\ngoog.provide('goog.ui.Component.State');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.events.EventHandler');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.object');\ngoog.require('goog.style');\ngoog.require('goog.ui.IdGenerator');\n\n\n\n/**\n * Default implementation of UI component.\n *\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper.\n * @constructor\n * @extends {goog.events.EventTarget}\n * @suppress {underscore}\n */\ngoog.ui.Component = function(opt_domHelper) {\n  goog.events.EventTarget.call(this);\n  /**\n   * DomHelper used to interact with the document, allowing components to be\n   * created in a different window.\n   * @protected {!goog.dom.DomHelper}\n   * @suppress {underscore|visibility}\n   */\n  this.dom_ = opt_domHelper || goog.dom.getDomHelper();\n\n  /**\n   * Whether the component is rendered right-to-left.  Right-to-left is set\n   * lazily when {@link #isRightToLeft} is called the first time, unless it has\n   * been set by calling {@link #setRightToLeft} explicitly.\n   * @private {?boolean}\n   */\n  this.rightToLeft_ = goog.ui.Component.defaultRightToLeft_;\n\n  /**\n   * Unique ID of the component, lazily initialized in {@link\n   * goog.ui.Component#getId} if needed.  This property is strictly private and\n   * must not be accessed directly outside of this class!\n   * @private {?string}\n   */\n  this.id_ = null;\n\n  /**\n   * Whether the component is in the document.\n   * @private {boolean}\n   */\n  this.inDocument_ = false;\n\n  // TODO(attila): Stop referring to this private field in subclasses.\n  /**\n   * The DOM element for the component.\n   * @private {Element}\n   */\n  this.element_ = null;\n\n  /**\n   * Event handler.\n   * TODO(user): rename it to handler_ after all component subclasses in\n   * inside Google have been cleaned up.\n   * Code search: http://go/component_code_search\n   * @private {goog.events.EventHandler|undefined}\n   */\n  this.googUiComponentHandler_ = void 0;\n\n  /**\n   * Arbitrary data object associated with the component.  Such as meta-data.\n   * @private {*}\n   */\n  this.model_ = null;\n\n  /**\n   * Parent component to which events will be propagated.  This property is\n   * strictly private and must not be accessed directly outside of this class!\n   * @private {goog.ui.Component?}\n   */\n  this.parent_ = null;\n\n  /**\n   * Array of child components.  Lazily initialized on first use.  Must be kept\n   * in sync with `childIndex_`.  This property is strictly private and\n   * must not be accessed directly outside of this class!\n   * @private {Array<goog.ui.Component>?}\n   */\n  this.children_ = null;\n\n  /**\n   * Map of child component IDs to child components.  Used for constant-time\n   * random access to child components by ID.  Lazily initialized on first use.\n   * Must be kept in sync with `children_`.  This property is strictly\n   * private and must not be accessed directly outside of this class!\n   *\n   * We use a plain Object, not a {@link goog.structs.Map}, for simplicity.\n   * This means components can't have children with IDs such as 'constructor' or\n   * 'valueOf', but this shouldn't really be an issue in practice, and if it is,\n   * we can always fix it later without changing the API.\n   *\n   * @private {Object}\n   */\n  this.childIndex_ = null;\n\n  /**\n   * Flag used to keep track of whether a component decorated an already\n   * existing element or whether it created the DOM itself.\n   *\n   * If an element is decorated, dispose will leave the node in the document.\n   * It is up to the app to remove the node.\n   *\n   * If an element was rendered, dispose will remove the node automatically.\n   *\n   * @private {boolean}\n   */\n  this.wasDecorated_ = false;\n\n  /**\n   * If true, listen for PointerEvent types rather than MouseEvent types. This\n   * allows supporting drag gestures for touch/stylus input.\n   * @private {boolean}\n   */\n  this.pointerEventsEnabled_ = false;\n};\ngoog.inherits(goog.ui.Component, goog.events.EventTarget);\n\n\n/**\n * @define {boolean} Whether to support calling decorate with an element that is\n *     not yet in the document. If true, we check if the element is in the\n *     document, and avoid calling enterDocument if it isn't. If false, we\n *     maintain legacy behavior (always call enterDocument from decorate).\n */\ngoog.define('goog.ui.Component.ALLOW_DETACHED_DECORATION', false);\n\n\n/**\n * Generator for unique IDs.\n * @type {goog.ui.IdGenerator}\n * @private\n */\ngoog.ui.Component.prototype.idGenerator_ = goog.ui.IdGenerator.getInstance();\n\n\n// TODO(gboyer): See if we can remove this and just check goog.i18n.bidi.IS_RTL.\n/**\n * @define {number} Defines the default BIDI directionality.\n *     0: Unknown.\n *     1: Left-to-right.\n *     -1: Right-to-left.\n */\ngoog.define('goog.ui.Component.DEFAULT_BIDI_DIR', 0);\n\n\n/**\n * The default right to left value.\n * @type {?boolean}\n * @private\n */\ngoog.ui.Component.defaultRightToLeft_ =\n    (goog.ui.Component.DEFAULT_BIDI_DIR == 1) ?\n    false :\n    (goog.ui.Component.DEFAULT_BIDI_DIR == -1) ? true : null;\n\n\n/**\n * Common events fired by components so that event propagation is useful.  Not\n * all components are expected to dispatch or listen for all event types.\n * Events dispatched before a state transition should be cancelable to prevent\n * the corresponding state change.\n * @enum {string}\n */\ngoog.ui.Component.EventType = {\n  /** Dispatched before the component becomes visible. */\n  BEFORE_SHOW: 'beforeshow',\n\n  /**\n   * Dispatched after the component becomes visible.\n   * NOTE(user): For goog.ui.Container, this actually fires before containers\n   * are shown.  Use goog.ui.Container.EventType.AFTER_SHOW if you want an event\n   * that fires after a goog.ui.Container is shown.\n   */\n  SHOW: 'show',\n\n  /** Dispatched before the component becomes hidden. */\n  HIDE: 'hide',\n\n  /** Dispatched before the component becomes disabled. */\n  DISABLE: 'disable',\n\n  /** Dispatched before the component becomes enabled. */\n  ENABLE: 'enable',\n\n  /** Dispatched before the component becomes highlighted. */\n  HIGHLIGHT: 'highlight',\n\n  /** Dispatched before the component becomes un-highlighted. */\n  UNHIGHLIGHT: 'unhighlight',\n\n  /** Dispatched before the component becomes activated. */\n  ACTIVATE: 'activate',\n\n  /** Dispatched before the component becomes deactivated. */\n  DEACTIVATE: 'deactivate',\n\n  /** Dispatched before the component becomes selected. */\n  SELECT: 'select',\n\n  /** Dispatched before the component becomes un-selected. */\n  UNSELECT: 'unselect',\n\n  /** Dispatched before a component becomes checked. */\n  CHECK: 'check',\n\n  /** Dispatched before a component becomes un-checked. */\n  UNCHECK: 'uncheck',\n\n  /** Dispatched before a component becomes focused. */\n  FOCUS: 'focus',\n\n  /** Dispatched before a component becomes blurred. */\n  BLUR: 'blur',\n\n  /** Dispatched before a component is opened (expanded). */\n  OPEN: 'open',\n\n  /** Dispatched before a component is closed (collapsed). */\n  CLOSE: 'close',\n\n  /** Dispatched after a component is moused over. */\n  ENTER: 'enter',\n\n  /** Dispatched after a component is moused out of. */\n  LEAVE: 'leave',\n\n  /** Dispatched after the user activates the component. */\n  ACTION: 'action',\n\n  /** Dispatched after the external-facing state of a component is changed. */\n  CHANGE: 'change'\n};\n\n\n/**\n * Errors thrown by the component.\n * @enum {string}\n */\ngoog.ui.Component.Error = {\n  /**\n   * Error when a method is not supported.\n   */\n  NOT_SUPPORTED: 'Method not supported',\n\n  /**\n   * Error when the given element can not be decorated.\n   */\n  DECORATE_INVALID: 'Invalid element to decorate',\n\n  /**\n   * Error when the component is already rendered and another render attempt is\n   * made.\n   */\n  ALREADY_RENDERED: 'Component already rendered',\n\n  /**\n   * Error when an attempt is made to set the parent of a component in a way\n   * that would result in an inconsistent object graph.\n   */\n  PARENT_UNABLE_TO_BE_SET: 'Unable to set parent component',\n\n  /**\n   * Error when an attempt is made to add a child component at an out-of-bounds\n   * index.  We don't support sparse child arrays.\n   */\n  CHILD_INDEX_OUT_OF_BOUNDS: 'Child component index out of bounds',\n\n  /**\n   * Error when an attempt is made to remove a child component from a component\n   * other than its parent.\n   */\n  NOT_OUR_CHILD: 'Child is not in parent component',\n\n  /**\n   * Error when an operation requiring DOM interaction is made when the\n   * component is not in the document\n   */\n  NOT_IN_DOCUMENT: 'Operation not supported while component is not in document',\n\n  /**\n   * Error when an invalid component state is encountered.\n   */\n  STATE_INVALID: 'Invalid component state'\n};\n\n\n/**\n * Common component states.  Components may have distinct appearance depending\n * on what state(s) apply to them.  Not all components are expected to support\n * all states.\n * @enum {number}\n */\ngoog.ui.Component.State = {\n  /**\n   * Union of all supported component states.\n   */\n  ALL: 0xFF,\n\n  /**\n   * Component is disabled.\n   * @see goog.ui.Component.EventType.DISABLE\n   * @see goog.ui.Component.EventType.ENABLE\n   */\n  DISABLED: 0x01,\n\n  /**\n   * Component is highlighted.\n   * @see goog.ui.Component.EventType.HIGHLIGHT\n   * @see goog.ui.Component.EventType.UNHIGHLIGHT\n   */\n  HOVER: 0x02,\n\n  /**\n   * Component is active (or \"pressed\").\n   * @see goog.ui.Component.EventType.ACTIVATE\n   * @see goog.ui.Component.EventType.DEACTIVATE\n   */\n  ACTIVE: 0x04,\n\n  /**\n   * Component is selected.\n   * @see goog.ui.Component.EventType.SELECT\n   * @see goog.ui.Component.EventType.UNSELECT\n   */\n  SELECTED: 0x08,\n\n  /**\n   * Component is checked.\n   * @see goog.ui.Component.EventType.CHECK\n   * @see goog.ui.Component.EventType.UNCHECK\n   */\n  CHECKED: 0x10,\n\n  /**\n   * Component has focus.\n   * @see goog.ui.Component.EventType.FOCUS\n   * @see goog.ui.Component.EventType.BLUR\n   */\n  FOCUSED: 0x20,\n\n  /**\n   * Component is opened (expanded).  Applies to tree nodes, menu buttons,\n   * submenus, zippys (zippies?), etc.\n   * @see goog.ui.Component.EventType.OPEN\n   * @see goog.ui.Component.EventType.CLOSE\n   */\n  OPENED: 0x40\n};\n\n\n/**\n * Static helper method; returns the type of event components are expected to\n * dispatch when transitioning to or from the given state.\n * @param {goog.ui.Component.State} state State to/from which the component\n *     is transitioning.\n * @param {boolean} isEntering Whether the component is entering or leaving the\n *     state.\n * @return {goog.ui.Component.EventType} Event type to dispatch.\n */\ngoog.ui.Component.getStateTransitionEvent = function(state, isEntering) {\n  switch (state) {\n    case goog.ui.Component.State.DISABLED:\n      return isEntering ? goog.ui.Component.EventType.DISABLE :\n                          goog.ui.Component.EventType.ENABLE;\n    case goog.ui.Component.State.HOVER:\n      return isEntering ? goog.ui.Component.EventType.HIGHLIGHT :\n                          goog.ui.Component.EventType.UNHIGHLIGHT;\n    case goog.ui.Component.State.ACTIVE:\n      return isEntering ? goog.ui.Component.EventType.ACTIVATE :\n                          goog.ui.Component.EventType.DEACTIVATE;\n    case goog.ui.Component.State.SELECTED:\n      return isEntering ? goog.ui.Component.EventType.SELECT :\n                          goog.ui.Component.EventType.UNSELECT;\n    case goog.ui.Component.State.CHECKED:\n      return isEntering ? goog.ui.Component.EventType.CHECK :\n                          goog.ui.Component.EventType.UNCHECK;\n    case goog.ui.Component.State.FOCUSED:\n      return isEntering ? goog.ui.Component.EventType.FOCUS :\n                          goog.ui.Component.EventType.BLUR;\n    case goog.ui.Component.State.OPENED:\n      return isEntering ? goog.ui.Component.EventType.OPEN :\n                          goog.ui.Component.EventType.CLOSE;\n    default:\n      // Fall through.\n  }\n\n  // Invalid state.\n  throw new Error(goog.ui.Component.Error.STATE_INVALID);\n};\n\n\n/**\n * Set the default right-to-left value. This causes all component's created from\n * this point forward to have the given value. This is useful for cases where\n * a given page is always in one directionality, avoiding unnecessary\n * right to left determinations.\n * @param {?boolean} rightToLeft Whether the components should be rendered\n *     right-to-left. Null iff components should determine their directionality.\n */\ngoog.ui.Component.setDefaultRightToLeft = function(rightToLeft) {\n  goog.ui.Component.defaultRightToLeft_ = rightToLeft;\n};\n\n\n/**\n * Gets the unique ID for the instance of this component.  If the instance\n * doesn't already have an ID, generates one on the fly.\n * @return {string} Unique component ID.\n */\ngoog.ui.Component.prototype.getId = function() {\n  return this.id_ || (this.id_ = this.idGenerator_.getNextUniqueId());\n};\n\n\n/**\n * Assigns an ID to this component instance.  It is the caller's responsibility\n * to guarantee that the ID is unique.  If the component is a child of a parent\n * component, then the parent component's child index is updated to reflect the\n * new ID; this may throw an error if the parent already has a child with an ID\n * that conflicts with the new ID.\n * @param {string} id Unique component ID.\n */\ngoog.ui.Component.prototype.setId = function(id) {\n  if (this.parent_ && this.parent_.childIndex_) {\n    // Update the parent's child index.\n    goog.object.remove(this.parent_.childIndex_, this.id_);\n    goog.object.add(this.parent_.childIndex_, id, this);\n  }\n\n  // Update the component ID.\n  this.id_ = id;\n};\n\n\n/**\n * Gets the component's element.\n * @return {Element} The element for the component.\n */\ngoog.ui.Component.prototype.getElement = function() {\n  return this.element_;\n};\n\n\n/**\n * Gets the component's element. This differs from getElement in that\n * it assumes that the element exists (i.e. the component has been\n * rendered/decorated) and will cause an assertion error otherwise (if\n * assertion is enabled).\n * @return {!Element} The element for the component.\n */\ngoog.ui.Component.prototype.getElementStrict = function() {\n  var el = this.element_;\n  goog.asserts.assert(\n      el, 'Can not call getElementStrict before rendering/decorating.');\n  return el;\n};\n\n\n/**\n * Sets the component's root element to the given element.  Considered\n * protected and final.\n *\n * This should generally only be called during createDom. Setting the element\n * does not actually change which element is rendered, only the element that is\n * associated with this UI component.\n *\n * This should only be used by subclasses and its associated renderers.\n *\n * @param {Element} element Root element for the component.\n */\ngoog.ui.Component.prototype.setElementInternal = function(element) {\n  this.element_ = element;\n};\n\n\n/**\n * Returns an array of all the elements in this component's DOM with the\n * provided className.\n * @param {string} className The name of the class to look for.\n * @return {!IArrayLike<!Element>} The items found with the class name provided.\n */\ngoog.ui.Component.prototype.getElementsByClass = function(className) {\n  return this.element_ ?\n      this.dom_.getElementsByClass(className, this.element_) :\n      [];\n};\n\n\n/**\n * Returns the first element in this component's DOM with the provided\n * className.\n * @param {string} className The name of the class to look for.\n * @return {Element} The first item with the class name provided.\n */\ngoog.ui.Component.prototype.getElementByClass = function(className) {\n  return this.element_ ? this.dom_.getElementByClass(className, this.element_) :\n                         null;\n};\n\n\n/**\n * Similar to `getElementByClass` except that it expects the\n * element to be present in the dom thus returning a required value. Otherwise,\n * will assert.\n * @param {string} className The name of the class to look for.\n * @return {!Element} The first item with the class name provided.\n */\ngoog.ui.Component.prototype.getRequiredElementByClass = function(className) {\n  var el = this.getElementByClass(className);\n  goog.asserts.assert(\n      el, 'Expected element in component with class: %s', className);\n  return el;\n};\n\n\n/**\n * Returns the event handler for this component, lazily created the first time\n * this method is called.\n * @return {!goog.events.EventHandler<T>} Event handler for this component.\n * @protected\n * @this {T}\n * @template T\n */\ngoog.ui.Component.prototype.getHandler = function() {\n  // TODO(user): templated \"this\" values currently result in \"this\" being\n  // \"unknown\" in the body of the function.\n  var self = /** @type {goog.ui.Component} */ (this);\n  if (!self.googUiComponentHandler_) {\n    self.googUiComponentHandler_ = new goog.events.EventHandler(self);\n  }\n  return goog.asserts.assert(self.googUiComponentHandler_);\n};\n\n\n/**\n * Sets the parent of this component to use for event bubbling.  Throws an error\n * if the component already has a parent or if an attempt is made to add a\n * component to itself as a child.  Callers must use `removeChild`\n * or `removeChildAt` to remove components from their containers before\n * calling this method.\n * @see goog.ui.Component#removeChild\n * @see goog.ui.Component#removeChildAt\n * @param {goog.ui.Component} parent The parent component.\n */\ngoog.ui.Component.prototype.setParent = function(parent) {\n  if (this == parent) {\n    // Attempting to add a child to itself is an error.\n    throw new Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);\n  }\n\n  if (parent && this.parent_ && this.id_ && this.parent_.getChild(this.id_) &&\n      this.parent_ != parent) {\n    // This component is already the child of some parent, so it should be\n    // removed using removeChild/removeChildAt first.\n    throw new Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);\n  }\n\n  this.parent_ = parent;\n  goog.ui.Component.superClass_.setParentEventTarget.call(this, parent);\n};\n\n\n/**\n * Returns the component's parent, if any.\n * @return {goog.ui.Component?} The parent component.\n */\ngoog.ui.Component.prototype.getParent = function() {\n  return this.parent_;\n};\n\n\n/**\n * Overrides {@link goog.events.EventTarget#setParentEventTarget} to throw an\n * error if the parent component is set, and the argument is not the parent.\n * @override\n */\ngoog.ui.Component.prototype.setParentEventTarget = function(parent) {\n  if (this.parent_ && this.parent_ != parent) {\n    throw new Error(goog.ui.Component.Error.NOT_SUPPORTED);\n  }\n  goog.ui.Component.superClass_.setParentEventTarget.call(this, parent);\n};\n\n\n/**\n * Returns the dom helper that is being used on this component.\n * @return {!goog.dom.DomHelper} The dom helper used on this component.\n */\ngoog.ui.Component.prototype.getDomHelper = function() {\n  return this.dom_;\n};\n\n\n/**\n * Determines whether the component has been added to the document.\n * @return {boolean} TRUE if rendered. Otherwise, FALSE.\n */\ngoog.ui.Component.prototype.isInDocument = function() {\n  return this.inDocument_;\n};\n\n\n/**\n * Creates the initial DOM representation for the component.  The default\n * implementation is to set this.element_ = div.\n */\ngoog.ui.Component.prototype.createDom = function() {\n  this.element_ = this.dom_.createElement(goog.dom.TagName.DIV);\n};\n\n\n/**\n * Renders the component.  If a parent element is supplied, the component's\n * element will be appended to it.  If there is no optional parent element and\n * the element doesn't have a parentNode then it will be appended to the\n * document body.\n *\n * If this component has a parent component, and the parent component is\n * not in the document already, then this will not call `enterDocument`\n * on this component.\n *\n * Throws an Error if the component is already rendered.\n *\n * @param {Element=} opt_parentElement Optional parent element to render the\n *    component into.\n */\ngoog.ui.Component.prototype.render = function(opt_parentElement) {\n  this.render_(opt_parentElement);\n};\n\n\n/**\n * Renders the component before another element. The other element should be in\n * the document already.\n *\n * Throws an Error if the component is already rendered.\n *\n * @param {Node} sibling Node to render the component before.\n */\ngoog.ui.Component.prototype.renderBefore = function(sibling) {\n  this.render_(/** @type {Element} */ (sibling.parentNode), sibling);\n};\n\n\n/**\n * Renders the component.  If a parent element is supplied, the component's\n * element will be appended to it.  If there is no optional parent element and\n * the element doesn't have a parentNode then it will be appended to the\n * document body.\n *\n * If this component has a parent component, and the parent component is\n * not in the document already, then this will not call `enterDocument`\n * on this component.\n *\n * Throws an Error if the component is already rendered.\n *\n * @param {Element=} opt_parentElement Optional parent element to render the\n *    component into.\n * @param {Node=} opt_beforeNode Node before which the component is to\n *    be rendered.  If left out the node is appended to the parent element.\n * @private\n */\ngoog.ui.Component.prototype.render_ = function(\n    opt_parentElement, opt_beforeNode) {\n  if (this.inDocument_) {\n    throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n\n  if (!this.element_) {\n    this.createDom();\n  }\n\n  if (opt_parentElement) {\n    opt_parentElement.insertBefore(this.element_, opt_beforeNode || null);\n  } else {\n    this.dom_.getDocument().body.appendChild(this.element_);\n  }\n\n  // If this component has a parent component that isn't in the document yet,\n  // we don't call enterDocument() here.  Instead, when the parent component\n  // enters the document, the enterDocument() call will propagate to its\n  // children, including this one.  If the component doesn't have a parent\n  // or if the parent is already in the document, we call enterDocument().\n  if (!this.parent_ || this.parent_.isInDocument()) {\n    this.enterDocument();\n  }\n};\n\n\n/**\n * Decorates the element for the UI component. If the element is in the\n * document, the enterDocument method will be called.\n *\n * If goog.ui.Component.ALLOW_DETACHED_DECORATION is false, the caller must\n * pass an element that is in the document.\n *\n * @param {Element} element Element to decorate.\n */\ngoog.ui.Component.prototype.decorate = function(element) {\n  if (this.inDocument_) {\n    throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  } else if (element && this.canDecorate(element)) {\n    this.wasDecorated_ = true;\n\n    // Set the DOM helper of the component to match the decorated element.\n    var doc = goog.dom.getOwnerDocument(element);\n    if (!this.dom_ || this.dom_.getDocument() != doc) {\n      this.dom_ = goog.dom.getDomHelper(element);\n    }\n\n    // Call specific component decorate logic.\n    this.decorateInternal(element);\n\n    // If supporting detached decoration, check that element is in doc.\n    if (!goog.ui.Component.ALLOW_DETACHED_DECORATION ||\n        goog.dom.contains(doc, element)) {\n      this.enterDocument();\n    }\n  } else {\n    throw new Error(goog.ui.Component.Error.DECORATE_INVALID);\n  }\n};\n\n\n/**\n * Determines if a given element can be decorated by this type of component.\n * This method should be overridden by inheriting objects.\n * @param {Element} element Element to decorate.\n * @return {boolean} True if the element can be decorated, false otherwise.\n */\ngoog.ui.Component.prototype.canDecorate = function(element) {\n  return true;\n};\n\n\n/**\n * @return {boolean} Whether the component was decorated.\n */\ngoog.ui.Component.prototype.wasDecorated = function() {\n  return this.wasDecorated_;\n};\n\n\n/**\n * Actually decorates the element. Should be overridden by inheriting objects.\n * This method can assume there are checks to ensure the component has not\n * already been rendered have occurred and that enter document will be called\n * afterwards. This method is considered protected.\n * @param {Element} element Element to decorate.\n * @protected\n */\ngoog.ui.Component.prototype.decorateInternal = function(element) {\n  this.element_ = element;\n};\n\n\n/**\n * Called when the component's element is known to be in the document. Anything\n * using document.getElementById etc. should be done at this stage.\n *\n * If the component contains child components, this call is propagated to its\n * children.\n */\ngoog.ui.Component.prototype.enterDocument = function() {\n  this.inDocument_ = true;\n\n  // Propagate enterDocument to child components that have a DOM, if any.\n  // If a child was decorated before entering the document (permitted when\n  // goog.ui.Component.ALLOW_DETACHED_DECORATION is true), its enterDocument\n  // will be called here.\n  this.forEachChild(function(child) {\n    if (!child.isInDocument() && child.getElement()) {\n      child.enterDocument();\n    }\n  });\n};\n\n\n/**\n * Called by dispose to clean up the elements and listeners created by a\n * component, or by a parent component/application who has removed the\n * component from the document but wants to reuse it later.\n *\n * If the component contains child components, this call is propagated to its\n * children.\n *\n * It should be possible for the component to be rendered again once this method\n * has been called.\n */\ngoog.ui.Component.prototype.exitDocument = function() {\n  // Propagate exitDocument to child components that have been rendered, if any.\n  this.forEachChild(function(child) {\n    if (child.isInDocument()) {\n      child.exitDocument();\n    }\n  });\n\n  if (this.googUiComponentHandler_) {\n    this.googUiComponentHandler_.removeAll();\n  }\n\n  this.inDocument_ = false;\n};\n\n\n/**\n * Disposes of the component.  Calls `exitDocument`, which is expected to\n * remove event handlers and clean up the component.  Propagates the call to\n * the component's children, if any. Removes the component's DOM from the\n * document unless it was decorated.\n * @override\n * @protected\n */\ngoog.ui.Component.prototype.disposeInternal = function() {\n  if (this.inDocument_) {\n    this.exitDocument();\n  }\n\n  if (this.googUiComponentHandler_) {\n    this.googUiComponentHandler_.dispose();\n    delete this.googUiComponentHandler_;\n  }\n\n  // Disposes of the component's children, if any.\n  this.forEachChild(function(child) { child.dispose(); });\n\n  // Detach the component's element from the DOM, unless it was decorated.\n  if (!this.wasDecorated_ && this.element_) {\n    goog.dom.removeNode(this.element_);\n  }\n\n  this.children_ = null;\n  this.childIndex_ = null;\n  this.element_ = null;\n  this.model_ = null;\n  this.parent_ = null;\n\n  goog.ui.Component.superClass_.disposeInternal.call(this);\n};\n\n\n/**\n * Helper function for subclasses that gets a unique id for a given fragment,\n * this can be used by components to generate unique string ids for DOM\n * elements.\n * @param {string} idFragment A partial id.\n * @return {string} Unique element id.\n */\ngoog.ui.Component.prototype.makeId = function(idFragment) {\n  return this.getId() + '.' + idFragment;\n};\n\n\n/**\n * Makes a collection of ids.  This is a convenience method for makeId.  The\n * object's values are the id fragments and the new values are the generated\n * ids.  The key will remain the same.\n * @param {Object} object The object that will be used to create the ids.\n * @return {!Object<string, string>} An object of id keys to generated ids.\n */\ngoog.ui.Component.prototype.makeIds = function(object) {\n  var ids = {};\n  for (var key in object) {\n    ids[key] = this.makeId(object[key]);\n  }\n  return ids;\n};\n\n\n/**\n * Returns the model associated with the UI component.\n * @return {*} The model.\n */\ngoog.ui.Component.prototype.getModel = function() {\n  return this.model_;\n};\n\n\n/**\n * Sets the model associated with the UI component.\n * @param {*} obj The model.\n */\ngoog.ui.Component.prototype.setModel = function(obj) {\n  this.model_ = obj;\n};\n\n\n/**\n * Helper function for returning the fragment portion of an id generated using\n * makeId().\n * @param {string} id Id generated with makeId().\n * @return {string} Fragment.\n */\ngoog.ui.Component.prototype.getFragmentFromId = function(id) {\n  return id.substring(this.getId().length + 1);\n};\n\n\n/**\n * Helper function for returning an element in the document with a unique id\n * generated using makeId().\n * @param {string} idFragment The partial id.\n * @return {Element} The element with the unique id, or null if it cannot be\n *     found.\n */\ngoog.ui.Component.prototype.getElementByFragment = function(idFragment) {\n  if (!this.inDocument_) {\n    throw new Error(goog.ui.Component.Error.NOT_IN_DOCUMENT);\n  }\n  return this.dom_.getElement(this.makeId(idFragment));\n};\n\n\n/**\n * Adds the specified component as the last child of this component.  See\n * {@link goog.ui.Component#addChildAt} for detailed semantics.\n *\n * @see goog.ui.Component#addChildAt\n * @param {goog.ui.Component} child The new child component.\n * @param {boolean=} opt_render If true, the child component will be rendered\n *    into the parent.\n */\ngoog.ui.Component.prototype.addChild = function(child, opt_render) {\n  // TODO(gboyer): addChildAt(child, this.getChildCount(), false) will\n  // reposition any already-rendered child to the end.  Instead, perhaps\n  // addChild(child, false) should never reposition the child; instead, clients\n  // that need the repositioning will use addChildAt explicitly.  Right now,\n  // clients can get around this by calling addChild before calling decorate.\n  this.addChildAt(child, this.getChildCount(), opt_render);\n};\n\n\n/**\n * Adds the specified component as a child of this component at the given\n * 0-based index.\n *\n * Both `addChild` and `addChildAt` assume the following contract\n * between parent and child components:\n *  <ul>\n *    <li>the child component's element must be a descendant of the parent\n *        component's element, and\n *    <li>the DOM state of the child component must be consistent with the DOM\n *        state of the parent component (see `isInDocument`) in the\n *        steady state -- the exception is to addChildAt(child, i, false) and\n *        then immediately decorate/render the child.\n *  </ul>\n *\n * In particular, `parent.addChild(child)` will throw an error if the\n * child component is already in the document, but the parent isn't.\n *\n * Clients of this API may call `addChild` and `addChildAt` with\n * `opt_render` set to true.  If `opt_render` is true, calling these\n * methods will automatically render the child component's element into the\n * parent component's element. If the parent does not yet have an element, then\n * `createDom` will automatically be invoked on the parent before\n * rendering the child.\n *\n * Invoking {@code parent.addChild(child, true)} will throw an error if the\n * child component is already in the document, regardless of the parent's DOM\n * state.\n *\n * If `opt_render` is true and the parent component is not already\n * in the document, `enterDocument` will not be called on this component\n * at this point.\n *\n * Finally, this method also throws an error if the new child already has a\n * different parent, or the given index is out of bounds.\n *\n * @see goog.ui.Component#addChild\n * @param {goog.ui.Component} child The new child component.\n * @param {number} index 0-based index at which the new child component is to be\n *    added; must be between 0 and the current child count (inclusive).\n * @param {boolean=} opt_render If true, the child component will be rendered\n *    into the parent.\n * @return {void} Nada.\n */\ngoog.ui.Component.prototype.addChildAt = function(child, index, opt_render) {\n  goog.asserts.assert(!!child, 'Provided element must not be null.');\n\n  if (child.inDocument_ && (opt_render || !this.inDocument_)) {\n    // Adding a child that's already in the document is an error, except if the\n    // parent is also in the document and opt_render is false (e.g. decorate()).\n    throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n\n  if (index < 0 || index > this.getChildCount()) {\n    // Allowing sparse child arrays would lead to strange behavior, so we don't.\n    throw new Error(goog.ui.Component.Error.CHILD_INDEX_OUT_OF_BOUNDS);\n  }\n\n  // Create the index and the child array on first use.\n  if (!this.childIndex_ || !this.children_) {\n    this.childIndex_ = {};\n    this.children_ = [];\n  }\n\n  // Moving child within component, remove old reference.\n  if (child.getParent() == this) {\n    goog.object.set(this.childIndex_, child.getId(), child);\n    goog.array.remove(this.children_, child);\n\n    // Add the child to this component.  goog.object.add() throws an error if\n    // a child with the same ID already exists.\n  } else {\n    goog.object.add(this.childIndex_, child.getId(), child);\n  }\n\n  // Set the parent of the child to this component.  This throws an error if\n  // the child is already contained by another component.\n  child.setParent(this);\n  goog.array.insertAt(this.children_, child, index);\n\n  if (child.inDocument_ && this.inDocument_ && child.getParent() == this) {\n    // Changing the position of an existing child, move the DOM node (if\n    // necessary).\n    var contentElement = this.getContentElement();\n    var insertBeforeElement = contentElement.childNodes[index] || null;\n    if (insertBeforeElement != child.getElement()) {\n      contentElement.insertBefore(child.getElement(), insertBeforeElement);\n    }\n  } else if (opt_render) {\n    // If this (parent) component doesn't have a DOM yet, call createDom now\n    // to make sure we render the child component's element into the correct\n    // parent element (otherwise render_ with a null first argument would\n    // render the child into the document body, which is almost certainly not\n    // what we want).\n    if (!this.element_) {\n      this.createDom();\n    }\n    // Render the child into the parent at the appropriate location.  Note that\n    // getChildAt(index + 1) returns undefined if inserting at the end.\n    // TODO(attila): We should have a renderer with a renderChildAt API.\n    var sibling = this.getChildAt(index + 1);\n    // render_() calls enterDocument() if the parent is already in the document.\n    child.render_(this.getContentElement(), sibling ? sibling.element_ : null);\n  } else if (\n      this.inDocument_ && !child.inDocument_ && child.element_ &&\n      child.element_.parentNode &&\n      // Under some circumstances, IE8 implicitly creates a Document Fragment\n      // for detached nodes, so ensure the parent is an Element as it should be.\n      child.element_.parentNode.nodeType == goog.dom.NodeType.ELEMENT) {\n    // We don't touch the DOM, but if the parent is in the document, and the\n    // child element is in the document but not marked as such, then we call\n    // enterDocument on the child.\n    // TODO(gboyer): It would be nice to move this condition entirely, but\n    // there's a large risk of breaking existing applications that manually\n    // append the child to the DOM and then call addChild.\n    child.enterDocument();\n  }\n};\n\n\n/**\n * Returns the DOM element into which child components are to be rendered,\n * or null if the component itself hasn't been rendered yet.  This default\n * implementation returns the component's root element.  Subclasses with\n * complex DOM structures must override this method.\n * @return {Element} Element to contain child elements (null if none).\n */\ngoog.ui.Component.prototype.getContentElement = function() {\n  return this.element_;\n};\n\n\n/**\n * Returns true if the component is rendered right-to-left, false otherwise.\n * The first time this function is invoked, the right-to-left rendering property\n * is set if it has not been already.\n * @return {boolean} Whether the control is rendered right-to-left.\n */\ngoog.ui.Component.prototype.isRightToLeft = function() {\n  if (this.rightToLeft_ == null) {\n    this.rightToLeft_ = goog.style.isRightToLeft(\n        this.inDocument_ ? this.element_ : this.dom_.getDocument().body);\n  }\n  return this.rightToLeft_;\n};\n\n\n/**\n * Set is right-to-left. This function should be used if the component needs\n * to know the rendering direction during dom creation (i.e. before\n * {@link #enterDocument} is called and is right-to-left is set).\n * @param {boolean} rightToLeft Whether the component is rendered\n *     right-to-left.\n */\ngoog.ui.Component.prototype.setRightToLeft = function(rightToLeft) {\n  if (this.inDocument_) {\n    throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n  this.rightToLeft_ = rightToLeft;\n};\n\n\n/**\n * Returns true if the component has children.\n * @return {boolean} True if the component has children.\n */\ngoog.ui.Component.prototype.hasChildren = function() {\n  return !!this.children_ && this.children_.length != 0;\n};\n\n\n/**\n * Returns the number of children of this component.\n * @return {number} The number of children.\n */\ngoog.ui.Component.prototype.getChildCount = function() {\n  return this.children_ ? this.children_.length : 0;\n};\n\n\n/**\n * Returns an array containing the IDs of the children of this component, or an\n * empty array if the component has no children.\n * @return {!Array<string>} Child component IDs.\n */\ngoog.ui.Component.prototype.getChildIds = function() {\n  var ids = [];\n\n  // We don't use goog.object.getKeys(this.childIndex_) because we want to\n  // return the IDs in the correct order as determined by this.children_.\n  this.forEachChild(function(child) {\n    // addChild()/addChildAt() guarantee that the child array isn't sparse.\n    ids.push(child.getId());\n  });\n\n  return ids;\n};\n\n\n/**\n * Returns the child with the given ID, or null if no such child exists.\n * @param {string} id Child component ID.\n * @return {goog.ui.Component?} The child with the given ID; null if none.\n */\ngoog.ui.Component.prototype.getChild = function(id) {\n  // Use childIndex_ for O(1) access by ID.\n  return (this.childIndex_ && id) ?\n      /** @type {goog.ui.Component} */ (\n          goog.object.get(this.childIndex_, id)) ||\n          null :\n      null;\n};\n\n\n/**\n * Returns the child at the given index, or null if the index is out of bounds.\n * @param {number} index 0-based index.\n * @return {goog.ui.Component?} The child at the given index; null if none.\n */\ngoog.ui.Component.prototype.getChildAt = function(index) {\n  // Use children_ for access by index.\n  return this.children_ ? this.children_[index] || null : null;\n};\n\n\n/**\n * Calls the given function on each of this component's children in order.  If\n * `opt_obj` is provided, it will be used as the 'this' object in the\n * function when called.  The function should take two arguments:  the child\n * component and its 0-based index.  The return value is ignored.\n * @param {function(this:T,?,number):?} f The function to call for every\n * child component; should take 2 arguments (the child and its index).\n * @param {T=} opt_obj Used as the 'this' object in f when called.\n * @template T\n */\ngoog.ui.Component.prototype.forEachChild = function(f, opt_obj) {\n  if (this.children_) {\n    goog.array.forEach(this.children_, f, opt_obj);\n  }\n};\n\n\n/**\n * Returns the 0-based index of the given child component, or -1 if no such\n * child is found.\n * @param {goog.ui.Component?} child The child component.\n * @return {number} 0-based index of the child component; -1 if not found.\n */\ngoog.ui.Component.prototype.indexOfChild = function(child) {\n  return (this.children_ && child) ? goog.array.indexOf(this.children_, child) :\n                                     -1;\n};\n\n\n/**\n * Removes the given child from this component, and returns it.  Throws an error\n * if the argument is invalid or if the specified child isn't found in the\n * parent component.  The argument can either be a string (interpreted as the\n * ID of the child component to remove) or the child component itself.\n *\n * If `opt_unrender` is true, calls {@link goog.ui.component#exitDocument}\n * on the removed child, and subsequently detaches the child's DOM from the\n * document.  Otherwise it is the caller's responsibility to clean up the child\n * component's DOM.\n *\n * @see goog.ui.Component#removeChildAt\n * @param {string|goog.ui.Component|null} child The ID of the child to remove,\n *    or the child component itself.\n * @param {boolean=} opt_unrender If true, calls `exitDocument` on the\n *    removed child component, and detaches its DOM from the document.\n * @return {goog.ui.Component} The removed component, if any.\n */\ngoog.ui.Component.prototype.removeChild = function(child, opt_unrender) {\n  if (child) {\n    // Normalize child to be the object and id to be the ID string.  This also\n    // ensures that the child is really ours.\n    var id = goog.isString(child) ? child : child.getId();\n    child = this.getChild(id);\n\n    if (id && child) {\n      goog.object.remove(this.childIndex_, id);\n      goog.array.remove(this.children_, child);\n\n      if (opt_unrender) {\n        // Remove the child component's DOM from the document.  We have to call\n        // exitDocument first (see documentation).\n        child.exitDocument();\n        if (child.element_) {\n          goog.dom.removeNode(child.element_);\n        }\n      }\n\n      // Child's parent must be set to null after exitDocument is called\n      // so that the child can unlisten to its parent if required.\n      child.setParent(null);\n    }\n  }\n\n  if (!child) {\n    throw new Error(goog.ui.Component.Error.NOT_OUR_CHILD);\n  }\n\n  return /** @type {!goog.ui.Component} */ (child);\n};\n\n\n/**\n * Removes the child at the given index from this component, and returns it.\n * Throws an error if the argument is out of bounds, or if the specified child\n * isn't found in the parent.  See {@link goog.ui.Component#removeChild} for\n * detailed semantics.\n *\n * @see goog.ui.Component#removeChild\n * @param {number} index 0-based index of the child to remove.\n * @param {boolean=} opt_unrender If true, calls `exitDocument` on the\n *    removed child component, and detaches its DOM from the document.\n * @return {goog.ui.Component} The removed component, if any.\n */\ngoog.ui.Component.prototype.removeChildAt = function(index, opt_unrender) {\n  // removeChild(null) will throw error.\n  return this.removeChild(this.getChildAt(index), opt_unrender);\n};\n\n\n/**\n * Removes every child component attached to this one and returns them.\n *\n * @see goog.ui.Component#removeChild\n * @param {boolean=} opt_unrender If true, calls {@link #exitDocument} on the\n *    removed child components, and detaches their DOM from the document.\n * @return {!Array<goog.ui.Component>} The removed components if any.\n */\ngoog.ui.Component.prototype.removeChildren = function(opt_unrender) {\n  var removedChildren = [];\n  while (this.hasChildren()) {\n    removedChildren.push(this.removeChildAt(0, opt_unrender));\n  }\n  return removedChildren;\n};\n\n\n/**\n * Returns whether this component should listen for PointerEvent types rather\n * than MouseEvent types. This allows supporting drag gestures for touch/stylus\n * input.\n * @return {boolean}\n */\ngoog.ui.Component.prototype.pointerEventsEnabled = function() {\n  return this.pointerEventsEnabled_;\n};\n\n\n/**\n * Indicates whether this component should listen for PointerEvent types rather\n * than MouseEvent types. This allows supporting drag gestures for touch/stylus\n * input. Must be called before enterDocument to listen for the correct event\n * types.\n * @param {boolean} enable\n */\ngoog.ui.Component.prototype.setPointerEventsEnabled = function(enable) {\n  if (this.inDocument_) {\n    throw new Error(goog.ui.Component.Error.ALREADY_RENDERED);\n  }\n  this.pointerEventsEnabled_ = enable;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Implementation of a progress bar.\n *\n * @author arv@google.com (Erik Arvidsson)\n * @see ../demos/progressbar.html\n */\n\n\ngoog.provide('goog.ui.ProgressBar');\ngoog.provide('goog.ui.ProgressBar.Orientation');\n\ngoog.require('goog.a11y.aria');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.events');\ngoog.require('goog.events.EventType');\ngoog.require('goog.ui.Component');\ngoog.require('goog.ui.RangeModel');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * This creates a progress bar object.\n * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM helper.\n * @constructor\n * @extends {goog.ui.Component}\n */\ngoog.ui.ProgressBar = function(opt_domHelper) {\n  goog.ui.Component.call(this, opt_domHelper);\n\n  /** @type {?HTMLDivElement} */\n  this.thumbElement_;\n\n  /**\n   * The underlying data model for the progress bar.\n   * @type {goog.ui.RangeModel}\n   * @private\n   */\n  this.rangeModel_ = new goog.ui.RangeModel;\n  goog.events.listen(\n      this.rangeModel_, goog.ui.Component.EventType.CHANGE, this.handleChange_,\n      false, this);\n};\ngoog.inherits(goog.ui.ProgressBar, goog.ui.Component);\ngoog.tagUnsealableClass(goog.ui.ProgressBar);\n\n\n/**\n * Enum for representing the orientation of the progress bar.\n *\n * @enum {string}\n */\ngoog.ui.ProgressBar.Orientation = {\n  VERTICAL: 'vertical',\n  HORIZONTAL: 'horizontal'\n};\n\n\n/**\n * Map from progress bar orientation to CSS class names.\n * @type {!Object<string, string>}\n * @private\n */\ngoog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_ = {};\ngoog.ui.ProgressBar\n    .ORIENTATION_TO_CSS_NAME_[goog.ui.ProgressBar.Orientation.VERTICAL] =\n    goog.getCssName('progress-bar-vertical');\ngoog.ui.ProgressBar\n    .ORIENTATION_TO_CSS_NAME_[goog.ui.ProgressBar.Orientation.HORIZONTAL] =\n    goog.getCssName('progress-bar-horizontal');\n\n\n/**\n * Creates the DOM nodes needed for the progress bar\n * @override\n */\ngoog.ui.ProgressBar.prototype.createDom = function() {\n  this.thumbElement_ = this.createThumb_();\n  this.setElementInternal(this.getDomHelper().createDom(\n      goog.dom.TagName.DIV,\n      goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_[this.orientation_],\n      this.thumbElement_));\n  this.setValueState_();\n  this.setMinimumState_();\n  this.setMaximumState_();\n};\n\n\n/** @override */\ngoog.ui.ProgressBar.prototype.enterDocument = function() {\n  goog.ui.ProgressBar.superClass_.enterDocument.call(this);\n  this.attachEvents_();\n  this.updateUi_();\n\n  var element = this.getElement();\n  goog.asserts.assert(element, 'The progress bar DOM element cannot be null.');\n  // state live = polite will notify the user of updates,\n  // but will not interrupt ongoing feedback\n  goog.a11y.aria.setRole(element, 'progressbar');\n  goog.a11y.aria.setState(element, 'live', 'polite');\n};\n\n\n/** @override */\ngoog.ui.ProgressBar.prototype.exitDocument = function() {\n  goog.ui.ProgressBar.superClass_.exitDocument.call(this);\n  this.detachEvents_();\n};\n\n\n/**\n * This creates the thumb element.\n * @private\n * @return {HTMLDivElement} The created thumb element.\n */\ngoog.ui.ProgressBar.prototype.createThumb_ = function() {\n  return this.getDomHelper().createDom(\n      goog.dom.TagName.DIV, goog.getCssName('progress-bar-thumb'));\n};\n\n\n/**\n * Adds the initial event listeners to the element.\n * @private\n */\ngoog.ui.ProgressBar.prototype.attachEvents_ = function() {\n  if (goog.userAgent.IE && goog.userAgent.VERSION < 7) {\n    goog.events.listen(\n        this.getElement(), goog.events.EventType.RESIZE, this.updateUi_, false,\n        this);\n  }\n};\n\n\n/**\n * Removes the event listeners added by attachEvents_.\n * @private\n */\ngoog.ui.ProgressBar.prototype.detachEvents_ = function() {\n  if (goog.userAgent.IE && goog.userAgent.VERSION < 7) {\n    goog.events.unlisten(\n        this.getElement(), goog.events.EventType.RESIZE, this.updateUi_, false,\n        this);\n  }\n};\n\n\n/**\n * Decorates an existing HTML DIV element as a progress bar input. If the\n * element contains a child with a class name of 'progress-bar-thumb' that will\n * be used as the thumb.\n * @param {Element} element  The HTML element to decorate.\n * @override\n */\ngoog.ui.ProgressBar.prototype.decorateInternal = function(element) {\n  goog.ui.ProgressBar.superClass_.decorateInternal.call(this, element);\n  goog.dom.classlist.add(\n      goog.asserts.assert(this.getElement()),\n      goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_[this.orientation_]);\n\n  // find thumb\n  var thumb = goog.dom.getElementsByTagNameAndClass(\n      null, goog.getCssName('progress-bar-thumb'), this.getElement())[0];\n  if (!thumb) {\n    thumb = this.createThumb_();\n    this.getElement().appendChild(thumb);\n  }\n  this.thumbElement_ = /** @type {!HTMLDivElement} */ (thumb);\n};\n\n\n/**\n * @return {number} The value.\n */\ngoog.ui.ProgressBar.prototype.getValue = function() {\n  return this.rangeModel_.getValue();\n};\n\n\n/**\n * Sets the value\n * @param {number} v The value.\n */\ngoog.ui.ProgressBar.prototype.setValue = function(v) {\n  this.rangeModel_.setValue(v);\n  if (this.getElement()) {\n    this.setValueState_();\n  }\n};\n\n\n/**\n * Sets the state for a11y of the current value.\n * @private\n */\ngoog.ui.ProgressBar.prototype.setValueState_ = function() {\n  var element = this.getElement();\n  goog.asserts.assert(element, 'The progress bar DOM element cannot be null.');\n  goog.a11y.aria.setState(element, 'valuenow', this.getValue());\n};\n\n\n/**\n * @return {number} The minimum value.\n */\ngoog.ui.ProgressBar.prototype.getMinimum = function() {\n  return this.rangeModel_.getMinimum();\n};\n\n\n/**\n * Sets the minimum number\n * @param {number} v The minimum value.\n */\ngoog.ui.ProgressBar.prototype.setMinimum = function(v) {\n  this.rangeModel_.setMinimum(v);\n  if (this.getElement()) {\n    this.setMinimumState_();\n  }\n};\n\n\n/**\n * Sets the state for a11y of the minimum value.\n * @private\n */\ngoog.ui.ProgressBar.prototype.setMinimumState_ = function() {\n  var element = this.getElement();\n  goog.asserts.assert(element, 'The progress bar DOM element cannot be null.');\n  goog.a11y.aria.setState(element, 'valuemin', this.getMinimum());\n};\n\n\n/**\n * @return {number} The maximum value.\n */\ngoog.ui.ProgressBar.prototype.getMaximum = function() {\n  return this.rangeModel_.getMaximum();\n};\n\n\n/**\n * Sets the maximum number\n * @param {number} v The maximum value.\n */\ngoog.ui.ProgressBar.prototype.setMaximum = function(v) {\n  this.rangeModel_.setMaximum(v);\n  if (this.getElement()) {\n    this.setMaximumState_();\n  }\n};\n\n\n/**\n * Sets the state for a11y of the maximum valiue.\n * @private\n */\ngoog.ui.ProgressBar.prototype.setMaximumState_ = function() {\n  var element = this.getElement();\n  goog.asserts.assert(element, 'The progress bar DOM element cannot be null.');\n  goog.a11y.aria.setState(element, 'valuemax', this.getMaximum());\n};\n\n\n/**\n *\n * @type {goog.ui.ProgressBar.Orientation}\n * @private\n */\ngoog.ui.ProgressBar.prototype.orientation_ =\n    goog.ui.ProgressBar.Orientation.HORIZONTAL;\n\n\n/**\n * Call back when the internal range model changes\n * @param {goog.events.Event} e The event object.\n * @private\n */\ngoog.ui.ProgressBar.prototype.handleChange_ = function(e) {\n  this.updateUi_();\n  this.dispatchEvent(goog.ui.Component.EventType.CHANGE);\n};\n\n\n/**\n * This is called when we need to update the size of the thumb. This happens\n * when first created as well as when the value and the orientation changes.\n * @private\n */\ngoog.ui.ProgressBar.prototype.updateUi_ = function() {\n  if (this.thumbElement_) {\n    var min = this.getMinimum();\n    var max = this.getMaximum();\n    var val = this.getValue();\n    var ratio = (val - min) / (max - min);\n    var size = Math.round(ratio * 100);\n    if (this.orientation_ == goog.ui.ProgressBar.Orientation.VERTICAL) {\n      // Note(arv): IE up to version 6 has some serious computation bugs when\n      // using percentages or bottom. We therefore first set the height to\n      // 100% and measure that and base the top and height on that size instead.\n      if (goog.userAgent.IE && goog.userAgent.VERSION < 7) {\n        this.thumbElement_.style.top = '0';\n        this.thumbElement_.style.height = '100%';\n        var h = this.thumbElement_.offsetHeight;\n        var bottom = Math.round(ratio * h);\n        this.thumbElement_.style.top = h - bottom + 'px';\n        this.thumbElement_.style.height = bottom + 'px';\n      } else {\n        this.thumbElement_.style.top = (100 - size) + '%';\n        this.thumbElement_.style.height = size + '%';\n      }\n    } else {\n      this.thumbElement_.style.width = size + '%';\n    }\n  }\n};\n\n\n/**\n * This is called when we need to setup the UI sizes and positions. This\n * happens when we create the element and when we change the orientation.\n * @private\n */\ngoog.ui.ProgressBar.prototype.initializeUi_ = function() {\n  var tStyle = this.thumbElement_.style;\n  if (this.orientation_ == goog.ui.ProgressBar.Orientation.VERTICAL) {\n    tStyle.left = '0';\n    tStyle.width = '100%';\n  } else {\n    tStyle.top = tStyle.left = '0';\n    tStyle.height = '100%';\n  }\n};\n\n\n/**\n * Changes the orientation\n * @param {goog.ui.ProgressBar.Orientation} orient The orientation.\n */\ngoog.ui.ProgressBar.prototype.setOrientation = function(orient) {\n  if (this.orientation_ != orient) {\n    var oldCss =\n        goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_[this.orientation_];\n    var newCss = goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_[orient];\n    this.orientation_ = orient;\n\n    // Update the DOM\n    var element = this.getElement();\n    if (element) {\n      goog.dom.classlist.swap(element, oldCss, newCss);\n      this.initializeUi_();\n      this.updateUi_();\n    }\n  }\n};\n\n\n/**\n * @return {goog.ui.ProgressBar.Orientation} The orientation of the\n *     progress bar.\n */\ngoog.ui.ProgressBar.prototype.getOrientation = function() {\n  return this.orientation_;\n};\n\n\n/** @override */\ngoog.ui.ProgressBar.prototype.disposeInternal = function() {\n  this.detachEvents_();\n  goog.ui.ProgressBar.superClass_.disposeInternal.call(this);\n  this.thumbElement_ = null;\n  this.rangeModel_.dispose();\n};\n\n\n/**\n * @return {?number} The step value used to determine how to round the value.\n */\ngoog.ui.ProgressBar.prototype.getStep = function() {\n  return this.rangeModel_.getStep();\n};\n\n\n/**\n * Sets the step value. The step value is used to determine how to round the\n * value.\n * @param {?number} step  The step size.\n */\ngoog.ui.ProgressBar.prototype.setStep = function(step) {\n  this.rangeModel_.setStep(step);\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Implementation of a range model. This is an implementation of\n * the BoundedRangeModel as described by Java at\n * http://java.sun.com/javase/6/docs/api/javax/swing/BoundedRangeModel.html.\n *\n * One good way to understand the range model is to think of a scroll bar for\n * a scrollable element. In that case minimum is 0, maximum is scrollHeight,\n * value is scrollTop and extent is clientHeight.\n *\n * Based on http://webfx.eae.net/dhtml/slider/js/range.js\n *\n * @author arv@google.com (Erik Arvidsson)\n */\n\ngoog.provide('goog.ui.RangeModel');\n\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.ui.Component');\n\n\n\n/**\n * Creates a range model\n * @extends {goog.events.EventTarget}\n * @constructor\n */\ngoog.ui.RangeModel = function() {\n  goog.events.EventTarget.call(this);\n};\ngoog.inherits(goog.ui.RangeModel, goog.events.EventTarget);\ngoog.tagUnsealableClass(goog.ui.RangeModel);\n\n\n/**\n * @type {number}\n * @private\n */\ngoog.ui.RangeModel.prototype.value_ = 0;\n\n\n/**\n * @type {number}\n * @private\n */\ngoog.ui.RangeModel.prototype.minimum_ = 0;\n\n\n/**\n * @type {number}\n * @private\n */\ngoog.ui.RangeModel.prototype.maximum_ = 100;\n\n\n/**\n * @type {number}\n * @private\n */\ngoog.ui.RangeModel.prototype.extent_ = 0;\n\n\n/**\n * @type {?number}\n * @private\n */\ngoog.ui.RangeModel.prototype.step_ = 1;\n\n\n/**\n * This is true if something is changed as a side effect. This happens when for\n * example we set the maximum below the current value.\n * @type {boolean}\n * @private\n */\ngoog.ui.RangeModel.prototype.isChanging_ = false;\n\n\n/**\n * If set to true, we do not fire any change events.\n * @type {boolean}\n * @private\n */\ngoog.ui.RangeModel.prototype.mute_ = false;\n\n\n/**\n * Sets the model to mute / unmute.\n * @param {boolean} muteValue Whether or not to mute the range, i.e.,\n *     suppress any CHANGE events.\n */\ngoog.ui.RangeModel.prototype.setMute = function(muteValue) {\n  this.mute_ = muteValue;\n};\n\n\n/**\n * Sets the value.\n * @param {number} value The new value.\n */\ngoog.ui.RangeModel.prototype.setValue = function(value) {\n  value = this.roundToStepWithMin(value);\n  if (this.value_ != value) {\n    if (value + this.extent_ > this.maximum_) {\n      this.value_ = this.maximum_ - this.extent_;\n    } else if (value < this.minimum_) {\n      this.value_ = this.minimum_;\n    } else {\n      this.value_ = value;\n    }\n    if (!this.isChanging_ && !this.mute_) {\n      this.dispatchEvent(goog.ui.Component.EventType.CHANGE);\n    }\n  }\n};\n\n\n/**\n * @return {number} the current value.\n */\ngoog.ui.RangeModel.prototype.getValue = function() {\n  return this.roundToStepWithMin(this.value_);\n};\n\n\n/**\n * Sets the extent. The extent is the 'size' of the value.\n * @param {number} extent The new extent.\n */\ngoog.ui.RangeModel.prototype.setExtent = function(extent) {\n  extent = this.roundToStepWithMin(extent);\n  if (this.extent_ != extent) {\n    if (extent < 0) {\n      this.extent_ = 0;\n    } else if (this.value_ + extent > this.maximum_) {\n      this.extent_ = this.maximum_ - this.value_;\n    } else {\n      this.extent_ = extent;\n    }\n    if (!this.isChanging_ && !this.mute_) {\n      this.dispatchEvent(goog.ui.Component.EventType.CHANGE);\n    }\n  }\n};\n\n\n/**\n * @return {number} The extent for the range model.\n */\ngoog.ui.RangeModel.prototype.getExtent = function() {\n  return this.roundToStep(this.extent_);\n};\n\n\n/**\n * Sets the minimum\n * @param {number} minimum The new minimum.\n */\ngoog.ui.RangeModel.prototype.setMinimum = function(minimum) {\n  // Don't round minimum because it is the base\n  if (this.minimum_ != minimum) {\n    var oldIsChanging = this.isChanging_;\n    this.isChanging_ = true;\n\n    this.minimum_ = minimum;\n\n    if (minimum + this.extent_ > this.maximum_) {\n      this.extent_ = this.maximum_ - this.minimum_;\n    }\n    if (minimum > this.value_) {\n      this.setValue(minimum);\n    }\n    if (minimum > this.maximum_) {\n      this.extent_ = 0;\n      this.setMaximum(minimum);\n      this.setValue(minimum);\n    }\n\n\n    this.isChanging_ = oldIsChanging;\n    if (!this.isChanging_ && !this.mute_) {\n      this.dispatchEvent(goog.ui.Component.EventType.CHANGE);\n    }\n  }\n};\n\n\n/**\n * @return {number} The minimum value for the range model.\n */\ngoog.ui.RangeModel.prototype.getMinimum = function() {\n  return this.roundToStepWithMin(this.minimum_);\n};\n\n\n/**\n * Sets the maximum\n * @param {number} maximum The new maximum.\n */\ngoog.ui.RangeModel.prototype.setMaximum = function(maximum) {\n  maximum = this.roundToStepWithMin(maximum);\n  if (this.maximum_ != maximum) {\n    var oldIsChanging = this.isChanging_;\n    this.isChanging_ = true;\n\n    this.maximum_ = maximum;\n\n    if (maximum < this.value_ + this.extent_) {\n      this.setValue(maximum - this.extent_);\n    }\n    if (maximum < this.minimum_) {\n      this.extent_ = 0;\n      this.setMinimum(maximum);\n      this.setValue(this.maximum_);\n    }\n    if (maximum < this.minimum_ + this.extent_) {\n      this.extent_ = this.maximum_ - this.minimum_;\n    }\n\n    this.isChanging_ = oldIsChanging;\n    if (!this.isChanging_ && !this.mute_) {\n      this.dispatchEvent(goog.ui.Component.EventType.CHANGE);\n    }\n  }\n};\n\n\n/**\n * @return {number} The maximimum value for the range model.\n */\ngoog.ui.RangeModel.prototype.getMaximum = function() {\n  return this.roundToStepWithMin(this.maximum_);\n};\n\n\n/**\n * Returns the step value. The step value is used to determine how to round the\n * value.\n * @return {?number} The maximimum value for the range model.\n */\ngoog.ui.RangeModel.prototype.getStep = function() {\n  return this.step_;\n};\n\n\n/**\n * Sets the step. The step value is used to determine how to round the value.\n * @param {?number} step  The step size.\n */\ngoog.ui.RangeModel.prototype.setStep = function(step) {\n  if (this.step_ != step) {\n    this.step_ = step;\n\n    // adjust value, extent and maximum\n    var oldIsChanging = this.isChanging_;\n    this.isChanging_ = true;\n\n    this.setMaximum(this.getMaximum());\n    this.setExtent(this.getExtent());\n    this.setValue(this.getValue());\n\n    this.isChanging_ = oldIsChanging;\n    if (!this.isChanging_ && !this.mute_) {\n      this.dispatchEvent(goog.ui.Component.EventType.CHANGE);\n    }\n  }\n};\n\n\n/**\n * Rounds to the closest step using the minimum value as the base.\n * @param {number} value  The number to round.\n * @return {number} The number rounded to the closest step.\n */\ngoog.ui.RangeModel.prototype.roundToStepWithMin = function(value) {\n  if (this.step_ == null) return value;\n  return this.minimum_ +\n      Math.round((value - this.minimum_) / this.step_) * this.step_;\n};\n\n\n/**\n * Rounds to the closest step.\n * @param {number} value  The number to round.\n * @return {number} The number rounded to the closest step.\n */\ngoog.ui.RangeModel.prototype.roundToStep = function(value) {\n  if (this.step_ == null) return value;\n  return Math.round(value / this.step_) * this.step_;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Bootstrap for the Google JS Library (Closure).\n *\n * In uncompiled mode base.js will attempt to load Closure's deps file, unless\n * the global <code>CLOSURE_NO_DEPS</code> is set to true.  This allows projects\n * to include their own deps file(s) from different locations.\n *\n * Avoid including base.js more than once. This is strictly discouraged and not\n * supported. goog.require(...) won't work properly in that case.\n *\n * @provideGoog\n */\n\n\n/**\n * @define {boolean} Overridden to true by the compiler.\n */\nvar COMPILED = false;\n\n\n/**\n * Base namespace for the Closure library.  Checks to see goog is already\n * defined in the current scope before assigning to prevent clobbering if\n * base.js is loaded more than once.\n *\n * @const\n */\nvar goog = goog || {};\n\n/**\n * Reference to the global context.  In most cases this will be 'window'.\n * @const\n * @suppress {newCheckTypes}\n */\ngoog.global = this;\n\n\n/**\n * A hook for overriding the define values in uncompiled mode.\n *\n * In uncompiled mode, `CLOSURE_UNCOMPILED_DEFINES` may be defined before\n * loading base.js.  If a key is defined in `CLOSURE_UNCOMPILED_DEFINES`,\n * `goog.define` will use the value instead of the default value.  This\n * allows flags to be overwritten without compilation (this is normally\n * accomplished with the compiler's \"define\" flag).\n *\n * Example:\n * <pre>\n *   var CLOSURE_UNCOMPILED_DEFINES = {'goog.DEBUG': false};\n * </pre>\n *\n * @type {Object<string, (string|number|boolean)>|undefined}\n */\ngoog.global.CLOSURE_UNCOMPILED_DEFINES;\n\n\n/**\n * A hook for overriding the define values in uncompiled or compiled mode,\n * like CLOSURE_UNCOMPILED_DEFINES but effective in compiled code.  In\n * uncompiled code CLOSURE_UNCOMPILED_DEFINES takes precedence.\n *\n * Also unlike CLOSURE_UNCOMPILED_DEFINES the values must be number, boolean or\n * string literals or the compiler will emit an error.\n *\n * While any @define value may be set, only those set with goog.define will be\n * effective for uncompiled code.\n *\n * Example:\n * <pre>\n *   var CLOSURE_DEFINES = {'goog.DEBUG': false} ;\n * </pre>\n *\n * @type {Object<string, (string|number|boolean)>|undefined}\n */\ngoog.global.CLOSURE_DEFINES;\n\n\n/**\n * Returns true if the specified value is not undefined.\n *\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is defined.\n */\ngoog.isDef = function(val) {\n  // void 0 always evaluates to undefined and hence we do not need to depend on\n  // the definition of the global variable named 'undefined'.\n  return val !== void 0;\n};\n\n/**\n * Returns true if the specified value is a string.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is a string.\n */\ngoog.isString = function(val) {\n  return typeof val == 'string';\n};\n\n\n/**\n * Returns true if the specified value is a boolean.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is boolean.\n */\ngoog.isBoolean = function(val) {\n  return typeof val == 'boolean';\n};\n\n\n/**\n * Returns true if the specified value is a number.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is a number.\n */\ngoog.isNumber = function(val) {\n  return typeof val == 'number';\n};\n\n\n/**\n * Builds an object structure for the provided namespace path, ensuring that\n * names that already exist are not overwritten. For example:\n * \"a.b.c\" -> a = {};a.b={};a.b.c={};\n * Used by goog.provide and goog.exportSymbol.\n * @param {string} name name of the object that this file defines.\n * @param {*=} opt_object the object to expose at the end of the path.\n * @param {Object=} opt_objectToExportTo The object to add the path to; default\n *     is `goog.global`.\n * @private\n */\ngoog.exportPath_ = function(name, opt_object, opt_objectToExportTo) {\n  var parts = name.split('.');\n  var cur = opt_objectToExportTo || goog.global;\n\n  // Internet Explorer exhibits strange behavior when throwing errors from\n  // methods externed in this manner.  See the testExportSymbolExceptions in\n  // base_test.html for an example.\n  if (!(parts[0] in cur) && typeof cur.execScript != 'undefined') {\n    cur.execScript('var ' + parts[0]);\n  }\n\n  for (var part; parts.length && (part = parts.shift());) {\n    if (!parts.length && goog.isDef(opt_object)) {\n      // last part and we have an object; use it\n      cur[part] = opt_object;\n    } else if (cur[part] && cur[part] !== Object.prototype[part]) {\n      cur = cur[part];\n    } else {\n      cur = cur[part] = {};\n    }\n  }\n};\n\n\n/**\n * Defines a named value. In uncompiled mode, the value is retrieved from\n * CLOSURE_DEFINES or CLOSURE_UNCOMPILED_DEFINES if the object is defined and\n * has the property specified, and otherwise used the defined defaultValue.\n * When compiled the default can be overridden using the compiler\n * options or the value set in the CLOSURE_DEFINES object.\n *\n * @param {string} name The distinguished name to provide.\n * @param {string|number|boolean} defaultValue\n */\ngoog.define = function(name, defaultValue) {\n  var value = defaultValue;\n  if (!COMPILED) {\n    var uncompiledDefines = goog.global.CLOSURE_UNCOMPILED_DEFINES;\n    var defines = goog.global.CLOSURE_DEFINES;\n    if (uncompiledDefines &&\n        // Anti DOM-clobbering runtime check (b/37736576).\n        /** @type {?} */ (uncompiledDefines).nodeType === undefined &&\n        Object.prototype.hasOwnProperty.call(uncompiledDefines, name)) {\n      value = uncompiledDefines[name];\n    } else if (\n        defines &&\n        // Anti DOM-clobbering runtime check (b/37736576).\n        /** @type {?} */ (defines).nodeType === undefined &&\n        Object.prototype.hasOwnProperty.call(defines, name)) {\n      value = defines[name];\n    }\n  }\n  goog.exportPath_(name, value);\n};\n\n\n/**\n * @define {boolean} DEBUG is provided as a convenience so that debugging code\n * that should not be included in a production. It can be easily stripped\n * by specifying --define goog.DEBUG=false to the Closure Compiler aka\n * JSCompiler. For example, most toString() methods should be declared inside an\n * \"if (goog.DEBUG)\" conditional because they are generally used for debugging\n * purposes and it is difficult for the JSCompiler to statically determine\n * whether they are used.\n */\ngoog.define('goog.DEBUG', true);\n\n\n/**\n * @define {string} LOCALE defines the locale being used for compilation. It is\n * used to select locale specific data to be compiled in js binary. BUILD rule\n * can specify this value by \"--define goog.LOCALE=<locale_name>\" as a compiler\n * option.\n *\n * Take into account that the locale code format is important. You should use\n * the canonical Unicode format with hyphen as a delimiter. Language must be\n * lowercase, Language Script - Capitalized, Region - UPPERCASE.\n * There are few examples: pt-BR, en, en-US, sr-Latin-BO, zh-Hans-CN.\n *\n * See more info about locale codes here:\n * http://www.unicode.org/reports/tr35/#Unicode_Language_and_Locale_Identifiers\n *\n * For language codes you should use values defined by ISO 693-1. See it here\n * http://www.w3.org/WAI/ER/IG/ert/iso639.htm. There is only one exception from\n * this rule: the Hebrew language. For legacy reasons the old code (iw) should\n * be used instead of the new code (he).\n *\n */\ngoog.define('goog.LOCALE', 'en');  // default to en\n\n\n/**\n * @define {boolean} Whether this code is running on trusted sites.\n *\n * On untrusted sites, several native functions can be defined or overridden by\n * external libraries like Prototype, Datejs, and JQuery and setting this flag\n * to false forces closure to use its own implementations when possible.\n *\n * If your JavaScript can be loaded by a third party site and you are wary about\n * relying on non-standard implementations, specify\n * \"--define goog.TRUSTED_SITE=false\" to the compiler.\n */\ngoog.define('goog.TRUSTED_SITE', true);\n\n\n/**\n * @define {boolean} Whether a project is expected to be running in strict mode.\n *\n * This define can be used to trigger alternate implementations compatible with\n * running in EcmaScript Strict mode or warn about unavailable functionality.\n * @see https://goo.gl/PudQ4y\n *\n */\ngoog.define('goog.STRICT_MODE_COMPATIBLE', false);\n\n\n/**\n * @define {boolean} Whether code that calls {@link goog.setTestOnly} should\n *     be disallowed in the compilation unit.\n */\ngoog.define('goog.DISALLOW_TEST_ONLY_CODE', COMPILED && !goog.DEBUG);\n\n\n/**\n * @define {boolean} Whether to use a Chrome app CSP-compliant method for\n *     loading scripts via goog.require. @see appendScriptSrcNode_.\n */\ngoog.define('goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING', false);\n\n\n/**\n * Defines a namespace in Closure.\n *\n * A namespace may only be defined once in a codebase. It may be defined using\n * goog.provide() or goog.module().\n *\n * The presence of one or more goog.provide() calls in a file indicates\n * that the file defines the given objects/namespaces.\n * Provided symbols must not be null or undefined.\n *\n * In addition, goog.provide() creates the object stubs for a namespace\n * (for example, goog.provide(\"goog.foo.bar\") will create the object\n * goog.foo.bar if it does not already exist).\n *\n * Build tools also scan for provide/require/module statements\n * to discern dependencies, build dependency files (see deps.js), etc.\n *\n * @see goog.require\n * @see goog.module\n * @param {string} name Namespace provided by this file in the form\n *     \"goog.package.part\".\n */\ngoog.provide = function(name) {\n  if (goog.isInModuleLoader_()) {\n    throw new Error('goog.provide cannot be used within a module.');\n  }\n  if (!COMPILED) {\n    // Ensure that the same namespace isn't provided twice.\n    // A goog.module/goog.provide maps a goog.require to a specific file\n    if (goog.isProvided_(name)) {\n      throw new Error('Namespace \"' + name + '\" already declared.');\n    }\n  }\n\n  goog.constructNamespace_(name);\n};\n\n\n/**\n * @param {string} name Namespace provided by this file in the form\n *     \"goog.package.part\".\n * @param {Object=} opt_obj The object to embed in the namespace.\n * @private\n */\ngoog.constructNamespace_ = function(name, opt_obj) {\n  if (!COMPILED) {\n    delete goog.implicitNamespaces_[name];\n\n    var namespace = name;\n    while ((namespace = namespace.substring(0, namespace.lastIndexOf('.')))) {\n      if (goog.getObjectByName(namespace)) {\n        break;\n      }\n      goog.implicitNamespaces_[namespace] = true;\n    }\n  }\n\n  goog.exportPath_(name, opt_obj);\n};\n\n\n/**\n * Returns CSP nonce, if set for any script tag.\n * @return {string} CSP nonce or empty string if no nonce is present.\n */\ngoog.getScriptNonce = function() {\n  if (goog.cspNonce_ === null) {\n    goog.cspNonce_ = goog.getScriptNonce_(goog.global.document) || '';\n  }\n  return goog.cspNonce_;\n};\n\n\n/**\n * According to the CSP3 spec a nonce must be a valid base64 string.\n * @see https://www.w3.org/TR/CSP3/#grammardef-base64-value\n * @private @const\n */\ngoog.NONCE_PATTERN_ = /^[\\w+/_-]+[=]{0,2}$/;\n\n\n/**\n * @private {?string}\n */\ngoog.cspNonce_ = null;\n\n\n/**\n * Returns CSP nonce, if set for any script tag.\n * @param {!Document} doc\n * @return {?string} CSP nonce or null if no nonce is present.\n * @private\n */\ngoog.getScriptNonce_ = function(doc) {\n  var script = doc.querySelector && doc.querySelector('script[nonce]');\n  if (script) {\n    // Try to get the nonce from the IDL property first, because browsers that\n    // implement additional nonce protection features (currently only Chrome) to\n    // prevent nonce stealing via CSS do not expose the nonce via attributes.\n    // See https://github.com/whatwg/html/issues/2369\n    var nonce = script['nonce'] || script.getAttribute('nonce');\n    if (nonce && goog.NONCE_PATTERN_.test(nonce)) {\n      return nonce;\n    }\n  }\n  return null;\n};\n\n\n/**\n * Module identifier validation regexp.\n * Note: This is a conservative check, it is very possible to be more lenient,\n *   the primary exclusion here is \"/\" and \"\\\" and a leading \".\", these\n *   restrictions are intended to leave the door open for using goog.require\n *   with relative file paths rather than module identifiers.\n * @private\n */\ngoog.VALID_MODULE_RE_ = /^[a-zA-Z_$][a-zA-Z0-9._$]*$/;\n\n\n/**\n * Defines a module in Closure.\n *\n * Marks that this file must be loaded as a module and claims the namespace.\n *\n * A namespace may only be defined once in a codebase. It may be defined using\n * goog.provide() or goog.module().\n *\n * goog.module() has three requirements:\n * - goog.module may not be used in the same file as goog.provide.\n * - goog.module must be the first statement in the file.\n * - only one goog.module is allowed per file.\n *\n * When a goog.module annotated file is loaded, it is enclosed in\n * a strict function closure. This means that:\n * - any variables declared in a goog.module file are private to the file\n * (not global), though the compiler is expected to inline the module.\n * - The code must obey all the rules of \"strict\" JavaScript.\n * - the file will be marked as \"use strict\"\n *\n * NOTE: unlike goog.provide, goog.module does not declare any symbols by\n * itself. If declared symbols are desired, use\n * goog.module.declareLegacyNamespace().\n *\n *\n * See the public goog.module proposal: http://goo.gl/Va1hin\n *\n * @param {string} name Namespace provided by this file in the form\n *     \"goog.package.part\", is expected but not required.\n * @return {void}\n */\ngoog.module = function(name) {\n  if (!goog.isString(name) || !name ||\n      name.search(goog.VALID_MODULE_RE_) == -1) {\n    throw new Error('Invalid module identifier');\n  }\n  if (!goog.isInGoogModuleLoader_()) {\n    throw new Error(\n        'Module ' + name + ' has been loaded incorrectly. Note, ' +\n        'modules cannot be loaded as normal scripts. They require some kind of ' +\n        'pre-processing step. You\\'re likely trying to load a module via a ' +\n        'script tag or as a part of a concatenated bundle without rewriting the ' +\n        'module. For more info see: ' +\n        'https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.');\n  }\n  if (goog.moduleLoaderState_.moduleName) {\n    throw new Error('goog.module may only be called once per module.');\n  }\n\n  // Store the module name for the loader.\n  goog.moduleLoaderState_.moduleName = name;\n  if (!COMPILED) {\n    // Ensure that the same namespace isn't provided twice.\n    // A goog.module/goog.provide maps a goog.require to a specific file\n    if (goog.isProvided_(name)) {\n      throw new Error('Namespace \"' + name + '\" already declared.');\n    }\n    delete goog.implicitNamespaces_[name];\n  }\n};\n\n\n/**\n * @param {string} name The module identifier.\n * @return {?} The module exports for an already loaded module or null.\n *\n * Note: This is not an alternative to goog.require, it does not\n * indicate a hard dependency, instead it is used to indicate\n * an optional dependency or to access the exports of a module\n * that has already been loaded.\n * @suppress {missingProvide}\n */\ngoog.module.get = function(name) {\n\n  return goog.module.getInternal_(name);\n};\n\n\n/**\n * @param {string} name The module identifier.\n * @return {?} The module exports for an already loaded module or null.\n * @private\n */\ngoog.module.getInternal_ = function(name) {\n  if (!COMPILED) {\n    if (name in goog.loadedModules_) {\n      return goog.loadedModules_[name].exports;\n    } else if (!goog.implicitNamespaces_[name]) {\n      var ns = goog.getObjectByName(name);\n      return ns != null ? ns : null;\n    }\n  }\n  return null;\n};\n\n\n/**\n * Types of modules the debug loader can load.\n * @enum {string}\n */\ngoog.ModuleType = {\n  ES6: 'es6',\n  GOOG: 'goog'\n};\n\n\n/**\n * @private {?{\n *   moduleName: (string|undefined),\n *   declareLegacyNamespace:boolean,\n *   type: goog.ModuleType\n * }}\n */\ngoog.moduleLoaderState_ = null;\n\n\n/**\n * @private\n * @return {boolean} Whether a goog.module or an es6 module is currently being\n *     initialized.\n */\ngoog.isInModuleLoader_ = function() {\n  return goog.isInGoogModuleLoader_() || goog.isInEs6ModuleLoader_();\n};\n\n\n/**\n * @private\n * @return {boolean} Whether a goog.module is currently being initialized.\n */\ngoog.isInGoogModuleLoader_ = function() {\n  return !!goog.moduleLoaderState_ &&\n      goog.moduleLoaderState_.type == goog.ModuleType.GOOG;\n};\n\n\n/**\n * @private\n * @return {boolean} Whether an es6 module is currently being initialized.\n */\ngoog.isInEs6ModuleLoader_ = function() {\n  var inLoader = !!goog.moduleLoaderState_ &&\n      goog.moduleLoaderState_.type == goog.ModuleType.ES6;\n\n  if (inLoader) {\n    return true;\n  }\n\n  var jscomp = goog.global['$jscomp'];\n\n  if (jscomp) {\n    // jscomp may not have getCurrentModulePath if this is a compiled bundle\n    // that has some of the runtime, but not all of it. This can happen if\n    // optimizations are turned on so the unused runtime is removed but renaming\n    // and Closure pass are off (so $jscomp is still named $jscomp and the\n    // goog.provide/require calls still exist).\n    if (typeof jscomp.getCurrentModulePath != 'function') {\n      return false;\n    }\n\n    // Bundled ES6 module.\n    return !!jscomp.getCurrentModulePath();\n  }\n\n  return false;\n};\n\n\n/**\n * Provide the module's exports as a globally accessible object under the\n * module's declared name.  This is intended to ease migration to goog.module\n * for files that have existing usages.\n * @suppress {missingProvide}\n */\ngoog.module.declareLegacyNamespace = function() {\n  if (!COMPILED && !goog.isInGoogModuleLoader_()) {\n    throw new Error(\n        'goog.module.declareLegacyNamespace must be called from ' +\n        'within a goog.module');\n  }\n  if (!COMPILED && !goog.moduleLoaderState_.moduleName) {\n    throw new Error(\n        'goog.module must be called prior to ' +\n        'goog.module.declareLegacyNamespace.');\n  }\n  goog.moduleLoaderState_.declareLegacyNamespace = true;\n};\n\n\n/**\n * Associate an ES6 module with a Closure namespace so that is available via\n * goog.require. This associates a namespace that acts like a goog.module - it\n * does not create any global names, it is merely available via goog.require.\n * goog.require will return the entire module as if it was import *'d. This\n * allows Closure files to reference ES6 modules.\n *\n * @param {string} namespace\n * @suppress {missingProvide}\n */\ngoog.module.declareNamespace = function(namespace) {\n  if (!COMPILED) {\n    if (!goog.isInEs6ModuleLoader_()) {\n      throw new Error(\n          'goog.module.declareNamespace may only be called from ' +\n          'within an ES6 module');\n    }\n    if (goog.moduleLoaderState_ && goog.moduleLoaderState_.moduleName) {\n      throw new Error(\n          'goog.module.declareNamespace may only be called once per module.');\n    }\n    if (namespace in goog.loadedModules_) {\n      throw new Error(\n          'Module with namespace \"' + namespace + '\" already exists.');\n    }\n  }\n  if (goog.moduleLoaderState_) {\n    // Not bundled - debug loading.\n    goog.moduleLoaderState_.moduleName = namespace;\n  } else {\n    // Bundled - not debug loading, no module loader state.\n    var jscomp = goog.global['$jscomp'];\n    if (!jscomp || typeof jscomp.getCurrentModulePath != 'function') {\n      throw new Error(\n          'Module with namespace \"' + namespace +\n          '\" has been loaded incorrectly.');\n    }\n    var exports = jscomp.require(jscomp.getCurrentModulePath());\n    goog.loadedModules_[namespace] = {\n      exports: exports,\n      type: goog.ModuleType.ES6,\n      moduleId: namespace\n    };\n  }\n};\n\n\n/**\n * Marks that the current file should only be used for testing, and never for\n * live code in production.\n *\n * In the case of unit tests, the message may optionally be an exact namespace\n * for the test (e.g. 'goog.stringTest'). The linter will then ignore the extra\n * provide (if not explicitly defined in the code).\n *\n * @param {string=} opt_message Optional message to add to the error that's\n *     raised when used in production code.\n */\ngoog.setTestOnly = function(opt_message) {\n  if (goog.DISALLOW_TEST_ONLY_CODE) {\n    opt_message = opt_message || '';\n    throw new Error(\n        'Importing test-only code into non-debug environment' +\n        (opt_message ? ': ' + opt_message : '.'));\n  }\n};\n\n\n/**\n * Forward declares a symbol. This is an indication to the compiler that the\n * symbol may be used in the source yet is not required and may not be provided\n * in compilation.\n *\n * The most common usage of forward declaration is code that takes a type as a\n * function parameter but does not need to require it. By forward declaring\n * instead of requiring, no hard dependency is made, and (if not required\n * elsewhere) the namespace may never be required and thus, not be pulled\n * into the JavaScript binary. If it is required elsewhere, it will be type\n * checked as normal.\n *\n * Before using goog.forwardDeclare, please read the documentation at\n * https://github.com/google/closure-compiler/wiki/Bad-Type-Annotation to\n * understand the options and tradeoffs when working with forward declarations.\n *\n * @param {string} name The namespace to forward declare in the form of\n *     \"goog.package.part\".\n */\ngoog.forwardDeclare = function(name) {};\n\n\n/**\n * Forward declare type information. Used to assign types to goog.global\n * referenced object that would otherwise result in unknown type references\n * and thus block property disambiguation.\n */\ngoog.forwardDeclare('Document');\ngoog.forwardDeclare('HTMLScriptElement');\ngoog.forwardDeclare('XMLHttpRequest');\n\n\nif (!COMPILED) {\n  /**\n   * Check if the given name has been goog.provided. This will return false for\n   * names that are available only as implicit namespaces.\n   * @param {string} name name of the object to look for.\n   * @return {boolean} Whether the name has been provided.\n   * @private\n   */\n  goog.isProvided_ = function(name) {\n    return (name in goog.loadedModules_) ||\n        (!goog.implicitNamespaces_[name] &&\n         goog.isDefAndNotNull(goog.getObjectByName(name)));\n  };\n\n  /**\n   * Namespaces implicitly defined by goog.provide. For example,\n   * goog.provide('goog.events.Event') implicitly declares that 'goog' and\n   * 'goog.events' must be namespaces.\n   *\n   * @type {!Object<string, (boolean|undefined)>}\n   * @private\n   */\n  goog.implicitNamespaces_ = {'goog.module': true};\n\n  // NOTE: We add goog.module as an implicit namespace as goog.module is defined\n  // here and because the existing module package has not been moved yet out of\n  // the goog.module namespace. This satisifies both the debug loader and\n  // ahead-of-time dependency management.\n}\n\n\n/**\n * Returns an object based on its fully qualified external name.  The object\n * is not found if null or undefined.  If you are using a compilation pass that\n * renames property names beware that using this function will not find renamed\n * properties.\n *\n * @param {string} name The fully qualified name.\n * @param {Object=} opt_obj The object within which to look; default is\n *     |goog.global|.\n * @return {?} The value (object or primitive) or, if not found, null.\n */\ngoog.getObjectByName = function(name, opt_obj) {\n  var parts = name.split('.');\n  var cur = opt_obj || goog.global;\n  for (var i = 0; i < parts.length; i++) {\n    cur = cur[parts[i]];\n    if (!goog.isDefAndNotNull(cur)) {\n      return null;\n    }\n  }\n  return cur;\n};\n\n\n/**\n * Globalizes a whole namespace, such as goog or goog.lang.\n *\n * @param {!Object} obj The namespace to globalize.\n * @param {Object=} opt_global The object to add the properties to.\n * @deprecated Properties may be explicitly exported to the global scope, but\n *     this should no longer be done in bulk.\n */\ngoog.globalize = function(obj, opt_global) {\n  var global = opt_global || goog.global;\n  for (var x in obj) {\n    global[x] = obj[x];\n  }\n};\n\n\n/**\n * Adds a dependency from a file to the files it requires.\n * @param {string} relPath The path to the js file.\n * @param {!Array<string>} provides An array of strings with\n *     the names of the objects this file provides.\n * @param {!Array<string>} requires An array of strings with\n *     the names of the objects this file requires.\n * @param {boolean|!Object<string>=} opt_loadFlags Parameters indicating\n *     how the file must be loaded.  The boolean 'true' is equivalent\n *     to {'module': 'goog'} for backwards-compatibility.  Valid properties\n *     and values include {'module': 'goog'} and {'lang': 'es6'}.\n */\ngoog.addDependency = function(relPath, provides, requires, opt_loadFlags) {\n  if (!COMPILED && goog.DEPENDENCIES_ENABLED) {\n    goog.debugLoader_.addDependency(relPath, provides, requires, opt_loadFlags);\n  }\n};\n\n\n\n\n// NOTE(nnaze): The debug DOM loader was included in base.js as an original way\n// to do \"debug-mode\" development.  The dependency system can sometimes be\n// confusing, as can the debug DOM loader's asynchronous nature.\n//\n// With the DOM loader, a call to goog.require() is not blocking -- the script\n// will not load until some point after the current script.  If a namespace is\n// needed at runtime, it needs to be defined in a previous script, or loaded via\n// require() with its registered dependencies.\n//\n// User-defined namespaces may need their own deps file. For a reference on\n// creating a deps file, see:\n// Externally: https://developers.google.com/closure/library/docs/depswriter\n//\n// Because of legacy clients, the DOM loader can't be easily removed from\n// base.js.  Work was done to make it disableable or replaceable for\n// different environments (DOM-less JavaScript interpreters like Rhino or V8,\n// for example). See bootstrap/ for more information.\n\n\n/**\n * @define {boolean} Whether to enable the debug loader.\n *\n * If enabled, a call to goog.require() will attempt to load the namespace by\n * appending a script tag to the DOM (if the namespace has been registered).\n *\n * If disabled, goog.require() will simply assert that the namespace has been\n * provided (and depend on the fact that some outside tool correctly ordered\n * the script).\n */\ngoog.define('goog.ENABLE_DEBUG_LOADER', true);\n\n\n/**\n * @param {string} msg\n * @private\n */\ngoog.logToConsole_ = function(msg) {\n  if (goog.global.console) {\n    goog.global.console['error'](msg);\n  }\n};\n\n\n/**\n * Implements a system for the dynamic resolution of dependencies that works in\n * parallel with the BUILD system. Note that all calls to goog.require will be\n * stripped by the compiler.\n * @see goog.provide\n * @param {string} namespace Namespace (as was given in goog.provide,\n *     goog.module, or goog.module.declareNamespace) in the form\n * \"goog.package.part\".\n * @return {?} If called within a goog.module or ES6 module file, the associated\n *     namespace or module otherwise null.\n */\ngoog.require = function(namespace) {\n  if (!COMPILED) {\n    // Might need to lazy load on old IE.\n    if (goog.ENABLE_DEBUG_LOADER) {\n      goog.debugLoader_.requested(namespace);\n    }\n\n    // If the object already exists we do not need to do anything.\n    if (goog.isProvided_(namespace)) {\n      if (goog.isInModuleLoader_()) {\n        return goog.module.getInternal_(namespace);\n      }\n    } else if (goog.ENABLE_DEBUG_LOADER) {\n      var moduleLoaderState = goog.moduleLoaderState_;\n      goog.moduleLoaderState_ = null;\n      try {\n        goog.debugLoader_.load_(namespace);\n      } finally {\n        goog.moduleLoaderState_ = moduleLoaderState;\n      }\n    }\n\n    return null;\n  }\n};\n\n\n/**\n * Path for included scripts.\n * @type {string}\n */\ngoog.basePath = '';\n\n\n/**\n * A hook for overriding the base path.\n * @type {string|undefined}\n */\ngoog.global.CLOSURE_BASE_PATH;\n\n\n/**\n * Whether to attempt to load Closure's deps file. By default, when uncompiled,\n * deps files will attempt to be loaded.\n * @type {boolean|undefined}\n */\ngoog.global.CLOSURE_NO_DEPS;\n\n\n/**\n * A function to import a single script. This is meant to be overridden when\n * Closure is being run in non-HTML contexts, such as web workers. It's defined\n * in the global scope so that it can be set before base.js is loaded, which\n * allows deps.js to be imported properly.\n *\n * The first parameter the script source, which is a relative URI. The second,\n * optional parameter is the script contents, in the event the script needed\n * transformation. It should return true if the script was imported, false\n * otherwise.\n * @type {(function(string, string=): boolean)|undefined}\n */\ngoog.global.CLOSURE_IMPORT_SCRIPT;\n\n\n/**\n * Null function used for default values of callbacks, etc.\n * @return {void} Nothing.\n */\ngoog.nullFunction = function() {};\n\n\n/**\n * When defining a class Foo with an abstract method bar(), you can do:\n * Foo.prototype.bar = goog.abstractMethod\n *\n * Now if a subclass of Foo fails to override bar(), an error will be thrown\n * when bar() is invoked.\n *\n * @type {!Function}\n * @throws {Error} when invoked to indicate the method should be overridden.\n */\ngoog.abstractMethod = function() {\n  throw new Error('unimplemented abstract method');\n};\n\n\n/**\n * Adds a `getInstance` static method that always returns the same\n * instance object.\n * @param {!Function} ctor The constructor for the class to add the static\n *     method to.\n * @suppress {missingProperties} 'instance_' isn't a property on 'Function'\n *     but we don't have a better type to use here.\n */\ngoog.addSingletonGetter = function(ctor) {\n  // instance_ is immediately set to prevent issues with sealed constructors\n  // such as are encountered when a constructor is returned as the export object\n  // of a goog.module in unoptimized code.\n  ctor.instance_ = undefined;\n  ctor.getInstance = function() {\n    if (ctor.instance_) {\n      return ctor.instance_;\n    }\n    if (goog.DEBUG) {\n      // NOTE: JSCompiler can't optimize away Array#push.\n      goog.instantiatedSingletons_[goog.instantiatedSingletons_.length] = ctor;\n    }\n    return ctor.instance_ = new ctor;\n  };\n};\n\n\n/**\n * All singleton classes that have been instantiated, for testing. Don't read\n * it directly, use the `goog.testing.singleton` module. The compiler\n * removes this variable if unused.\n * @type {!Array<!Function>}\n * @private\n */\ngoog.instantiatedSingletons_ = [];\n\n\n/**\n * @define {boolean} Whether to load goog.modules using `eval` when using\n * the debug loader.  This provides a better debugging experience as the\n * source is unmodified and can be edited using Chrome Workspaces or similar.\n * However in some environments the use of `eval` is banned\n * so we provide an alternative.\n */\ngoog.define('goog.LOAD_MODULE_USING_EVAL', true);\n\n\n/**\n * @define {boolean} Whether the exports of goog.modules should be sealed when\n * possible.\n */\ngoog.define('goog.SEAL_MODULE_EXPORTS', goog.DEBUG);\n\n\n/**\n * The registry of initialized modules:\n * The module identifier or path to module exports map.\n * @private @const {!Object<string, {exports:?,type:string,moduleId:string}>}\n */\ngoog.loadedModules_ = {};\n\n\n/**\n * True if the debug loader enabled and used.\n * @const {boolean}\n */\ngoog.DEPENDENCIES_ENABLED = !COMPILED && goog.ENABLE_DEBUG_LOADER;\n\n\n/**\n * @define {string} How to decide whether to transpile.  Valid values\n * are 'always', 'never', and 'detect'.  The default ('detect') is to\n * use feature detection to determine which language levels need\n * transpilation.\n */\n// NOTE(sdh): we could expand this to accept a language level to bypass\n// detection: e.g. goog.TRANSPILE == 'es5' would transpile ES6 files but\n// would leave ES3 and ES5 files alone.\ngoog.define('goog.TRANSPILE', 'detect');\n\n\n/**\n * @define {string} If a file needs to be transpiled what the output language\n * should be. By default this is the highest language level this file detects\n * the current environment supports. Generally this flag should not be set, but\n * it could be useful to override. Example: If the current environment supports\n * ES6 then by default ES7+ files will be transpiled to ES6, unless this is\n * overridden.\n *\n * Valid values include: es3, es5, es6, es7, and es8. Anything not recognized\n * is treated as es3.\n *\n * Note that setting this value does not force transpilation. Just if\n * transpilation occurs this will be the output. So this is most useful when\n * goog.TRANSPILE is set to 'always' and then forcing the language level to be\n * something lower than what the environment detects.\n */\ngoog.define('goog.TRANSPILE_TO_LANGUAGE', '');\n\n\n/**\n * @define {string} Path to the transpiler.  Executing the script at this\n * path (relative to base.js) should define a function $jscomp.transpile.\n */\ngoog.define('goog.TRANSPILER', 'transpile.js');\n\n\n/**\n * @package {?boolean}\n * Visible for testing.\n */\ngoog.hasBadLetScoping = null;\n\n\n/**\n * @return {boolean}\n * @package Visible for testing.\n */\ngoog.useSafari10Workaround = function() {\n  if (goog.hasBadLetScoping == null) {\n    var hasBadLetScoping;\n    try {\n      hasBadLetScoping = !eval(\n          '\"use strict\";' +\n          'let x = 1; function f() { return typeof x; };' +\n          'f() == \"number\";');\n    } catch (e) {\n      // Assume that ES6 syntax isn't supported.\n      hasBadLetScoping = false;\n    }\n    goog.hasBadLetScoping = hasBadLetScoping;\n  }\n  return goog.hasBadLetScoping;\n};\n\n\n/**\n * @param {string} moduleDef\n * @return {string}\n * @package Visible for testing.\n */\ngoog.workaroundSafari10EvalBug = function(moduleDef) {\n  return '(function(){' + moduleDef +\n      '\\n' +  // Terminate any trailing single line comment.\n      ';' +   // Terminate any trailing expression.\n      '})();\\n';\n};\n\n\n/**\n * @param {function(?):?|string} moduleDef The module definition.\n */\ngoog.loadModule = function(moduleDef) {\n  // NOTE: we allow function definitions to be either in the from\n  // of a string to eval (which keeps the original source intact) or\n  // in a eval forbidden environment (CSP) we allow a function definition\n  // which in its body must call `goog.module`, and return the exports\n  // of the module.\n  var previousState = goog.moduleLoaderState_;\n  try {\n    goog.moduleLoaderState_ = {\n      moduleName: '',\n      declareLegacyNamespace: false,\n      type: goog.ModuleType.GOOG\n    };\n    var exports;\n    if (goog.isFunction(moduleDef)) {\n      exports = moduleDef.call(undefined, {});\n    } else if (goog.isString(moduleDef)) {\n      if (goog.useSafari10Workaround()) {\n        moduleDef = goog.workaroundSafari10EvalBug(moduleDef);\n      }\n\n      exports = goog.loadModuleFromSource_.call(undefined, moduleDef);\n    } else {\n      throw new Error('Invalid module definition');\n    }\n\n    var moduleName = goog.moduleLoaderState_.moduleName;\n    if (goog.isString(moduleName) && moduleName) {\n      // Don't seal legacy namespaces as they may be used as a parent of\n      // another namespace\n      if (goog.moduleLoaderState_.declareLegacyNamespace) {\n        goog.constructNamespace_(moduleName, exports);\n      } else if (\n          goog.SEAL_MODULE_EXPORTS && Object.seal &&\n          typeof exports == 'object' && exports != null) {\n        Object.seal(exports);\n      }\n\n      var data = {\n        exports: exports,\n        type: goog.ModuleType.GOOG,\n        moduleId: goog.moduleLoaderState_.moduleName\n      };\n      goog.loadedModules_[moduleName] = data;\n    } else {\n      throw new Error('Invalid module name \\\"' + moduleName + '\\\"');\n    }\n  } finally {\n    goog.moduleLoaderState_ = previousState;\n  }\n};\n\n\n/**\n * @private @const\n */\ngoog.loadModuleFromSource_ = /** @type {function(string):?} */ (function() {\n  // NOTE: we avoid declaring parameters or local variables here to avoid\n  // masking globals or leaking values into the module definition.\n  'use strict';\n  var exports = {};\n  eval(arguments[0]);\n  return exports;\n});\n\n\n/**\n * Normalize a file path by removing redundant \"..\" and extraneous \".\" file\n * path components.\n * @param {string} path\n * @return {string}\n * @private\n */\ngoog.normalizePath_ = function(path) {\n  var components = path.split('/');\n  var i = 0;\n  while (i < components.length) {\n    if (components[i] == '.') {\n      components.splice(i, 1);\n    } else if (\n        i && components[i] == '..' && components[i - 1] &&\n        components[i - 1] != '..') {\n      components.splice(--i, 2);\n    } else {\n      i++;\n    }\n  }\n  return components.join('/');\n};\n\n\n/**\n * Provides a hook for loading a file when using Closure's goog.require() API\n * with goog.modules.  In particular this hook is provided to support Node.js.\n *\n * @type {(function(string):string)|undefined}\n */\ngoog.global.CLOSURE_LOAD_FILE_SYNC;\n\n\n/**\n * Loads file by synchronous XHR. Should not be used in production environments.\n * @param {string} src Source URL.\n * @return {?string} File contents, or null if load failed.\n * @private\n */\ngoog.loadFileSync_ = function(src) {\n  if (goog.global.CLOSURE_LOAD_FILE_SYNC) {\n    return goog.global.CLOSURE_LOAD_FILE_SYNC(src);\n  } else {\n    try {\n      /** @type {XMLHttpRequest} */\n      var xhr = new goog.global['XMLHttpRequest']();\n      xhr.open('get', src, false);\n      xhr.send();\n      // NOTE: Successful http: requests have a status of 200, but successful\n      // file: requests may have a status of zero.  Any other status, or a\n      // thrown exception (particularly in case of file: requests) indicates\n      // some sort of error, which we treat as a missing or unavailable file.\n      return xhr.status == 0 || xhr.status == 200 ? xhr.responseText : null;\n    } catch (err) {\n      // No need to rethrow or log, since errors should show up on their own.\n      return null;\n    }\n  }\n};\n\n\n/**\n * Lazily retrieves the transpiler and applies it to the source.\n * @param {string} code JS code.\n * @param {string} path Path to the code.\n * @param {string} target Language level output.\n * @return {string} The transpiled code.\n * @private\n */\ngoog.transpile_ = function(code, path, target) {\n  var jscomp = goog.global['$jscomp'];\n  if (!jscomp) {\n    goog.global['$jscomp'] = jscomp = {};\n  }\n  var transpile = jscomp.transpile;\n  if (!transpile) {\n    var transpilerPath = goog.basePath + goog.TRANSPILER;\n    var transpilerCode = goog.loadFileSync_(transpilerPath);\n    if (transpilerCode) {\n      // This must be executed synchronously, since by the time we know we\n      // need it, we're about to load and write the ES6 code synchronously,\n      // so a normal script-tag load will be too slow. Wrapped in a function\n      // so that code is eval'd in the global scope.\n      (function() {\n        eval(transpilerCode + '\\n//# sourceURL=' + transpilerPath);\n      }).call(goog.global);\n      // Even though the transpiler is optional, if $gwtExport is found, it's\n      // a sign the transpiler was loaded and the $jscomp.transpile *should*\n      // be there.\n      if (goog.global['$gwtExport'] && goog.global['$gwtExport']['$jscomp'] &&\n          !goog.global['$gwtExport']['$jscomp']['transpile']) {\n        throw new Error(\n            'The transpiler did not properly export the \"transpile\" ' +\n            'method. $gwtExport: ' + JSON.stringify(goog.global['$gwtExport']));\n      }\n      // transpile.js only exports a single $jscomp function, transpile. We\n      // grab just that and add it to the existing definition of $jscomp which\n      // contains the polyfills.\n      goog.global['$jscomp'].transpile =\n          goog.global['$gwtExport']['$jscomp']['transpile'];\n      jscomp = goog.global['$jscomp'];\n      transpile = jscomp.transpile;\n    }\n  }\n  if (!transpile) {\n    // The transpiler is an optional component.  If it's not available then\n    // replace it with a pass-through function that simply logs.\n    var suffix = ' requires transpilation but no transpiler was found.';\n    transpile = jscomp.transpile = function(code, path) {\n      // TODO(sdh): figure out some way to get this error to show up\n      // in test results, noting that the failure may occur in many\n      // different ways, including in loadModule() before the test\n      // runner even comes up.\n      goog.logToConsole_(path + suffix);\n      return code;\n    };\n  }\n  // Note: any transpilation errors/warnings will be logged to the console.\n  return transpile(code, path, target);\n};\n\n//==============================================================================\n// Language Enhancements\n//==============================================================================\n\n\n/**\n * This is a \"fixed\" version of the typeof operator.  It differs from the typeof\n * operator in such a way that null returns 'null' and arrays return 'array'.\n * @param {?} value The value to get the type of.\n * @return {string} The name of the type.\n */\ngoog.typeOf = function(value) {\n  var s = typeof value;\n  if (s == 'object') {\n    if (value) {\n      // Check these first, so we can avoid calling Object.prototype.toString if\n      // possible.\n      //\n      // IE improperly marshals typeof across execution contexts, but a\n      // cross-context object will still return false for \"instanceof Object\".\n      if (value instanceof Array) {\n        return 'array';\n      } else if (value instanceof Object) {\n        return s;\n      }\n\n      // HACK: In order to use an Object prototype method on the arbitrary\n      //   value, the compiler requires the value be cast to type Object,\n      //   even though the ECMA spec explicitly allows it.\n      var className = Object.prototype.toString.call(\n          /** @type {!Object} */ (value));\n      // In Firefox 3.6, attempting to access iframe window objects' length\n      // property throws an NS_ERROR_FAILURE, so we need to special-case it\n      // here.\n      if (className == '[object Window]') {\n        return 'object';\n      }\n\n      // We cannot always use constructor == Array or instanceof Array because\n      // different frames have different Array objects. In IE6, if the iframe\n      // where the array was created is destroyed, the array loses its\n      // prototype. Then dereferencing val.splice here throws an exception, so\n      // we can't use goog.isFunction. Calling typeof directly returns 'unknown'\n      // so that will work. In this case, this function will return false and\n      // most array functions will still work because the array is still\n      // array-like (supports length and []) even though it has lost its\n      // prototype.\n      // Mark Miller noticed that Object.prototype.toString\n      // allows access to the unforgeable [[Class]] property.\n      //  15.2.4.2 Object.prototype.toString ( )\n      //  When the toString method is called, the following steps are taken:\n      //      1. Get the [[Class]] property of this object.\n      //      2. Compute a string value by concatenating the three strings\n      //         \"[object \", Result(1), and \"]\".\n      //      3. Return Result(2).\n      // and this behavior survives the destruction of the execution context.\n      if ((className == '[object Array]' ||\n           // In IE all non value types are wrapped as objects across window\n           // boundaries (not iframe though) so we have to do object detection\n           // for this edge case.\n           typeof value.length == 'number' &&\n               typeof value.splice != 'undefined' &&\n               typeof value.propertyIsEnumerable != 'undefined' &&\n               !value.propertyIsEnumerable('splice')\n\n               )) {\n        return 'array';\n      }\n      // HACK: There is still an array case that fails.\n      //     function ArrayImpostor() {}\n      //     ArrayImpostor.prototype = [];\n      //     var impostor = new ArrayImpostor;\n      // this can be fixed by getting rid of the fast path\n      // (value instanceof Array) and solely relying on\n      // (value && Object.prototype.toString.vall(value) === '[object Array]')\n      // but that would require many more function calls and is not warranted\n      // unless closure code is receiving objects from untrusted sources.\n\n      // IE in cross-window calls does not correctly marshal the function type\n      // (it appears just as an object) so we cannot use just typeof val ==\n      // 'function'. However, if the object has a call property, it is a\n      // function.\n      if ((className == '[object Function]' ||\n           typeof value.call != 'undefined' &&\n               typeof value.propertyIsEnumerable != 'undefined' &&\n               !value.propertyIsEnumerable('call'))) {\n        return 'function';\n      }\n\n    } else {\n      return 'null';\n    }\n\n  } else if (s == 'function' && typeof value.call == 'undefined') {\n    // In Safari typeof nodeList returns 'function', and on Firefox typeof\n    // behaves similarly for HTML{Applet,Embed,Object}, Elements and RegExps. We\n    // would like to return object for those and we can detect an invalid\n    // function by making sure that the function object has a call method.\n    return 'object';\n  }\n  return s;\n};\n\n\n/**\n * Returns true if the specified value is null.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is null.\n */\ngoog.isNull = function(val) {\n  return val === null;\n};\n\n\n/**\n * Returns true if the specified value is defined and not null.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is defined and not null.\n */\ngoog.isDefAndNotNull = function(val) {\n  // Note that undefined == null.\n  return val != null;\n};\n\n\n/**\n * Returns true if the specified value is an array.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is an array.\n */\ngoog.isArray = function(val) {\n  return goog.typeOf(val) == 'array';\n};\n\n\n/**\n * Returns true if the object looks like an array. To qualify as array like\n * the value needs to be either a NodeList or an object with a Number length\n * property. Note that for this function neither strings nor functions are\n * considered \"array-like\".\n *\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is an array.\n */\ngoog.isArrayLike = function(val) {\n  var type = goog.typeOf(val);\n  // We do not use goog.isObject here in order to exclude function values.\n  return type == 'array' || type == 'object' && typeof val.length == 'number';\n};\n\n\n/**\n * Returns true if the object looks like a Date. To qualify as Date-like the\n * value needs to be an object and have a getFullYear() function.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is a like a Date.\n */\ngoog.isDateLike = function(val) {\n  return goog.isObject(val) && typeof val.getFullYear == 'function';\n};\n\n\n/**\n * Returns true if the specified value is a function.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is a function.\n */\ngoog.isFunction = function(val) {\n  return goog.typeOf(val) == 'function';\n};\n\n\n/**\n * Returns true if the specified value is an object.  This includes arrays and\n * functions.\n * @param {?} val Variable to test.\n * @return {boolean} Whether variable is an object.\n */\ngoog.isObject = function(val) {\n  var type = typeof val;\n  return type == 'object' && val != null || type == 'function';\n  // return Object(val) === val also works, but is slower, especially if val is\n  // not an object.\n};\n\n\n/**\n * Gets a unique ID for an object. This mutates the object so that further calls\n * with the same object as a parameter returns the same value. The unique ID is\n * guaranteed to be unique across the current session amongst objects that are\n * passed into `getUid`. There is no guarantee that the ID is unique or\n * consistent across sessions. It is unsafe to generate unique ID for function\n * prototypes.\n *\n * @param {Object} obj The object to get the unique ID for.\n * @return {number} The unique ID for the object.\n */\ngoog.getUid = function(obj) {\n  // TODO(arv): Make the type stricter, do not accept null.\n\n  // In Opera window.hasOwnProperty exists but always returns false so we avoid\n  // using it. As a consequence the unique ID generated for BaseClass.prototype\n  // and SubClass.prototype will be the same.\n  return obj[goog.UID_PROPERTY_] ||\n      (obj[goog.UID_PROPERTY_] = ++goog.uidCounter_);\n};\n\n\n/**\n * Whether the given object is already assigned a unique ID.\n *\n * This does not modify the object.\n *\n * @param {!Object} obj The object to check.\n * @return {boolean} Whether there is an assigned unique id for the object.\n */\ngoog.hasUid = function(obj) {\n  return !!obj[goog.UID_PROPERTY_];\n};\n\n\n/**\n * Removes the unique ID from an object. This is useful if the object was\n * previously mutated using `goog.getUid` in which case the mutation is\n * undone.\n * @param {Object} obj The object to remove the unique ID field from.\n */\ngoog.removeUid = function(obj) {\n  // TODO(arv): Make the type stricter, do not accept null.\n\n  // In IE, DOM nodes are not instances of Object and throw an exception if we\n  // try to delete.  Instead we try to use removeAttribute.\n  if (obj !== null && 'removeAttribute' in obj) {\n    obj.removeAttribute(goog.UID_PROPERTY_);\n  }\n\n  try {\n    delete obj[goog.UID_PROPERTY_];\n  } catch (ex) {\n  }\n};\n\n\n/**\n * Name for unique ID property. Initialized in a way to help avoid collisions\n * with other closure JavaScript on the same page.\n * @type {string}\n * @private\n */\ngoog.UID_PROPERTY_ = 'closure_uid_' + ((Math.random() * 1e9) >>> 0);\n\n\n/**\n * Counter for UID.\n * @type {number}\n * @private\n */\ngoog.uidCounter_ = 0;\n\n\n/**\n * Adds a hash code field to an object. The hash code is unique for the\n * given object.\n * @param {Object} obj The object to get the hash code for.\n * @return {number} The hash code for the object.\n * @deprecated Use goog.getUid instead.\n */\ngoog.getHashCode = goog.getUid;\n\n\n/**\n * Removes the hash code field from an object.\n * @param {Object} obj The object to remove the field from.\n * @deprecated Use goog.removeUid instead.\n */\ngoog.removeHashCode = goog.removeUid;\n\n\n/**\n * Clones a value. The input may be an Object, Array, or basic type. Objects and\n * arrays will be cloned recursively.\n *\n * WARNINGS:\n * <code>goog.cloneObject</code> does not detect reference loops. Objects that\n * refer to themselves will cause infinite recursion.\n *\n * <code>goog.cloneObject</code> is unaware of unique identifiers, and copies\n * UIDs created by <code>getUid</code> into cloned results.\n *\n * @param {*} obj The value to clone.\n * @return {*} A clone of the input value.\n * @deprecated goog.cloneObject is unsafe. Prefer the goog.object methods.\n */\ngoog.cloneObject = function(obj) {\n  var type = goog.typeOf(obj);\n  if (type == 'object' || type == 'array') {\n    if (typeof obj.clone === 'function') {\n      return obj.clone();\n    }\n    var clone = type == 'array' ? [] : {};\n    for (var key in obj) {\n      clone[key] = goog.cloneObject(obj[key]);\n    }\n    return clone;\n  }\n\n  return obj;\n};\n\n\n/**\n * A native implementation of goog.bind.\n * @param {?function(this:T, ...)} fn A function to partially apply.\n * @param {T} selfObj Specifies the object which this should point to when the\n *     function is run.\n * @param {...*} var_args Additional arguments that are partially applied to the\n *     function.\n * @return {!Function} A partially-applied form of the function goog.bind() was\n *     invoked as a method of.\n * @template T\n * @private\n */\ngoog.bindNative_ = function(fn, selfObj, var_args) {\n  return /** @type {!Function} */ (fn.call.apply(fn.bind, arguments));\n};\n\n\n/**\n * A pure-JS implementation of goog.bind.\n * @param {?function(this:T, ...)} fn A function to partially apply.\n * @param {T} selfObj Specifies the object which this should point to when the\n *     function is run.\n * @param {...*} var_args Additional arguments that are partially applied to the\n *     function.\n * @return {!Function} A partially-applied form of the function goog.bind() was\n *     invoked as a method of.\n * @template T\n * @private\n */\ngoog.bindJs_ = function(fn, selfObj, var_args) {\n  if (!fn) {\n    throw new Error();\n  }\n\n  if (arguments.length > 2) {\n    var boundArgs = Array.prototype.slice.call(arguments, 2);\n    return function() {\n      // Prepend the bound arguments to the current arguments.\n      var newArgs = Array.prototype.slice.call(arguments);\n      Array.prototype.unshift.apply(newArgs, boundArgs);\n      return fn.apply(selfObj, newArgs);\n    };\n\n  } else {\n    return function() {\n      return fn.apply(selfObj, arguments);\n    };\n  }\n};\n\n\n/**\n * Partially applies this function to a particular 'this object' and zero or\n * more arguments. The result is a new function with some arguments of the first\n * function pre-filled and the value of this 'pre-specified'.\n *\n * Remaining arguments specified at call-time are appended to the pre-specified\n * ones.\n *\n * Also see: {@link #partial}.\n *\n * Usage:\n * <pre>var barMethBound = goog.bind(myFunction, myObj, 'arg1', 'arg2');\n * barMethBound('arg3', 'arg4');</pre>\n *\n * @param {?function(this:T, ...)} fn A function to partially apply.\n * @param {T} selfObj Specifies the object which this should point to when the\n *     function is run.\n * @param {...*} var_args Additional arguments that are partially applied to the\n *     function.\n * @return {!Function} A partially-applied form of the function goog.bind() was\n *     invoked as a method of.\n * @template T\n * @suppress {deprecated} See above.\n */\ngoog.bind = function(fn, selfObj, var_args) {\n  // TODO(nicksantos): narrow the type signature.\n  if (Function.prototype.bind &&\n      // NOTE(nicksantos): Somebody pulled base.js into the default Chrome\n      // extension environment. This means that for Chrome extensions, they get\n      // the implementation of Function.prototype.bind that calls goog.bind\n      // instead of the native one. Even worse, we don't want to introduce a\n      // circular dependency between goog.bind and Function.prototype.bind, so\n      // we have to hack this to make sure it works correctly.\n      Function.prototype.bind.toString().indexOf('native code') != -1) {\n    goog.bind = goog.bindNative_;\n  } else {\n    goog.bind = goog.bindJs_;\n  }\n  return goog.bind.apply(null, arguments);\n};\n\n\n/**\n * Like goog.bind(), except that a 'this object' is not required. Useful when\n * the target function is already bound.\n *\n * Usage:\n * var g = goog.partial(f, arg1, arg2);\n * g(arg3, arg4);\n *\n * @param {Function} fn A function to partially apply.\n * @param {...*} var_args Additional arguments that are partially applied to fn.\n * @return {!Function} A partially-applied form of the function goog.partial()\n *     was invoked as a method of.\n */\ngoog.partial = function(fn, var_args) {\n  var args = Array.prototype.slice.call(arguments, 1);\n  return function() {\n    // Clone the array (with slice()) and append additional arguments\n    // to the existing arguments.\n    var newArgs = args.slice();\n    newArgs.push.apply(newArgs, arguments);\n    return fn.apply(this, newArgs);\n  };\n};\n\n\n/**\n * Copies all the members of a source object to a target object. This method\n * does not work on all browsers for all objects that contain keys such as\n * toString or hasOwnProperty. Use goog.object.extend for this purpose.\n * @param {Object} target Target.\n * @param {Object} source Source.\n */\ngoog.mixin = function(target, source) {\n  for (var x in source) {\n    target[x] = source[x];\n  }\n\n  // For IE7 or lower, the for-in-loop does not contain any properties that are\n  // not enumerable on the prototype object (for example, isPrototypeOf from\n  // Object.prototype) but also it will not include 'replace' on objects that\n  // extend String and change 'replace' (not that it is common for anyone to\n  // extend anything except Object).\n};\n\n\n/**\n * @return {number} An integer value representing the number of milliseconds\n *     between midnight, January 1, 1970 and the current time.\n */\ngoog.now = (goog.TRUSTED_SITE && Date.now) || (function() {\n             // Unary plus operator converts its operand to a number which in\n             // the case of\n             // a date is done by calling getTime().\n             return +new Date();\n           });\n\n\n/**\n * Evals JavaScript in the global scope.  In IE this uses execScript, other\n * browsers use goog.global.eval. If goog.global.eval does not evaluate in the\n * global scope (for example, in Safari), appends a script tag instead.\n * Throws an exception if neither execScript or eval is defined.\n * @param {string} script JavaScript string.\n */\ngoog.globalEval = function(script) {\n  if (goog.global.execScript) {\n    goog.global.execScript(script, 'JavaScript');\n  } else if (goog.global.eval) {\n    // Test to see if eval works\n    if (goog.evalWorksForGlobals_ == null) {\n      try {\n        goog.global.eval('var _evalTest_ = 1;');\n      } catch (ignore) {\n      }\n      if (typeof goog.global['_evalTest_'] != 'undefined') {\n        try {\n          delete goog.global['_evalTest_'];\n        } catch (ignore) {\n          // Microsoft edge fails the deletion above in strict mode.\n        }\n        goog.evalWorksForGlobals_ = true;\n      } else {\n        goog.evalWorksForGlobals_ = false;\n      }\n    }\n\n    if (goog.evalWorksForGlobals_) {\n      goog.global.eval(script);\n    } else {\n      /** @type {!Document} */\n      var doc = goog.global.document;\n      var scriptElt =\n          /** @type {!HTMLScriptElement} */ (doc.createElement('SCRIPT'));\n      scriptElt.type = 'text/javascript';\n      scriptElt.defer = false;\n      // Note(user): can't use .innerHTML since \"t('<test>')\" will fail and\n      // .text doesn't work in Safari 2.  Therefore we append a text node.\n      scriptElt.appendChild(doc.createTextNode(script));\n      doc.head.appendChild(scriptElt);\n      doc.head.removeChild(scriptElt);\n    }\n  } else {\n    throw new Error('goog.globalEval not available');\n  }\n};\n\n\n/**\n * Indicates whether or not we can call 'eval' directly to eval code in the\n * global scope. Set to a Boolean by the first call to goog.globalEval (which\n * empirically tests whether eval works for globals). @see goog.globalEval\n * @type {?boolean}\n * @private\n */\ngoog.evalWorksForGlobals_ = null;\n\n\n/**\n * Optional map of CSS class names to obfuscated names used with\n * goog.getCssName().\n * @private {!Object<string, string>|undefined}\n * @see goog.setCssNameMapping\n */\ngoog.cssNameMapping_;\n\n\n/**\n * Optional obfuscation style for CSS class names. Should be set to either\n * 'BY_WHOLE' or 'BY_PART' if defined.\n * @type {string|undefined}\n * @private\n * @see goog.setCssNameMapping\n */\ngoog.cssNameMappingStyle_;\n\n\n\n/**\n * A hook for modifying the default behavior goog.getCssName. The function\n * if present, will receive the standard output of the goog.getCssName as\n * its input.\n *\n * @type {(function(string):string)|undefined}\n */\ngoog.global.CLOSURE_CSS_NAME_MAP_FN;\n\n\n/**\n * Handles strings that are intended to be used as CSS class names.\n *\n * This function works in tandem with @see goog.setCssNameMapping.\n *\n * Without any mapping set, the arguments are simple joined with a hyphen and\n * passed through unaltered.\n *\n * When there is a mapping, there are two possible styles in which these\n * mappings are used. In the BY_PART style, each part (i.e. in between hyphens)\n * of the passed in css name is rewritten according to the map. In the BY_WHOLE\n * style, the full css name is looked up in the map directly. If a rewrite is\n * not specified by the map, the compiler will output a warning.\n *\n * When the mapping is passed to the compiler, it will replace calls to\n * goog.getCssName with the strings from the mapping, e.g.\n *     var x = goog.getCssName('foo');\n *     var y = goog.getCssName(this.baseClass, 'active');\n *  becomes:\n *     var x = 'foo';\n *     var y = this.baseClass + '-active';\n *\n * If one argument is passed it will be processed, if two are passed only the\n * modifier will be processed, as it is assumed the first argument was generated\n * as a result of calling goog.getCssName.\n *\n * @param {string} className The class name.\n * @param {string=} opt_modifier A modifier to be appended to the class name.\n * @return {string} The class name or the concatenation of the class name and\n *     the modifier.\n */\ngoog.getCssName = function(className, opt_modifier) {\n  // String() is used for compatibility with compiled soy where the passed\n  // className can be non-string objects.\n  if (String(className).charAt(0) == '.') {\n    throw new Error(\n        'className passed in goog.getCssName must not start with \".\".' +\n        ' You passed: ' + className);\n  }\n\n  var getMapping = function(cssName) {\n    return goog.cssNameMapping_[cssName] || cssName;\n  };\n\n  var renameByParts = function(cssName) {\n    // Remap all the parts individually.\n    var parts = cssName.split('-');\n    var mapped = [];\n    for (var i = 0; i < parts.length; i++) {\n      mapped.push(getMapping(parts[i]));\n    }\n    return mapped.join('-');\n  };\n\n  var rename;\n  if (goog.cssNameMapping_) {\n    rename =\n        goog.cssNameMappingStyle_ == 'BY_WHOLE' ? getMapping : renameByParts;\n  } else {\n    rename = function(a) {\n      return a;\n    };\n  }\n\n  var result =\n      opt_modifier ? className + '-' + rename(opt_modifier) : rename(className);\n\n  // The special CLOSURE_CSS_NAME_MAP_FN allows users to specify further\n  // processing of the class name.\n  if (goog.global.CLOSURE_CSS_NAME_MAP_FN) {\n    return goog.global.CLOSURE_CSS_NAME_MAP_FN(result);\n  }\n\n  return result;\n};\n\n\n/**\n * Sets the map to check when returning a value from goog.getCssName(). Example:\n * <pre>\n * goog.setCssNameMapping({\n *   \"goog\": \"a\",\n *   \"disabled\": \"b\",\n * });\n *\n * var x = goog.getCssName('goog');\n * // The following evaluates to: \"a a-b\".\n * goog.getCssName('goog') + ' ' + goog.getCssName(x, 'disabled')\n * </pre>\n * When declared as a map of string literals to string literals, the JSCompiler\n * will replace all calls to goog.getCssName() using the supplied map if the\n * --process_closure_primitives flag is set.\n *\n * @param {!Object} mapping A map of strings to strings where keys are possible\n *     arguments to goog.getCssName() and values are the corresponding values\n *     that should be returned.\n * @param {string=} opt_style The style of css name mapping. There are two valid\n *     options: 'BY_PART', and 'BY_WHOLE'.\n * @see goog.getCssName for a description.\n */\ngoog.setCssNameMapping = function(mapping, opt_style) {\n  goog.cssNameMapping_ = mapping;\n  goog.cssNameMappingStyle_ = opt_style;\n};\n\n\n/**\n * To use CSS renaming in compiled mode, one of the input files should have a\n * call to goog.setCssNameMapping() with an object literal that the JSCompiler\n * can extract and use to replace all calls to goog.getCssName(). In uncompiled\n * mode, JavaScript code should be loaded before this base.js file that declares\n * a global variable, CLOSURE_CSS_NAME_MAPPING, which is used below. This is\n * to ensure that the mapping is loaded before any calls to goog.getCssName()\n * are made in uncompiled mode.\n *\n * A hook for overriding the CSS name mapping.\n * @type {!Object<string, string>|undefined}\n */\ngoog.global.CLOSURE_CSS_NAME_MAPPING;\n\n\nif (!COMPILED && goog.global.CLOSURE_CSS_NAME_MAPPING) {\n  // This does not call goog.setCssNameMapping() because the JSCompiler\n  // requires that goog.setCssNameMapping() be called with an object literal.\n  goog.cssNameMapping_ = goog.global.CLOSURE_CSS_NAME_MAPPING;\n}\n\n\n/**\n * Gets a localized message.\n *\n * This function is a compiler primitive. If you give the compiler a localized\n * message bundle, it will replace the string at compile-time with a localized\n * version, and expand goog.getMsg call to a concatenated string.\n *\n * Messages must be initialized in the form:\n * <code>\n * var MSG_NAME = goog.getMsg('Hello {$placeholder}', {'placeholder': 'world'});\n * </code>\n *\n * This function produces a string which should be treated as plain text. Use\n * {@link goog.html.SafeHtmlFormatter} in conjunction with goog.getMsg to\n * produce SafeHtml.\n *\n * @param {string} str Translatable string, places holders in the form {$foo}.\n * @param {Object<string, string>=} opt_values Maps place holder name to value.\n * @return {string} message with placeholders filled.\n */\ngoog.getMsg = function(str, opt_values) {\n  if (opt_values) {\n    str = str.replace(/\\{\\$([^}]+)}/g, function(match, key) {\n      return (opt_values != null && key in opt_values) ? opt_values[key] :\n                                                         match;\n    });\n  }\n  return str;\n};\n\n\n/**\n * Gets a localized message. If the message does not have a translation, gives a\n * fallback message.\n *\n * This is useful when introducing a new message that has not yet been\n * translated into all languages.\n *\n * This function is a compiler primitive. Must be used in the form:\n * <code>var x = goog.getMsgWithFallback(MSG_A, MSG_B);</code>\n * where MSG_A and MSG_B were initialized with goog.getMsg.\n *\n * @param {string} a The preferred message.\n * @param {string} b The fallback message.\n * @return {string} The best translated message.\n */\ngoog.getMsgWithFallback = function(a, b) {\n  return a;\n};\n\n\n/**\n * Exposes an unobfuscated global namespace path for the given object.\n * Note that fields of the exported object *will* be obfuscated, unless they are\n * exported in turn via this function or goog.exportProperty.\n *\n * Also handy for making public items that are defined in anonymous closures.\n *\n * ex. goog.exportSymbol('public.path.Foo', Foo);\n *\n * ex. goog.exportSymbol('public.path.Foo.staticFunction', Foo.staticFunction);\n *     public.path.Foo.staticFunction();\n *\n * ex. goog.exportSymbol('public.path.Foo.prototype.myMethod',\n *                       Foo.prototype.myMethod);\n *     new public.path.Foo().myMethod();\n *\n * @param {string} publicPath Unobfuscated name to export.\n * @param {*} object Object the name should point to.\n * @param {Object=} opt_objectToExportTo The object to add the path to; default\n *     is goog.global.\n */\ngoog.exportSymbol = function(publicPath, object, opt_objectToExportTo) {\n  goog.exportPath_(publicPath, object, opt_objectToExportTo);\n};\n\n\n/**\n * Exports a property unobfuscated into the object's namespace.\n * ex. goog.exportProperty(Foo, 'staticFunction', Foo.staticFunction);\n * ex. goog.exportProperty(Foo.prototype, 'myMethod', Foo.prototype.myMethod);\n * @param {Object} object Object whose static property is being exported.\n * @param {string} publicName Unobfuscated name to export.\n * @param {*} symbol Object the name should point to.\n */\ngoog.exportProperty = function(object, publicName, symbol) {\n  object[publicName] = symbol;\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * Usage:\n * <pre>\n * function ParentClass(a, b) { }\n * ParentClass.prototype.foo = function(a) { };\n *\n * function ChildClass(a, b, c) {\n *   ChildClass.base(this, 'constructor', a, b);\n * }\n * goog.inherits(ChildClass, ParentClass);\n *\n * var child = new ChildClass('a', 'b', 'see');\n * child.foo(); // This works.\n * </pre>\n *\n * @param {!Function} childCtor Child class.\n * @param {!Function} parentCtor Parent class.\n * @suppress {strictMissingProperties} superClass_ and base is not defined on\n *    Function.\n */\ngoog.inherits = function(childCtor, parentCtor) {\n  /** @constructor */\n  function tempCtor() {}\n  tempCtor.prototype = parentCtor.prototype;\n  childCtor.superClass_ = parentCtor.prototype;\n  childCtor.prototype = new tempCtor();\n  /** @override */\n  childCtor.prototype.constructor = childCtor;\n\n  /**\n   * Calls superclass constructor/method.\n   *\n   * This function is only available if you use goog.inherits to\n   * express inheritance relationships between classes.\n   *\n   * NOTE: This is a replacement for goog.base and for superClass_\n   * property defined in childCtor.\n   *\n   * @param {!Object} me Should always be \"this\".\n   * @param {string} methodName The method name to call. Calling\n   *     superclass constructor can be done with the special string\n   *     'constructor'.\n   * @param {...*} var_args The arguments to pass to superclass\n   *     method/constructor.\n   * @return {*} The return value of the superclass method/constructor.\n   */\n  childCtor.base = function(me, methodName, var_args) {\n    // Copying using loop to avoid deop due to passing arguments object to\n    // function. This is faster in many JS engines as of late 2014.\n    var args = new Array(arguments.length - 2);\n    for (var i = 2; i < arguments.length; i++) {\n      args[i - 2] = arguments[i];\n    }\n    return parentCtor.prototype[methodName].apply(me, args);\n  };\n};\n\n\n/**\n * Call up to the superclass.\n *\n * If this is called from a constructor, then this calls the superclass\n * constructor with arguments 1-N.\n *\n * If this is called from a prototype method, then you must pass the name of the\n * method as the second argument to this function. If you do not, you will get a\n * runtime error. This calls the superclass' method with arguments 2-N.\n *\n * This function only works if you use goog.inherits to express inheritance\n * relationships between your classes.\n *\n * This function is a compiler primitive. At compile-time, the compiler will do\n * macro expansion to remove a lot of the extra overhead that this function\n * introduces. The compiler will also enforce a lot of the assumptions that this\n * function makes, and treat it as a compiler error if you break them.\n *\n * @param {!Object} me Should always be \"this\".\n * @param {*=} opt_methodName The method name if calling a super method.\n * @param {...*} var_args The rest of the arguments.\n * @return {*} The return value of the superclass method.\n * @suppress {es5Strict} This method can not be used in strict mode, but\n *     all Closure Library consumers must depend on this file.\n * @deprecated goog.base is not strict mode compatible.  Prefer the static\n *     \"base\" method added to the constructor by goog.inherits\n *     or ES6 classes and the \"super\" keyword.\n */\ngoog.base = function(me, opt_methodName, var_args) {\n  var caller = arguments.callee.caller;\n\n  if (goog.STRICT_MODE_COMPATIBLE || (goog.DEBUG && !caller)) {\n    throw new Error(\n        'arguments.caller not defined.  goog.base() cannot be used ' +\n        'with strict mode code. See ' +\n        'http://www.ecma-international.org/ecma-262/5.1/#sec-C');\n  }\n\n  if (typeof caller.superClass_ !== 'undefined') {\n    // Copying using loop to avoid deop due to passing arguments object to\n    // function. This is faster in many JS engines as of late 2014.\n    var ctorArgs = new Array(arguments.length - 1);\n    for (var i = 1; i < arguments.length; i++) {\n      ctorArgs[i - 1] = arguments[i];\n    }\n    // This is a constructor. Call the superclass constructor.\n    return caller.superClass_.constructor.apply(me, ctorArgs);\n  }\n\n  if (typeof opt_methodName != 'string' && typeof opt_methodName != 'symbol') {\n    throw new Error(\n        'method names provided to goog.base must be a string or a symbol');\n  }\n\n  // Copying using loop to avoid deop due to passing arguments object to\n  // function. This is faster in many JS engines as of late 2014.\n  var args = new Array(arguments.length - 2);\n  for (var i = 2; i < arguments.length; i++) {\n    args[i - 2] = arguments[i];\n  }\n  var foundCaller = false;\n  for (var ctor = me.constructor; ctor;\n       ctor = ctor.superClass_ && ctor.superClass_.constructor) {\n    if (ctor.prototype[opt_methodName] === caller) {\n      foundCaller = true;\n    } else if (foundCaller) {\n      return ctor.prototype[opt_methodName].apply(me, args);\n    }\n  }\n\n  // If we did not find the caller in the prototype chain, then one of two\n  // things happened:\n  // 1) The caller is an instance method.\n  // 2) This method was not called by the right caller.\n  if (me[opt_methodName] === caller) {\n    return me.constructor.prototype[opt_methodName].apply(me, args);\n  } else {\n    throw new Error(\n        'goog.base called from a method of one name ' +\n        'to a method of a different name');\n  }\n};\n\n\n/**\n * Allow for aliasing within scope functions.  This function exists for\n * uncompiled code - in compiled code the calls will be inlined and the aliases\n * applied.  In uncompiled code the function is simply run since the aliases as\n * written are valid JavaScript.\n *\n *\n * @param {function()} fn Function to call.  This function can contain aliases\n *     to namespaces (e.g. \"var dom = goog.dom\") or classes\n *     (e.g. \"var Timer = goog.Timer\").\n */\ngoog.scope = function(fn) {\n  if (goog.isInModuleLoader_()) {\n    throw new Error('goog.scope is not supported within a module.');\n  }\n  fn.call(goog.global);\n};\n\n\n/*\n * To support uncompiled, strict mode bundles that use eval to divide source\n * like so:\n *    eval('someSource;//# sourceUrl sourcefile.js');\n * We need to export the globally defined symbols \"goog\" and \"COMPILED\".\n * Exporting \"goog\" breaks the compiler optimizations, so we required that\n * be defined externally.\n * NOTE: We don't use goog.exportSymbol here because we don't want to trigger\n * extern generation when that compiler option is enabled.\n */\nif (!COMPILED) {\n  goog.global['COMPILED'] = COMPILED;\n}\n\n\n//==============================================================================\n// goog.defineClass implementation\n//==============================================================================\n\n\n/**\n * Creates a restricted form of a Closure \"class\":\n *   - from the compiler's perspective, the instance returned from the\n *     constructor is sealed (no new properties may be added).  This enables\n *     better checks.\n *   - the compiler will rewrite this definition to a form that is optimal\n *     for type checking and optimization (initially this will be a more\n *     traditional form).\n *\n * @param {Function} superClass The superclass, Object or null.\n * @param {goog.defineClass.ClassDescriptor} def\n *     An object literal describing\n *     the class.  It may have the following properties:\n *     \"constructor\": the constructor function\n *     \"statics\": an object literal containing methods to add to the constructor\n *        as \"static\" methods or a function that will receive the constructor\n *        function as its only parameter to which static properties can\n *        be added.\n *     all other properties are added to the prototype.\n * @return {!Function} The class constructor.\n */\ngoog.defineClass = function(superClass, def) {\n  // TODO(johnlenz): consider making the superClass an optional parameter.\n  var constructor = def.constructor;\n  var statics = def.statics;\n  // Wrap the constructor prior to setting up the prototype and static methods.\n  if (!constructor || constructor == Object.prototype.constructor) {\n    constructor = function() {\n      throw new Error(\n          'cannot instantiate an interface (no constructor defined).');\n    };\n  }\n\n  var cls = goog.defineClass.createSealingConstructor_(constructor, superClass);\n  if (superClass) {\n    goog.inherits(cls, superClass);\n  }\n\n  // Remove all the properties that should not be copied to the prototype.\n  delete def.constructor;\n  delete def.statics;\n\n  goog.defineClass.applyProperties_(cls.prototype, def);\n  if (statics != null) {\n    if (statics instanceof Function) {\n      statics(cls);\n    } else {\n      goog.defineClass.applyProperties_(cls, statics);\n    }\n  }\n\n  return cls;\n};\n\n\n/**\n * @typedef {{\n *   constructor: (!Function|undefined),\n *   statics: (Object|undefined|function(Function):void)\n * }}\n */\ngoog.defineClass.ClassDescriptor;\n\n\n/**\n * @define {boolean} Whether the instances returned by goog.defineClass should\n *     be sealed when possible.\n *\n * When sealing is disabled the constructor function will not be wrapped by\n * goog.defineClass, making it incompatible with ES6 class methods.\n */\ngoog.define('goog.defineClass.SEAL_CLASS_INSTANCES', goog.DEBUG);\n\n\n/**\n * If goog.defineClass.SEAL_CLASS_INSTANCES is enabled and Object.seal is\n * defined, this function will wrap the constructor in a function that seals the\n * results of the provided constructor function.\n *\n * @param {!Function} ctr The constructor whose results maybe be sealed.\n * @param {Function} superClass The superclass constructor.\n * @return {!Function} The replacement constructor.\n * @private\n */\ngoog.defineClass.createSealingConstructor_ = function(ctr, superClass) {\n  if (!goog.defineClass.SEAL_CLASS_INSTANCES) {\n    // Do now wrap the constructor when sealing is disabled. Angular code\n    // depends on this for injection to work properly.\n    return ctr;\n  }\n\n  // Compute whether the constructor is sealable at definition time, rather\n  // than when the instance is being constructed.\n  var superclassSealable = !goog.defineClass.isUnsealable_(superClass);\n\n  /**\n   * @this {Object}\n   * @return {?}\n   */\n  var wrappedCtr = function() {\n    // Don't seal an instance of a subclass when it calls the constructor of\n    // its super class as there is most likely still setup to do.\n    var instance = ctr.apply(this, arguments) || this;\n    instance[goog.UID_PROPERTY_] = instance[goog.UID_PROPERTY_];\n\n    if (this.constructor === wrappedCtr && superclassSealable &&\n        Object.seal instanceof Function) {\n      Object.seal(instance);\n    }\n    return instance;\n  };\n\n  return wrappedCtr;\n};\n\n\n/**\n * @param {Function} ctr The constructor to test.\n * @return {boolean} Whether the constructor has been tagged as unsealable\n *     using goog.tagUnsealableClass.\n * @private\n */\ngoog.defineClass.isUnsealable_ = function(ctr) {\n  return ctr && ctr.prototype &&\n      ctr.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_];\n};\n\n\n// TODO(johnlenz): share these values with the goog.object\n/**\n * The names of the fields that are defined on Object.prototype.\n * @type {!Array<string>}\n * @private\n * @const\n */\ngoog.defineClass.OBJECT_PROTOTYPE_FIELDS_ = [\n  'constructor', 'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable',\n  'toLocaleString', 'toString', 'valueOf'\n];\n\n\n// TODO(johnlenz): share this function with the goog.object\n/**\n * @param {!Object} target The object to add properties to.\n * @param {!Object} source The object to copy properties from.\n * @private\n */\ngoog.defineClass.applyProperties_ = function(target, source) {\n  // TODO(johnlenz): update this to support ES5 getters/setters\n\n  var key;\n  for (key in source) {\n    if (Object.prototype.hasOwnProperty.call(source, key)) {\n      target[key] = source[key];\n    }\n  }\n\n  // For IE the for-in-loop does not contain any properties that are not\n  // enumerable on the prototype object (for example isPrototypeOf from\n  // Object.prototype) and it will also not include 'replace' on objects that\n  // extend String and change 'replace' (not that it is common for anyone to\n  // extend anything except Object).\n  for (var i = 0; i < goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length; i++) {\n    key = goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[i];\n    if (Object.prototype.hasOwnProperty.call(source, key)) {\n      target[key] = source[key];\n    }\n  }\n};\n\n\n/**\n * Sealing classes breaks the older idiom of assigning properties on the\n * prototype rather than in the constructor. As such, goog.defineClass\n * must not seal subclasses of these old-style classes until they are fixed.\n * Until then, this marks a class as \"broken\", instructing defineClass\n * not to seal subclasses.\n * @param {!Function} ctr The legacy constructor to tag as unsealable.\n */\ngoog.tagUnsealableClass = function(ctr) {\n  if (!COMPILED && goog.defineClass.SEAL_CLASS_INSTANCES) {\n    ctr.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_] = true;\n  }\n};\n\n\n/**\n * Name for unsealable tag property.\n * @const @private {string}\n */\ngoog.UNSEALABLE_CONSTRUCTOR_PROPERTY_ = 'goog_defineClass_legacy_unsealable';\n\n\n// There's a bug in the compiler where without collapse properties the\n// Closure namespace defines do not guard code correctly. To help reduce code\n// size also check for !COMPILED even though it redundant until this is fixed.\nif (!COMPILED && goog.DEPENDENCIES_ENABLED) {\n\n  /**\n   * Tries to detect whether is in the context of an HTML document.\n   * @return {boolean} True if it looks like HTML document.\n   * @private\n   */\n  goog.inHtmlDocument_ = function() {\n    /** @type {!Document} */\n    var doc = goog.global.document;\n    return doc != null && 'write' in doc;  // XULDocument misses write.\n  };\n\n\n  /**\n   * We'd like to check for if the document readyState is 'loading'; however\n   * there are bugs on IE 10 and below where the readyState being anything other\n   * than 'complete' is not reliable.\n   * @return {boolean}\n   * @private\n   */\n  goog.isDocumentLoading_ = function() {\n    // attachEvent is available on IE 6 thru 10 only, and thus can be used to\n    // detect those browsers.\n    /** @type {!HTMLDocument} */\n    var doc = goog.global.document;\n    return doc.attachEvent ? doc.readyState != 'complete' :\n                             doc.readyState == 'loading';\n  };\n\n\n  /**\n   * Tries to detect the base path of base.js script that bootstraps Closure.\n   * @private\n   */\n  goog.findBasePath_ = function() {\n    if (goog.isDef(goog.global.CLOSURE_BASE_PATH) &&\n        // Anti DOM-clobbering runtime check (b/37736576).\n        goog.isString(goog.global.CLOSURE_BASE_PATH)) {\n      goog.basePath = goog.global.CLOSURE_BASE_PATH;\n      return;\n    } else if (!goog.inHtmlDocument_()) {\n      return;\n    }\n    /** @type {!Document} */\n    var doc = goog.global.document;\n    // If we have a currentScript available, use it exclusively.\n    var currentScript = doc.currentScript;\n    if (currentScript) {\n      var scripts = [currentScript];\n    } else {\n      var scripts = doc.getElementsByTagName('SCRIPT');\n    }\n    // Search backwards since the current script is in almost all cases the one\n    // that has base.js.\n    for (var i = scripts.length - 1; i >= 0; --i) {\n      var script = /** @type {!HTMLScriptElement} */ (scripts[i]);\n      var src = script.src;\n      var qmark = src.lastIndexOf('?');\n      var l = qmark == -1 ? src.length : qmark;\n      if (src.substr(l - 7, 7) == 'base.js') {\n        goog.basePath = src.substr(0, l - 7);\n        return;\n      }\n    }\n  };\n\n  goog.findBasePath_();\n\n  /** @struct @constructor @final */\n  goog.Transpiler = function() {\n    /** @private {?Object<string, boolean>} */\n    this.requiresTranspilation_ = null;\n    /** @private {string} */\n    this.transpilationTarget_ = goog.TRANSPILE_TO_LANGUAGE;\n  };\n\n\n  /**\n   * Returns a newly created map from language mode string to a boolean\n   * indicating whether transpilation should be done for that mode as well as\n   * the highest level language that this environment supports.\n   *\n   * Guaranteed invariant:\n   * For any two modes, l1 and l2 where l2 is a newer mode than l1,\n   * `map[l1] == true` implies that `map[l2] == true`.\n   *\n   * Note this method is extracted and used elsewhere, so it cannot rely on\n   * anything external (it should easily be able to be transformed into a\n   * standalone, top level function).\n   *\n   * @private\n   * @return {{\n   *   target: string,\n   *   map: !Object<string, boolean>\n   * }}\n   */\n  goog.Transpiler.prototype.createRequiresTranspilation_ = function() {\n    var transpilationTarget = 'es3';\n    var /** !Object<string, boolean> */ requiresTranspilation = {'es3': false};\n    var transpilationRequiredForAllLaterModes = false;\n\n    /**\n     * Adds an entry to requiresTranspliation for the given language mode.\n     *\n     * IMPORTANT: Calls must be made in order from oldest to newest language\n     * mode.\n     * @param {string} modeName\n     * @param {function(): boolean} isSupported Returns true if the JS engine\n     *     supports the given mode.\n     */\n    function addNewerLanguageTranspilationCheck(modeName, isSupported) {\n      if (transpilationRequiredForAllLaterModes) {\n        requiresTranspilation[modeName] = true;\n      } else if (isSupported()) {\n        transpilationTarget = modeName;\n        requiresTranspilation[modeName] = false;\n      } else {\n        requiresTranspilation[modeName] = true;\n        transpilationRequiredForAllLaterModes = true;\n      }\n    }\n\n    /**\n     * Does the given code evaluate without syntax errors and return a truthy\n     * result?\n     */\n    function /** boolean */ evalCheck(/** string */ code) {\n      try {\n        return !!eval(code);\n      } catch (ignored) {\n        return false;\n      }\n    }\n\n    var userAgent = goog.global.navigator && goog.global.navigator.userAgent ?\n        goog.global.navigator.userAgent :\n        '';\n\n    // Identify ES3-only browsers by their incorrect treatment of commas.\n    addNewerLanguageTranspilationCheck('es5', function() {\n      return evalCheck('[1,].length==1');\n    });\n    addNewerLanguageTranspilationCheck('es6', function() {\n      // Edge has a non-deterministic (i.e., not reproducible) bug with ES6:\n      // https://github.com/Microsoft/ChakraCore/issues/1496.\n      var re = /Edge\\/(\\d+)(\\.\\d)*/i;\n      var edgeUserAgent = userAgent.match(re);\n      if (edgeUserAgent && Number(edgeUserAgent[1]) < 15) {\n        return false;\n      }\n      // Test es6: [FF50 (?), Edge 14 (?), Chrome 50]\n      //   (a) default params (specifically shadowing locals),\n      //   (b) destructuring, (c) block-scoped functions,\n      //   (d) for-of (const), (e) new.target/Reflect.construct\n      var es6fullTest =\n          'class X{constructor(){if(new.target!=String)throw 1;this.x=42}}' +\n          'let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof ' +\n          'String))throw 1;for(const a of[2,3]){if(a==2)continue;function ' +\n          'f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()' +\n          '==3}';\n\n      return evalCheck('(()=>{\"use strict\";' + es6fullTest + '})()');\n    });\n    // TODO(joeltine): Remove es6-impl references for b/31340605.\n    // Consider es6-impl (widely-implemented es6 features) to be supported\n    // whenever es6 is supported. Technically es6-impl is a lower level of\n    // support than es6, but we don't have tests specifically for it.\n    addNewerLanguageTranspilationCheck('es6-impl', function() {\n      return true;\n    });\n    // ** and **= are the only new features in 'es7'\n    addNewerLanguageTranspilationCheck('es7', function() {\n      return evalCheck('2 ** 2 == 4');\n    });\n    // async functions are the only new features in 'es8'\n    addNewerLanguageTranspilationCheck('es8', function() {\n      return evalCheck('async () => 1, true');\n    });\n    addNewerLanguageTranspilationCheck('es9', function() {\n      return evalCheck('({...rest} = {}), true');\n    });\n    addNewerLanguageTranspilationCheck('es_next', function() {\n      return false;  // assume it always need to transpile\n    });\n    return {target: transpilationTarget, map: requiresTranspilation};\n  };\n\n\n  /**\n   * Determines whether the given language needs to be transpiled.\n   * @param {string} lang\n   * @param {string|undefined} module\n   * @return {boolean}\n   */\n  goog.Transpiler.prototype.needsTranspile = function(lang, module) {\n    if (goog.TRANSPILE == 'always') {\n      return true;\n    } else if (goog.TRANSPILE == 'never') {\n      return false;\n    } else if (!this.requiresTranspilation_) {\n      var obj = this.createRequiresTranspilation_();\n      this.requiresTranspilation_ = obj.map;\n      this.transpilationTarget_ = this.transpilationTarget_ || obj.target;\n    }\n    if (lang in this.requiresTranspilation_) {\n      if (this.requiresTranspilation_[lang]) {\n        return true;\n      } else if (\n          goog.inHtmlDocument_() && module == 'es6' &&\n          !('noModule' in goog.global.document.createElement('script'))) {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      throw new Error('Unknown language mode: ' + lang);\n    }\n  };\n\n\n  /**\n   * Lazily retrieves the transpiler and applies it to the source.\n   * @param {string} code JS code.\n   * @param {string} path Path to the code.\n   * @return {string} The transpiled code.\n   */\n  goog.Transpiler.prototype.transpile = function(code, path) {\n    // TODO(johnplaisted): We should delete goog.transpile_ and just have this\n    // function. But there's some compile error atm where goog.global is being\n    // stripped incorrectly without this.\n    return goog.transpile_(code, path, this.transpilationTarget_);\n  };\n\n\n  /** @private @final {!goog.Transpiler} */\n  goog.transpiler_ = new goog.Transpiler();\n\n  /**\n   * Rewrites closing script tags in input to avoid ending an enclosing script\n   * tag.\n   *\n   * @param {string} str\n   * @return {string}\n   * @private\n   */\n  goog.protectScriptTag_ = function(str) {\n    return str.replace(/<\\/(SCRIPT)/ig, '\\\\x3c/$1');\n  };\n\n\n  /**\n   * A debug loader is responsible for downloading and executing javascript\n   * files in an unbundled, uncompiled environment.\n   *\n   * This can be custimized via the setDependencyFactory method, or by\n   * CLOSURE_IMPORT_SCRIPT/CLOSURE_LOAD_FILE_SYNC.\n   *\n   * @struct @constructor @final @private\n   */\n  goog.DebugLoader_ = function() {\n    /** @private @const {!Object<string, !goog.Dependency>} */\n    this.dependencies_ = {};\n    /** @private @const {!Object<string, string>} */\n    this.idToPath_ = {};\n    /** @private @const {!Object<string, boolean>} */\n    this.written_ = {};\n    /** @private @const {!Array<!goog.Dependency>} */\n    this.loadingDeps_ = [];\n    /** @private {!Array<!goog.Dependency>} */\n    this.depsToLoad_ = [];\n    /** @private {boolean} */\n    this.paused_ = false;\n    /** @private {!goog.DependencyFactory} */\n    this.factory_ = new goog.DependencyFactory(goog.transpiler_);\n    /** @private @const {!Object<string, !Function>} */\n    this.deferredCallbacks_ = {};\n    /** @private @const {!Array<string>} */\n    this.deferredQueue_ = [];\n  };\n\n  /**\n   * @param {!Array<string>} namespaces\n   * @param {function(): undefined} callback Function to call once all the\n   *     namespaces have loaded.\n   */\n  goog.DebugLoader_.prototype.bootstrap = function(namespaces, callback) {\n    var cb = callback;\n    function resolve() {\n      if (cb) {\n        goog.global.setTimeout(cb, 0);\n        cb = null;\n      }\n    }\n\n    if (!namespaces.length) {\n      resolve();\n      return;\n    }\n\n    var deps = [];\n    for (var i = 0; i < namespaces.length; i++) {\n      var path = this.getPathFromDeps_(namespaces[i]);\n      if (!path) {\n        throw new Error('Unregonized namespace: ' + namespaces[i]);\n      }\n      deps.push(this.dependencies_[path]);\n    }\n\n    var require = goog.require;\n    var loaded = 0;\n    for (var i = 0; i < namespaces.length; i++) {\n      require(namespaces[i]);\n      deps[i].onLoad(function() {\n        if (++loaded == namespaces.length) {\n          resolve();\n        }\n      });\n    }\n  };\n\n\n  /**\n   * Loads the Closure Dependency file.\n   *\n   * Exposed a public function so CLOSURE_NO_DEPS can be set to false, base\n   * loaded, setDependencyFactory called, and then this called. i.e. allows\n   * custom loading of the deps file.\n   */\n  goog.DebugLoader_.prototype.loadClosureDeps = function() {\n    // Circumvent addDependency, which would try to transpile deps.js if\n    // transpile is set to always.\n    var relPath = 'deps.js';\n    this.depsToLoad_.push(this.factory_.createDependency(\n        goog.normalizePath_(goog.basePath + relPath), relPath, [], [], {},\n        false));\n    this.loadDeps_();\n  };\n\n\n  /**\n   * Notifies the debug loader when a dependency has been requested.\n   *\n   * @param {string} absPathOrId Path of the dependency or goog id.\n   * @param {boolean=} opt_force\n   */\n  goog.DebugLoader_.prototype.requested = function(absPathOrId, opt_force) {\n    var path = this.getPathFromDeps_(absPathOrId);\n    if (path &&\n        (opt_force || this.areDepsLoaded_(this.dependencies_[path].requires))) {\n      var callback = this.deferredCallbacks_[path];\n      if (callback) {\n        delete this.deferredCallbacks_[path];\n        callback();\n      }\n    }\n  };\n\n\n  /**\n   * Sets the dependency factory, which can be used to create custom\n   * goog.Dependency implementations to control how dependencies are loaded.\n   *\n   * @param {!goog.DependencyFactory} factory\n   */\n  goog.DebugLoader_.prototype.setDependencyFactory = function(factory) {\n    this.factory_ = factory;\n  };\n\n\n  /**\n   * Travserses the dependency graph and queues the given dependency, and all of\n   * its transitive dependencies, for loading and then starts loading if not\n   * paused.\n   *\n   * @param {string} namespace\n   * @private\n   */\n  goog.DebugLoader_.prototype.load_ = function(namespace) {\n    if (!this.getPathFromDeps_(namespace)) {\n      var errorMessage = 'goog.require could not find: ' + namespace;\n\n      goog.logToConsole_(errorMessage);\n      throw Error(errorMessage);\n    } else {\n      var loader = this;\n\n      var deps = [];\n\n      /** @param {string} namespace */\n      var visit = function(namespace) {\n        var path = loader.getPathFromDeps_(namespace);\n\n        if (!path) {\n          throw new Error('Bad dependency path or symbol: ' + namespace);\n        }\n\n        if (loader.written_[path]) {\n          return;\n        }\n\n        loader.written_[path] = true;\n\n        var dep = loader.dependencies_[path];\n        for (var i = 0; i < dep.requires.length; i++) {\n          if (!goog.isProvided_(dep.requires[i])) {\n            visit(dep.requires[i]);\n          }\n        }\n\n        deps.push(dep);\n      };\n\n      visit(namespace);\n\n      var wasLoading = !!this.depsToLoad_.length;\n      this.depsToLoad_ = this.depsToLoad_.concat(deps);\n\n      if (!this.paused_ && !wasLoading) {\n        this.loadDeps_();\n      }\n    }\n  };\n\n\n  /**\n   * Loads any queued dependencies until they are all loaded or paused.\n   *\n   * @private\n   */\n  goog.DebugLoader_.prototype.loadDeps_ = function() {\n    var loader = this;\n    var paused = this.paused_;\n\n    while (this.depsToLoad_.length && !paused) {\n      (function() {\n        var loadCallDone = false;\n        var dep = loader.depsToLoad_.shift();\n\n        var loaded = false;\n        loader.loading_(dep);\n\n        var controller = {\n          pause: function() {\n            if (loadCallDone) {\n              throw new Error('Cannot call pause after the call to load.');\n            } else {\n              paused = true;\n            }\n          },\n          resume: function() {\n            if (loadCallDone) {\n              loader.resume_();\n            } else {\n              // Some dep called pause and then resume in the same load call.\n              // Just keep running this same loop.\n              paused = false;\n            }\n          },\n          loaded: function() {\n            if (loaded) {\n              throw new Error('Double call to loaded.');\n            }\n\n            loaded = true;\n            loader.loaded_(dep);\n          },\n          pending: function() {\n            // Defensive copy.\n            var pending = [];\n            for (var i = 0; i < loader.loadingDeps_.length; i++) {\n              pending.push(loader.loadingDeps_[i]);\n            }\n            return pending;\n          },\n          /**\n           * @param {goog.ModuleType} type\n           */\n          setModuleState: function(type) {\n            goog.moduleLoaderState_ = {\n              type: type,\n              moduleName: '',\n              declareLegacyNamespace: false\n            };\n          },\n          /** @type {function(string, string, string=)} */\n          registerEs6ModuleExports: function(\n              path, exports, opt_closureNamespace) {\n            if (opt_closureNamespace) {\n              goog.loadedModules_[opt_closureNamespace] = {\n                exports: exports,\n                type: goog.ModuleType.ES6,\n                moduleId: opt_closureNamespace || ''\n              };\n            }\n          },\n          /** @type {function(string, ?)} */\n          registerGoogModuleExports: function(moduleId, exports) {\n            goog.loadedModules_[moduleId] = {\n              exports: exports,\n              type: goog.ModuleType.GOOG,\n              moduleId: moduleId\n            };\n          },\n          clearModuleState: function() {\n            goog.moduleLoaderState_ = null;\n          },\n          defer: function(callback) {\n            if (loadCallDone) {\n              throw new Error(\n                  'Cannot register with defer after the call to load.');\n            }\n            loader.defer_(dep, callback);\n          },\n          areDepsLoaded: function() {\n            return loader.areDepsLoaded_(dep.requires);\n          }\n        };\n\n        try {\n          dep.load(controller);\n        } finally {\n          loadCallDone = true;\n        }\n      })();\n    }\n\n    if (paused) {\n      this.pause_();\n    }\n  };\n\n\n  /** @private */\n  goog.DebugLoader_.prototype.pause_ = function() {\n    this.paused_ = true;\n  };\n\n\n  /** @private */\n  goog.DebugLoader_.prototype.resume_ = function() {\n    if (this.paused_) {\n      this.paused_ = false;\n      this.loadDeps_();\n    }\n  };\n\n\n  /**\n   * Marks the given dependency as loading (load has been called but it has not\n   * yet marked itself as finished). Useful for dependencies that want to know\n   * what else is loading. Example: goog.modules cannot eval if there are\n   * loading dependencies.\n   *\n   * @param {!goog.Dependency} dep\n   * @private\n   */\n  goog.DebugLoader_.prototype.loading_ = function(dep) {\n    this.loadingDeps_.push(dep);\n  };\n\n\n  /**\n   * Marks the given dependency as having finished loading and being available\n   * for require.\n   *\n   * @param {!goog.Dependency} dep\n   * @private\n   */\n  goog.DebugLoader_.prototype.loaded_ = function(dep) {\n    for (var i = 0; i < this.loadingDeps_.length; i++) {\n      if (this.loadingDeps_[i] == dep) {\n        this.loadingDeps_.splice(i, 1);\n        break;\n      }\n    }\n\n    for (var i = 0; i < this.deferredQueue_.length; i++) {\n      if (this.deferredQueue_[i] == dep.path) {\n        this.deferredQueue_.splice(i, 1);\n        break;\n      }\n    }\n\n    if (this.loadingDeps_.length == this.deferredQueue_.length &&\n        !this.depsToLoad_.length) {\n      // Something has asked to load these, but they may not be directly\n      // required again later, so load them now that we know we're done loading\n      // everything else. e.g. a goog module entry point.\n      while (this.deferredQueue_.length) {\n        this.requested(this.deferredQueue_.shift(), true);\n      }\n    }\n\n    dep.loaded();\n  };\n\n\n  /**\n   * @param {!Array<string>} pathsOrIds\n   * @return {boolean}\n   * @private\n   */\n  goog.DebugLoader_.prototype.areDepsLoaded_ = function(pathsOrIds) {\n    for (var i = 0; i < pathsOrIds.length; i++) {\n      var path = this.getPathFromDeps_(pathsOrIds[i]);\n      if (!path ||\n          (!(path in this.deferredCallbacks_) &&\n           !goog.isProvided_(pathsOrIds[i]))) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n\n  /**\n   * @param {string} absPathOrId\n   * @return {?string}\n   * @private\n   */\n  goog.DebugLoader_.prototype.getPathFromDeps_ = function(absPathOrId) {\n    if (absPathOrId in this.idToPath_) {\n      return this.idToPath_[absPathOrId];\n    } else if (absPathOrId in this.dependencies_) {\n      return absPathOrId;\n    } else {\n      return null;\n    }\n  };\n\n\n  /**\n   * @param {!goog.Dependency} dependency\n   * @param {!Function} callback\n   * @private\n   */\n  goog.DebugLoader_.prototype.defer_ = function(dependency, callback) {\n    this.deferredCallbacks_[dependency.path] = callback;\n    this.deferredQueue_.push(dependency.path);\n  };\n\n\n  /**\n   * Interface for goog.Dependency implementations to have some control over\n   * loading of dependencies.\n   *\n   * @record\n   */\n  goog.LoadController = function() {};\n\n\n  /**\n   * Tells the controller to halt loading of more dependencies.\n   */\n  goog.LoadController.prototype.pause = function() {};\n\n\n  /**\n   * Tells the controller to resume loading of more dependencies if paused.\n   */\n  goog.LoadController.prototype.resume = function() {};\n\n\n  /**\n   * Tells the controller that this dependency has finished loading.\n   *\n   * This causes this to be removed from pending() and any load callbacks to\n   * fire.\n   */\n  goog.LoadController.prototype.loaded = function() {};\n\n\n  /**\n   * List of dependencies on which load has been called but which have not\n   * called loaded on their controller. This includes the current dependency.\n   *\n   * @return {!Array<!goog.Dependency>}\n   */\n  goog.LoadController.prototype.pending = function() {};\n\n\n  /**\n   * Registers an object as an ES6 module's exports so that goog.modules may\n   * require it by path.\n   *\n   * @param {string} path Full path of the module.\n   * @param {?} exports\n   * @param {string=} opt_closureNamespace Closure namespace to associate with\n   *     this module.\n   */\n  goog.LoadController.prototype.registerEs6ModuleExports = function(\n      path, exports, opt_closureNamespace) {};\n\n\n  /**\n   * Sets the current module state.\n   *\n   * @param {goog.ModuleType} type Type of module.\n   */\n  goog.LoadController.prototype.setModuleState = function(type) {};\n\n\n  /**\n   * Clears the current module state.\n   */\n  goog.LoadController.prototype.clearModuleState = function() {};\n\n\n  /**\n   * Registers a callback to call once the dependency is actually requested\n   * via goog.require + all of the immediate dependencies have been loaded or\n   * all other files have been loaded. Allows for lazy loading until\n   * require'd without pausing dependency loading, which is needed on old IE.\n   *\n   * @param {!Function} callback\n   */\n  goog.LoadController.prototype.defer = function(callback) {};\n\n\n  /**\n   * @return {boolean}\n   */\n  goog.LoadController.prototype.areDepsLoaded = function() {};\n\n\n  /**\n   * Basic super class for all dependencies Closure Library can load.\n   *\n   * This default implementation is designed to load untranspiled, non-module\n   * scripts in a web broswer.\n   *\n   * For transpiled non-goog.module files {@see goog.TranspiledDependency}.\n   * For goog.modules see {@see goog.GoogModuleDependency}.\n   * For untranspiled ES6 modules {@see goog.Es6ModuleDependency}.\n   *\n   * @param {string} path Absolute path of this script.\n   * @param {string} relativePath Path of this script relative to goog.basePath.\n   * @param {!Array<string>} provides goog.provided or goog.module symbols\n   *     in this file.\n   * @param {!Array<string>} requires goog symbols or relative paths to Closure\n   *     this depends on.\n   * @param {!Object<string, string>} loadFlags\n   * @struct @constructor\n   */\n  goog.Dependency = function(\n      path, relativePath, provides, requires, loadFlags) {\n    /** @const */\n    this.path = path;\n    /** @const */\n    this.relativePath = relativePath;\n    /** @const */\n    this.provides = provides;\n    /** @const */\n    this.requires = requires;\n    /** @const */\n    this.loadFlags = loadFlags;\n    /** @private {boolean} */\n    this.loaded_ = false;\n    /** @private {!Array<function()>} */\n    this.loadCallbacks_ = [];\n  };\n\n\n  /**\n   * @return {string} The pathname part of this dependency's path if it is a\n   *     URI.\n   */\n  goog.Dependency.prototype.getPathName = function() {\n    var pathName = this.path;\n    var protocolIndex = pathName.indexOf('://');\n    if (protocolIndex >= 0) {\n      pathName = pathName.substring(protocolIndex + 3);\n      var slashIndex = pathName.indexOf('/');\n      if (slashIndex >= 0) {\n        pathName = pathName.substring(slashIndex + 1);\n      }\n    }\n    return pathName;\n  };\n\n\n  /**\n   * @param {function()} callback Callback to fire as soon as this has loaded.\n   * @final\n   */\n  goog.Dependency.prototype.onLoad = function(callback) {\n    if (this.loaded_) {\n      callback();\n    } else {\n      this.loadCallbacks_.push(callback);\n    }\n  };\n\n\n  /**\n   * Marks this dependency as loaded and fires any callbacks registered with\n   * onLoad.\n   * @final\n   */\n  goog.Dependency.prototype.loaded = function() {\n    this.loaded_ = true;\n    var callbacks = this.loadCallbacks_;\n    this.loadCallbacks_ = [];\n    for (var i = 0; i < callbacks.length; i++) {\n      callbacks[i]();\n    }\n  };\n\n\n  /**\n   * Whether or not document.written / appended script tags should be deferred.\n   *\n   * @private {boolean}\n   */\n  goog.Dependency.defer_ = false;\n\n\n  /**\n   * Map of script ready / state change callbacks. Old IE cannot handle putting\n   * these properties on goog.global.\n   *\n   * @private @const {!Object<string, function(?):undefined>}\n   */\n  goog.Dependency.callbackMap_ = {};\n\n\n  /**\n   * @param {function(...?):?} callback\n   * @return {string}\n   * @private\n   */\n  goog.Dependency.registerCallback_ = function(callback) {\n    var key = Math.random().toString(32);\n    goog.Dependency.callbackMap_[key] = callback;\n    return key;\n  };\n\n\n  /**\n   * @param {string} key\n   * @private\n   */\n  goog.Dependency.unregisterCallback_ = function(key) {\n    delete goog.Dependency.callbackMap_[key];\n  };\n\n\n  /**\n   * @param {string} key\n   * @param {...?} var_args\n   * @private\n   * @suppress {unusedPrivateMembers}\n   */\n  goog.Dependency.callback_ = function(key, var_args) {\n    if (key in goog.Dependency.callbackMap_) {\n      var callback = goog.Dependency.callbackMap_[key];\n      var args = [];\n      for (var i = 1; i < arguments.length; i++) {\n        args.push(arguments[i]);\n      }\n      callback.apply(undefined, args);\n    } else {\n      var errorMessage = 'Callback key ' + key +\n          ' does not exist (was base.js loaded more than once?).';\n      throw Error(errorMessage);\n    }\n  };\n\n\n  /**\n   * Starts loading this dependency. This dependency can pause loading if it\n   * needs to and resume it later via the controller interface.\n   *\n   * When this is loaded it should call controller.loaded(). Note that this will\n   * end up calling the loaded method of this dependency; there is no need to\n   * call it explicitly.\n   *\n   * @param {!goog.LoadController} controller\n   */\n  goog.Dependency.prototype.load = function(controller) {\n    if (goog.global.CLOSURE_IMPORT_SCRIPT) {\n      if (goog.global.CLOSURE_IMPORT_SCRIPT(this.path)) {\n        controller.loaded();\n      } else {\n        controller.pause();\n      }\n      return;\n    }\n\n    if (!goog.inHtmlDocument_()) {\n      goog.logToConsole_(\n          'Cannot use default debug loader outside of HTML documents.');\n      if (this.relativePath == 'deps.js') {\n        // Some old code is relying on base.js auto loading deps.js failing with\n        // no error before later setting CLOSURE_IMPORT_SCRIPT.\n        // CLOSURE_IMPORT_SCRIPT should be set *before* base.js is loaded, or\n        // CLOSURE_NO_DEPS set to true.\n        goog.logToConsole_(\n            'Consider setting CLOSURE_IMPORT_SCRIPT before loading base.js, ' +\n            'or setting CLOSURE_NO_DEPS to true.');\n        controller.loaded();\n      } else {\n        controller.pause();\n      }\n      return;\n    }\n\n    /** @type {!HTMLDocument} */\n    var doc = goog.global.document;\n\n    // If the user tries to require a new symbol after document load,\n    // something has gone terribly wrong. Doing a document.write would\n    // wipe out the page. This does not apply to the CSP-compliant method\n    // of writing script tags.\n    if (doc.readyState == 'complete' &&\n        !goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING) {\n      // Certain test frameworks load base.js multiple times, which tries\n      // to write deps.js each time. If that happens, just fail silently.\n      // These frameworks wipe the page between each load of base.js, so this\n      // is OK.\n      var isDeps = /\\bdeps.js$/.test(this.path);\n      if (isDeps) {\n        controller.loaded();\n        return;\n      } else {\n        throw Error('Cannot write \"' + this.path + '\" after document load');\n      }\n    }\n\n    if (!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING &&\n        goog.isDocumentLoading_()) {\n      var key = goog.Dependency.registerCallback_(function(script) {\n        if (!goog.DebugLoader_.IS_OLD_IE_ || script.readyState == 'complete') {\n          goog.Dependency.unregisterCallback_(key);\n          controller.loaded();\n        }\n      });\n      var nonceAttr = !goog.DebugLoader_.IS_OLD_IE_ && goog.getScriptNonce() ?\n          ' nonce=\"' + goog.getScriptNonce() + '\"' :\n          '';\n      var event =\n          goog.DebugLoader_.IS_OLD_IE_ ? 'onreadystatechange' : 'onload';\n      var defer = goog.Dependency.defer_ ? 'defer' : '';\n      doc.write(\n          '<script src=\"' + this.path + '\" ' + event +\n          '=\"goog.Dependency.callback_(\\'' + key +\n          '\\', this)\" type=\"text/javascript\" ' + defer + nonceAttr + '><' +\n          '/script>');\n    } else {\n      var scriptEl =\n          /** @type {!HTMLScriptElement} */ (doc.createElement('script'));\n      scriptEl.defer = goog.Dependency.defer_;\n      scriptEl.async = false;\n      scriptEl.type = 'text/javascript';\n\n      // If CSP nonces are used, propagate them to dynamically created scripts.\n      // This is necessary to allow nonce-based CSPs without 'strict-dynamic'.\n      var nonce = goog.getScriptNonce();\n      if (nonce) {\n        scriptEl.setAttribute('nonce', nonce);\n      }\n\n      if (goog.DebugLoader_.IS_OLD_IE_) {\n        // Execution order is not guaranteed on old IE, halt loading and write\n        // these scripts one at a time, after each loads.\n        controller.pause();\n        scriptEl.onreadystatechange = function() {\n          if (scriptEl.readyState == 'loaded' ||\n              scriptEl.readyState == 'complete') {\n            controller.loaded();\n            controller.resume();\n          }\n        };\n      } else {\n        scriptEl.onload = function() {\n          scriptEl.onload = null;\n          controller.loaded();\n        };\n      }\n\n      scriptEl.src = this.path;\n      doc.head.appendChild(scriptEl);\n    }\n  };\n\n\n  /**\n   * @param {string} path Absolute path of this script.\n   * @param {string} relativePath Path of this script relative to goog.basePath.\n   * @param {!Array<string>} provides Should be an empty array.\n   *     TODO(johnplaisted) add support for adding closure namespaces to ES6\n   *     modules for interop purposes.\n   * @param {!Array<string>} requires goog symbols or relative paths to Closure\n   *     this depends on.\n   * @param {!Object<string, string>} loadFlags\n   * @struct @constructor\n   * @extends {goog.Dependency}\n   */\n  goog.Es6ModuleDependency = function(\n      path, relativePath, provides, requires, loadFlags) {\n    goog.Es6ModuleDependency.base(\n        this, 'constructor', path, relativePath, provides, requires, loadFlags);\n  };\n  goog.inherits(goog.Es6ModuleDependency, goog.Dependency);\n\n\n  /** @override */\n  goog.Es6ModuleDependency.prototype.load = function(controller) {\n    if (goog.global.CLOSURE_IMPORT_SCRIPT) {\n      if (goog.global.CLOSURE_IMPORT_SCRIPT(this.path)) {\n        controller.loaded();\n      } else {\n        controller.pause();\n      }\n      return;\n    }\n\n    if (!goog.inHtmlDocument_()) {\n      goog.logToConsole_(\n          'Cannot use default debug loader outside of HTML documents.');\n      controller.pause();\n      return;\n    }\n\n    /** @type {!HTMLDocument} */\n    var doc = goog.global.document;\n\n    var dep = this;\n\n    // TODO(johnplaisted): Does document.writing really speed up anything? Any\n    // difference between this and just waiting for interactive mode and then\n    // appending?\n    function write(src, contents) {\n      if (contents) {\n        doc.write(\n            '<script type=\"module\" crossorigin>' + contents + '</' +\n            'script>');\n      } else {\n        doc.write(\n            '<script type=\"module\" crossorigin src=\"' + src + '\"></' +\n            'script>');\n      }\n    }\n\n    function append(src, contents) {\n      var scriptEl =\n          /** @type {!HTMLScriptElement} */ (doc.createElement('script'));\n      scriptEl.defer = true;\n      scriptEl.async = false;\n      scriptEl.type = 'module';\n      scriptEl.setAttribute('crossorigin', true);\n\n      // If CSP nonces are used, propagate them to dynamically created scripts.\n      // This is necessary to allow nonce-based CSPs without 'strict-dynamic'.\n      var nonce = goog.getScriptNonce();\n      if (nonce) {\n        scriptEl.setAttribute('nonce', nonce);\n      }\n\n      if (contents) {\n        scriptEl.textContent = contents;\n      } else {\n        scriptEl.src = src;\n      }\n\n      doc.head.appendChild(scriptEl);\n    }\n\n    var create;\n\n    if (goog.isDocumentLoading_()) {\n      create = write;\n      // We can ONLY call document.write if we are guaranteed that any\n      // non-module script tags document.written after this are deferred.\n      // Small optimization, in theory document.writing is faster.\n      goog.Dependency.defer_ = true;\n    } else {\n      create = append;\n    }\n\n    // Write 4 separate tags here:\n    // 1) Sets the module state at the correct time (just before execution).\n    // 2) A src node for this, which just hopefully lets the browser load it a\n    //    little early (no need to parse #3).\n    // 3) Import the module and register it.\n    // 4) Clear the module state at the correct time. Guarnteed to run even\n    //    if there is an error in the module (#3 will not run if there is an\n    //    error in the module).\n    var beforeKey = goog.Dependency.registerCallback_(function() {\n      goog.Dependency.unregisterCallback_(beforeKey);\n      controller.setModuleState(goog.ModuleType.ES6);\n    });\n    create(undefined, 'goog.Dependency.callback_(\"' + beforeKey + '\")');\n\n    // TODO(johnplaisted): Does this really speed up anything?\n    create(this.path, undefined);\n\n    var registerKey = goog.Dependency.registerCallback_(function(exports) {\n      goog.Dependency.unregisterCallback_(registerKey);\n      controller.registerEs6ModuleExports(\n          dep.path, exports, goog.moduleLoaderState_.moduleName);\n    });\n    create(\n        undefined,\n        'import * as m from \"' + this.path + '\"; goog.Dependency.callback_(\"' +\n            registerKey + '\", m)');\n\n    var afterKey = goog.Dependency.registerCallback_(function() {\n      goog.Dependency.unregisterCallback_(afterKey);\n      controller.clearModuleState();\n      controller.loaded();\n    });\n    create(undefined, 'goog.Dependency.callback_(\"' + afterKey + '\")');\n  };\n\n\n  /**\n   * Superclass of any dependency that needs to be loaded into memory,\n   * transformed, and then eval'd (goog.modules and transpiled files).\n   *\n   * @param {string} path Absolute path of this script.\n   * @param {string} relativePath Path of this script relative to goog.basePath.\n   * @param {!Array<string>} provides goog.provided or goog.module symbols\n   *     in this file.\n   * @param {!Array<string>} requires goog symbols or relative paths to Closure\n   *     this depends on.\n   * @param {!Object<string, string>} loadFlags\n   * @struct @constructor @abstract\n   * @extends {goog.Dependency}\n   */\n  goog.TransformedDependency = function(\n      path, relativePath, provides, requires, loadFlags) {\n    goog.TransformedDependency.base(\n        this, 'constructor', path, relativePath, provides, requires, loadFlags);\n    /** @private {?string} */\n    this.contents_ = null;\n\n    /**\n     * Whether to lazily make the synchronous XHR (when goog.require'd) or make\n     * the synchronous XHR when initially loading. On FireFox 61 there is a bug\n     * where an ES6 module cannot make a synchronous XHR (rather, it can, but if\n     * it does then no other ES6 modules will load after).\n     *\n     * tl;dr we lazy load due to bugs on older browsers and eager load due to\n     * bugs on newer ones.\n     *\n     * https://bugzilla.mozilla.org/show_bug.cgi?id=1477090\n     *\n     * @private @const {boolean}\n     */\n    this.lazyFetch_ = !goog.inHtmlDocument_() ||\n        !('noModule' in goog.global.document.createElement('script'));\n  };\n  goog.inherits(goog.TransformedDependency, goog.Dependency);\n\n\n  /** @override */\n  goog.TransformedDependency.prototype.load = function(controller) {\n    var dep = this;\n\n    function fetch() {\n      dep.contents_ = goog.loadFileSync_(dep.path);\n\n      if (dep.contents_) {\n        dep.contents_ = dep.transform(dep.contents_);\n        if (dep.contents_) {\n          dep.contents_ += '\\n//# sourceURL=' + dep.path;\n        }\n      }\n    }\n\n    if (goog.global.CLOSURE_IMPORT_SCRIPT) {\n      fetch();\n      if (this.contents_ &&\n          goog.global.CLOSURE_IMPORT_SCRIPT('', this.contents_)) {\n        this.contents_ = null;\n        controller.loaded();\n      } else {\n        controller.pause();\n      }\n      return;\n    }\n\n\n    var isEs6 = this.loadFlags['module'] == goog.ModuleType.ES6;\n\n    if (!this.lazyFetch_) {\n      fetch();\n    }\n\n    function load() {\n      if (dep.lazyFetch_) {\n        fetch();\n      }\n\n      if (!dep.contents_) {\n        // loadFileSync_ or transform are responsible. Assume they logged an\n        // error.\n        return;\n      }\n\n      if (isEs6) {\n        controller.setModuleState(goog.ModuleType.ES6);\n      }\n\n      var namespace;\n\n      try {\n        var contents = dep.contents_;\n        dep.contents_ = null;\n        goog.globalEval(contents);\n        if (isEs6) {\n          namespace = goog.moduleLoaderState_.moduleName;\n        }\n      } finally {\n        if (isEs6) {\n          controller.clearModuleState();\n        }\n      }\n\n      if (isEs6) {\n        // Due to circular dependencies this may not be available for require\n        // right now.\n        goog.global['$jscomp']['require']['ensure'](\n            [dep.getPathName()], function() {\n              controller.registerEs6ModuleExports(\n                  dep.path,\n                  goog.global['$jscomp']['require'](dep.getPathName()),\n                  namespace);\n            });\n      }\n\n      controller.loaded();\n    }\n\n    // Do not fetch now; in FireFox 47 the synchronous XHR doesn't block all\n    // events. If we fetched now and then document.write'd the contents the\n    // document.write would be an eval and would execute too soon! Instead write\n    // a script tag to fetch and eval synchronously at the correct time.\n    function fetchInOwnScriptThenLoad() {\n      /** @type {!HTMLDocument} */\n      var doc = goog.global.document;\n\n      var key = goog.Dependency.registerCallback_(function() {\n        goog.Dependency.unregisterCallback_(key);\n        load();\n      });\n\n      doc.write(\n          '<script type=\"text/javascript\">' +\n          goog.protectScriptTag_('goog.Dependency.callback_(\"' + key + '\");') +\n          '</' +\n          'script>');\n    }\n\n    // If one thing is pending it is this.\n    var anythingElsePending = controller.pending().length > 1;\n\n    // If anything else is loading we need to lazy load due to bugs in old IE.\n    // Specifically script tags with src and script tags with contents could\n    // execute out of order if document.write is used, so we cannot use\n    // document.write. Do not pause here; it breaks old IE as well.\n    var useOldIeWorkAround =\n        anythingElsePending && goog.DebugLoader_.IS_OLD_IE_;\n\n    // Additionally if we are meant to defer scripts but the page is still\n    // loading (e.g. an ES6 module is loading) then also defer. Or if we are\n    // meant to defer and anything else is pending then defer (those may be\n    // scripts that did not need transformation and are just script tags with\n    // defer set to true, and we need to evaluate after that deferred script).\n    var needsAsyncLoading = goog.Dependency.defer_ &&\n        (anythingElsePending || goog.isDocumentLoading_());\n\n    if (useOldIeWorkAround || needsAsyncLoading) {\n      // Note that we only defer when we have to rather than 100% of the time.\n      // Always defering would work, but then in theory the order of\n      // goog.require calls would then matter. We want to enforce that most of\n      // the time the order of the require calls does not matter.\n      controller.defer(function() {\n        load();\n      });\n      return;\n    }\n    // TODO(johnplaisted): Externs are missing onreadystatechange for\n    // HTMLDocument.\n    /** @type {?} */\n    var doc = goog.global.document;\n\n    var isInternetExplorer =\n        goog.inHtmlDocument_() && 'ActiveXObject' in goog.global;\n\n    // Don't delay in any version of IE. There's bug around this that will\n    // cause out of order script execution. This means that on older IE ES6\n    // modules will load too early (while the document is still loading + the\n    // dom is not available). The other option is to load too late (when the\n    // document is complete and the onload even will never fire). This seems\n    // to be the lesser of two evils as scripts already act like the former.\n    if (isEs6 && goog.inHtmlDocument_() && goog.isDocumentLoading_() &&\n        !isInternetExplorer) {\n      goog.Dependency.defer_ = true;\n      // Transpiled ES6 modules still need to load like regular ES6 modules,\n      // aka only after the document is interactive.\n      controller.pause();\n      var oldCallback = doc.onreadystatechange;\n      doc.onreadystatechange = function() {\n        if (doc.readyState == 'interactive') {\n          doc.onreadystatechange = oldCallback;\n          load();\n          controller.resume();\n        }\n        if (goog.isFunction(oldCallback)) {\n          oldCallback.apply(undefined, arguments);\n        }\n      };\n    } else {\n      // Always eval on old IE.\n      if (goog.DebugLoader_.IS_OLD_IE_ || !goog.inHtmlDocument_() ||\n          !goog.isDocumentLoading_()) {\n        load();\n      } else {\n        fetchInOwnScriptThenLoad();\n      }\n    }\n  };\n\n\n  /**\n   * @param {string} contents\n   * @return {string}\n   * @abstract\n   */\n  goog.TransformedDependency.prototype.transform = function(contents) {};\n\n\n  /**\n   * Any non-goog.module dependency which needs to be transpiled before eval.\n   *\n   * @param {string} path Absolute path of this script.\n   * @param {string} relativePath Path of this script relative to goog.basePath.\n   * @param {!Array<string>} provides goog.provided or goog.module symbols\n   *     in this file.\n   * @param {!Array<string>} requires goog symbols or relative paths to Closure\n   *     this depends on.\n   * @param {!Object<string, string>} loadFlags\n   * @param {!goog.Transpiler} transpiler\n   * @struct @constructor\n   * @extends {goog.TransformedDependency}\n   */\n  goog.TranspiledDependency = function(\n      path, relativePath, provides, requires, loadFlags, transpiler) {\n    goog.TranspiledDependency.base(\n        this, 'constructor', path, relativePath, provides, requires, loadFlags);\n    /** @protected @const*/\n    this.transpiler = transpiler;\n  };\n  goog.inherits(goog.TranspiledDependency, goog.TransformedDependency);\n\n\n  /** @override */\n  goog.TranspiledDependency.prototype.transform = function(contents) {\n    // Transpile with the pathname so that ES6 modules are domain agnostic.\n    return this.transpiler.transpile(contents, this.getPathName());\n  };\n\n\n  /**\n   * A goog.module, transpiled or not. Will always perform some minimal\n   * transformation even when not transpiled to wrap in a goog.loadModule\n   * statement.\n   *\n   * @param {string} path Absolute path of this script.\n   * @param {string} relativePath Path of this script relative to goog.basePath.\n   * @param {!Array<string>} provides goog.provided or goog.module symbols\n   *     in this file.\n   * @param {!Array<string>} requires goog symbols or relative paths to Closure\n   *     this depends on.\n   * @param {!Object<string, string>} loadFlags\n   * @param {boolean} needsTranspile\n   * @param {!goog.Transpiler} transpiler\n   * @struct @constructor\n   * @extends {goog.TransformedDependency}\n   */\n  goog.GoogModuleDependency = function(\n      path, relativePath, provides, requires, loadFlags, needsTranspile,\n      transpiler) {\n    goog.GoogModuleDependency.base(\n        this, 'constructor', path, relativePath, provides, requires, loadFlags);\n    /** @private @const */\n    this.needsTranspile_ = needsTranspile;\n    /** @private @const */\n    this.transpiler_ = transpiler;\n  };\n  goog.inherits(goog.GoogModuleDependency, goog.TransformedDependency);\n\n\n  /** @override */\n  goog.GoogModuleDependency.prototype.transform = function(contents) {\n    if (this.needsTranspile_) {\n      contents = this.transpiler_.transpile(contents, this.getPathName());\n    }\n\n    if (!goog.LOAD_MODULE_USING_EVAL || !goog.isDef(goog.global.JSON)) {\n      return '' +\n          'goog.loadModule(function(exports) {' +\n          '\"use strict\";' + contents +\n          '\\n' +  // terminate any trailing single line comment.\n          ';return exports' +\n          '});' +\n          '\\n//# sourceURL=' + this.path + '\\n';\n    } else {\n      return '' +\n          'goog.loadModule(' +\n          goog.global.JSON.stringify(\n              contents + '\\n//# sourceURL=' + this.path + '\\n') +\n          ');';\n    }\n  };\n\n\n  /**\n   * Whether the browser is IE9 or earlier, which needs special handling\n   * for deferred modules.\n   * @const @private {boolean}\n   */\n  goog.DebugLoader_.IS_OLD_IE_ =\n      !!(!goog.global.atob && goog.global.document && goog.global.document.all);\n\n\n  /**\n   * @param {string} relPath\n   * @param {!Array<string>|undefined} provides\n   * @param {!Array<string>} requires\n   * @param {boolean|!Object<string>=} opt_loadFlags\n   * @see goog.addDependency\n   */\n  goog.DebugLoader_.prototype.addDependency = function(\n      relPath, provides, requires, opt_loadFlags) {\n    provides = provides || [];\n    relPath = relPath.replace(/\\\\/g, '/');\n    var path = goog.normalizePath_(goog.basePath + relPath);\n    if (!opt_loadFlags || typeof opt_loadFlags === 'boolean') {\n      opt_loadFlags = opt_loadFlags ? {'module': goog.ModuleType.GOOG} : {};\n    }\n    var dep = this.factory_.createDependency(\n        path, relPath, provides, requires, opt_loadFlags,\n        goog.transpiler_.needsTranspile(\n            opt_loadFlags['lang'] || 'es3', opt_loadFlags['module']));\n    this.dependencies_[path] = dep;\n    for (var i = 0; i < provides.length; i++) {\n      this.idToPath_[provides[i]] = path;\n    }\n    this.idToPath_[relPath] = path;\n  };\n\n\n  /**\n   * Creates goog.Dependency instances for the debug loader to load.\n   *\n   * Should be overridden to have the debug loader use custom subclasses of\n   * goog.Dependency.\n   *\n   * @param {!goog.Transpiler} transpiler\n   * @struct @constructor\n   */\n  goog.DependencyFactory = function(transpiler) {\n    /** @protected @const */\n    this.transpiler = transpiler;\n  };\n\n\n  /**\n   * @param {string} path Absolute path of the file.\n   * @param {string} relativePath Path relative to closure\u2019s base.js.\n   * @param {!Array<string>} provides Array of provided goog.provide/module ids.\n   * @param {!Array<string>} requires Array of required goog.provide/module /\n   *     relative ES6 module paths.\n   * @param {!Object<string, string>} loadFlags\n   * @param {boolean} needsTranspile True if the file needs to be transpiled\n   *     per the goog.Transpiler.\n   * @return {!goog.Dependency}\n   */\n  goog.DependencyFactory.prototype.createDependency = function(\n      path, relativePath, provides, requires, loadFlags, needsTranspile) {\n\n    if (loadFlags['module'] == goog.ModuleType.GOOG) {\n      return new goog.GoogModuleDependency(\n          path, relativePath, provides, requires, loadFlags, needsTranspile,\n          this.transpiler);\n    } else if (needsTranspile) {\n      return new goog.TranspiledDependency(\n          path, relativePath, provides, requires, loadFlags, this.transpiler);\n    } else {\n      if (loadFlags['module'] == goog.ModuleType.ES6) {\n        return new goog.Es6ModuleDependency(\n            path, relativePath, provides, requires, loadFlags);\n      } else {\n        return new goog.Dependency(\n            path, relativePath, provides, requires, loadFlags);\n      }\n    }\n  };\n\n\n  /** @private @const */\n  goog.debugLoader_ = new goog.DebugLoader_();\n\n\n  /**\n   * Loads the Closure Dependency file.\n   *\n   * Exposed a public function so CLOSURE_NO_DEPS can be set to false, base\n   * loaded, setDependencyFactory called, and then this called. i.e. allows\n   * custom loading of the deps file.\n   */\n  goog.loadClosureDeps = function() {\n    goog.debugLoader_.loadClosureDeps();\n  };\n\n\n  /**\n   * Sets the dependency factory, which can be used to create custom\n   * goog.Dependency implementations to control how dependencies are loaded.\n   *\n   * Note: if you wish to call this function and provide your own implemnetation\n   * it is a wise idea to set CLOSURE_NO_DEPS to true, otherwise the dependency\n   * file and all of its goog.addDependency calls will use the default factory.\n   * You can call goog.loadClosureDeps to load the Closure dependency file\n   * later, after your factory is injected.\n   *\n   * @param {!goog.DependencyFactory} factory\n   */\n  goog.setDependencyFactory = function(factory) {\n    goog.debugLoader_.setDependencyFactory(factory);\n  };\n\n\n  if (!goog.global.CLOSURE_NO_DEPS) {\n    goog.debugLoader_.loadClosureDeps();\n  }\n\n\n  /**\n   * Bootstraps the given namespaces and calls the callback once they are\n   * available either via goog.require. This is a replacement for using\n   * `goog.require` to bootstrap Closure JavaScript. Previously a `goog.require`\n   * in an HTML file would guarantee that the require'd namespace was available\n   * in the next immediate script tag. With ES6 modules this no longer a\n   * guarantee.\n   *\n   * @param {!Array<string>} namespaces\n   * @param {function(): ?} callback Function to call once all the namespaces\n   *     have loaded. Always called asynchronously.\n   */\n  goog.bootstrap = function(namespaces, callback) {\n    goog.debugLoader_.bootstrap(namespaces, callback);\n  };\n}\n","// Copyright 2009 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Provides a base class for custom Error objects such that the\n * stack is correctly maintained.\n *\n * You should never need to throw goog.debug.Error(msg) directly, Error(msg) is\n * sufficient.\n *\n */\n\ngoog.provide('goog.debug.Error');\n\n\n\n/**\n * Base class for custom error objects.\n * @param {*=} opt_msg The message associated with the error.\n * @constructor\n * @extends {Error}\n */\ngoog.debug.Error = function(opt_msg) {\n\n  // Attempt to ensure there is a stack trace.\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, goog.debug.Error);\n  } else {\n    var stack = new Error().stack;\n    if (stack) {\n      /** @override */\n      this.stack = stack;\n    }\n  }\n\n  if (opt_msg) {\n    /** @override */\n    this.message = String(opt_msg);\n  }\n\n  /**\n   * Whether to report this error to the server. Setting this to false will\n   * cause the error reporter to not report the error back to the server,\n   * which can be useful if the client knows that the error has already been\n   * logged on the server.\n   * @type {boolean}\n   */\n  this.reportErrorToServer = true;\n};\ngoog.inherits(goog.debug.Error, Error);\n\n\n/** @override */\ngoog.debug.Error.prototype.name = 'CustomError';\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Definition of goog.dom.NodeType.\n */\n\ngoog.provide('goog.dom.NodeType');\n\n\n/**\n * Constants for the nodeType attribute in the Node interface.\n *\n * These constants match those specified in the Node interface. These are\n * usually present on the Node object in recent browsers, but not in older\n * browsers (specifically, early IEs) and thus are given here.\n *\n * In some browsers (early IEs), these are not defined on the Node object,\n * so they are provided here.\n *\n * See http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1950641247\n * @enum {number}\n */\ngoog.dom.NodeType = {\n  ELEMENT: 1,\n  ATTRIBUTE: 2,\n  TEXT: 3,\n  CDATA_SECTION: 4,\n  ENTITY_REFERENCE: 5,\n  ENTITY: 6,\n  PROCESSING_INSTRUCTION: 7,\n  COMMENT: 8,\n  DOCUMENT: 9,\n  DOCUMENT_TYPE: 10,\n  DOCUMENT_FRAGMENT: 11,\n  NOTATION: 12\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities to check the preconditions, postconditions and\n * invariants runtime.\n *\n * Methods in this package should be given special treatment by the compiler\n * for type-inference. For example, <code>goog.asserts.assert(foo)</code>\n * will restrict <code>foo</code> to a truthy value.\n *\n * The compiler has an option to disable asserts. So code like:\n * <code>\n * var x = goog.asserts.assert(foo()); goog.asserts.assert(bar());\n * </code>\n * will be transformed into:\n * <code>\n * var x = foo();\n * </code>\n * The compiler will leave in foo() (because its return value is used),\n * but it will remove bar() because it assumes it does not have side-effects.\n *\n * @author agrieve@google.com (Andrew Grieve)\n */\n\ngoog.provide('goog.asserts');\ngoog.provide('goog.asserts.AssertionError');\n\ngoog.require('goog.debug.Error');\ngoog.require('goog.dom.NodeType');\n\n\n/**\n * @define {boolean} Whether to strip out asserts or to leave them in.\n */\ngoog.define('goog.asserts.ENABLE_ASSERTS', goog.DEBUG);\n\n\n\n/**\n * Error object for failed assertions.\n * @param {string} messagePattern The pattern that was used to form message.\n * @param {!Array<*>} messageArgs The items to substitute into the pattern.\n * @constructor\n * @extends {goog.debug.Error}\n * @final\n */\ngoog.asserts.AssertionError = function(messagePattern, messageArgs) {\n  goog.debug.Error.call(this, goog.asserts.subs_(messagePattern, messageArgs));\n\n  /**\n   * The message pattern used to format the error message. Error handlers can\n   * use this to uniquely identify the assertion.\n   * @type {string}\n   */\n  this.messagePattern = messagePattern;\n};\ngoog.inherits(goog.asserts.AssertionError, goog.debug.Error);\n\n\n/** @override */\ngoog.asserts.AssertionError.prototype.name = 'AssertionError';\n\n\n/**\n * The default error handler.\n * @param {!goog.asserts.AssertionError} e The exception to be handled.\n */\ngoog.asserts.DEFAULT_ERROR_HANDLER = function(e) {\n  throw e;\n};\n\n\n/**\n * The handler responsible for throwing or logging assertion errors.\n * @private {function(!goog.asserts.AssertionError)}\n */\ngoog.asserts.errorHandler_ = goog.asserts.DEFAULT_ERROR_HANDLER;\n\n\n/**\n * Does simple python-style string substitution.\n * subs(\"foo%s hot%s\", \"bar\", \"dog\") becomes \"foobar hotdog\".\n * @param {string} pattern The string containing the pattern.\n * @param {!Array<*>} subs The items to substitute into the pattern.\n * @return {string} A copy of `str` in which each occurrence of\n *     {@code %s} has been replaced an argument from `var_args`.\n * @private\n */\ngoog.asserts.subs_ = function(pattern, subs) {\n  var splitParts = pattern.split('%s');\n  var returnString = '';\n\n  // Replace up to the last split part. We are inserting in the\n  // positions between split parts.\n  var subLast = splitParts.length - 1;\n  for (var i = 0; i < subLast; i++) {\n    // keep unsupplied as '%s'\n    var sub = (i < subs.length) ? subs[i] : '%s';\n    returnString += splitParts[i] + sub;\n  }\n  return returnString + splitParts[subLast];\n};\n\n\n/**\n * Throws an exception with the given message and \"Assertion failed\" prefixed\n * onto it.\n * @param {string} defaultMessage The message to use if givenMessage is empty.\n * @param {Array<*>} defaultArgs The substitution arguments for defaultMessage.\n * @param {string|undefined} givenMessage Message supplied by the caller.\n * @param {Array<*>} givenArgs The substitution arguments for givenMessage.\n * @throws {goog.asserts.AssertionError} When the value is not a number.\n * @private\n */\ngoog.asserts.doAssertFailure_ = function(\n    defaultMessage, defaultArgs, givenMessage, givenArgs) {\n  var message = 'Assertion failed';\n  if (givenMessage) {\n    message += ': ' + givenMessage;\n    var args = givenArgs;\n  } else if (defaultMessage) {\n    message += ': ' + defaultMessage;\n    args = defaultArgs;\n  }\n  // The '' + works around an Opera 10 bug in the unit tests. Without it,\n  // a stack trace is added to var message above. With this, a stack trace is\n  // not added until this line (it causes the extra garbage to be added after\n  // the assertion message instead of in the middle of it).\n  var e = new goog.asserts.AssertionError('' + message, args || []);\n  goog.asserts.errorHandler_(e);\n};\n\n\n/**\n * Sets a custom error handler that can be used to customize the behavior of\n * assertion failures, for example by turning all assertion failures into log\n * messages.\n * @param {function(!goog.asserts.AssertionError)} errorHandler\n */\ngoog.asserts.setErrorHandler = function(errorHandler) {\n  if (goog.asserts.ENABLE_ASSERTS) {\n    goog.asserts.errorHandler_ = errorHandler;\n  }\n};\n\n\n/**\n * Checks if the condition evaluates to true if goog.asserts.ENABLE_ASSERTS is\n * true.\n * @template T\n * @param {T} condition The condition to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {T} The value of the condition.\n * @throws {goog.asserts.AssertionError} When the condition evaluates to false.\n */\ngoog.asserts.assert = function(condition, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !condition) {\n    goog.asserts.doAssertFailure_(\n        '', null, opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return condition;\n};\n\n\n/**\n * Fails if goog.asserts.ENABLE_ASSERTS is true. This function is useful in case\n * when we want to add a check in the unreachable area like switch-case\n * statement:\n *\n * <pre>\n *  switch(type) {\n *    case FOO: doSomething(); break;\n *    case BAR: doSomethingElse(); break;\n *    default: goog.asserts.fail('Unrecognized type: ' + type);\n *      // We have only 2 types - \"default:\" section is unreachable code.\n *  }\n * </pre>\n *\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @throws {goog.asserts.AssertionError} Failure.\n */\ngoog.asserts.fail = function(opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS) {\n    goog.asserts.errorHandler_(\n        new goog.asserts.AssertionError(\n            'Failure' + (opt_message ? ': ' + opt_message : ''),\n            Array.prototype.slice.call(arguments, 1)));\n  }\n};\n\n\n/**\n * Checks if the value is a number if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {number} The value, guaranteed to be a number when asserts enabled.\n * @throws {goog.asserts.AssertionError} When the value is not a number.\n */\ngoog.asserts.assertNumber = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isNumber(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected number but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {number} */ (value);\n};\n\n\n/**\n * Checks if the value is a string if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {string} The value, guaranteed to be a string when asserts enabled.\n * @throws {goog.asserts.AssertionError} When the value is not a string.\n */\ngoog.asserts.assertString = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isString(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected string but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {string} */ (value);\n};\n\n\n/**\n * Checks if the value is a function if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {!Function} The value, guaranteed to be a function when asserts\n *     enabled.\n * @throws {goog.asserts.AssertionError} When the value is not a function.\n */\ngoog.asserts.assertFunction = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isFunction(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected function but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {!Function} */ (value);\n};\n\n\n/**\n * Checks if the value is an Object if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {!Object} The value, guaranteed to be a non-null object.\n * @throws {goog.asserts.AssertionError} When the value is not an object.\n */\ngoog.asserts.assertObject = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isObject(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected object but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {!Object} */ (value);\n};\n\n\n/**\n * Checks if the value is an Array if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {!Array<?>} The value, guaranteed to be a non-null array.\n * @throws {goog.asserts.AssertionError} When the value is not an array.\n */\ngoog.asserts.assertArray = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isArray(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected array but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {!Array<?>} */ (value);\n};\n\n\n/**\n * Checks if the value is a boolean if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {boolean} The value, guaranteed to be a boolean when asserts are\n *     enabled.\n * @throws {goog.asserts.AssertionError} When the value is not a boolean.\n */\ngoog.asserts.assertBoolean = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !goog.isBoolean(value)) {\n    goog.asserts.doAssertFailure_(\n        'Expected boolean but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {boolean} */ (value);\n};\n\n\n/**\n * Checks if the value is a DOM Element if goog.asserts.ENABLE_ASSERTS is true.\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @return {!Element} The value, likely to be a DOM Element when asserts are\n *     enabled.\n * @throws {goog.asserts.AssertionError} When the value is not an Element.\n */\ngoog.asserts.assertElement = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS &&\n      (!goog.isObject(value) || value.nodeType != goog.dom.NodeType.ELEMENT)) {\n    goog.asserts.doAssertFailure_(\n        'Expected Element but got %s: %s.', [goog.typeOf(value), value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {!Element} */ (value);\n};\n\n\n/**\n * Checks if the value is an instance of the user-defined type if\n * goog.asserts.ENABLE_ASSERTS is true.\n *\n * The compiler may tighten the type returned by this function.\n *\n * @param {?} value The value to check.\n * @param {function(new: T, ...)} type A user-defined constructor.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @throws {goog.asserts.AssertionError} When the value is not an instance of\n *     type.\n * @return {T}\n * @template T\n */\ngoog.asserts.assertInstanceof = function(value, type, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS && !(value instanceof type)) {\n    goog.asserts.doAssertFailure_(\n        'Expected instanceof %s but got %s.',\n        [goog.asserts.getType_(type), goog.asserts.getType_(value)],\n        opt_message, Array.prototype.slice.call(arguments, 3));\n  }\n  return value;\n};\n\n\n/**\n * Checks whether the value is a finite number, if goog.asserts.ENABLE_ASSERTS\n * is true.\n *\n * @param {*} value The value to check.\n * @param {string=} opt_message Error message in case of failure.\n * @param {...*} var_args The items to substitute into the failure message.\n * @throws {goog.asserts.AssertionError} When the value is not a number, or is\n *     a non-finite number such as NaN, Infinity or -Infinity.\n * @return {number} The value initially passed in.\n */\ngoog.asserts.assertFinite = function(value, opt_message, var_args) {\n  if (goog.asserts.ENABLE_ASSERTS &&\n      (typeof value != 'number' || !isFinite(value))) {\n    goog.asserts.doAssertFailure_(\n        'Expected %s to be a finite number but it is not.', [value],\n        opt_message, Array.prototype.slice.call(arguments, 2));\n  }\n  return /** @type {number} */ (value);\n};\n\n/**\n * Checks that no enumerable keys are present in Object.prototype. Such keys\n * would break most code that use {@code for (var ... in ...)} loops.\n */\ngoog.asserts.assertObjectPrototypeIsIntact = function() {\n  for (var key in Object.prototype) {\n    goog.asserts.fail(key + ' should not be enumerable in Object.prototype.');\n  }\n};\n\n\n/**\n * Returns the type of a value. If a constructor is passed, and a suitable\n * string cannot be found, 'unknown type name' will be returned.\n * @param {*} value A constructor, object, or primitive.\n * @return {string} The best display name for the value, or 'unknown type name'.\n * @private\n */\ngoog.asserts.getType_ = function(value) {\n  if (value instanceof Function) {\n    return value.displayName || value.name || 'unknown type name';\n  } else if (value instanceof Object) {\n    return /** @type {string} */ (value.constructor.displayName) ||\n        value.constructor.name || Object.prototype.toString.call(value);\n  } else {\n    return value === null ? 'null' : typeof value;\n  }\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for manipulating arrays.\n *\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\ngoog.provide('goog.array');\n\ngoog.require('goog.asserts');\n\n\n/**\n * @define {boolean} NATIVE_ARRAY_PROTOTYPES indicates whether the code should\n * rely on Array.prototype functions, if available.\n *\n * The Array.prototype functions can be defined by external libraries like\n * Prototype and setting this flag to false forces closure to use its own\n * goog.array implementation.\n *\n * If your javascript can be loaded by a third party site and you are wary about\n * relying on the prototype functions, specify\n * \"--define goog.NATIVE_ARRAY_PROTOTYPES=false\" to the JSCompiler.\n *\n * Setting goog.TRUSTED_SITE to false will automatically set\n * NATIVE_ARRAY_PROTOTYPES to false.\n */\ngoog.define('goog.NATIVE_ARRAY_PROTOTYPES', goog.TRUSTED_SITE);\n\n\n/**\n * @define {boolean} If true, JSCompiler will use the native implementation of\n * array functions where appropriate (e.g., `Array#filter`) and remove the\n * unused pure JS implementation.\n */\ngoog.define('goog.array.ASSUME_NATIVE_FUNCTIONS', false);\n\n\n/**\n * Returns the last element in an array without removing it.\n * Same as goog.array.last.\n * @param {IArrayLike<T>|string} array The array.\n * @return {T} Last item in array.\n * @template T\n */\ngoog.array.peek = function(array) {\n  return array[array.length - 1];\n};\n\n\n/**\n * Returns the last element in an array without removing it.\n * Same as goog.array.peek.\n * @param {IArrayLike<T>|string} array The array.\n * @return {T} Last item in array.\n * @template T\n */\ngoog.array.last = goog.array.peek;\n\n// NOTE(arv): Since most of the array functions are generic it allows you to\n// pass an array-like object. Strings have a length and are considered array-\n// like. However, the 'in' operator does not work on strings so we cannot just\n// use the array path even if the browser supports indexing into strings. We\n// therefore end up splitting the string.\n\n\n/**\n * Returns the index of the first element of an array with a specified value, or\n * -1 if the element is not present in the array.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-indexof}\n *\n * @param {IArrayLike<T>|string} arr The array to be searched.\n * @param {T} obj The object for which we are searching.\n * @param {number=} opt_fromIndex The index at which to start the search. If\n *     omitted the search starts at index 0.\n * @return {number} The index of the first matching array element.\n * @template T\n */\ngoog.array.indexOf = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.indexOf) ?\n    function(arr, obj, opt_fromIndex) {\n      goog.asserts.assert(arr.length != null);\n\n      return Array.prototype.indexOf.call(arr, obj, opt_fromIndex);\n    } :\n    function(arr, obj, opt_fromIndex) {\n      var fromIndex = opt_fromIndex == null ?\n          0 :\n          (opt_fromIndex < 0 ? Math.max(0, arr.length + opt_fromIndex) :\n                               opt_fromIndex);\n\n      if (goog.isString(arr)) {\n        // Array.prototype.indexOf uses === so only strings should be found.\n        if (!goog.isString(obj) || obj.length != 1) {\n          return -1;\n        }\n        return arr.indexOf(obj, fromIndex);\n      }\n\n      for (var i = fromIndex; i < arr.length; i++) {\n        if (i in arr && arr[i] === obj) return i;\n      }\n      return -1;\n    };\n\n\n/**\n * Returns the index of the last element of an array with a specified value, or\n * -1 if the element is not present in the array.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-lastindexof}\n *\n * @param {!IArrayLike<T>|string} arr The array to be searched.\n * @param {T} obj The object for which we are searching.\n * @param {?number=} opt_fromIndex The index at which to start the search. If\n *     omitted the search starts at the end of the array.\n * @return {number} The index of the last matching array element.\n * @template T\n */\ngoog.array.lastIndexOf = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.lastIndexOf) ?\n    function(arr, obj, opt_fromIndex) {\n      goog.asserts.assert(arr.length != null);\n\n      // Firefox treats undefined and null as 0 in the fromIndex argument which\n      // leads it to always return -1\n      var fromIndex = opt_fromIndex == null ? arr.length - 1 : opt_fromIndex;\n      return Array.prototype.lastIndexOf.call(arr, obj, fromIndex);\n    } :\n    function(arr, obj, opt_fromIndex) {\n      var fromIndex = opt_fromIndex == null ? arr.length - 1 : opt_fromIndex;\n\n      if (fromIndex < 0) {\n        fromIndex = Math.max(0, arr.length + fromIndex);\n      }\n\n      if (goog.isString(arr)) {\n        // Array.prototype.lastIndexOf uses === so only strings should be found.\n        if (!goog.isString(obj) || obj.length != 1) {\n          return -1;\n        }\n        return arr.lastIndexOf(obj, fromIndex);\n      }\n\n      for (var i = fromIndex; i >= 0; i--) {\n        if (i in arr && arr[i] === obj) return i;\n      }\n      return -1;\n    };\n\n\n/**\n * Calls a function for each element in an array. Skips holes in the array.\n * See {@link http://tinyurl.com/developer-mozilla-org-array-foreach}\n *\n * @param {IArrayLike<T>|string} arr Array or array like object over\n *     which to iterate.\n * @param {?function(this: S, T, number, ?): ?} f The function to call for every\n *     element. This function takes 3 arguments (the element, the index and the\n *     array). The return value is ignored.\n * @param {S=} opt_obj The object to be used as the value of 'this' within f.\n * @template T,S\n */\ngoog.array.forEach = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.forEach) ?\n    function(arr, f, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n\n      Array.prototype.forEach.call(arr, f, opt_obj);\n    } :\n    function(arr, f, opt_obj) {\n      var l = arr.length;  // must be fixed during loop... see docs\n      var arr2 = goog.isString(arr) ? arr.split('') : arr;\n      for (var i = 0; i < l; i++) {\n        if (i in arr2) {\n          f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr);\n        }\n      }\n    };\n\n\n/**\n * Calls a function for each element in an array, starting from the last\n * element rather than the first.\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this: S, T, number, ?): ?} f The function to call for every\n *     element. This function\n *     takes 3 arguments (the element, the index and the array). The return\n *     value is ignored.\n * @param {S=} opt_obj The object to be used as the value of 'this'\n *     within f.\n * @template T,S\n */\ngoog.array.forEachRight = function(arr, f, opt_obj) {\n  var l = arr.length;  // must be fixed during loop... see docs\n  var arr2 = goog.isString(arr) ? arr.split('') : arr;\n  for (var i = l - 1; i >= 0; --i) {\n    if (i in arr2) {\n      f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr);\n    }\n  }\n};\n\n\n/**\n * Calls a function for each element in an array, and if the function returns\n * true adds the element to a new array.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-filter}\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?):boolean} f The function to call for\n *     every element. This function\n *     takes 3 arguments (the element, the index and the array) and must\n *     return a Boolean. If the return value is true the element is added to the\n *     result array. If it is false the element is not included.\n * @param {S=} opt_obj The object to be used as the value of 'this'\n *     within f.\n * @return {!Array<T>} a new array in which only elements that passed the test\n *     are present.\n * @template T,S\n */\ngoog.array.filter = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.filter) ?\n    function(arr, f, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n\n      return Array.prototype.filter.call(arr, f, opt_obj);\n    } :\n    function(arr, f, opt_obj) {\n      var l = arr.length;  // must be fixed during loop... see docs\n      var res = [];\n      var resLength = 0;\n      var arr2 = goog.isString(arr) ? arr.split('') : arr;\n      for (var i = 0; i < l; i++) {\n        if (i in arr2) {\n          var val = arr2[i];  // in case f mutates arr2\n          if (f.call(/** @type {?} */ (opt_obj), val, i, arr)) {\n            res[resLength++] = val;\n          }\n        }\n      }\n      return res;\n    };\n\n\n/**\n * Calls a function for each element in an array and inserts the result into a\n * new array.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-map}\n *\n * @param {IArrayLike<VALUE>|string} arr Array or array like object\n *     over which to iterate.\n * @param {function(this:THIS, VALUE, number, ?): RESULT} f The function to call\n *     for every element. This function takes 3 arguments (the element,\n *     the index and the array) and should return something. The result will be\n *     inserted into a new array.\n * @param {THIS=} opt_obj The object to be used as the value of 'this' within f.\n * @return {!Array<RESULT>} a new array with the results from f.\n * @template THIS, VALUE, RESULT\n */\ngoog.array.map = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.map) ?\n    function(arr, f, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n\n      return Array.prototype.map.call(arr, f, opt_obj);\n    } :\n    function(arr, f, opt_obj) {\n      var l = arr.length;  // must be fixed during loop... see docs\n      var res = new Array(l);\n      var arr2 = goog.isString(arr) ? arr.split('') : arr;\n      for (var i = 0; i < l; i++) {\n        if (i in arr2) {\n          res[i] = f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr);\n        }\n      }\n      return res;\n    };\n\n\n/**\n * Passes every element of an array into a function and accumulates the result.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-reduce}\n *\n * For example:\n * var a = [1, 2, 3, 4];\n * goog.array.reduce(a, function(r, v, i, arr) {return r + v;}, 0);\n * returns 10\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {function(this:S, R, T, number, ?) : R} f The function to call for\n *     every element. This function\n *     takes 4 arguments (the function's previous result or the initial value,\n *     the value of the current array element, the current array index, and the\n *     array itself)\n *     function(previousValue, currentValue, index, array).\n * @param {?} val The initial value to pass into the function on the first call.\n * @param {S=} opt_obj  The object to be used as the value of 'this'\n *     within f.\n * @return {R} Result of evaluating f repeatedly across the values of the array.\n * @template T,S,R\n */\ngoog.array.reduce = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.reduce) ?\n    function(arr, f, val, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n      if (opt_obj) {\n        f = goog.bind(f, opt_obj);\n      }\n      return Array.prototype.reduce.call(arr, f, val);\n    } :\n    function(arr, f, val, opt_obj) {\n      var rval = val;\n      goog.array.forEach(arr, function(val, index) {\n        rval = f.call(/** @type {?} */ (opt_obj), rval, val, index, arr);\n      });\n      return rval;\n    };\n\n\n/**\n * Passes every element of an array into a function and accumulates the result,\n * starting from the last element and working towards the first.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-reduceright}\n *\n * For example:\n * var a = ['a', 'b', 'c'];\n * goog.array.reduceRight(a, function(r, v, i, arr) {return r + v;}, '');\n * returns 'cba'\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, R, T, number, ?) : R} f The function to call for\n *     every element. This function\n *     takes 4 arguments (the function's previous result or the initial value,\n *     the value of the current array element, the current array index, and the\n *     array itself)\n *     function(previousValue, currentValue, index, array).\n * @param {?} val The initial value to pass into the function on the first call.\n * @param {S=} opt_obj The object to be used as the value of 'this'\n *     within f.\n * @return {R} Object returned as a result of evaluating f repeatedly across the\n *     values of the array.\n * @template T,S,R\n */\ngoog.array.reduceRight = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.reduceRight) ?\n    function(arr, f, val, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n      goog.asserts.assert(f != null);\n      if (opt_obj) {\n        f = goog.bind(f, opt_obj);\n      }\n      return Array.prototype.reduceRight.call(arr, f, val);\n    } :\n    function(arr, f, val, opt_obj) {\n      var rval = val;\n      goog.array.forEachRight(arr, function(val, index) {\n        rval = f.call(/** @type {?} */ (opt_obj), rval, val, index, arr);\n      });\n      return rval;\n    };\n\n\n/**\n * Calls f for each element of an array. If any call returns true, some()\n * returns true (without checking the remaining elements). If all calls\n * return false, some() returns false.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-some}\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call for\n *     for every element. This function takes 3 arguments (the element, the\n *     index and the array) and should return a boolean.\n * @param {S=} opt_obj  The object to be used as the value of 'this'\n *     within f.\n * @return {boolean} true if any element passes the test.\n * @template T,S\n */\ngoog.array.some = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.some) ?\n    function(arr, f, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n\n      return Array.prototype.some.call(arr, f, opt_obj);\n    } :\n    function(arr, f, opt_obj) {\n      var l = arr.length;  // must be fixed during loop... see docs\n      var arr2 = goog.isString(arr) ? arr.split('') : arr;\n      for (var i = 0; i < l; i++) {\n        if (i in arr2 && f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr)) {\n          return true;\n        }\n      }\n      return false;\n    };\n\n\n/**\n * Call f for each element of an array. If all calls return true, every()\n * returns true. If any call returns false, every() returns false and\n * does not continue to check the remaining elements.\n *\n * See {@link http://tinyurl.com/developer-mozilla-org-array-every}\n *\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call for\n *     for every element. This function takes 3 arguments (the element, the\n *     index and the array) and should return a boolean.\n * @param {S=} opt_obj The object to be used as the value of 'this'\n *     within f.\n * @return {boolean} false if any element fails the test.\n * @template T,S\n */\ngoog.array.every = goog.NATIVE_ARRAY_PROTOTYPES &&\n        (goog.array.ASSUME_NATIVE_FUNCTIONS || Array.prototype.every) ?\n    function(arr, f, opt_obj) {\n      goog.asserts.assert(arr.length != null);\n\n      return Array.prototype.every.call(arr, f, opt_obj);\n    } :\n    function(arr, f, opt_obj) {\n      var l = arr.length;  // must be fixed during loop... see docs\n      var arr2 = goog.isString(arr) ? arr.split('') : arr;\n      for (var i = 0; i < l; i++) {\n        if (i in arr2 && !f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr)) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n\n/**\n * Counts the array elements that fulfill the predicate, i.e. for which the\n * callback function returns true. Skips holes in the array.\n *\n * @param {!IArrayLike<T>|string} arr Array or array like object\n *     over which to iterate.\n * @param {function(this: S, T, number, ?): boolean} f The function to call for\n *     every element. Takes 3 arguments (the element, the index and the array).\n * @param {S=} opt_obj The object to be used as the value of 'this' within f.\n * @return {number} The number of the matching elements.\n * @template T,S\n */\ngoog.array.count = function(arr, f, opt_obj) {\n  var count = 0;\n  goog.array.forEach(arr, function(element, index, arr) {\n    if (f.call(/** @type {?} */ (opt_obj), element, index, arr)) {\n      ++count;\n    }\n  }, opt_obj);\n  return count;\n};\n\n\n/**\n * Search an array for the first element that satisfies a given condition and\n * return that element.\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call\n *     for every element. This function takes 3 arguments (the element, the\n *     index and the array) and should return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {T|null} The first array element that passes the test, or null if no\n *     element is found.\n * @template T,S\n */\ngoog.array.find = function(arr, f, opt_obj) {\n  var i = goog.array.findIndex(arr, f, opt_obj);\n  return i < 0 ? null : goog.isString(arr) ? arr.charAt(i) : arr[i];\n};\n\n\n/**\n * Search an array for the first element that satisfies a given condition and\n * return its index.\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call for\n *     every element. This function\n *     takes 3 arguments (the element, the index and the array) and should\n *     return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {number} The index of the first array element that passes the test,\n *     or -1 if no element is found.\n * @template T,S\n */\ngoog.array.findIndex = function(arr, f, opt_obj) {\n  var l = arr.length;  // must be fixed during loop... see docs\n  var arr2 = goog.isString(arr) ? arr.split('') : arr;\n  for (var i = 0; i < l; i++) {\n    if (i in arr2 && f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr)) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n\n/**\n * Search an array (in reverse order) for the last element that satisfies a\n * given condition and return that element.\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call\n *     for every element. This function\n *     takes 3 arguments (the element, the index and the array) and should\n *     return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {T|null} The last array element that passes the test, or null if no\n *     element is found.\n * @template T,S\n */\ngoog.array.findRight = function(arr, f, opt_obj) {\n  var i = goog.array.findIndexRight(arr, f, opt_obj);\n  return i < 0 ? null : goog.isString(arr) ? arr.charAt(i) : arr[i];\n};\n\n\n/**\n * Search an array (in reverse order) for the last element that satisfies a\n * given condition and return its index.\n * @param {IArrayLike<T>|string} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call\n *     for every element. This function\n *     takes 3 arguments (the element, the index and the array) and should\n *     return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {number} The index of the last array element that passes the test,\n *     or -1 if no element is found.\n * @template T,S\n */\ngoog.array.findIndexRight = function(arr, f, opt_obj) {\n  var l = arr.length;  // must be fixed during loop... see docs\n  var arr2 = goog.isString(arr) ? arr.split('') : arr;\n  for (var i = l - 1; i >= 0; i--) {\n    if (i in arr2 && f.call(/** @type {?} */ (opt_obj), arr2[i], i, arr)) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n\n/**\n * Whether the array contains the given object.\n * @param {IArrayLike<?>|string} arr The array to test for the presence of the\n *     element.\n * @param {*} obj The object for which to test.\n * @return {boolean} true if obj is present.\n */\ngoog.array.contains = function(arr, obj) {\n  return goog.array.indexOf(arr, obj) >= 0;\n};\n\n\n/**\n * Whether the array is empty.\n * @param {IArrayLike<?>|string} arr The array to test.\n * @return {boolean} true if empty.\n */\ngoog.array.isEmpty = function(arr) {\n  return arr.length == 0;\n};\n\n\n/**\n * Clears the array.\n * @param {IArrayLike<?>} arr Array or array like object to clear.\n */\ngoog.array.clear = function(arr) {\n  // For non real arrays we don't have the magic length so we delete the\n  // indices.\n  if (!goog.isArray(arr)) {\n    for (var i = arr.length - 1; i >= 0; i--) {\n      delete arr[i];\n    }\n  }\n  arr.length = 0;\n};\n\n\n/**\n * Pushes an item into an array, if it's not already in the array.\n * @param {Array<T>} arr Array into which to insert the item.\n * @param {T} obj Value to add.\n * @template T\n */\ngoog.array.insert = function(arr, obj) {\n  if (!goog.array.contains(arr, obj)) {\n    arr.push(obj);\n  }\n};\n\n\n/**\n * Inserts an object at the given index of the array.\n * @param {IArrayLike<?>} arr The array to modify.\n * @param {*} obj The object to insert.\n * @param {number=} opt_i The index at which to insert the object. If omitted,\n *      treated as 0. A negative index is counted from the end of the array.\n */\ngoog.array.insertAt = function(arr, obj, opt_i) {\n  goog.array.splice(arr, opt_i, 0, obj);\n};\n\n\n/**\n * Inserts at the given index of the array, all elements of another array.\n * @param {IArrayLike<?>} arr The array to modify.\n * @param {IArrayLike<?>} elementsToAdd The array of elements to add.\n * @param {number=} opt_i The index at which to insert the object. If omitted,\n *      treated as 0. A negative index is counted from the end of the array.\n */\ngoog.array.insertArrayAt = function(arr, elementsToAdd, opt_i) {\n  goog.partial(goog.array.splice, arr, opt_i, 0).apply(null, elementsToAdd);\n};\n\n\n/**\n * Inserts an object into an array before a specified object.\n * @param {Array<T>} arr The array to modify.\n * @param {T} obj The object to insert.\n * @param {T=} opt_obj2 The object before which obj should be inserted. If obj2\n *     is omitted or not found, obj is inserted at the end of the array.\n * @template T\n */\ngoog.array.insertBefore = function(arr, obj, opt_obj2) {\n  var i;\n  if (arguments.length == 2 || (i = goog.array.indexOf(arr, opt_obj2)) < 0) {\n    arr.push(obj);\n  } else {\n    goog.array.insertAt(arr, obj, i);\n  }\n};\n\n\n/**\n * Removes the first occurrence of a particular value from an array.\n * @param {IArrayLike<T>} arr Array from which to remove\n *     value.\n * @param {T} obj Object to remove.\n * @return {boolean} True if an element was removed.\n * @template T\n */\ngoog.array.remove = function(arr, obj) {\n  var i = goog.array.indexOf(arr, obj);\n  var rv;\n  if ((rv = i >= 0)) {\n    goog.array.removeAt(arr, i);\n  }\n  return rv;\n};\n\n\n/**\n * Removes the last occurrence of a particular value from an array.\n * @param {!IArrayLike<T>} arr Array from which to remove value.\n * @param {T} obj Object to remove.\n * @return {boolean} True if an element was removed.\n * @template T\n */\ngoog.array.removeLast = function(arr, obj) {\n  var i = goog.array.lastIndexOf(arr, obj);\n  if (i >= 0) {\n    goog.array.removeAt(arr, i);\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Removes from an array the element at index i\n * @param {IArrayLike<?>} arr Array or array like object from which to\n *     remove value.\n * @param {number} i The index to remove.\n * @return {boolean} True if an element was removed.\n */\ngoog.array.removeAt = function(arr, i) {\n  goog.asserts.assert(arr.length != null);\n\n  // use generic form of splice\n  // splice returns the removed items and if successful the length of that\n  // will be 1\n  return Array.prototype.splice.call(arr, i, 1).length == 1;\n};\n\n\n/**\n * Removes the first value that satisfies the given condition.\n * @param {IArrayLike<T>} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call\n *     for every element. This function\n *     takes 3 arguments (the element, the index and the array) and should\n *     return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {boolean} True if an element was removed.\n * @template T,S\n */\ngoog.array.removeIf = function(arr, f, opt_obj) {\n  var i = goog.array.findIndex(arr, f, opt_obj);\n  if (i >= 0) {\n    goog.array.removeAt(arr, i);\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Removes all values that satisfy the given condition.\n * @param {IArrayLike<T>} arr Array or array\n *     like object over which to iterate.\n * @param {?function(this:S, T, number, ?) : boolean} f The function to call\n *     for every element. This function\n *     takes 3 arguments (the element, the index and the array) and should\n *     return a boolean.\n * @param {S=} opt_obj An optional \"this\" context for the function.\n * @return {number} The number of items removed\n * @template T,S\n */\ngoog.array.removeAllIf = function(arr, f, opt_obj) {\n  var removedCount = 0;\n  goog.array.forEachRight(arr, function(val, index) {\n    if (f.call(/** @type {?} */ (opt_obj), val, index, arr)) {\n      if (goog.array.removeAt(arr, index)) {\n        removedCount++;\n      }\n    }\n  });\n  return removedCount;\n};\n\n\n/**\n * Returns a new array that is the result of joining the arguments.  If arrays\n * are passed then their items are added, however, if non-arrays are passed they\n * will be added to the return array as is.\n *\n * Note that ArrayLike objects will be added as is, rather than having their\n * items added.\n *\n * goog.array.concat([1, 2], [3, 4]) -> [1, 2, 3, 4]\n * goog.array.concat(0, [1, 2]) -> [0, 1, 2]\n * goog.array.concat([1, 2], null) -> [1, 2, null]\n *\n * There is bug in all current versions of IE (6, 7 and 8) where arrays created\n * in an iframe become corrupted soon (not immediately) after the iframe is\n * destroyed. This is common if loading data via goog.net.IframeIo, for example.\n * This corruption only affects the concat method which will start throwing\n * Catastrophic Errors (#-2147418113).\n *\n * See http://endoflow.com/scratch/corrupted-arrays.html for a test case.\n *\n * Internally goog.array should use this, so that all methods will continue to\n * work on these broken array objects.\n *\n * @param {...*} var_args Items to concatenate.  Arrays will have each item\n *     added, while primitives and objects will be added as is.\n * @return {!Array<?>} The new resultant array.\n */\ngoog.array.concat = function(var_args) {\n  return Array.prototype.concat.apply([], arguments);\n};\n\n\n/**\n * Returns a new array that contains the contents of all the arrays passed.\n * @param {...!Array<T>} var_args\n * @return {!Array<T>}\n * @template T\n */\ngoog.array.join = function(var_args) {\n  return Array.prototype.concat.apply([], arguments);\n};\n\n\n/**\n * Converts an object to an array.\n * @param {IArrayLike<T>|string} object  The object to convert to an\n *     array.\n * @return {!Array<T>} The object converted into an array. If object has a\n *     length property, every property indexed with a non-negative number\n *     less than length will be included in the result. If object does not\n *     have a length property, an empty array will be returned.\n * @template T\n */\ngoog.array.toArray = function(object) {\n  var length = object.length;\n\n  // If length is not a number the following is false. This case is kept for\n  // backwards compatibility since there are callers that pass objects that are\n  // not array like.\n  if (length > 0) {\n    var rv = new Array(length);\n    for (var i = 0; i < length; i++) {\n      rv[i] = object[i];\n    }\n    return rv;\n  }\n  return [];\n};\n\n\n/**\n * Does a shallow copy of an array.\n * @param {IArrayLike<T>|string} arr  Array or array-like object to\n *     clone.\n * @return {!Array<T>} Clone of the input array.\n * @template T\n */\ngoog.array.clone = goog.array.toArray;\n\n\n/**\n * Extends an array with another array, element, or \"array like\" object.\n * This function operates 'in-place', it does not create a new Array.\n *\n * Example:\n * var a = [];\n * goog.array.extend(a, [0, 1]);\n * a; // [0, 1]\n * goog.array.extend(a, 2);\n * a; // [0, 1, 2]\n *\n * @param {Array<VALUE>} arr1  The array to modify.\n * @param {...(IArrayLike<VALUE>|VALUE)} var_args The elements or arrays of\n *     elements to add to arr1.\n * @template VALUE\n */\ngoog.array.extend = function(arr1, var_args) {\n  for (var i = 1; i < arguments.length; i++) {\n    var arr2 = arguments[i];\n    if (goog.isArrayLike(arr2)) {\n      var len1 = arr1.length || 0;\n      var len2 = arr2.length || 0;\n      arr1.length = len1 + len2;\n      for (var j = 0; j < len2; j++) {\n        arr1[len1 + j] = arr2[j];\n      }\n    } else {\n      arr1.push(arr2);\n    }\n  }\n};\n\n\n/**\n * Adds or removes elements from an array. This is a generic version of Array\n * splice. This means that it might work on other objects similar to arrays,\n * such as the arguments object.\n *\n * @param {IArrayLike<T>} arr The array to modify.\n * @param {number|undefined} index The index at which to start changing the\n *     array. If not defined, treated as 0.\n * @param {number} howMany How many elements to remove (0 means no removal. A\n *     value below 0 is treated as zero and so is any other non number. Numbers\n *     are floored).\n * @param {...T} var_args Optional, additional elements to insert into the\n *     array.\n * @return {!Array<T>} the removed elements.\n * @template T\n */\ngoog.array.splice = function(arr, index, howMany, var_args) {\n  goog.asserts.assert(arr.length != null);\n\n  return Array.prototype.splice.apply(arr, goog.array.slice(arguments, 1));\n};\n\n\n/**\n * Returns a new array from a segment of an array. This is a generic version of\n * Array slice. This means that it might work on other objects similar to\n * arrays, such as the arguments object.\n *\n * @param {IArrayLike<T>|string} arr The array from\n * which to copy a segment.\n * @param {number} start The index of the first element to copy.\n * @param {number=} opt_end The index after the last element to copy.\n * @return {!Array<T>} A new array containing the specified segment of the\n *     original array.\n * @template T\n */\ngoog.array.slice = function(arr, start, opt_end) {\n  goog.asserts.assert(arr.length != null);\n\n  // passing 1 arg to slice is not the same as passing 2 where the second is\n  // null or undefined (in that case the second argument is treated as 0).\n  // we could use slice on the arguments object and then use apply instead of\n  // testing the length\n  if (arguments.length <= 2) {\n    return Array.prototype.slice.call(arr, start);\n  } else {\n    return Array.prototype.slice.call(arr, start, opt_end);\n  }\n};\n\n\n/**\n * Removes all duplicates from an array (retaining only the first\n * occurrence of each array element).  This function modifies the\n * array in place and doesn't change the order of the non-duplicate items.\n *\n * For objects, duplicates are identified as having the same unique ID as\n * defined by {@link goog.getUid}.\n *\n * Alternatively you can specify a custom hash function that returns a unique\n * value for each item in the array it should consider unique.\n *\n * Runtime: N,\n * Worstcase space: 2N (no dupes)\n *\n * @param {IArrayLike<T>} arr The array from which to remove\n *     duplicates.\n * @param {Array=} opt_rv An optional array in which to return the results,\n *     instead of performing the removal inplace.  If specified, the original\n *     array will remain unchanged.\n * @param {function(T):string=} opt_hashFn An optional function to use to\n *     apply to every item in the array. This function should return a unique\n *     value for each item in the array it should consider unique.\n * @template T\n */\ngoog.array.removeDuplicates = function(arr, opt_rv, opt_hashFn) {\n  var returnArray = opt_rv || arr;\n  var defaultHashFn = function(item) {\n    // Prefix each type with a single character representing the type to\n    // prevent conflicting keys (e.g. true and 'true').\n    return goog.isObject(item) ? 'o' + goog.getUid(item) :\n                                 (typeof item).charAt(0) + item;\n  };\n  var hashFn = opt_hashFn || defaultHashFn;\n\n  var seen = {}, cursorInsert = 0, cursorRead = 0;\n  while (cursorRead < arr.length) {\n    var current = arr[cursorRead++];\n    var key = hashFn(current);\n    if (!Object.prototype.hasOwnProperty.call(seen, key)) {\n      seen[key] = true;\n      returnArray[cursorInsert++] = current;\n    }\n  }\n  returnArray.length = cursorInsert;\n};\n\n\n/**\n * Searches the specified array for the specified target using the binary\n * search algorithm.  If no opt_compareFn is specified, elements are compared\n * using <code>goog.array.defaultCompare</code>, which compares the elements\n * using the built in < and > operators.  This will produce the expected\n * behavior for homogeneous arrays of String(s) and Number(s). The array\n * specified <b>must</b> be sorted in ascending order (as defined by the\n * comparison function).  If the array is not sorted, results are undefined.\n * If the array contains multiple instances of the specified target value, any\n * of these instances may be found.\n *\n * Runtime: O(log n)\n *\n * @param {IArrayLike<VALUE>} arr The array to be searched.\n * @param {TARGET} target The sought value.\n * @param {function(TARGET, VALUE): number=} opt_compareFn Optional comparison\n *     function by which the array is ordered. Should take 2 arguments to\n *     compare, and return a negative number, zero, or a positive number\n *     depending on whether the first argument is less than, equal to, or\n *     greater than the second.\n * @return {number} Lowest index of the target value if found, otherwise\n *     (-(insertion point) - 1). The insertion point is where the value should\n *     be inserted into arr to preserve the sorted property.  Return value >= 0\n *     iff target is found.\n * @template TARGET, VALUE\n */\ngoog.array.binarySearch = function(arr, target, opt_compareFn) {\n  return goog.array.binarySearch_(\n      arr, opt_compareFn || goog.array.defaultCompare, false /* isEvaluator */,\n      target);\n};\n\n\n/**\n * Selects an index in the specified array using the binary search algorithm.\n * The evaluator receives an element and determines whether the desired index\n * is before, at, or after it.  The evaluator must be consistent (formally,\n * goog.array.map(goog.array.map(arr, evaluator, opt_obj), goog.math.sign)\n * must be monotonically non-increasing).\n *\n * Runtime: O(log n)\n *\n * @param {IArrayLike<VALUE>} arr The array to be searched.\n * @param {function(this:THIS, VALUE, number, ?): number} evaluator\n *     Evaluator function that receives 3 arguments (the element, the index and\n *     the array). Should return a negative number, zero, or a positive number\n *     depending on whether the desired index is before, at, or after the\n *     element passed to it.\n * @param {THIS=} opt_obj The object to be used as the value of 'this'\n *     within evaluator.\n * @return {number} Index of the leftmost element matched by the evaluator, if\n *     such exists; otherwise (-(insertion point) - 1). The insertion point is\n *     the index of the first element for which the evaluator returns negative,\n *     or arr.length if no such element exists. The return value is non-negative\n *     iff a match is found.\n * @template THIS, VALUE\n */\ngoog.array.binarySelect = function(arr, evaluator, opt_obj) {\n  return goog.array.binarySearch_(\n      arr, evaluator, true /* isEvaluator */, undefined /* opt_target */,\n      opt_obj);\n};\n\n\n/**\n * Implementation of a binary search algorithm which knows how to use both\n * comparison functions and evaluators. If an evaluator is provided, will call\n * the evaluator with the given optional data object, conforming to the\n * interface defined in binarySelect. Otherwise, if a comparison function is\n * provided, will call the comparison function against the given data object.\n *\n * This implementation purposefully does not use goog.bind or goog.partial for\n * performance reasons.\n *\n * Runtime: O(log n)\n *\n * @param {IArrayLike<?>} arr The array to be searched.\n * @param {function(?, ?, ?): number | function(?, ?): number} compareFn\n *     Either an evaluator or a comparison function, as defined by binarySearch\n *     and binarySelect above.\n * @param {boolean} isEvaluator Whether the function is an evaluator or a\n *     comparison function.\n * @param {?=} opt_target If the function is a comparison function, then\n *     this is the target to binary search for.\n * @param {Object=} opt_selfObj If the function is an evaluator, this is an\n *     optional this object for the evaluator.\n * @return {number} Lowest index of the target value if found, otherwise\n *     (-(insertion point) - 1). The insertion point is where the value should\n *     be inserted into arr to preserve the sorted property.  Return value >= 0\n *     iff target is found.\n * @private\n */\ngoog.array.binarySearch_ = function(\n    arr, compareFn, isEvaluator, opt_target, opt_selfObj) {\n  var left = 0;            // inclusive\n  var right = arr.length;  // exclusive\n  var found;\n  while (left < right) {\n    var middle = (left + right) >> 1;\n    var compareResult;\n    if (isEvaluator) {\n      compareResult = compareFn.call(opt_selfObj, arr[middle], middle, arr);\n    } else {\n      // NOTE(dimvar): To avoid this cast, we'd have to use function overloading\n      // for the type of binarySearch_, which the type system can't express yet.\n      compareResult = /** @type {function(?, ?): number} */ (compareFn)(\n          opt_target, arr[middle]);\n    }\n    if (compareResult > 0) {\n      left = middle + 1;\n    } else {\n      right = middle;\n      // We are looking for the lowest index so we can't return immediately.\n      found = !compareResult;\n    }\n  }\n  // left is the index if found, or the insertion point otherwise.\n  // ~left is a shorthand for -left - 1.\n  return found ? left : ~left;\n};\n\n\n/**\n * Sorts the specified array into ascending order.  If no opt_compareFn is\n * specified, elements are compared using\n * <code>goog.array.defaultCompare</code>, which compares the elements using\n * the built in < and > operators.  This will produce the expected behavior\n * for homogeneous arrays of String(s) and Number(s), unlike the native sort,\n * but will give unpredictable results for heterogeneous lists of strings and\n * numbers with different numbers of digits.\n *\n * This sort is not guaranteed to be stable.\n *\n * Runtime: Same as <code>Array.prototype.sort</code>\n *\n * @param {Array<T>} arr The array to be sorted.\n * @param {?function(T,T):number=} opt_compareFn Optional comparison\n *     function by which the\n *     array is to be ordered. Should take 2 arguments to compare, and return a\n *     negative number, zero, or a positive number depending on whether the\n *     first argument is less than, equal to, or greater than the second.\n * @template T\n */\ngoog.array.sort = function(arr, opt_compareFn) {\n  // TODO(arv): Update type annotation since null is not accepted.\n  arr.sort(opt_compareFn || goog.array.defaultCompare);\n};\n\n\n/**\n * Sorts the specified array into ascending order in a stable way.  If no\n * opt_compareFn is specified, elements are compared using\n * <code>goog.array.defaultCompare</code>, which compares the elements using\n * the built in < and > operators.  This will produce the expected behavior\n * for homogeneous arrays of String(s) and Number(s).\n *\n * Runtime: Same as <code>Array.prototype.sort</code>, plus an additional\n * O(n) overhead of copying the array twice.\n *\n * @param {Array<T>} arr The array to be sorted.\n * @param {?function(T, T): number=} opt_compareFn Optional comparison function\n *     by which the array is to be ordered. Should take 2 arguments to compare,\n *     and return a negative number, zero, or a positive number depending on\n *     whether the first argument is less than, equal to, or greater than the\n *     second.\n * @template T\n */\ngoog.array.stableSort = function(arr, opt_compareFn) {\n  var compArr = new Array(arr.length);\n  for (var i = 0; i < arr.length; i++) {\n    compArr[i] = {index: i, value: arr[i]};\n  }\n  var valueCompareFn = opt_compareFn || goog.array.defaultCompare;\n  function stableCompareFn(obj1, obj2) {\n    return valueCompareFn(obj1.value, obj2.value) || obj1.index - obj2.index;\n  }\n  goog.array.sort(compArr, stableCompareFn);\n  for (var i = 0; i < arr.length; i++) {\n    arr[i] = compArr[i].value;\n  }\n};\n\n\n/**\n * Sort the specified array into ascending order based on item keys\n * returned by the specified key function.\n * If no opt_compareFn is specified, the keys are compared in ascending order\n * using <code>goog.array.defaultCompare</code>.\n *\n * Runtime: O(S(f(n)), where S is runtime of <code>goog.array.sort</code>\n * and f(n) is runtime of the key function.\n *\n * @param {Array<T>} arr The array to be sorted.\n * @param {function(T): K} keyFn Function taking array element and returning\n *     a key used for sorting this element.\n * @param {?function(K, K): number=} opt_compareFn Optional comparison function\n *     by which the keys are to be ordered. Should take 2 arguments to compare,\n *     and return a negative number, zero, or a positive number depending on\n *     whether the first argument is less than, equal to, or greater than the\n *     second.\n * @template T,K\n */\ngoog.array.sortByKey = function(arr, keyFn, opt_compareFn) {\n  var keyCompareFn = opt_compareFn || goog.array.defaultCompare;\n  goog.array.sort(\n      arr, function(a, b) { return keyCompareFn(keyFn(a), keyFn(b)); });\n};\n\n\n/**\n * Sorts an array of objects by the specified object key and compare\n * function. If no compare function is provided, the key values are\n * compared in ascending order using <code>goog.array.defaultCompare</code>.\n * This won't work for keys that get renamed by the compiler. So use\n * {'foo': 1, 'bar': 2} rather than {foo: 1, bar: 2}.\n * @param {Array<Object>} arr An array of objects to sort.\n * @param {string} key The object key to sort by.\n * @param {Function=} opt_compareFn The function to use to compare key\n *     values.\n */\ngoog.array.sortObjectsByKey = function(arr, key, opt_compareFn) {\n  goog.array.sortByKey(arr, function(obj) { return obj[key]; }, opt_compareFn);\n};\n\n\n/**\n * Tells if the array is sorted.\n * @param {!IArrayLike<T>} arr The array.\n * @param {?function(T,T):number=} opt_compareFn Function to compare the\n *     array elements.\n *     Should take 2 arguments to compare, and return a negative number, zero,\n *     or a positive number depending on whether the first argument is less\n *     than, equal to, or greater than the second.\n * @param {boolean=} opt_strict If true no equal elements are allowed.\n * @return {boolean} Whether the array is sorted.\n * @template T\n */\ngoog.array.isSorted = function(arr, opt_compareFn, opt_strict) {\n  var compare = opt_compareFn || goog.array.defaultCompare;\n  for (var i = 1; i < arr.length; i++) {\n    var compareResult = compare(arr[i - 1], arr[i]);\n    if (compareResult > 0 || compareResult == 0 && opt_strict) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Compares two arrays for equality. Two arrays are considered equal if they\n * have the same length and their corresponding elements are equal according to\n * the comparison function.\n *\n * @param {IArrayLike<?>} arr1 The first array to compare.\n * @param {IArrayLike<?>} arr2 The second array to compare.\n * @param {Function=} opt_equalsFn Optional comparison function.\n *     Should take 2 arguments to compare, and return true if the arguments\n *     are equal. Defaults to {@link goog.array.defaultCompareEquality} which\n *     compares the elements using the built-in '===' operator.\n * @return {boolean} Whether the two arrays are equal.\n */\ngoog.array.equals = function(arr1, arr2, opt_equalsFn) {\n  if (!goog.isArrayLike(arr1) || !goog.isArrayLike(arr2) ||\n      arr1.length != arr2.length) {\n    return false;\n  }\n  var l = arr1.length;\n  var equalsFn = opt_equalsFn || goog.array.defaultCompareEquality;\n  for (var i = 0; i < l; i++) {\n    if (!equalsFn(arr1[i], arr2[i])) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * 3-way array compare function.\n * @param {!IArrayLike<VALUE>} arr1 The first array to\n *     compare.\n * @param {!IArrayLike<VALUE>} arr2 The second array to\n *     compare.\n * @param {function(VALUE, VALUE): number=} opt_compareFn Optional comparison\n *     function by which the array is to be ordered. Should take 2 arguments to\n *     compare, and return a negative number, zero, or a positive number\n *     depending on whether the first argument is less than, equal to, or\n *     greater than the second.\n * @return {number} Negative number, zero, or a positive number depending on\n *     whether the first argument is less than, equal to, or greater than the\n *     second.\n * @template VALUE\n */\ngoog.array.compare3 = function(arr1, arr2, opt_compareFn) {\n  var compare = opt_compareFn || goog.array.defaultCompare;\n  var l = Math.min(arr1.length, arr2.length);\n  for (var i = 0; i < l; i++) {\n    var result = compare(arr1[i], arr2[i]);\n    if (result != 0) {\n      return result;\n    }\n  }\n  return goog.array.defaultCompare(arr1.length, arr2.length);\n};\n\n\n/**\n * Compares its two arguments for order, using the built in < and >\n * operators.\n * @param {VALUE} a The first object to be compared.\n * @param {VALUE} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is less than, equal to, or greater than the second,\n *     respectively.\n * @template VALUE\n */\ngoog.array.defaultCompare = function(a, b) {\n  return a > b ? 1 : a < b ? -1 : 0;\n};\n\n\n/**\n * Compares its two arguments for inverse order, using the built in < and >\n * operators.\n * @param {VALUE} a The first object to be compared.\n * @param {VALUE} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is greater than, equal to, or less than the second,\n *     respectively.\n * @template VALUE\n */\ngoog.array.inverseDefaultCompare = function(a, b) {\n  return -goog.array.defaultCompare(a, b);\n};\n\n\n/**\n * Compares its two arguments for equality, using the built in === operator.\n * @param {*} a The first object to compare.\n * @param {*} b The second object to compare.\n * @return {boolean} True if the two arguments are equal, false otherwise.\n */\ngoog.array.defaultCompareEquality = function(a, b) {\n  return a === b;\n};\n\n\n/**\n * Inserts a value into a sorted array. The array is not modified if the\n * value is already present.\n * @param {IArrayLike<VALUE>} array The array to modify.\n * @param {VALUE} value The object to insert.\n * @param {function(VALUE, VALUE): number=} opt_compareFn Optional comparison\n *     function by which the array is ordered. Should take 2 arguments to\n *     compare, and return a negative number, zero, or a positive number\n *     depending on whether the first argument is less than, equal to, or\n *     greater than the second.\n * @return {boolean} True if an element was inserted.\n * @template VALUE\n */\ngoog.array.binaryInsert = function(array, value, opt_compareFn) {\n  var index = goog.array.binarySearch(array, value, opt_compareFn);\n  if (index < 0) {\n    goog.array.insertAt(array, value, -(index + 1));\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Removes a value from a sorted array.\n * @param {!IArrayLike<VALUE>} array The array to modify.\n * @param {VALUE} value The object to remove.\n * @param {function(VALUE, VALUE): number=} opt_compareFn Optional comparison\n *     function by which the array is ordered. Should take 2 arguments to\n *     compare, and return a negative number, zero, or a positive number\n *     depending on whether the first argument is less than, equal to, or\n *     greater than the second.\n * @return {boolean} True if an element was removed.\n * @template VALUE\n */\ngoog.array.binaryRemove = function(array, value, opt_compareFn) {\n  var index = goog.array.binarySearch(array, value, opt_compareFn);\n  return (index >= 0) ? goog.array.removeAt(array, index) : false;\n};\n\n\n/**\n * Splits an array into disjoint buckets according to a splitting function.\n * @param {IArrayLike<T>} array The array.\n * @param {function(this:S, T, number, !IArrayLike<T>):?} sorter Function to\n *     call for every element.  This takes 3 arguments (the element, the index\n *     and the array) and must return a valid object key (a string, number,\n *     etc), or undefined, if that object should not be placed in a bucket.\n * @param {S=} opt_obj The object to be used as the value of 'this' within\n *     sorter.\n * @return {!Object<!Array<T>>} An object, with keys being all of the unique\n *     return values of sorter, and values being arrays containing the items for\n *     which the splitter returned that key.\n * @template T,S\n */\ngoog.array.bucket = function(array, sorter, opt_obj) {\n  var buckets = {};\n\n  for (var i = 0; i < array.length; i++) {\n    var value = array[i];\n    var key = sorter.call(/** @type {?} */ (opt_obj), value, i, array);\n    if (goog.isDef(key)) {\n      // Push the value to the right bucket, creating it if necessary.\n      var bucket = buckets[key] || (buckets[key] = []);\n      bucket.push(value);\n    }\n  }\n\n  return buckets;\n};\n\n\n/**\n * Creates a new object built from the provided array and the key-generation\n * function.\n * @param {IArrayLike<T>} arr Array or array like object over\n *     which to iterate whose elements will be the values in the new object.\n * @param {?function(this:S, T, number, ?) : string} keyFunc The function to\n *     call for every element. This function takes 3 arguments (the element, the\n *     index and the array) and should return a string that will be used as the\n *     key for the element in the new object. If the function returns the same\n *     key for more than one element, the value for that key is\n *     implementation-defined.\n * @param {S=} opt_obj The object to be used as the value of 'this'\n *     within keyFunc.\n * @return {!Object<T>} The new object.\n * @template T,S\n */\ngoog.array.toObject = function(arr, keyFunc, opt_obj) {\n  var ret = {};\n  goog.array.forEach(arr, function(element, index) {\n    ret[keyFunc.call(/** @type {?} */ (opt_obj), element, index, arr)] =\n        element;\n  });\n  return ret;\n};\n\n\n/**\n * Creates a range of numbers in an arithmetic progression.\n *\n * Range takes 1, 2, or 3 arguments:\n * <pre>\n * range(5) is the same as range(0, 5, 1) and produces [0, 1, 2, 3, 4]\n * range(2, 5) is the same as range(2, 5, 1) and produces [2, 3, 4]\n * range(-2, -5, -1) produces [-2, -3, -4]\n * range(-2, -5, 1) produces [], since stepping by 1 wouldn't ever reach -5.\n * </pre>\n *\n * @param {number} startOrEnd The starting value of the range if an end argument\n *     is provided. Otherwise, the start value is 0, and this is the end value.\n * @param {number=} opt_end The optional end value of the range.\n * @param {number=} opt_step The step size between range values. Defaults to 1\n *     if opt_step is undefined or 0.\n * @return {!Array<number>} An array of numbers for the requested range. May be\n *     an empty array if adding the step would not converge toward the end\n *     value.\n */\ngoog.array.range = function(startOrEnd, opt_end, opt_step) {\n  var array = [];\n  var start = 0;\n  var end = startOrEnd;\n  var step = opt_step || 1;\n  if (opt_end !== undefined) {\n    start = startOrEnd;\n    end = opt_end;\n  }\n\n  if (step * (end - start) < 0) {\n    // Sign mismatch: start + step will never reach the end value.\n    return [];\n  }\n\n  if (step > 0) {\n    for (var i = start; i < end; i += step) {\n      array.push(i);\n    }\n  } else {\n    for (var i = start; i > end; i += step) {\n      array.push(i);\n    }\n  }\n  return array;\n};\n\n\n/**\n * Returns an array consisting of the given value repeated N times.\n *\n * @param {VALUE} value The value to repeat.\n * @param {number} n The repeat count.\n * @return {!Array<VALUE>} An array with the repeated value.\n * @template VALUE\n */\ngoog.array.repeat = function(value, n) {\n  var array = [];\n  for (var i = 0; i < n; i++) {\n    array[i] = value;\n  }\n  return array;\n};\n\n\n/**\n * Returns an array consisting of every argument with all arrays\n * expanded in-place recursively.\n *\n * @param {...*} var_args The values to flatten.\n * @return {!Array<?>} An array containing the flattened values.\n */\ngoog.array.flatten = function(var_args) {\n  var CHUNK_SIZE = 8192;\n\n  var result = [];\n  for (var i = 0; i < arguments.length; i++) {\n    var element = arguments[i];\n    if (goog.isArray(element)) {\n      for (var c = 0; c < element.length; c += CHUNK_SIZE) {\n        var chunk = goog.array.slice(element, c, c + CHUNK_SIZE);\n        var recurseResult = goog.array.flatten.apply(null, chunk);\n        for (var r = 0; r < recurseResult.length; r++) {\n          result.push(recurseResult[r]);\n        }\n      }\n    } else {\n      result.push(element);\n    }\n  }\n  return result;\n};\n\n\n/**\n * Rotates an array in-place. After calling this method, the element at\n * index i will be the element previously at index (i - n) %\n * array.length, for all values of i between 0 and array.length - 1,\n * inclusive.\n *\n * For example, suppose list comprises [t, a, n, k, s]. After invoking\n * rotate(array, 1) (or rotate(array, -4)), array will comprise [s, t, a, n, k].\n *\n * @param {!Array<T>} array The array to rotate.\n * @param {number} n The amount to rotate.\n * @return {!Array<T>} The array.\n * @template T\n */\ngoog.array.rotate = function(array, n) {\n  goog.asserts.assert(array.length != null);\n\n  if (array.length) {\n    n %= array.length;\n    if (n > 0) {\n      Array.prototype.unshift.apply(array, array.splice(-n, n));\n    } else if (n < 0) {\n      Array.prototype.push.apply(array, array.splice(0, -n));\n    }\n  }\n  return array;\n};\n\n\n/**\n * Moves one item of an array to a new position keeping the order of the rest\n * of the items. Example use case: keeping a list of JavaScript objects\n * synchronized with the corresponding list of DOM elements after one of the\n * elements has been dragged to a new position.\n * @param {!IArrayLike<?>} arr The array to modify.\n * @param {number} fromIndex Index of the item to move between 0 and\n *     {@code arr.length - 1}.\n * @param {number} toIndex Target index between 0 and {@code arr.length - 1}.\n */\ngoog.array.moveItem = function(arr, fromIndex, toIndex) {\n  goog.asserts.assert(fromIndex >= 0 && fromIndex < arr.length);\n  goog.asserts.assert(toIndex >= 0 && toIndex < arr.length);\n  // Remove 1 item at fromIndex.\n  var removedItems = Array.prototype.splice.call(arr, fromIndex, 1);\n  // Insert the removed item at toIndex.\n  Array.prototype.splice.call(arr, toIndex, 0, removedItems[0]);\n  // We don't use goog.array.insertAt and goog.array.removeAt, because they're\n  // significantly slower than splice.\n};\n\n\n/**\n * Creates a new array for which the element at position i is an array of the\n * ith element of the provided arrays.  The returned array will only be as long\n * as the shortest array provided; additional values are ignored.  For example,\n * the result of zipping [1, 2] and [3, 4, 5] is [[1,3], [2, 4]].\n *\n * This is similar to the zip() function in Python.  See {@link\n * http://docs.python.org/library/functions.html#zip}\n *\n * @param {...!IArrayLike<?>} var_args Arrays to be combined.\n * @return {!Array<!Array<?>>} A new array of arrays created from\n *     provided arrays.\n */\ngoog.array.zip = function(var_args) {\n  if (!arguments.length) {\n    return [];\n  }\n  var result = [];\n  var minLen = arguments[0].length;\n  for (var i = 1; i < arguments.length; i++) {\n    if (arguments[i].length < minLen) {\n      minLen = arguments[i].length;\n    }\n  }\n  for (var i = 0; i < minLen; i++) {\n    var value = [];\n    for (var j = 0; j < arguments.length; j++) {\n      value.push(arguments[j][i]);\n    }\n    result.push(value);\n  }\n  return result;\n};\n\n\n/**\n * Shuffles the values in the specified array using the Fisher-Yates in-place\n * shuffle (also known as the Knuth Shuffle). By default, calls Math.random()\n * and so resets the state of that random number generator. Similarly, may reset\n * the state of the any other specified random number generator.\n *\n * Runtime: O(n)\n *\n * @param {!Array<?>} arr The array to be shuffled.\n * @param {function():number=} opt_randFn Optional random function to use for\n *     shuffling.\n *     Takes no arguments, and returns a random number on the interval [0, 1).\n *     Defaults to Math.random() using JavaScript's built-in Math library.\n */\ngoog.array.shuffle = function(arr, opt_randFn) {\n  var randFn = opt_randFn || Math.random;\n\n  for (var i = arr.length - 1; i > 0; i--) {\n    // Choose a random array index in [0, i] (inclusive with i).\n    var j = Math.floor(randFn() * (i + 1));\n\n    var tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n  }\n};\n\n\n/**\n * Returns a new array of elements from arr, based on the indexes of elements\n * provided by index_arr. For example, the result of index copying\n * ['a', 'b', 'c'] with index_arr [1,0,0,2] is ['b', 'a', 'a', 'c'].\n *\n * @param {!IArrayLike<T>} arr The array to get a indexed copy from.\n * @param {!IArrayLike<number>} index_arr An array of indexes to get from arr.\n * @return {!Array<T>} A new array of elements from arr in index_arr order.\n * @template T\n */\ngoog.array.copyByIndex = function(arr, index_arr) {\n  var result = [];\n  goog.array.forEach(index_arr, function(index) { result.push(arr[index]); });\n  return result;\n};\n\n\n/**\n * Maps each element of the input array into zero or more elements of the output\n * array.\n *\n * @param {!IArrayLike<VALUE>|string} arr Array or array like object\n *     over which to iterate.\n * @param {function(this:THIS, VALUE, number, ?): !Array<RESULT>} f The function\n *     to call for every element. This function takes 3 arguments (the element,\n *     the index and the array) and should return an array. The result will be\n *     used to extend a new array.\n * @param {THIS=} opt_obj The object to be used as the value of 'this' within f.\n * @return {!Array<RESULT>} a new array with the concatenation of all arrays\n *     returned from f.\n * @template THIS, VALUE, RESULT\n */\ngoog.array.concatMap = function(arr, f, opt_obj) {\n  return goog.array.concat.apply([], goog.array.map(arr, f, opt_obj));\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for string manipulation.\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\n/**\n * Namespace for string utilities\n */\ngoog.provide('goog.string');\ngoog.provide('goog.string.Unicode');\n\n\n/**\n * @define {boolean} Enables HTML escaping of lowercase letter \"e\" which helps\n * with detection of double-escaping as this letter is frequently used.\n */\ngoog.define('goog.string.DETECT_DOUBLE_ESCAPING', false);\n\n\n/**\n * @define {boolean} Whether to force non-dom html unescaping.\n */\ngoog.define('goog.string.FORCE_NON_DOM_HTML_UNESCAPING', false);\n\n\n/**\n * Common Unicode string characters.\n * @enum {string}\n */\ngoog.string.Unicode = {\n  NBSP: '\\xa0'\n};\n\n\n/**\n * Fast prefix-checker.\n * @param {string} str The string to check.\n * @param {string} prefix A string to look for at the start of `str`.\n * @return {boolean} True if `str` begins with `prefix`.\n */\ngoog.string.startsWith = function(str, prefix) {\n  return str.lastIndexOf(prefix, 0) == 0;\n};\n\n\n/**\n * Fast suffix-checker.\n * @param {string} str The string to check.\n * @param {string} suffix A string to look for at the end of `str`.\n * @return {boolean} True if `str` ends with `suffix`.\n */\ngoog.string.endsWith = function(str, suffix) {\n  var l = str.length - suffix.length;\n  return l >= 0 && str.indexOf(suffix, l) == l;\n};\n\n\n/**\n * Case-insensitive prefix-checker.\n * @param {string} str The string to check.\n * @param {string} prefix  A string to look for at the end of `str`.\n * @return {boolean} True if `str` begins with `prefix` (ignoring\n *     case).\n */\ngoog.string.caseInsensitiveStartsWith = function(str, prefix) {\n  return goog.string.caseInsensitiveCompare(\n             prefix, str.substr(0, prefix.length)) == 0;\n};\n\n\n/**\n * Case-insensitive suffix-checker.\n * @param {string} str The string to check.\n * @param {string} suffix A string to look for at the end of `str`.\n * @return {boolean} True if `str` ends with `suffix` (ignoring\n *     case).\n */\ngoog.string.caseInsensitiveEndsWith = function(str, suffix) {\n  return (\n      goog.string.caseInsensitiveCompare(\n          suffix, str.substr(str.length - suffix.length, suffix.length)) == 0);\n};\n\n\n/**\n * Case-insensitive equality checker.\n * @param {string} str1 First string to check.\n * @param {string} str2 Second string to check.\n * @return {boolean} True if `str1` and `str2` are the same string,\n *     ignoring case.\n */\ngoog.string.caseInsensitiveEquals = function(str1, str2) {\n  return str1.toLowerCase() == str2.toLowerCase();\n};\n\n\n/**\n * Does simple python-style string substitution.\n * subs(\"foo%s hot%s\", \"bar\", \"dog\") becomes \"foobar hotdog\".\n * @param {string} str The string containing the pattern.\n * @param {...*} var_args The items to substitute into the pattern.\n * @return {string} A copy of `str` in which each occurrence of\n *     {@code %s} has been replaced an argument from `var_args`.\n */\ngoog.string.subs = function(str, var_args) {\n  var splitParts = str.split('%s');\n  var returnString = '';\n\n  var subsArguments = Array.prototype.slice.call(arguments, 1);\n  while (subsArguments.length &&\n         // Replace up to the last split part. We are inserting in the\n         // positions between split parts.\n         splitParts.length > 1) {\n    returnString += splitParts.shift() + subsArguments.shift();\n  }\n\n  return returnString + splitParts.join('%s');  // Join unused '%s'\n};\n\n\n/**\n * Converts multiple whitespace chars (spaces, non-breaking-spaces, new lines\n * and tabs) to a single space, and strips leading and trailing whitespace.\n * @param {string} str Input string.\n * @return {string} A copy of `str` with collapsed whitespace.\n */\ngoog.string.collapseWhitespace = function(str) {\n  // Since IE doesn't include non-breaking-space (0xa0) in their \\s character\n  // class (as required by section 7.2 of the ECMAScript spec), we explicitly\n  // include it in the regexp to enforce consistent cross-browser behavior.\n  return str.replace(/[\\s\\xa0]+/g, ' ').replace(/^\\s+|\\s+$/g, '');\n};\n\n\n/**\n * Checks if a string is empty or contains only whitespaces.\n * @param {string} str The string to check.\n * @return {boolean} Whether `str` is empty or whitespace only.\n */\ngoog.string.isEmptyOrWhitespace = function(str) {\n  // testing length == 0 first is actually slower in all browsers (about the\n  // same in Opera).\n  // Since IE doesn't include non-breaking-space (0xa0) in their \\s character\n  // class (as required by section 7.2 of the ECMAScript spec), we explicitly\n  // include it in the regexp to enforce consistent cross-browser behavior.\n  return /^[\\s\\xa0]*$/.test(str);\n};\n\n\n/**\n * Checks if a string is empty.\n * @param {string} str The string to check.\n * @return {boolean} Whether `str` is empty.\n */\ngoog.string.isEmptyString = function(str) {\n  return str.length == 0;\n};\n\n\n/**\n * Checks if a string is empty or contains only whitespaces.\n *\n * @param {string} str The string to check.\n * @return {boolean} Whether `str` is empty or whitespace only.\n * @deprecated Use goog.string.isEmptyOrWhitespace instead.\n */\ngoog.string.isEmpty = goog.string.isEmptyOrWhitespace;\n\n\n/**\n * Checks if a string is null, undefined, empty or contains only whitespaces.\n * @param {*} str The string to check.\n * @return {boolean} Whether `str` is null, undefined, empty, or\n *     whitespace only.\n * @deprecated Use goog.string.isEmptyOrWhitespace(goog.string.makeSafe(str))\n *     instead.\n */\ngoog.string.isEmptyOrWhitespaceSafe = function(str) {\n  return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(str));\n};\n\n\n/**\n * Checks if a string is null, undefined, empty or contains only whitespaces.\n *\n * @param {*} str The string to check.\n * @return {boolean} Whether `str` is null, undefined, empty, or\n *     whitespace only.\n * @deprecated Use goog.string.isEmptyOrWhitespace instead.\n */\ngoog.string.isEmptySafe = goog.string.isEmptyOrWhitespaceSafe;\n\n\n/**\n * Checks if a string is all breaking whitespace.\n * @param {string} str The string to check.\n * @return {boolean} Whether the string is all breaking whitespace.\n */\ngoog.string.isBreakingWhitespace = function(str) {\n  return !/[^\\t\\n\\r ]/.test(str);\n};\n\n\n/**\n * Checks if a string contains all letters.\n * @param {string} str string to check.\n * @return {boolean} True if `str` consists entirely of letters.\n */\ngoog.string.isAlpha = function(str) {\n  return !/[^a-zA-Z]/.test(str);\n};\n\n\n/**\n * Checks if a string contains only numbers.\n * @param {*} str string to check. If not a string, it will be\n *     casted to one.\n * @return {boolean} True if `str` is numeric.\n */\ngoog.string.isNumeric = function(str) {\n  return !/[^0-9]/.test(str);\n};\n\n\n/**\n * Checks if a string contains only numbers or letters.\n * @param {string} str string to check.\n * @return {boolean} True if `str` is alphanumeric.\n */\ngoog.string.isAlphaNumeric = function(str) {\n  return !/[^a-zA-Z0-9]/.test(str);\n};\n\n\n/**\n * Checks if a character is a space character.\n * @param {string} ch Character to check.\n * @return {boolean} True if `ch` is a space.\n */\ngoog.string.isSpace = function(ch) {\n  return ch == ' ';\n};\n\n\n/**\n * Checks if a character is a valid unicode character.\n * @param {string} ch Character to check.\n * @return {boolean} True if `ch` is a valid unicode character.\n */\ngoog.string.isUnicodeChar = function(ch) {\n  return ch.length == 1 && ch >= ' ' && ch <= '~' ||\n      ch >= '\\u0080' && ch <= '\\uFFFD';\n};\n\n\n/**\n * Takes a string and replaces newlines with a space. Multiple lines are\n * replaced with a single space.\n * @param {string} str The string from which to strip newlines.\n * @return {string} A copy of `str` stripped of newlines.\n */\ngoog.string.stripNewlines = function(str) {\n  return str.replace(/(\\r\\n|\\r|\\n)+/g, ' ');\n};\n\n\n/**\n * Replaces Windows and Mac new lines with unix style: \\r or \\r\\n with \\n.\n * @param {string} str The string to in which to canonicalize newlines.\n * @return {string} `str` A copy of {@code} with canonicalized newlines.\n */\ngoog.string.canonicalizeNewlines = function(str) {\n  return str.replace(/(\\r\\n|\\r|\\n)/g, '\\n');\n};\n\n\n/**\n * Normalizes whitespace in a string, replacing all whitespace chars with\n * a space.\n * @param {string} str The string in which to normalize whitespace.\n * @return {string} A copy of `str` with all whitespace normalized.\n */\ngoog.string.normalizeWhitespace = function(str) {\n  return str.replace(/\\xa0|\\s/g, ' ');\n};\n\n\n/**\n * Normalizes spaces in a string, replacing all consecutive spaces and tabs\n * with a single space. Replaces non-breaking space with a space.\n * @param {string} str The string in which to normalize spaces.\n * @return {string} A copy of `str` with all consecutive spaces and tabs\n *    replaced with a single space.\n */\ngoog.string.normalizeSpaces = function(str) {\n  return str.replace(/\\xa0|[ \\t]+/g, ' ');\n};\n\n\n/**\n * Removes the breaking spaces from the left and right of the string and\n * collapses the sequences of breaking spaces in the middle into single spaces.\n * The original and the result strings render the same way in HTML.\n * @param {string} str A string in which to collapse spaces.\n * @return {string} Copy of the string with normalized breaking spaces.\n */\ngoog.string.collapseBreakingSpaces = function(str) {\n  return str.replace(/[\\t\\r\\n ]+/g, ' ')\n      .replace(/^[\\t\\r\\n ]+|[\\t\\r\\n ]+$/g, '');\n};\n\n\n/**\n * Trims white spaces to the left and right of a string.\n * @param {string} str The string to trim.\n * @return {string} A trimmed copy of `str`.\n */\ngoog.string.trim =\n    (goog.TRUSTED_SITE && String.prototype.trim) ? function(str) {\n      return str.trim();\n    } : function(str) {\n      // Since IE doesn't include non-breaking-space (0xa0) in their \\s\n      // character class (as required by section 7.2 of the ECMAScript spec),\n      // we explicitly include it in the regexp to enforce consistent\n      // cross-browser behavior.\n      // NOTE: We don't use String#replace because it might have side effects\n      // causing this function to not compile to 0 bytes.\n      return /^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(str)[1];\n    };\n\n\n/**\n * Trims whitespaces at the left end of a string.\n * @param {string} str The string to left trim.\n * @return {string} A trimmed copy of `str`.\n */\ngoog.string.trimLeft = function(str) {\n  // Since IE doesn't include non-breaking-space (0xa0) in their \\s character\n  // class (as required by section 7.2 of the ECMAScript spec), we explicitly\n  // include it in the regexp to enforce consistent cross-browser behavior.\n  return str.replace(/^[\\s\\xa0]+/, '');\n};\n\n\n/**\n * Trims whitespaces at the right end of a string.\n * @param {string} str The string to right trim.\n * @return {string} A trimmed copy of `str`.\n */\ngoog.string.trimRight = function(str) {\n  // Since IE doesn't include non-breaking-space (0xa0) in their \\s character\n  // class (as required by section 7.2 of the ECMAScript spec), we explicitly\n  // include it in the regexp to enforce consistent cross-browser behavior.\n  return str.replace(/[\\s\\xa0]+$/, '');\n};\n\n\n/**\n * A string comparator that ignores case.\n * -1 = str1 less than str2\n *  0 = str1 equals str2\n *  1 = str1 greater than str2\n *\n * @param {string} str1 The string to compare.\n * @param {string} str2 The string to compare `str1` to.\n * @return {number} The comparator result, as described above.\n */\ngoog.string.caseInsensitiveCompare = function(str1, str2) {\n  var test1 = String(str1).toLowerCase();\n  var test2 = String(str2).toLowerCase();\n\n  if (test1 < test2) {\n    return -1;\n  } else if (test1 == test2) {\n    return 0;\n  } else {\n    return 1;\n  }\n};\n\n\n/**\n * Compares two strings interpreting their numeric substrings as numbers.\n *\n * @param {string} str1 First string.\n * @param {string} str2 Second string.\n * @param {!RegExp} tokenizerRegExp Splits a string into substrings of\n *     non-negative integers, non-numeric characters and optionally fractional\n *     numbers starting with a decimal point.\n * @return {number} Negative if str1 < str2, 0 is str1 == str2, positive if\n *     str1 > str2.\n * @private\n */\ngoog.string.numberAwareCompare_ = function(str1, str2, tokenizerRegExp) {\n  if (str1 == str2) {\n    return 0;\n  }\n  if (!str1) {\n    return -1;\n  }\n  if (!str2) {\n    return 1;\n  }\n\n  // Using match to split the entire string ahead of time turns out to be faster\n  // for most inputs than using RegExp.exec or iterating over each character.\n  var tokens1 = str1.toLowerCase().match(tokenizerRegExp);\n  var tokens2 = str2.toLowerCase().match(tokenizerRegExp);\n\n  var count = Math.min(tokens1.length, tokens2.length);\n\n  for (var i = 0; i < count; i++) {\n    var a = tokens1[i];\n    var b = tokens2[i];\n\n    // Compare pairs of tokens, returning if one token sorts before the other.\n    if (a != b) {\n      // Only if both tokens are integers is a special comparison required.\n      // Decimal numbers are sorted as strings (e.g., '.09' < '.1').\n      var num1 = parseInt(a, 10);\n      if (!isNaN(num1)) {\n        var num2 = parseInt(b, 10);\n        if (!isNaN(num2) && num1 - num2) {\n          return num1 - num2;\n        }\n      }\n      return a < b ? -1 : 1;\n    }\n  }\n\n  // If one string is a substring of the other, the shorter string sorts first.\n  if (tokens1.length != tokens2.length) {\n    return tokens1.length - tokens2.length;\n  }\n\n  // The two strings must be equivalent except for case (perfect equality is\n  // tested at the head of the function.) Revert to default ASCII string\n  // comparison to stabilize the sort.\n  return str1 < str2 ? -1 : 1;\n};\n\n\n/**\n * String comparison function that handles non-negative integer numbers in a\n * way humans might expect. Using this function, the string 'File 2.jpg' sorts\n * before 'File 10.jpg', and 'Version 1.9' before 'Version 1.10'. The comparison\n * is mostly case-insensitive, though strings that are identical except for case\n * are sorted with the upper-case strings before lower-case.\n *\n * This comparison function is up to 50x slower than either the default or the\n * case-insensitive compare. It should not be used in time-critical code, but\n * should be fast enough to sort several hundred short strings (like filenames)\n * with a reasonable delay.\n *\n * @param {string} str1 The string to compare in a numerically sensitive way.\n * @param {string} str2 The string to compare `str1` to.\n * @return {number} less than 0 if str1 < str2, 0 if str1 == str2, greater than\n *     0 if str1 > str2.\n */\ngoog.string.intAwareCompare = function(str1, str2) {\n  return goog.string.numberAwareCompare_(str1, str2, /\\d+|\\D+/g);\n};\n\n\n/**\n * String comparison function that handles non-negative integer and fractional\n * numbers in a way humans might expect. Using this function, the string\n * 'File 2.jpg' sorts before 'File 10.jpg', and '3.14' before '3.2'. Equivalent\n * to {@link goog.string.intAwareCompare} apart from the way how it interprets\n * dots.\n *\n * @param {string} str1 The string to compare in a numerically sensitive way.\n * @param {string} str2 The string to compare `str1` to.\n * @return {number} less than 0 if str1 < str2, 0 if str1 == str2, greater than\n *     0 if str1 > str2.\n */\ngoog.string.floatAwareCompare = function(str1, str2) {\n  return goog.string.numberAwareCompare_(str1, str2, /\\d+|\\.\\d+|\\D+/g);\n};\n\n\n/**\n * Alias for {@link goog.string.floatAwareCompare}.\n *\n * @param {string} str1\n * @param {string} str2\n * @return {number}\n */\ngoog.string.numerateCompare = goog.string.floatAwareCompare;\n\n\n/**\n * URL-encodes a string\n * @param {*} str The string to url-encode.\n * @return {string} An encoded copy of `str` that is safe for urls.\n *     Note that '#', ':', and other characters used to delimit portions\n *     of URLs *will* be encoded.\n */\ngoog.string.urlEncode = function(str) {\n  return encodeURIComponent(String(str));\n};\n\n\n/**\n * URL-decodes the string. We need to specially handle '+'s because\n * the javascript library doesn't convert them to spaces.\n * @param {string} str The string to url decode.\n * @return {string} The decoded `str`.\n */\ngoog.string.urlDecode = function(str) {\n  return decodeURIComponent(str.replace(/\\+/g, ' '));\n};\n\n\n/**\n * Converts \\n to <br>s or <br />s.\n * @param {string} str The string in which to convert newlines.\n * @param {boolean=} opt_xml Whether to use XML compatible tags.\n * @return {string} A copy of `str` with converted newlines.\n */\ngoog.string.newLineToBr = function(str, opt_xml) {\n  return str.replace(/(\\r\\n|\\r|\\n)/g, opt_xml ? '<br />' : '<br>');\n};\n\n\n/**\n * Escapes double quote '\"' and single quote '\\'' characters in addition to\n * '&', '<', and '>' so that a string can be included in an HTML tag attribute\n * value within double or single quotes.\n *\n * It should be noted that > doesn't need to be escaped for the HTML or XML to\n * be valid, but it has been decided to escape it for consistency with other\n * implementations.\n *\n * With goog.string.DETECT_DOUBLE_ESCAPING, this function escapes also the\n * lowercase letter \"e\".\n *\n * NOTE(user):\n * HtmlEscape is often called during the generation of large blocks of HTML.\n * Using statics for the regular expressions and strings is an optimization\n * that can more than half the amount of time IE spends in this function for\n * large apps, since strings and regexes both contribute to GC allocations.\n *\n * Testing for the presence of a character before escaping increases the number\n * of function calls, but actually provides a speed increase for the average\n * case -- since the average case often doesn't require the escaping of all 4\n * characters and indexOf() is much cheaper than replace().\n * The worst case does suffer slightly from the additional calls, therefore the\n * opt_isLikelyToContainHtmlChars option has been included for situations\n * where all 4 HTML entities are very likely to be present and need escaping.\n *\n * Some benchmarks (times tended to fluctuate +-0.05ms):\n *                                     FireFox                     IE6\n * (no chars / average (mix of cases) / all 4 chars)\n * no checks                     0.13 / 0.22 / 0.22         0.23 / 0.53 / 0.80\n * indexOf                       0.08 / 0.17 / 0.26         0.22 / 0.54 / 0.84\n * indexOf + re test             0.07 / 0.17 / 0.28         0.19 / 0.50 / 0.85\n *\n * An additional advantage of checking if replace actually needs to be called\n * is a reduction in the number of object allocations, so as the size of the\n * application grows the difference between the various methods would increase.\n *\n * @param {string} str string to be escaped.\n * @param {boolean=} opt_isLikelyToContainHtmlChars Don't perform a check to see\n *     if the character needs replacing - use this option if you expect each of\n *     the characters to appear often. Leave false if you expect few html\n *     characters to occur in your strings, such as if you are escaping HTML.\n * @return {string} An escaped copy of `str`.\n */\ngoog.string.htmlEscape = function(str, opt_isLikelyToContainHtmlChars) {\n  if (opt_isLikelyToContainHtmlChars) {\n    str = str.replace(goog.string.AMP_RE_, '&amp;')\n              .replace(goog.string.LT_RE_, '&lt;')\n              .replace(goog.string.GT_RE_, '&gt;')\n              .replace(goog.string.QUOT_RE_, '&quot;')\n              .replace(goog.string.SINGLE_QUOTE_RE_, '&#39;')\n              .replace(goog.string.NULL_RE_, '&#0;');\n    if (goog.string.DETECT_DOUBLE_ESCAPING) {\n      str = str.replace(goog.string.E_RE_, '&#101;');\n    }\n    return str;\n\n  } else {\n    // quick test helps in the case when there are no chars to replace, in\n    // worst case this makes barely a difference to the time taken\n    if (!goog.string.ALL_RE_.test(str)) return str;\n\n    // str.indexOf is faster than regex.test in this case\n    if (str.indexOf('&') != -1) {\n      str = str.replace(goog.string.AMP_RE_, '&amp;');\n    }\n    if (str.indexOf('<') != -1) {\n      str = str.replace(goog.string.LT_RE_, '&lt;');\n    }\n    if (str.indexOf('>') != -1) {\n      str = str.replace(goog.string.GT_RE_, '&gt;');\n    }\n    if (str.indexOf('\"') != -1) {\n      str = str.replace(goog.string.QUOT_RE_, '&quot;');\n    }\n    if (str.indexOf('\\'') != -1) {\n      str = str.replace(goog.string.SINGLE_QUOTE_RE_, '&#39;');\n    }\n    if (str.indexOf('\\x00') != -1) {\n      str = str.replace(goog.string.NULL_RE_, '&#0;');\n    }\n    if (goog.string.DETECT_DOUBLE_ESCAPING && str.indexOf('e') != -1) {\n      str = str.replace(goog.string.E_RE_, '&#101;');\n    }\n    return str;\n  }\n};\n\n\n/**\n * Regular expression that matches an ampersand, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.AMP_RE_ = /&/g;\n\n\n/**\n * Regular expression that matches a less than sign, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.LT_RE_ = /</g;\n\n\n/**\n * Regular expression that matches a greater than sign, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.GT_RE_ = />/g;\n\n\n/**\n * Regular expression that matches a double quote, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.QUOT_RE_ = /\"/g;\n\n\n/**\n * Regular expression that matches a single quote, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.SINGLE_QUOTE_RE_ = /'/g;\n\n\n/**\n * Regular expression that matches null character, for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.NULL_RE_ = /\\x00/g;\n\n\n/**\n * Regular expression that matches a lowercase letter \"e\", for use in escaping.\n * @const {!RegExp}\n * @private\n */\ngoog.string.E_RE_ = /e/g;\n\n\n/**\n * Regular expression that matches any character that needs to be escaped.\n * @const {!RegExp}\n * @private\n */\ngoog.string.ALL_RE_ =\n    (goog.string.DETECT_DOUBLE_ESCAPING ? /[\\x00&<>\"'e]/ : /[\\x00&<>\"']/);\n\n\n/**\n * Unescapes an HTML string.\n *\n * @param {string} str The string to unescape.\n * @return {string} An unescaped copy of `str`.\n */\ngoog.string.unescapeEntities = function(str) {\n  if (goog.string.contains(str, '&')) {\n    // We are careful not to use a DOM if we do not have one or we explicitly\n    // requested non-DOM html unescaping.\n    if (!goog.string.FORCE_NON_DOM_HTML_UNESCAPING &&\n        'document' in goog.global) {\n      return goog.string.unescapeEntitiesUsingDom_(str);\n    } else {\n      // Fall back on pure XML entities\n      return goog.string.unescapePureXmlEntities_(str);\n    }\n  }\n  return str;\n};\n\n\n/**\n * Unescapes a HTML string using the provided document.\n *\n * @param {string} str The string to unescape.\n * @param {!Document} document A document to use in escaping the string.\n * @return {string} An unescaped copy of `str`.\n */\ngoog.string.unescapeEntitiesWithDocument = function(str, document) {\n  if (goog.string.contains(str, '&')) {\n    return goog.string.unescapeEntitiesUsingDom_(str, document);\n  }\n  return str;\n};\n\n\n/**\n * Unescapes an HTML string using a DOM to resolve non-XML, non-numeric\n * entities. This function is XSS-safe and whitespace-preserving.\n * @private\n * @param {string} str The string to unescape.\n * @param {Document=} opt_document An optional document to use for creating\n *     elements. If this is not specified then the default window.document\n *     will be used.\n * @return {string} The unescaped `str` string.\n */\ngoog.string.unescapeEntitiesUsingDom_ = function(str, opt_document) {\n  /** @type {!Object<string, string>} */\n  var seen = {'&amp;': '&', '&lt;': '<', '&gt;': '>', '&quot;': '\"'};\n  var div;\n  if (opt_document) {\n    div = opt_document.createElement('div');\n  } else {\n    div = goog.global.document.createElement('div');\n  }\n  // Match as many valid entity characters as possible. If the actual entity\n  // happens to be shorter, it will still work as innerHTML will return the\n  // trailing characters unchanged. Since the entity characters do not include\n  // open angle bracket, there is no chance of XSS from the innerHTML use.\n  // Since no whitespace is passed to innerHTML, whitespace is preserved.\n  return str.replace(goog.string.HTML_ENTITY_PATTERN_, function(s, entity) {\n    // Check for cached entity.\n    var value = seen[s];\n    if (value) {\n      return value;\n    }\n    // Check for numeric entity.\n    if (entity.charAt(0) == '#') {\n      // Prefix with 0 so that hex entities (e.g. &#x10) parse as hex numbers.\n      var n = Number('0' + entity.substr(1));\n      if (!isNaN(n)) {\n        value = String.fromCharCode(n);\n      }\n    }\n    // Fall back to innerHTML otherwise.\n    if (!value) {\n      // Append a non-entity character to avoid a bug in Webkit that parses\n      // an invalid entity at the end of innerHTML text as the empty string.\n      div.innerHTML = s + ' ';\n      // Then remove the trailing character from the result.\n      value = div.firstChild.nodeValue.slice(0, -1);\n    }\n    // Cache and return.\n    return seen[s] = value;\n  });\n};\n\n\n/**\n * Unescapes XML entities.\n * @private\n * @param {string} str The string to unescape.\n * @return {string} An unescaped copy of `str`.\n */\ngoog.string.unescapePureXmlEntities_ = function(str) {\n  return str.replace(/&([^;]+);/g, function(s, entity) {\n    switch (entity) {\n      case 'amp':\n        return '&';\n      case 'lt':\n        return '<';\n      case 'gt':\n        return '>';\n      case 'quot':\n        return '\"';\n      default:\n        if (entity.charAt(0) == '#') {\n          // Prefix with 0 so that hex entities (e.g. &#x10) parse as hex.\n          var n = Number('0' + entity.substr(1));\n          if (!isNaN(n)) {\n            return String.fromCharCode(n);\n          }\n        }\n        // For invalid entities we just return the entity\n        return s;\n    }\n  });\n};\n\n\n/**\n * Regular expression that matches an HTML entity.\n * See also HTML5: Tokenization / Tokenizing character references.\n * @private\n * @type {!RegExp}\n */\ngoog.string.HTML_ENTITY_PATTERN_ = /&([^;\\s<&]+);?/g;\n\n\n/**\n * Do escaping of whitespace to preserve spatial formatting. We use character\n * entity #160 to make it safer for xml.\n * @param {string} str The string in which to escape whitespace.\n * @param {boolean=} opt_xml Whether to use XML compatible tags.\n * @return {string} An escaped copy of `str`.\n */\ngoog.string.whitespaceEscape = function(str, opt_xml) {\n  // This doesn't use goog.string.preserveSpaces for backwards compatibility.\n  return goog.string.newLineToBr(str.replace(/  /g, ' &#160;'), opt_xml);\n};\n\n\n/**\n * Preserve spaces that would be otherwise collapsed in HTML by replacing them\n * with non-breaking space Unicode characters.\n * @param {string} str The string in which to preserve whitespace.\n * @return {string} A copy of `str` with preserved whitespace.\n */\ngoog.string.preserveSpaces = function(str) {\n  return str.replace(/(^|[\\n ]) /g, '$1' + goog.string.Unicode.NBSP);\n};\n\n\n/**\n * Strip quote characters around a string.  The second argument is a string of\n * characters to treat as quotes.  This can be a single character or a string of\n * multiple character and in that case each of those are treated as possible\n * quote characters. For example:\n *\n * <pre>\n * goog.string.stripQuotes('\"abc\"', '\"`') --\u003e 'abc'\n * goog.string.stripQuotes('`abc`', '\"`') --\u003e 'abc'\n * </pre>\n *\n * @param {string} str The string to strip.\n * @param {string} quoteChars The quote characters to strip.\n * @return {string} A copy of `str` without the quotes.\n */\ngoog.string.stripQuotes = function(str, quoteChars) {\n  var length = quoteChars.length;\n  for (var i = 0; i < length; i++) {\n    var quoteChar = length == 1 ? quoteChars : quoteChars.charAt(i);\n    if (str.charAt(0) == quoteChar && str.charAt(str.length - 1) == quoteChar) {\n      return str.substring(1, str.length - 1);\n    }\n  }\n  return str;\n};\n\n\n/**\n * Truncates a string to a certain length and adds '...' if necessary.  The\n * length also accounts for the ellipsis, so a maximum length of 10 and a string\n * 'Hello World!' produces 'Hello W...'.\n * @param {string} str The string to truncate.\n * @param {number} chars Max number of characters.\n * @param {boolean=} opt_protectEscapedCharacters Whether to protect escaped\n *     characters from being cut off in the middle.\n * @return {string} The truncated `str` string.\n */\ngoog.string.truncate = function(str, chars, opt_protectEscapedCharacters) {\n  if (opt_protectEscapedCharacters) {\n    str = goog.string.unescapeEntities(str);\n  }\n\n  if (str.length > chars) {\n    str = str.substring(0, chars - 3) + '...';\n  }\n\n  if (opt_protectEscapedCharacters) {\n    str = goog.string.htmlEscape(str);\n  }\n\n  return str;\n};\n\n\n/**\n * Truncate a string in the middle, adding \"...\" if necessary,\n * and favoring the beginning of the string.\n * @param {string} str The string to truncate the middle of.\n * @param {number} chars Max number of characters.\n * @param {boolean=} opt_protectEscapedCharacters Whether to protect escaped\n *     characters from being cutoff in the middle.\n * @param {number=} opt_trailingChars Optional number of trailing characters to\n *     leave at the end of the string, instead of truncating as close to the\n *     middle as possible.\n * @return {string} A truncated copy of `str`.\n */\ngoog.string.truncateMiddle = function(\n    str, chars, opt_protectEscapedCharacters, opt_trailingChars) {\n  if (opt_protectEscapedCharacters) {\n    str = goog.string.unescapeEntities(str);\n  }\n\n  if (opt_trailingChars && str.length > chars) {\n    if (opt_trailingChars > chars) {\n      opt_trailingChars = chars;\n    }\n    var endPoint = str.length - opt_trailingChars;\n    var startPoint = chars - opt_trailingChars;\n    str = str.substring(0, startPoint) + '...' + str.substring(endPoint);\n  } else if (str.length > chars) {\n    // Favor the beginning of the string:\n    var half = Math.floor(chars / 2);\n    var endPos = str.length - half;\n    half += chars % 2;\n    str = str.substring(0, half) + '...' + str.substring(endPos);\n  }\n\n  if (opt_protectEscapedCharacters) {\n    str = goog.string.htmlEscape(str);\n  }\n\n  return str;\n};\n\n\n/**\n * Special chars that need to be escaped for goog.string.quote.\n * @private {!Object<string, string>}\n */\ngoog.string.specialEscapeChars_ = {\n  '\\0': '\\\\0',\n  '\\b': '\\\\b',\n  '\\f': '\\\\f',\n  '\\n': '\\\\n',\n  '\\r': '\\\\r',\n  '\\t': '\\\\t',\n  '\\x0B': '\\\\x0B',  // '\\v' is not supported in JScript\n  '\"': '\\\\\"',\n  '\\\\': '\\\\\\\\',\n  // To support the use case of embedding quoted strings inside of script\n  // tags, we have to make sure HTML comments and opening/closing script tags do\n  // not appear in the resulting string. The specific strings that must be\n  // escaped are documented at:\n  // http://www.w3.org/TR/html51/semantics.html#restrictions-for-contents-of-script-elements\n  '<': '\\x3c'\n};\n\n\n/**\n * Character mappings used internally for goog.string.escapeChar.\n * @private {!Object<string, string>}\n */\ngoog.string.jsEscapeCache_ = {\n  '\\'': '\\\\\\''\n};\n\n\n/**\n * Encloses a string in double quotes and escapes characters so that the\n * string is a valid JS string. The resulting string is safe to embed in\n * `<script>` tags as \"<\" is escaped.\n * @param {string} s The string to quote.\n * @return {string} A copy of `s` surrounded by double quotes.\n */\ngoog.string.quote = function(s) {\n  s = String(s);\n  var sb = ['\"'];\n  for (var i = 0; i < s.length; i++) {\n    var ch = s.charAt(i);\n    var cc = ch.charCodeAt(0);\n    sb[i + 1] = goog.string.specialEscapeChars_[ch] ||\n        ((cc > 31 && cc < 127) ? ch : goog.string.escapeChar(ch));\n  }\n  sb.push('\"');\n  return sb.join('');\n};\n\n\n/**\n * Takes a string and returns the escaped string for that input string.\n * @param {string} str The string to escape.\n * @return {string} An escaped string representing `str`.\n */\ngoog.string.escapeString = function(str) {\n  var sb = [];\n  for (var i = 0; i < str.length; i++) {\n    sb[i] = goog.string.escapeChar(str.charAt(i));\n  }\n  return sb.join('');\n};\n\n\n/**\n * Takes a character and returns the escaped string for that character. For\n * example escapeChar(String.fromCharCode(15)) -> \"\\\\x0E\".\n * @param {string} c The character to escape.\n * @return {string} An escaped string representing `c`.\n */\ngoog.string.escapeChar = function(c) {\n  if (c in goog.string.jsEscapeCache_) {\n    return goog.string.jsEscapeCache_[c];\n  }\n\n  if (c in goog.string.specialEscapeChars_) {\n    return goog.string.jsEscapeCache_[c] = goog.string.specialEscapeChars_[c];\n  }\n\n  var rv = c;\n  var cc = c.charCodeAt(0);\n  if (cc > 31 && cc < 127) {\n    rv = c;\n  } else {\n    // tab is 9 but handled above\n    if (cc < 256) {\n      rv = '\\\\x';\n      if (cc < 16 || cc > 256) {\n        rv += '0';\n      }\n    } else {\n      rv = '\\\\u';\n      if (cc < 4096) {  // \\u1000\n        rv += '0';\n      }\n    }\n    rv += cc.toString(16).toUpperCase();\n  }\n\n  return goog.string.jsEscapeCache_[c] = rv;\n};\n\n\n/**\n * Determines whether a string contains a substring.\n * @param {string} str The string to search.\n * @param {string} subString The substring to search for.\n * @return {boolean} Whether `str` contains `subString`.\n */\ngoog.string.contains = function(str, subString) {\n  return str.indexOf(subString) != -1;\n};\n\n\n/**\n * Determines whether a string contains a substring, ignoring case.\n * @param {string} str The string to search.\n * @param {string} subString The substring to search for.\n * @return {boolean} Whether `str` contains `subString`.\n */\ngoog.string.caseInsensitiveContains = function(str, subString) {\n  return goog.string.contains(str.toLowerCase(), subString.toLowerCase());\n};\n\n\n/**\n * Returns the non-overlapping occurrences of ss in s.\n * If either s or ss evalutes to false, then returns zero.\n * @param {string} s The string to look in.\n * @param {string} ss The string to look for.\n * @return {number} Number of occurrences of ss in s.\n */\ngoog.string.countOf = function(s, ss) {\n  return s && ss ? s.split(ss).length - 1 : 0;\n};\n\n\n/**\n * Removes a substring of a specified length at a specific\n * index in a string.\n * @param {string} s The base string from which to remove.\n * @param {number} index The index at which to remove the substring.\n * @param {number} stringLength The length of the substring to remove.\n * @return {string} A copy of `s` with the substring removed or the full\n *     string if nothing is removed or the input is invalid.\n */\ngoog.string.removeAt = function(s, index, stringLength) {\n  var resultStr = s;\n  // If the index is greater or equal to 0 then remove substring\n  if (index >= 0 && index < s.length && stringLength > 0) {\n    resultStr = s.substr(0, index) +\n        s.substr(index + stringLength, s.length - index - stringLength);\n  }\n  return resultStr;\n};\n\n\n/**\n * Removes the first occurrence of a substring from a string.\n * @param {string} str The base string from which to remove.\n * @param {string} substr The string to remove.\n * @return {string} A copy of `str` with `substr` removed or the\n *     full string if nothing is removed.\n */\ngoog.string.remove = function(str, substr) {\n  return str.replace(substr, '');\n};\n\n\n/**\n *  Removes all occurrences of a substring from a string.\n *  @param {string} s The base string from which to remove.\n *  @param {string} ss The string to remove.\n *  @return {string} A copy of `s` with `ss` removed or the full\n *      string if nothing is removed.\n */\ngoog.string.removeAll = function(s, ss) {\n  var re = new RegExp(goog.string.regExpEscape(ss), 'g');\n  return s.replace(re, '');\n};\n\n\n/**\n *  Replaces all occurrences of a substring of a string with a new substring.\n *  @param {string} s The base string from which to remove.\n *  @param {string} ss The string to replace.\n *  @param {string} replacement The replacement string.\n *  @return {string} A copy of `s` with `ss` replaced by\n *      `replacement` or the original string if nothing is replaced.\n */\ngoog.string.replaceAll = function(s, ss, replacement) {\n  var re = new RegExp(goog.string.regExpEscape(ss), 'g');\n  return s.replace(re, replacement.replace(/\\$/g, '$$$$'));\n};\n\n\n/**\n * Escapes characters in the string that are not safe to use in a RegExp.\n * @param {*} s The string to escape. If not a string, it will be casted\n *     to one.\n * @return {string} A RegExp safe, escaped copy of `s`.\n */\ngoog.string.regExpEscape = function(s) {\n  return String(s)\n      .replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')\n      .replace(/\\x08/g, '\\\\x08');\n};\n\n\n/**\n * Repeats a string n times.\n * @param {string} string The string to repeat.\n * @param {number} length The number of times to repeat.\n * @return {string} A string containing `length` repetitions of\n *     `string`.\n */\ngoog.string.repeat = (String.prototype.repeat) ? function(string, length) {\n  // The native method is over 100 times faster than the alternative.\n  return string.repeat(length);\n} : function(string, length) {\n  return new Array(length + 1).join(string);\n};\n\n\n/**\n * Pads number to given length and optionally rounds it to a given precision.\n * For example:\n * <pre>padNumber(1.25, 2, 3) -> '01.250'\n * padNumber(1.25, 2) -> '01.25'\n * padNumber(1.25, 2, 1) -> '01.3'\n * padNumber(1.25, 0) -> '1.25'</pre>\n *\n * @param {number} num The number to pad.\n * @param {number} length The desired length.\n * @param {number=} opt_precision The desired precision.\n * @return {string} `num` as a string with the given options.\n */\ngoog.string.padNumber = function(num, length, opt_precision) {\n  var s = goog.isDef(opt_precision) ? num.toFixed(opt_precision) : String(num);\n  var index = s.indexOf('.');\n  if (index == -1) {\n    index = s.length;\n  }\n  return goog.string.repeat('0', Math.max(0, length - index)) + s;\n};\n\n\n/**\n * Returns a string representation of the given object, with\n * null and undefined being returned as the empty string.\n *\n * @param {*} obj The object to convert.\n * @return {string} A string representation of the `obj`.\n */\ngoog.string.makeSafe = function(obj) {\n  return obj == null ? '' : String(obj);\n};\n\n\n/**\n * Concatenates string expressions. This is useful\n * since some browsers are very inefficient when it comes to using plus to\n * concat strings. Be careful when using null and undefined here since\n * these will not be included in the result. If you need to represent these\n * be sure to cast the argument to a String first.\n * For example:\n * <pre>buildString('a', 'b', 'c', 'd') -> 'abcd'\n * buildString(null, undefined) -> ''\n * </pre>\n * @param {...*} var_args A list of strings to concatenate. If not a string,\n *     it will be casted to one.\n * @return {string} The concatenation of `var_args`.\n */\ngoog.string.buildString = function(var_args) {\n  return Array.prototype.join.call(arguments, '');\n};\n\n\n/**\n * Returns a string with at least 64-bits of randomness.\n *\n * Doesn't trust JavaScript's random function entirely. Uses a combination of\n * random and current timestamp, and then encodes the string in base-36 to\n * make it shorter.\n *\n * @return {string} A random string, e.g. sn1s7vb4gcic.\n */\ngoog.string.getRandomString = function() {\n  var x = 2147483648;\n  return Math.floor(Math.random() * x).toString(36) +\n      Math.abs(Math.floor(Math.random() * x) ^ goog.now()).toString(36);\n};\n\n\n/**\n * Compares two version numbers.\n *\n * @param {string|number} version1 Version of first item.\n * @param {string|number} version2 Version of second item.\n *\n * @return {number}  1 if `version1` is higher.\n *                   0 if arguments are equal.\n *                  -1 if `version2` is higher.\n */\ngoog.string.compareVersions = function(version1, version2) {\n  var order = 0;\n  // Trim leading and trailing whitespace and split the versions into\n  // subversions.\n  var v1Subs = goog.string.trim(String(version1)).split('.');\n  var v2Subs = goog.string.trim(String(version2)).split('.');\n  var subCount = Math.max(v1Subs.length, v2Subs.length);\n\n  // Iterate over the subversions, as long as they appear to be equivalent.\n  for (var subIdx = 0; order == 0 && subIdx < subCount; subIdx++) {\n    var v1Sub = v1Subs[subIdx] || '';\n    var v2Sub = v2Subs[subIdx] || '';\n\n    do {\n      // Split the subversions into pairs of numbers and qualifiers (like 'b').\n      // Two different RegExp objects are use to make it clear the code\n      // is side-effect free\n      var v1Comp = /(\\d*)(\\D*)(.*)/.exec(v1Sub) || ['', '', '', ''];\n      var v2Comp = /(\\d*)(\\D*)(.*)/.exec(v2Sub) || ['', '', '', ''];\n      // Break if there are no more matches.\n      if (v1Comp[0].length == 0 && v2Comp[0].length == 0) {\n        break;\n      }\n\n      // Parse the numeric part of the subversion. A missing number is\n      // equivalent to 0.\n      var v1CompNum = v1Comp[1].length == 0 ? 0 : parseInt(v1Comp[1], 10);\n      var v2CompNum = v2Comp[1].length == 0 ? 0 : parseInt(v2Comp[1], 10);\n\n      // Compare the subversion components. The number has the highest\n      // precedence. Next, if the numbers are equal, a subversion without any\n      // qualifier is always higher than a subversion with any qualifier. Next,\n      // the qualifiers are compared as strings.\n      order = goog.string.compareElements_(v1CompNum, v2CompNum) ||\n          goog.string.compareElements_(\n              v1Comp[2].length == 0, v2Comp[2].length == 0) ||\n          goog.string.compareElements_(v1Comp[2], v2Comp[2]);\n      // Stop as soon as an inequality is discovered.\n\n      v1Sub = v1Comp[3];\n      v2Sub = v2Comp[3];\n    } while (order == 0);\n  }\n\n  return order;\n};\n\n\n/**\n * Compares elements of a version number.\n *\n * @param {string|number|boolean} left An element from a version number.\n * @param {string|number|boolean} right An element from a version number.\n *\n * @return {number}  1 if `left` is higher.\n *                   0 if arguments are equal.\n *                  -1 if `right` is higher.\n * @private\n */\ngoog.string.compareElements_ = function(left, right) {\n  if (left < right) {\n    return -1;\n  } else if (left > right) {\n    return 1;\n  }\n  return 0;\n};\n\n\n/**\n * String hash function similar to java.lang.String.hashCode().\n * The hash code for a string is computed as\n * s[0] * 31 ^ (n - 1) + s[1] * 31 ^ (n - 2) + ... + s[n - 1],\n * where s[i] is the ith character of the string and n is the length of\n * the string. We mod the result to make it between 0 (inclusive) and 2^32\n * (exclusive).\n * @param {string} str A string.\n * @return {number} Hash value for `str`, between 0 (inclusive) and 2^32\n *  (exclusive). The empty string returns 0.\n */\ngoog.string.hashCode = function(str) {\n  var result = 0;\n  for (var i = 0; i < str.length; ++i) {\n    // Normalize to 4 byte range, 0 ... 2^32.\n    result = (31 * result + str.charCodeAt(i)) >>> 0;\n  }\n  return result;\n};\n\n\n/**\n * The most recent unique ID. |0 is equivalent to Math.floor in this case.\n * @type {number}\n * @private\n */\ngoog.string.uniqueStringCounter_ = Math.random() * 0x80000000 | 0;\n\n\n/**\n * Generates and returns a string which is unique in the current document.\n * This is useful, for example, to create unique IDs for DOM elements.\n * @return {string} A unique id.\n */\ngoog.string.createUniqueString = function() {\n  return 'goog_' + goog.string.uniqueStringCounter_++;\n};\n\n\n/**\n * Converts the supplied string to a number, which may be Infinity or NaN.\n * This function strips whitespace: (toNumber(' 123') === 123)\n * This function accepts scientific notation: (toNumber('1e1') === 10)\n *\n * This is better than JavaScript's built-in conversions because, sadly:\n *     (Number(' ') === 0) and (parseFloat('123a') === 123)\n *\n * @param {string} str The string to convert.\n * @return {number} The number the supplied string represents, or NaN.\n */\ngoog.string.toNumber = function(str) {\n  var num = Number(str);\n  if (num == 0 && goog.string.isEmptyOrWhitespace(str)) {\n    return NaN;\n  }\n  return num;\n};\n\n\n/**\n * Returns whether the given string is lower camel case (e.g. \"isFooBar\").\n *\n * Note that this assumes the string is entirely letters.\n * @see http://en.wikipedia.org/wiki/CamelCase#Variations_and_synonyms\n *\n * @param {string} str String to test.\n * @return {boolean} Whether the string is lower camel case.\n */\ngoog.string.isLowerCamelCase = function(str) {\n  return /^[a-z]+([A-Z][a-z]*)*$/.test(str);\n};\n\n\n/**\n * Returns whether the given string is upper camel case (e.g. \"FooBarBaz\").\n *\n * Note that this assumes the string is entirely letters.\n * @see http://en.wikipedia.org/wiki/CamelCase#Variations_and_synonyms\n *\n * @param {string} str String to test.\n * @return {boolean} Whether the string is upper camel case.\n */\ngoog.string.isUpperCamelCase = function(str) {\n  return /^([A-Z][a-z]*)+$/.test(str);\n};\n\n\n/**\n * Converts a string from selector-case to camelCase (e.g. from\n * \"multi-part-string\" to \"multiPartString\"), useful for converting\n * CSS selectors and HTML dataset keys to their equivalent JS properties.\n * @param {string} str The string in selector-case form.\n * @return {string} The string in camelCase form.\n */\ngoog.string.toCamelCase = function(str) {\n  return String(str).replace(/\\-([a-z])/g, function(all, match) {\n    return match.toUpperCase();\n  });\n};\n\n\n/**\n * Converts a string from camelCase to selector-case (e.g. from\n * \"multiPartString\" to \"multi-part-string\"), useful for converting JS\n * style and dataset properties to equivalent CSS selectors and HTML keys.\n * @param {string} str The string in camelCase form.\n * @return {string} The string in selector-case form.\n */\ngoog.string.toSelectorCase = function(str) {\n  return String(str).replace(/([A-Z])/g, '-$1').toLowerCase();\n};\n\n\n/**\n * Converts a string into TitleCase. First character of the string is always\n * capitalized in addition to the first letter of every subsequent word.\n * Words are delimited by one or more whitespaces by default. Custom delimiters\n * can optionally be specified to replace the default, which doesn't preserve\n * whitespace delimiters and instead must be explicitly included if needed.\n *\n * Default delimiter => \" \":\n *    goog.string.toTitleCase('oneTwoThree')    => 'OneTwoThree'\n *    goog.string.toTitleCase('one two three')  => 'One Two Three'\n *    goog.string.toTitleCase('  one   two   ') => '  One   Two   '\n *    goog.string.toTitleCase('one_two_three')  => 'One_two_three'\n *    goog.string.toTitleCase('one-two-three')  => 'One-two-three'\n *\n * Custom delimiter => \"_-.\":\n *    goog.string.toTitleCase('oneTwoThree', '_-.')       => 'OneTwoThree'\n *    goog.string.toTitleCase('one two three', '_-.')     => 'One two three'\n *    goog.string.toTitleCase('  one   two   ', '_-.')    => '  one   two   '\n *    goog.string.toTitleCase('one_two_three', '_-.')     => 'One_Two_Three'\n *    goog.string.toTitleCase('one-two-three', '_-.')     => 'One-Two-Three'\n *    goog.string.toTitleCase('one...two...three', '_-.') => 'One...Two...Three'\n *    goog.string.toTitleCase('one. two. three', '_-.')   => 'One. two. three'\n *    goog.string.toTitleCase('one-two.three', '_-.')     => 'One-Two.Three'\n *\n * @param {string} str String value in camelCase form.\n * @param {string=} opt_delimiters Custom delimiter character set used to\n *      distinguish words in the string value. Each character represents a\n *      single delimiter. When provided, default whitespace delimiter is\n *      overridden and must be explicitly included if needed.\n * @return {string} String value in TitleCase form.\n */\ngoog.string.toTitleCase = function(str, opt_delimiters) {\n  var delimiters = goog.isString(opt_delimiters) ?\n      goog.string.regExpEscape(opt_delimiters) :\n      '\\\\s';\n\n  // For IE8, we need to prevent using an empty character set. Otherwise,\n  // incorrect matching will occur.\n  delimiters = delimiters ? '|[' + delimiters + ']+' : '';\n\n  var regexp = new RegExp('(^' + delimiters + ')([a-z])', 'g');\n  return str.replace(regexp, function(all, p1, p2) {\n    return p1 + p2.toUpperCase();\n  });\n};\n\n\n/**\n * Capitalizes a string, i.e. converts the first letter to uppercase\n * and all other letters to lowercase, e.g.:\n *\n * goog.string.capitalize('one')     => 'One'\n * goog.string.capitalize('ONE')     => 'One'\n * goog.string.capitalize('one two') => 'One two'\n *\n * Note that this function does not trim initial whitespace.\n *\n * @param {string} str String value to capitalize.\n * @return {string} String value with first letter in uppercase.\n */\ngoog.string.capitalize = function(str) {\n  return String(str.charAt(0)).toUpperCase() +\n      String(str.substr(1)).toLowerCase();\n};\n\n\n/**\n * Parse a string in decimal or hexidecimal ('0xFFFF') form.\n *\n * To parse a particular radix, please use parseInt(string, radix) directly. See\n * https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseInt\n *\n * This is a wrapper for the built-in parseInt function that will only parse\n * numbers as base 10 or base 16.  Some JS implementations assume strings\n * starting with \"0\" are intended to be octal. ES3 allowed but discouraged\n * this behavior. ES5 forbids it.  This function emulates the ES5 behavior.\n *\n * For more information, see Mozilla JS Reference: http://goo.gl/8RiFj\n *\n * @param {string|number|null|undefined} value The value to be parsed.\n * @return {number} The number, parsed. If the string failed to parse, this\n *     will be NaN.\n */\ngoog.string.parseInt = function(value) {\n  // Force finite numbers to strings.\n  if (isFinite(value)) {\n    value = String(value);\n  }\n\n  if (goog.isString(value)) {\n    // If the string starts with '0x' or '-0x', parse as hex.\n    return /^\\s*-?0x/i.test(value) ? parseInt(value, 16) : parseInt(value, 10);\n  }\n\n  return NaN;\n};\n\n\n/**\n * Splits a string on a separator a limited number of times.\n *\n * This implementation is more similar to Python or Java, where the limit\n * parameter specifies the maximum number of splits rather than truncating\n * the number of results.\n *\n * See http://docs.python.org/2/library/stdtypes.html#str.split\n * See JavaDoc: http://goo.gl/F2AsY\n * See Mozilla reference: http://goo.gl/dZdZs\n *\n * @param {string} str String to split.\n * @param {string} separator The separator.\n * @param {number} limit The limit to the number of splits. The resulting array\n *     will have a maximum length of limit+1.  Negative numbers are the same\n *     as zero.\n * @return {!Array<string>} The string, split.\n */\ngoog.string.splitLimit = function(str, separator, limit) {\n  var parts = str.split(separator);\n  var returnVal = [];\n\n  // Only continue doing this while we haven't hit the limit and we have\n  // parts left.\n  while (limit > 0 && parts.length) {\n    returnVal.push(parts.shift());\n    limit--;\n  }\n\n  // If there are remaining parts, append them to the end.\n  if (parts.length) {\n    returnVal.push(parts.join(separator));\n  }\n\n  return returnVal;\n};\n\n\n/**\n * Finds the characters to the right of the last instance of any separator\n *\n * This function is similar to goog.string.path.baseName, except it can take a\n * list of characters to split the string on. It will return the rightmost\n * grouping of characters to the right of any separator as a left-to-right\n * oriented string.\n *\n * @see goog.string.path.baseName\n * @param {string} str The string\n * @param {string|!Array<string>} separators A list of separator characters\n * @return {string} The last part of the string with respect to the separators\n */\ngoog.string.lastComponent = function(str, separators) {\n  if (!separators) {\n    return str;\n  } else if (typeof separators == 'string') {\n    separators = [separators];\n  }\n\n  var lastSeparatorIndex = -1;\n  for (var i = 0; i < separators.length; i++) {\n    if (separators[i] == '') {\n      continue;\n    }\n    var currentSeparatorIndex = str.lastIndexOf(separators[i]);\n    if (currentSeparatorIndex > lastSeparatorIndex) {\n      lastSeparatorIndex = currentSeparatorIndex;\n    }\n  }\n  if (lastSeparatorIndex == -1) {\n    return str;\n  }\n  return str.slice(lastSeparatorIndex + 1);\n};\n\n\n/**\n * Computes the Levenshtein edit distance between two strings.\n * @param {string} a\n * @param {string} b\n * @return {number} The edit distance between the two strings.\n */\ngoog.string.editDistance = function(a, b) {\n  var v0 = [];\n  var v1 = [];\n\n  if (a == b) {\n    return 0;\n  }\n\n  if (!a.length || !b.length) {\n    return Math.max(a.length, b.length);\n  }\n\n  for (var i = 0; i < b.length + 1; i++) {\n    v0[i] = i;\n  }\n\n  for (var i = 0; i < a.length; i++) {\n    v1[0] = i + 1;\n\n    for (var j = 0; j < b.length; j++) {\n      var cost = Number(a[i] != b[j]);\n      // Cost for the substring is the minimum of adding one character, removing\n      // one character, or a swap.\n      v1[j + 1] = Math.min(v1[j] + 1, v0[j + 1] + 1, v0[j] + cost);\n    }\n\n    for (var j = 0; j < v0.length; j++) {\n      v0[j] = v1[j];\n    }\n  }\n\n  return v1[b.length];\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\ngoog.provide('goog.labs.userAgent.util');\n\ngoog.require('goog.string');\n\n\n/**\n * Gets the native userAgent string from navigator if it exists.\n * If navigator or navigator.userAgent string is missing, returns an empty\n * string.\n * @return {string}\n * @private\n */\ngoog.labs.userAgent.util.getNativeUserAgentString_ = function() {\n  var navigator = goog.labs.userAgent.util.getNavigator_();\n  if (navigator) {\n    var userAgent = navigator.userAgent;\n    if (userAgent) {\n      return userAgent;\n    }\n  }\n  return '';\n};\n\n\n/**\n * Getter for the native navigator.\n * This is a separate function so it can be stubbed out in testing.\n * @return {Navigator}\n * @private\n */\ngoog.labs.userAgent.util.getNavigator_ = function() {\n  return goog.global.navigator;\n};\n\n\n/**\n * A possible override for applications which wish to not check\n * navigator.userAgent but use a specified value for detection instead.\n * @private {string}\n */\ngoog.labs.userAgent.util.userAgent_ =\n    goog.labs.userAgent.util.getNativeUserAgentString_();\n\n\n/**\n * Applications may override browser detection on the built in\n * navigator.userAgent object by setting this string. Set to null to use the\n * browser object instead.\n * @param {?string=} opt_userAgent The User-Agent override.\n */\ngoog.labs.userAgent.util.setUserAgent = function(opt_userAgent) {\n  goog.labs.userAgent.util.userAgent_ =\n      opt_userAgent || goog.labs.userAgent.util.getNativeUserAgentString_();\n};\n\n\n/**\n * @return {string} The user agent string.\n */\ngoog.labs.userAgent.util.getUserAgent = function() {\n  return goog.labs.userAgent.util.userAgent_;\n};\n\n\n/**\n * @param {string} str\n * @return {boolean} Whether the user agent contains the given string.\n */\ngoog.labs.userAgent.util.matchUserAgent = function(str) {\n  var userAgent = goog.labs.userAgent.util.getUserAgent();\n  return goog.string.contains(userAgent, str);\n};\n\n\n/**\n * @param {string} str\n * @return {boolean} Whether the user agent contains the given string, ignoring\n *     case.\n */\ngoog.labs.userAgent.util.matchUserAgentIgnoreCase = function(str) {\n  var userAgent = goog.labs.userAgent.util.getUserAgent();\n  return goog.string.caseInsensitiveContains(userAgent, str);\n};\n\n\n/**\n * Parses the user agent into tuples for each section.\n * @param {string} userAgent\n * @return {!Array<!Array<string>>} Tuples of key, version, and the contents\n *     of the parenthetical.\n */\ngoog.labs.userAgent.util.extractVersionTuples = function(userAgent) {\n  // Matches each section of a user agent string.\n  // Example UA:\n  // Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us)\n  // AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/7B405\n  // This has three version tuples: Mozilla, AppleWebKit, and Mobile.\n\n  var versionRegExp = new RegExp(\n      // Key. Note that a key may have a space.\n      // (i.e. 'Mobile Safari' in 'Mobile Safari/5.0')\n      '(\\\\w[\\\\w ]+)' +\n\n          '/' +                // slash\n          '([^\\\\s]+)' +        // version (i.e. '5.0b')\n          '\\\\s*' +             // whitespace\n          '(?:\\\\((.*?)\\\\))?',  // parenthetical info. parentheses not matched.\n      'g');\n\n  var data = [];\n  var match;\n\n  // Iterate and collect the version tuples.  Each iteration will be the\n  // next regex match.\n  while (match = versionRegExp.exec(userAgent)) {\n    data.push([\n      match[1],  // key\n      match[2],  // value\n      // || undefined as this is not undefined in IE7 and IE8\n      match[3] || undefined  // info\n    ]);\n  }\n\n  return data;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for manipulating objects/maps/hashes.\n * @author arv@google.com (Erik Arvidsson)\n */\n\ngoog.provide('goog.object');\n\n\n/**\n * Whether two values are not observably distinguishable. This\n * correctly detects that 0 is not the same as -0 and two NaNs are\n * practically equivalent.\n *\n * The implementation is as suggested by harmony:egal proposal.\n *\n * @param {*} v The first value to compare.\n * @param {*} v2 The second value to compare.\n * @return {boolean} Whether two values are not observably distinguishable.\n * @see http://wiki.ecmascript.org/doku.php?id=harmony:egal\n */\ngoog.object.is = function(v, v2) {\n  if (v === v2) {\n    // 0 === -0, but they are not identical.\n    // We need the cast because the compiler requires that v2 is a\n    // number (although 1/v2 works with non-number). We cast to ? to\n    // stop the compiler from type-checking this statement.\n    return v !== 0 || 1 / v === 1 / /** @type {?} */ (v2);\n  }\n\n  // NaN is non-reflexive: NaN !== NaN, although they are identical.\n  return v !== v && v2 !== v2;\n};\n\n\n/**\n * Calls a function for each element in an object/map/hash.\n *\n * @param {Object<K,V>} obj The object over which to iterate.\n * @param {function(this:T,V,?,Object<K,V>):?} f The function to call\n *     for every element. This function takes 3 arguments (the value, the\n *     key and the object) and the return value is ignored.\n * @param {T=} opt_obj This is used as the 'this' object within f.\n * @template T,K,V\n */\ngoog.object.forEach = function(obj, f, opt_obj) {\n  for (var key in obj) {\n    f.call(/** @type {?} */ (opt_obj), obj[key], key, obj);\n  }\n};\n\n\n/**\n * Calls a function for each element in an object/map/hash. If that call returns\n * true, adds the element to a new object.\n *\n * @param {Object<K,V>} obj The object over which to iterate.\n * @param {function(this:T,V,?,Object<K,V>):boolean} f The function to call\n *     for every element. This\n *     function takes 3 arguments (the value, the key and the object)\n *     and should return a boolean. If the return value is true the\n *     element is added to the result object. If it is false the\n *     element is not included.\n * @param {T=} opt_obj This is used as the 'this' object within f.\n * @return {!Object<K,V>} a new object in which only elements that passed the\n *     test are present.\n * @template T,K,V\n */\ngoog.object.filter = function(obj, f, opt_obj) {\n  var res = {};\n  for (var key in obj) {\n    if (f.call(/** @type {?} */ (opt_obj), obj[key], key, obj)) {\n      res[key] = obj[key];\n    }\n  }\n  return res;\n};\n\n\n/**\n * For every element in an object/map/hash calls a function and inserts the\n * result into a new object.\n *\n * @param {Object<K,V>} obj The object over which to iterate.\n * @param {function(this:T,V,?,Object<K,V>):R} f The function to call\n *     for every element. This function\n *     takes 3 arguments (the value, the key and the object)\n *     and should return something. The result will be inserted\n *     into a new object.\n * @param {T=} opt_obj This is used as the 'this' object within f.\n * @return {!Object<K,R>} a new object with the results from f.\n * @template T,K,V,R\n */\ngoog.object.map = function(obj, f, opt_obj) {\n  var res = {};\n  for (var key in obj) {\n    res[key] = f.call(/** @type {?} */ (opt_obj), obj[key], key, obj);\n  }\n  return res;\n};\n\n\n/**\n * Calls a function for each element in an object/map/hash. If any\n * call returns true, returns true (without checking the rest). If\n * all calls return false, returns false.\n *\n * @param {Object<K,V>} obj The object to check.\n * @param {function(this:T,V,?,Object<K,V>):boolean} f The function to\n *     call for every element. This function\n *     takes 3 arguments (the value, the key and the object) and should\n *     return a boolean.\n * @param {T=} opt_obj This is used as the 'this' object within f.\n * @return {boolean} true if any element passes the test.\n * @template T,K,V\n */\ngoog.object.some = function(obj, f, opt_obj) {\n  for (var key in obj) {\n    if (f.call(/** @type {?} */ (opt_obj), obj[key], key, obj)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Calls a function for each element in an object/map/hash. If\n * all calls return true, returns true. If any call returns false, returns\n * false at this point and does not continue to check the remaining elements.\n *\n * @param {Object<K,V>} obj The object to check.\n * @param {?function(this:T,V,?,Object<K,V>):boolean} f The function to\n *     call for every element. This function\n *     takes 3 arguments (the value, the key and the object) and should\n *     return a boolean.\n * @param {T=} opt_obj This is used as the 'this' object within f.\n * @return {boolean} false if any element fails the test.\n * @template T,K,V\n */\ngoog.object.every = function(obj, f, opt_obj) {\n  for (var key in obj) {\n    if (!f.call(/** @type {?} */ (opt_obj), obj[key], key, obj)) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Returns the number of key-value pairs in the object map.\n *\n * @param {Object} obj The object for which to get the number of key-value\n *     pairs.\n * @return {number} The number of key-value pairs in the object map.\n */\ngoog.object.getCount = function(obj) {\n  var rv = 0;\n  for (var key in obj) {\n    rv++;\n  }\n  return rv;\n};\n\n\n/**\n * Returns one key from the object map, if any exists.\n * For map literals the returned key will be the first one in most of the\n * browsers (a know exception is Konqueror).\n *\n * @param {Object} obj The object to pick a key from.\n * @return {string|undefined} The key or undefined if the object is empty.\n */\ngoog.object.getAnyKey = function(obj) {\n  for (var key in obj) {\n    return key;\n  }\n};\n\n\n/**\n * Returns one value from the object map, if any exists.\n * For map literals the returned value will be the first one in most of the\n * browsers (a know exception is Konqueror).\n *\n * @param {Object<K,V>} obj The object to pick a value from.\n * @return {V|undefined} The value or undefined if the object is empty.\n * @template K,V\n */\ngoog.object.getAnyValue = function(obj) {\n  for (var key in obj) {\n    return obj[key];\n  }\n};\n\n\n/**\n * Whether the object/hash/map contains the given object as a value.\n * An alias for goog.object.containsValue(obj, val).\n *\n * @param {Object<K,V>} obj The object in which to look for val.\n * @param {V} val The object for which to check.\n * @return {boolean} true if val is present.\n * @template K,V\n */\ngoog.object.contains = function(obj, val) {\n  return goog.object.containsValue(obj, val);\n};\n\n\n/**\n * Returns the values of the object/map/hash.\n *\n * @param {Object<K,V>} obj The object from which to get the values.\n * @return {!Array<V>} The values in the object/map/hash.\n * @template K,V\n */\ngoog.object.getValues = function(obj) {\n  var res = [];\n  var i = 0;\n  for (var key in obj) {\n    res[i++] = obj[key];\n  }\n  return res;\n};\n\n\n/**\n * Returns the keys of the object/map/hash.\n *\n * @param {Object} obj The object from which to get the keys.\n * @return {!Array<string>} Array of property keys.\n */\ngoog.object.getKeys = function(obj) {\n  var res = [];\n  var i = 0;\n  for (var key in obj) {\n    res[i++] = key;\n  }\n  return res;\n};\n\n\n/**\n * Get a value from an object multiple levels deep.  This is useful for\n * pulling values from deeply nested objects, such as JSON responses.\n * Example usage: getValueByKeys(jsonObj, 'foo', 'entries', 3)\n *\n * @param {!Object} obj An object to get the value from.  Can be array-like.\n * @param {...(string|number|!IArrayLike<number|string>)}\n *     var_args A number of keys\n *     (as strings, or numbers, for array-like objects).  Can also be\n *     specified as a single array of keys.\n * @return {*} The resulting value.  If, at any point, the value for a key\n *     in the current object is null or undefined, returns undefined.\n */\ngoog.object.getValueByKeys = function(obj, var_args) {\n  var isArrayLike = goog.isArrayLike(var_args);\n  var keys = isArrayLike ?\n      /** @type {!IArrayLike<number|string>} */ (var_args) :\n      arguments;\n\n  // Start with the 2nd parameter for the variable parameters syntax.\n  for (var i = isArrayLike ? 0 : 1; i < keys.length; i++) {\n    if (obj == null) return undefined;\n    obj = obj[keys[i]];\n  }\n\n  return obj;\n};\n\n\n/**\n * Whether the object/map/hash contains the given key.\n *\n * @param {Object} obj The object in which to look for key.\n * @param {?} key The key for which to check.\n * @return {boolean} true If the map contains the key.\n */\ngoog.object.containsKey = function(obj, key) {\n  return obj !== null && key in obj;\n};\n\n\n/**\n * Whether the object/map/hash contains the given value. This is O(n).\n *\n * @param {Object<K,V>} obj The object in which to look for val.\n * @param {V} val The value for which to check.\n * @return {boolean} true If the map contains the value.\n * @template K,V\n */\ngoog.object.containsValue = function(obj, val) {\n  for (var key in obj) {\n    if (obj[key] == val) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Searches an object for an element that satisfies the given condition and\n * returns its key.\n * @param {Object<K,V>} obj The object to search in.\n * @param {function(this:T,V,string,Object<K,V>):boolean} f The\n *      function to call for every element. Takes 3 arguments (the value,\n *     the key and the object) and should return a boolean.\n * @param {T=} opt_this An optional \"this\" context for the function.\n * @return {string|undefined} The key of an element for which the function\n *     returns true or undefined if no such element is found.\n * @template T,K,V\n */\ngoog.object.findKey = function(obj, f, opt_this) {\n  for (var key in obj) {\n    if (f.call(/** @type {?} */ (opt_this), obj[key], key, obj)) {\n      return key;\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * Searches an object for an element that satisfies the given condition and\n * returns its value.\n * @param {Object<K,V>} obj The object to search in.\n * @param {function(this:T,V,string,Object<K,V>):boolean} f The function\n *     to call for every element. Takes 3 arguments (the value, the key\n *     and the object) and should return a boolean.\n * @param {T=} opt_this An optional \"this\" context for the function.\n * @return {V} The value of an element for which the function returns true or\n *     undefined if no such element is found.\n * @template T,K,V\n */\ngoog.object.findValue = function(obj, f, opt_this) {\n  var key = goog.object.findKey(obj, f, opt_this);\n  return key && obj[key];\n};\n\n\n/**\n * Whether the object/map/hash is empty.\n *\n * @param {Object} obj The object to test.\n * @return {boolean} true if obj is empty.\n */\ngoog.object.isEmpty = function(obj) {\n  for (var key in obj) {\n    return false;\n  }\n  return true;\n};\n\n\n/**\n * Removes all key value pairs from the object/map/hash.\n *\n * @param {Object} obj The object to clear.\n */\ngoog.object.clear = function(obj) {\n  for (var i in obj) {\n    delete obj[i];\n  }\n};\n\n\n/**\n * Removes a key-value pair based on the key.\n *\n * @param {Object} obj The object from which to remove the key.\n * @param {?} key The key to remove.\n * @return {boolean} Whether an element was removed.\n */\ngoog.object.remove = function(obj, key) {\n  var rv;\n  if (rv = key in /** @type {!Object} */ (obj)) {\n    delete obj[key];\n  }\n  return rv;\n};\n\n\n/**\n * Adds a key-value pair to the object. Throws an exception if the key is\n * already in use. Use set if you want to change an existing pair.\n *\n * @param {Object<K,V>} obj The object to which to add the key-value pair.\n * @param {string} key The key to add.\n * @param {V} val The value to add.\n * @template K,V\n */\ngoog.object.add = function(obj, key, val) {\n  if (obj !== null && key in obj) {\n    throw new Error('The object already contains the key \"' + key + '\"');\n  }\n  goog.object.set(obj, key, val);\n};\n\n\n/**\n * Returns the value for the given key.\n *\n * @param {Object<K,V>} obj The object from which to get the value.\n * @param {string} key The key for which to get the value.\n * @param {R=} opt_val The value to return if no item is found for the given\n *     key (default is undefined).\n * @return {V|R|undefined} The value for the given key.\n * @template K,V,R\n */\ngoog.object.get = function(obj, key, opt_val) {\n  if (obj !== null && key in obj) {\n    return obj[key];\n  }\n  return opt_val;\n};\n\n\n/**\n * Adds a key-value pair to the object/map/hash.\n *\n * @param {Object<K,V>} obj The object to which to add the key-value pair.\n * @param {string} key The key to add.\n * @param {V} value The value to add.\n * @template K,V\n */\ngoog.object.set = function(obj, key, value) {\n  obj[key] = value;\n};\n\n\n/**\n * Adds a key-value pair to the object/map/hash if it doesn't exist yet.\n *\n * @param {Object<K,V>} obj The object to which to add the key-value pair.\n * @param {string} key The key to add.\n * @param {V} value The value to add if the key wasn't present.\n * @return {V} The value of the entry at the end of the function.\n * @template K,V\n */\ngoog.object.setIfUndefined = function(obj, key, value) {\n  return key in /** @type {!Object} */ (obj) ? obj[key] : (obj[key] = value);\n};\n\n\n/**\n * Sets a key and value to an object if the key is not set. The value will be\n * the return value of the given function. If the key already exists, the\n * object will not be changed and the function will not be called (the function\n * will be lazily evaluated -- only called if necessary).\n *\n * This function is particularly useful for use with a map used a as a cache.\n *\n * @param {!Object<K,V>} obj The object to which to add the key-value pair.\n * @param {string} key The key to add.\n * @param {function():V} f The value to add if the key wasn't present.\n * @return {V} The value of the entry at the end of the function.\n * @template K,V\n */\ngoog.object.setWithReturnValueIfNotSet = function(obj, key, f) {\n  if (key in obj) {\n    return obj[key];\n  }\n\n  var val = f();\n  obj[key] = val;\n  return val;\n};\n\n\n/**\n * Compares two objects for equality using === on the values.\n *\n * @param {!Object<K,V>} a\n * @param {!Object<K,V>} b\n * @return {boolean}\n * @template K,V\n */\ngoog.object.equals = function(a, b) {\n  for (var k in a) {\n    if (!(k in b) || a[k] !== b[k]) {\n      return false;\n    }\n  }\n  for (var k in b) {\n    if (!(k in a)) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Returns a shallow clone of the object.\n *\n * @param {Object<K,V>} obj Object to clone.\n * @return {!Object<K,V>} Clone of the input object.\n * @template K,V\n */\ngoog.object.clone = function(obj) {\n  // We cannot use the prototype trick because a lot of methods depend on where\n  // the actual key is set.\n\n  var res = {};\n  for (var key in obj) {\n    res[key] = obj[key];\n  }\n  return res;\n  // We could also use goog.mixin but I wanted this to be independent from that.\n};\n\n\n/**\n * Clones a value. The input may be an Object, Array, or basic type. Objects and\n * arrays will be cloned recursively.\n *\n * WARNINGS:\n * <code>goog.object.unsafeClone</code> does not detect reference loops. Objects\n * that refer to themselves will cause infinite recursion.\n *\n * <code>goog.object.unsafeClone</code> is unaware of unique identifiers, and\n * copies UIDs created by <code>getUid</code> into cloned results.\n *\n * @param {T} obj The value to clone.\n * @return {T} A clone of the input value.\n * @template T\n */\ngoog.object.unsafeClone = function(obj) {\n  var type = goog.typeOf(obj);\n  if (type == 'object' || type == 'array') {\n    if (goog.isFunction(obj.clone)) {\n      return obj.clone();\n    }\n    var clone = type == 'array' ? [] : {};\n    for (var key in obj) {\n      clone[key] = goog.object.unsafeClone(obj[key]);\n    }\n    return clone;\n  }\n\n  return obj;\n};\n\n\n/**\n * Returns a new object in which all the keys and values are interchanged\n * (keys become values and values become keys). If multiple keys map to the\n * same value, the chosen transposed value is implementation-dependent.\n *\n * @param {Object} obj The object to transpose.\n * @return {!Object} The transposed object.\n */\ngoog.object.transpose = function(obj) {\n  var transposed = {};\n  for (var key in obj) {\n    transposed[obj[key]] = key;\n  }\n  return transposed;\n};\n\n\n/**\n * The names of the fields that are defined on Object.prototype.\n * @type {Array<string>}\n * @private\n */\ngoog.object.PROTOTYPE_FIELDS_ = [\n  'constructor', 'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable',\n  'toLocaleString', 'toString', 'valueOf'\n];\n\n\n/**\n * Extends an object with another object.\n * This operates 'in-place'; it does not create a new Object.\n *\n * Example:\n * var o = {};\n * goog.object.extend(o, {a: 0, b: 1});\n * o; // {a: 0, b: 1}\n * goog.object.extend(o, {b: 2, c: 3});\n * o; // {a: 0, b: 2, c: 3}\n *\n * @param {Object} target The object to modify. Existing properties will be\n *     overwritten if they are also present in one of the objects in\n *     `var_args`.\n * @param {...(Object|null|undefined)} var_args The objects from which values\n *     will be copied.\n */\ngoog.object.extend = function(target, var_args) {\n  var key, source;\n  for (var i = 1; i < arguments.length; i++) {\n    source = arguments[i];\n    for (key in source) {\n      target[key] = source[key];\n    }\n\n    // For IE the for-in-loop does not contain any properties that are not\n    // enumerable on the prototype object (for example isPrototypeOf from\n    // Object.prototype) and it will also not include 'replace' on objects that\n    // extend String and change 'replace' (not that it is common for anyone to\n    // extend anything except Object).\n\n    for (var j = 0; j < goog.object.PROTOTYPE_FIELDS_.length; j++) {\n      key = goog.object.PROTOTYPE_FIELDS_[j];\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n};\n\n\n/**\n * Creates a new object built from the key-value pairs provided as arguments.\n * @param {...*} var_args If only one argument is provided and it is an array\n *     then this is used as the arguments, otherwise even arguments are used as\n *     the property names and odd arguments are used as the property values.\n * @return {!Object} The new object.\n * @throws {Error} If there are uneven number of arguments or there is only one\n *     non array argument.\n */\ngoog.object.create = function(var_args) {\n  var argLength = arguments.length;\n  if (argLength == 1 && goog.isArray(arguments[0])) {\n    return goog.object.create.apply(null, arguments[0]);\n  }\n\n  if (argLength % 2) {\n    throw new Error('Uneven number of arguments');\n  }\n\n  var rv = {};\n  for (var i = 0; i < argLength; i += 2) {\n    rv[arguments[i]] = arguments[i + 1];\n  }\n  return rv;\n};\n\n\n/**\n * Creates a new object where the property names come from the arguments but\n * the value is always set to true\n * @param {...*} var_args If only one argument is provided and it is an array\n *     then this is used as the arguments, otherwise the arguments are used\n *     as the property names.\n * @return {!Object} The new object.\n */\ngoog.object.createSet = function(var_args) {\n  var argLength = arguments.length;\n  if (argLength == 1 && goog.isArray(arguments[0])) {\n    return goog.object.createSet.apply(null, arguments[0]);\n  }\n\n  var rv = {};\n  for (var i = 0; i < argLength; i++) {\n    rv[arguments[i]] = true;\n  }\n  return rv;\n};\n\n\n/**\n * Creates an immutable view of the underlying object, if the browser\n * supports immutable objects.\n *\n * In default mode, writes to this view will fail silently. In strict mode,\n * they will throw an error.\n *\n * @param {!Object<K,V>} obj An object.\n * @return {!Object<K,V>} An immutable view of that object, or the\n *     original object if this browser does not support immutables.\n * @template K,V\n */\ngoog.object.createImmutableView = function(obj) {\n  var result = obj;\n  if (Object.isFrozen && !Object.isFrozen(obj)) {\n    result = Object.create(obj);\n    Object.freeze(result);\n  }\n  return result;\n};\n\n\n/**\n * @param {!Object} obj An object.\n * @return {boolean} Whether this is an immutable view of the object.\n */\ngoog.object.isImmutableView = function(obj) {\n  return !!Object.isFrozen && Object.isFrozen(obj);\n};\n\n\n/**\n * Get all properties names on a given Object regardless of enumerability.\n *\n * <p> If the browser does not support `Object.getOwnPropertyNames` nor\n * `Object.getPrototypeOf` then this is equivalent to using\n * `goog.object.getKeys`\n *\n * @param {?Object} obj The object to get the properties of.\n * @param {boolean=} opt_includeObjectPrototype Whether properties defined on\n *     `Object.prototype` should be included in the result.\n * @param {boolean=} opt_includeFunctionPrototype Whether properties defined on\n *     `Function.prototype` should be included in the result.\n * @return {!Array<string>}\n * @public\n */\ngoog.object.getAllPropertyNames = function(\n    obj, opt_includeObjectPrototype, opt_includeFunctionPrototype) {\n  if (!obj) {\n    return [];\n  }\n\n  // Naively use a for..in loop to get the property names if the browser doesn't\n  // support any other APIs for getting it.\n  if (!Object.getOwnPropertyNames || !Object.getPrototypeOf) {\n    return goog.object.getKeys(obj);\n  }\n\n  var visitedSet = {};\n\n  // Traverse the prototype chain and add all properties to the visited set.\n  var proto = obj;\n  while (proto &&\n         (proto !== Object.prototype || !!opt_includeObjectPrototype) &&\n         (proto !== Function.prototype || !!opt_includeFunctionPrototype)) {\n    var names = Object.getOwnPropertyNames(proto);\n    for (var i = 0; i < names.length; i++) {\n      visitedSet[names[i]] = true;\n    }\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return goog.object.getKeys(visitedSet);\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Basic animation controls.\n *\n * @author arv@google.com (Erik Arvidsson)\n */\ngoog.provide('goog.fx.anim');\ngoog.provide('goog.fx.anim.Animated');\n\ngoog.require('goog.async.AnimationDelay');\ngoog.require('goog.async.Delay');\ngoog.require('goog.object');\n\n\n\n/**\n * An interface for programatically animated objects. I.e. rendered in\n * javascript frame by frame.\n *\n * @interface\n */\ngoog.fx.anim.Animated = function() {};\n\n\n/**\n * Function called when a frame is requested for the animation.\n *\n * @param {number} now Current time in milliseconds.\n */\ngoog.fx.anim.Animated.prototype.onAnimationFrame;\n\n\n/**\n * Default wait timeout for animations (in milliseconds).  Only used for timed\n * animation, which uses a timer (setTimeout) to schedule animation.\n *\n * @type {number}\n * @const\n */\ngoog.fx.anim.TIMEOUT = goog.async.AnimationDelay.TIMEOUT;\n\n\n/**\n * A map of animations which should be cycled on the global timer.\n *\n * @type {!Object<number, goog.fx.anim.Animated>}\n * @private\n */\ngoog.fx.anim.activeAnimations_ = {};\n\n\n/**\n * An optional animation window.\n * @type {Window}\n * @private\n */\ngoog.fx.anim.animationWindow_ = null;\n\n\n/**\n * An interval ID for the global timer or event handler uid.\n * @type {goog.async.Delay|goog.async.AnimationDelay}\n * @private\n */\ngoog.fx.anim.animationDelay_ = null;\n\n\n/**\n * Registers an animation to be cycled on the global timer.\n * @param {goog.fx.anim.Animated} animation The animation to register.\n */\ngoog.fx.anim.registerAnimation = function(animation) {\n  var uid = goog.getUid(animation);\n  if (!(uid in goog.fx.anim.activeAnimations_)) {\n    goog.fx.anim.activeAnimations_[uid] = animation;\n  }\n\n  // If the timer is not already started, start it now.\n  goog.fx.anim.requestAnimationFrame_();\n};\n\n\n/**\n * Removes an animation from the list of animations which are cycled on the\n * global timer.\n * @param {goog.fx.anim.Animated} animation The animation to unregister.\n */\ngoog.fx.anim.unregisterAnimation = function(animation) {\n  var uid = goog.getUid(animation);\n  delete goog.fx.anim.activeAnimations_[uid];\n\n  // If a timer is running and we no longer have any active timers we stop the\n  // timers.\n  if (goog.object.isEmpty(goog.fx.anim.activeAnimations_)) {\n    goog.fx.anim.cancelAnimationFrame_();\n  }\n};\n\n\n/**\n * Tears down this module. Useful for testing.\n */\n// TODO(nicksantos): Wow, this api is pretty broken. This should be fixed.\ngoog.fx.anim.tearDown = function() {\n  goog.fx.anim.animationWindow_ = null;\n  goog.dispose(goog.fx.anim.animationDelay_);\n  goog.fx.anim.animationDelay_ = null;\n  goog.fx.anim.activeAnimations_ = {};\n};\n\n\n/**\n * Registers an animation window. This allows usage of the timing control API\n * for animations. Note that this window must be visible, as non-visible\n * windows can potentially stop animating. This window does not necessarily\n * need to be the window inside which animation occurs, but must remain visible.\n * See: https://developer.mozilla.org/en/DOM/window.mozRequestAnimationFrame.\n *\n * @param {Window} animationWindow The window in which to animate elements.\n */\ngoog.fx.anim.setAnimationWindow = function(animationWindow) {\n  // If a timer is currently running, reset it and restart with new functions\n  // after a timeout. This is to avoid mismatching timer UIDs if we change the\n  // animation window during a running animation.\n  //\n  // In practice this cannot happen before some animation window and timer\n  // control functions has already been set.\n  var hasTimer =\n      goog.fx.anim.animationDelay_ && goog.fx.anim.animationDelay_.isActive();\n\n  goog.dispose(goog.fx.anim.animationDelay_);\n  goog.fx.anim.animationDelay_ = null;\n  goog.fx.anim.animationWindow_ = animationWindow;\n\n  // If the timer was running, start it again.\n  if (hasTimer) {\n    goog.fx.anim.requestAnimationFrame_();\n  }\n};\n\n\n/**\n * Requests an animation frame based on the requestAnimationFrame and\n * cancelRequestAnimationFrame function pair.\n * @private\n */\ngoog.fx.anim.requestAnimationFrame_ = function() {\n  if (!goog.fx.anim.animationDelay_) {\n    // We cannot guarantee that the global window will be one that fires\n    // requestAnimationFrame events (consider off-screen chrome extension\n    // windows). Default to use goog.async.Delay, unless\n    // the client has explicitly set an animation window.\n    if (goog.fx.anim.animationWindow_) {\n      // requestAnimationFrame will call cycleAnimations_ with the current\n      // time in ms, as returned from goog.now().\n      goog.fx.anim.animationDelay_ =\n          new goog.async.AnimationDelay(function(now) {\n            goog.fx.anim.cycleAnimations_(now);\n          }, goog.fx.anim.animationWindow_);\n    } else {\n      goog.fx.anim.animationDelay_ = new goog.async.Delay(function() {\n        goog.fx.anim.cycleAnimations_(goog.now());\n      }, goog.fx.anim.TIMEOUT);\n    }\n  }\n\n  var delay = goog.fx.anim.animationDelay_;\n  if (!delay.isActive()) {\n    delay.start();\n  }\n};\n\n\n/**\n * Cancels an animation frame created by requestAnimationFrame_().\n * @private\n */\ngoog.fx.anim.cancelAnimationFrame_ = function() {\n  if (goog.fx.anim.animationDelay_) {\n    goog.fx.anim.animationDelay_.stop();\n  }\n};\n\n\n/**\n * Cycles through all registered animations.\n * @param {number} now Current time in milliseconds.\n * @private\n */\ngoog.fx.anim.cycleAnimations_ = function(now) {\n  goog.object.forEach(goog.fx.anim.activeAnimations_, function(anim) {\n    anim.onAnimationFrame(now);\n  });\n\n  if (!goog.object.isEmpty(goog.fx.anim.activeAnimations_)) {\n    goog.fx.anim.requestAnimationFrame_();\n  }\n};\n","// Copyright 2009 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Useful compiler idioms.\n *\n * @author johnlenz@google.com (John Lenz)\n */\n\ngoog.provide('goog.reflect');\n\n\n/**\n * Syntax for object literal casts.\n * @see http://go/jscompiler-renaming\n * @see https://goo.gl/CRs09P\n *\n * Use this if you have an object literal whose keys need to have the same names\n * as the properties of some class even after they are renamed by the compiler.\n *\n * @param {!Function} type Type to cast to.\n * @param {Object} object Object literal to cast.\n * @return {Object} The object literal.\n */\ngoog.reflect.object = function(type, object) {\n  return object;\n};\n\n/**\n * Syntax for renaming property strings.\n * @see http://go/jscompiler-renaming\n * @see https://goo.gl/CRs09P\n *\n * Use this if you have an need to access a property as a string, but want\n * to also have the property renamed by the compiler. In contrast to\n * goog.reflect.object, this method takes an instance of an object.\n *\n * Properties must be simple names (not qualified names).\n *\n * @param {string} prop Name of the property\n * @param {!Object} object Instance of the object whose type will be used\n *     for renaming\n * @return {string} The renamed property.\n */\ngoog.reflect.objectProperty = function(prop, object) {\n  return prop;\n};\n\n/**\n * To assert to the compiler that an operation is needed when it would\n * otherwise be stripped. For example:\n * <code>\n *     // Force a layout\n *     goog.reflect.sinkValue(dialog.offsetHeight);\n * </code>\n * @param {T} x\n * @return {T}\n * @template T\n */\ngoog.reflect.sinkValue = function(x) {\n  goog.reflect.sinkValue[' '](x);\n  return x;\n};\n\n\n/**\n * The compiler should optimize this function away iff no one ever uses\n * goog.reflect.sinkValue.\n */\ngoog.reflect.sinkValue[' '] = goog.nullFunction;\n\n\n/**\n * Check if a property can be accessed without throwing an exception.\n * @param {Object} obj The owner of the property.\n * @param {string} prop The property name.\n * @return {boolean} Whether the property is accessible. Will also return true\n *     if obj is null.\n */\ngoog.reflect.canAccessProperty = function(obj, prop) {\n\n  try {\n    goog.reflect.sinkValue(obj[prop]);\n    return true;\n  } catch (e) {\n  }\n  return false;\n};\n\n\n/**\n * Retrieves a value from a cache given a key. The compiler provides special\n * consideration for this call such that it is generally considered side-effect\n * free. However, if the `opt_keyFn` or `valueFn` have side-effects\n * then the entire call is considered to have side-effects.\n *\n * Conventionally storing the value on the cache would be considered a\n * side-effect and preclude unused calls from being pruned, ie. even if\n * the value was never used, it would still always be stored in the cache.\n *\n * Providing a side-effect free `valueFn` and `opt_keyFn`\n * allows unused calls to `goog.reflect.cache` to be pruned.\n *\n * @param {!Object<K, V>} cacheObj The object that contains the cached values.\n * @param {?} key The key to lookup in the cache. If it is not string or number\n *     then a `opt_keyFn` should be provided. The key is also used as the\n *     parameter to the `valueFn`.\n * @param {function(?):V} valueFn The value provider to use to calculate the\n *     value to store in the cache. This function should be side-effect free\n *     to take advantage of the optimization.\n * @param {function(?):K=} opt_keyFn The key provider to determine the cache\n *     map key. This should be used if the given key is not a string or number.\n *     If not provided then the given key is used. This function should be\n *     side-effect free to take advantage of the optimization.\n * @return {V} The cached or calculated value.\n * @template K\n * @template V\n */\ngoog.reflect.cache = function(cacheObj, key, valueFn, opt_keyFn) {\n  var storedKey = opt_keyFn ? opt_keyFn(key) : key;\n\n  if (Object.prototype.hasOwnProperty.call(cacheObj, storedKey)) {\n    return cacheObj[storedKey];\n  }\n\n  return (cacheObj[storedKey] = valueFn(key));\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Rendering engine detection.\n * @see <a href=\"http://www.useragentstring.com/\">User agent strings</a>\n * For information on the browser brand (such as Safari versus Chrome), see\n * goog.userAgent.product.\n * @author arv@google.com (Erik Arvidsson)\n * @see ../demos/useragent.html\n */\n\ngoog.provide('goog.userAgent');\n\ngoog.require('goog.labs.userAgent.browser');\ngoog.require('goog.labs.userAgent.engine');\ngoog.require('goog.labs.userAgent.platform');\ngoog.require('goog.labs.userAgent.util');\ngoog.require('goog.reflect');\ngoog.require('goog.string');\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is IE.\n */\ngoog.define('goog.userAgent.ASSUME_IE', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is EDGE.\n */\ngoog.define('goog.userAgent.ASSUME_EDGE', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is GECKO.\n */\ngoog.define('goog.userAgent.ASSUME_GECKO', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is WEBKIT.\n */\ngoog.define('goog.userAgent.ASSUME_WEBKIT', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is a\n *     mobile device running WebKit e.g. iPhone or Android.\n */\ngoog.define('goog.userAgent.ASSUME_MOBILE_WEBKIT', false);\n\n\n/**\n * @define {boolean} Whether we know at compile-time that the browser is OPERA.\n */\ngoog.define('goog.userAgent.ASSUME_OPERA', false);\n\n\n/**\n * @define {boolean} Whether the\n *     `goog.userAgent.isVersionOrHigher`\n *     function will return true for any version.\n */\ngoog.define('goog.userAgent.ASSUME_ANY_VERSION', false);\n\n\n/**\n * Whether we know the browser engine at compile-time.\n * @type {boolean}\n * @private\n */\ngoog.userAgent.BROWSER_KNOWN_ = goog.userAgent.ASSUME_IE ||\n    goog.userAgent.ASSUME_EDGE || goog.userAgent.ASSUME_GECKO ||\n    goog.userAgent.ASSUME_MOBILE_WEBKIT || goog.userAgent.ASSUME_WEBKIT ||\n    goog.userAgent.ASSUME_OPERA;\n\n\n/**\n * Returns the userAgent string for the current browser.\n *\n * @return {string} The userAgent string.\n */\ngoog.userAgent.getUserAgentString = function() {\n  return goog.labs.userAgent.util.getUserAgent();\n};\n\n\n/**\n * @return {?Navigator} The native navigator object.\n */\ngoog.userAgent.getNavigatorTyped = function() {\n  // Need a local navigator reference instead of using the global one,\n  // to avoid the rare case where they reference different objects.\n  // (in a WorkerPool, for example).\n  return goog.global['navigator'] || null;\n};\n\n\n/**\n * TODO(nnaze): Change type to \"Navigator\" and update compilation targets.\n * @return {?Object} The native navigator object.\n */\ngoog.userAgent.getNavigator = function() {\n  return goog.userAgent.getNavigatorTyped();\n};\n\n\n/**\n * Whether the user agent is Opera.\n * @type {boolean}\n */\ngoog.userAgent.OPERA = goog.userAgent.BROWSER_KNOWN_ ?\n    goog.userAgent.ASSUME_OPERA :\n    goog.labs.userAgent.browser.isOpera();\n\n\n/**\n * Whether the user agent is Internet Explorer.\n * @type {boolean}\n */\ngoog.userAgent.IE = goog.userAgent.BROWSER_KNOWN_ ?\n    goog.userAgent.ASSUME_IE :\n    goog.labs.userAgent.browser.isIE();\n\n\n/**\n * Whether the user agent is Microsoft Edge.\n * @type {boolean}\n */\ngoog.userAgent.EDGE = goog.userAgent.BROWSER_KNOWN_ ?\n    goog.userAgent.ASSUME_EDGE :\n    goog.labs.userAgent.engine.isEdge();\n\n\n/**\n * Whether the user agent is MS Internet Explorer or MS Edge.\n * @type {boolean}\n */\ngoog.userAgent.EDGE_OR_IE = goog.userAgent.EDGE || goog.userAgent.IE;\n\n\n/**\n * Whether the user agent is Gecko. Gecko is the rendering engine used by\n * Mozilla, Firefox, and others.\n * @type {boolean}\n */\ngoog.userAgent.GECKO = goog.userAgent.BROWSER_KNOWN_ ?\n    goog.userAgent.ASSUME_GECKO :\n    goog.labs.userAgent.engine.isGecko();\n\n\n/**\n * Whether the user agent is WebKit. WebKit is the rendering engine that\n * Safari, Android and others use.\n * @type {boolean}\n */\ngoog.userAgent.WEBKIT = goog.userAgent.BROWSER_KNOWN_ ?\n    goog.userAgent.ASSUME_WEBKIT || goog.userAgent.ASSUME_MOBILE_WEBKIT :\n    goog.labs.userAgent.engine.isWebKit();\n\n\n/**\n * Whether the user agent is running on a mobile device.\n *\n * This is a separate function so that the logic can be tested.\n *\n * TODO(nnaze): Investigate swapping in goog.labs.userAgent.device.isMobile().\n *\n * @return {boolean} Whether the user agent is running on a mobile device.\n * @private\n */\ngoog.userAgent.isMobile_ = function() {\n  return goog.userAgent.WEBKIT &&\n      goog.labs.userAgent.util.matchUserAgent('Mobile');\n};\n\n\n/**\n * Whether the user agent is running on a mobile device.\n *\n * TODO(nnaze): Consider deprecating MOBILE when labs.userAgent\n *   is promoted as the gecko/webkit logic is likely inaccurate.\n *\n * @type {boolean}\n */\ngoog.userAgent.MOBILE =\n    goog.userAgent.ASSUME_MOBILE_WEBKIT || goog.userAgent.isMobile_();\n\n\n/**\n * Used while transitioning code to use WEBKIT instead.\n * @type {boolean}\n * @deprecated Use {@link goog.userAgent.product.SAFARI} instead.\n * TODO(nicksantos): Delete this from goog.userAgent.\n */\ngoog.userAgent.SAFARI = goog.userAgent.WEBKIT;\n\n\n/**\n * @return {string} the platform (operating system) the user agent is running\n *     on. Default to empty string because navigator.platform may not be defined\n *     (on Rhino, for example).\n * @private\n */\ngoog.userAgent.determinePlatform_ = function() {\n  var navigator = goog.userAgent.getNavigatorTyped();\n  return navigator && navigator.platform || '';\n};\n\n\n/**\n * The platform (operating system) the user agent is running on. Default to\n * empty string because navigator.platform may not be defined (on Rhino, for\n * example).\n * @type {string}\n */\ngoog.userAgent.PLATFORM = goog.userAgent.determinePlatform_();\n\n\n/**\n * @define {boolean} Whether the user agent is running on a Macintosh operating\n *     system.\n */\ngoog.define('goog.userAgent.ASSUME_MAC', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on a Windows operating\n *     system.\n */\ngoog.define('goog.userAgent.ASSUME_WINDOWS', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on a Linux operating\n *     system.\n */\ngoog.define('goog.userAgent.ASSUME_LINUX', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on a X11 windowing\n *     system.\n */\ngoog.define('goog.userAgent.ASSUME_X11', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on Android.\n */\ngoog.define('goog.userAgent.ASSUME_ANDROID', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on an iPhone.\n */\ngoog.define('goog.userAgent.ASSUME_IPHONE', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on an iPad.\n */\ngoog.define('goog.userAgent.ASSUME_IPAD', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on an iPod.\n */\ngoog.define('goog.userAgent.ASSUME_IPOD', false);\n\n\n/**\n * @define {boolean} Whether the user agent is running on KaiOS.\n */\ngoog.define('goog.userAgent.ASSUME_KAIOS', false);\n\n\n/**\n * @type {boolean}\n * @private\n */\ngoog.userAgent.PLATFORM_KNOWN_ = goog.userAgent.ASSUME_MAC ||\n    goog.userAgent.ASSUME_WINDOWS || goog.userAgent.ASSUME_LINUX ||\n    goog.userAgent.ASSUME_X11 || goog.userAgent.ASSUME_ANDROID ||\n    goog.userAgent.ASSUME_IPHONE || goog.userAgent.ASSUME_IPAD ||\n    goog.userAgent.ASSUME_IPOD;\n\n\n/**\n * Whether the user agent is running on a Macintosh operating system.\n * @type {boolean}\n */\ngoog.userAgent.MAC = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_MAC :\n    goog.labs.userAgent.platform.isMacintosh();\n\n\n/**\n * Whether the user agent is running on a Windows operating system.\n * @type {boolean}\n */\ngoog.userAgent.WINDOWS = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_WINDOWS :\n    goog.labs.userAgent.platform.isWindows();\n\n\n/**\n * Whether the user agent is Linux per the legacy behavior of\n * goog.userAgent.LINUX, which considered ChromeOS to also be\n * Linux.\n * @return {boolean}\n * @private\n */\ngoog.userAgent.isLegacyLinux_ = function() {\n  return goog.labs.userAgent.platform.isLinux() ||\n      goog.labs.userAgent.platform.isChromeOS();\n};\n\n\n/**\n * Whether the user agent is running on a Linux operating system.\n *\n * Note that goog.userAgent.LINUX considers ChromeOS to be Linux,\n * while goog.labs.userAgent.platform considers ChromeOS and\n * Linux to be different OSes.\n *\n * @type {boolean}\n */\ngoog.userAgent.LINUX = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_LINUX :\n    goog.userAgent.isLegacyLinux_();\n\n\n/**\n * @return {boolean} Whether the user agent is an X11 windowing system.\n * @private\n */\ngoog.userAgent.isX11_ = function() {\n  var navigator = goog.userAgent.getNavigatorTyped();\n  return !!navigator &&\n      goog.string.contains(navigator['appVersion'] || '', 'X11');\n};\n\n\n/**\n * Whether the user agent is running on a X11 windowing system.\n * @type {boolean}\n */\ngoog.userAgent.X11 = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_X11 :\n    goog.userAgent.isX11_();\n\n\n/**\n * Whether the user agent is running on Android.\n * @type {boolean}\n */\ngoog.userAgent.ANDROID = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_ANDROID :\n    goog.labs.userAgent.platform.isAndroid();\n\n\n/**\n * Whether the user agent is running on an iPhone.\n * @type {boolean}\n */\ngoog.userAgent.IPHONE = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_IPHONE :\n    goog.labs.userAgent.platform.isIphone();\n\n\n/**\n * Whether the user agent is running on an iPad.\n * @type {boolean}\n */\ngoog.userAgent.IPAD = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_IPAD :\n    goog.labs.userAgent.platform.isIpad();\n\n\n/**\n * Whether the user agent is running on an iPod.\n * @type {boolean}\n */\ngoog.userAgent.IPOD = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_IPOD :\n    goog.labs.userAgent.platform.isIpod();\n\n\n/**\n * Whether the user agent is running on iOS.\n * @type {boolean}\n */\ngoog.userAgent.IOS = goog.userAgent.PLATFORM_KNOWN_ ?\n    (goog.userAgent.ASSUME_IPHONE || goog.userAgent.ASSUME_IPAD ||\n     goog.userAgent.ASSUME_IPOD) :\n    goog.labs.userAgent.platform.isIos();\n\n/**\n * Whether the user agent is running on KaiOS.\n */\ngoog.userAgent.KAIOS = goog.userAgent.PLATFORM_KNOWN_ ?\n    goog.userAgent.ASSUME_KAIOS :\n    goog.labs.userAgent.platform.isKaiOS();\n\n\n/**\n * @return {string} The string that describes the version number of the user\n *     agent.\n * @private\n */\ngoog.userAgent.determineVersion_ = function() {\n  // All browsers have different ways to detect the version and they all have\n  // different naming schemes.\n  // version is a string rather than a number because it may contain 'b', 'a',\n  // and so on.\n  var version = '';\n  var arr = goog.userAgent.getVersionRegexResult_();\n  if (arr) {\n    version = arr ? arr[1] : '';\n  }\n\n  if (goog.userAgent.IE) {\n    // IE9 can be in document mode 9 but be reporting an inconsistent user agent\n    // version.  If it is identifying as a version lower than 9 we take the\n    // documentMode as the version instead.  IE8 has similar behavior.\n    // It is recommended to set the X-UA-Compatible header to ensure that IE9\n    // uses documentMode 9.\n    var docMode = goog.userAgent.getDocumentMode_();\n    if (docMode != null && docMode > parseFloat(version)) {\n      return String(docMode);\n    }\n  }\n\n  return version;\n};\n\n\n/**\n * @return {?IArrayLike<string>|undefined} The version regex matches from\n *     parsing the user\n *     agent string. These regex statements must be executed inline so they can\n *     be compiled out by the closure compiler with the rest of the useragent\n *     detection logic when ASSUME_* is specified.\n * @private\n */\ngoog.userAgent.getVersionRegexResult_ = function() {\n  var userAgent = goog.userAgent.getUserAgentString();\n  if (goog.userAgent.GECKO) {\n    return /rv\\:([^\\);]+)(\\)|;)/.exec(userAgent);\n  }\n  if (goog.userAgent.EDGE) {\n    return /Edge\\/([\\d\\.]+)/.exec(userAgent);\n  }\n  if (goog.userAgent.IE) {\n    return /\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(userAgent);\n  }\n  if (goog.userAgent.WEBKIT) {\n    // WebKit/125.4\n    return /WebKit\\/(\\S+)/.exec(userAgent);\n  }\n  if (goog.userAgent.OPERA) {\n    // If none of the above browsers were detected but the browser is Opera, the\n    // only string that is of interest is 'Version/<number>'.\n    return /(?:Version)[ \\/]?(\\S+)/.exec(userAgent);\n  }\n  return undefined;\n};\n\n\n/**\n * @return {number|undefined} Returns the document mode (for testing).\n * @private\n */\ngoog.userAgent.getDocumentMode_ = function() {\n  // NOTE(user): goog.userAgent may be used in context where there is no DOM.\n  var doc = goog.global['document'];\n  return doc ? doc['documentMode'] : undefined;\n};\n\n\n/**\n * The version of the user agent. This is a string because it might contain\n * 'b' (as in beta) as well as multiple dots.\n * @type {string}\n */\ngoog.userAgent.VERSION = goog.userAgent.determineVersion_();\n\n\n/**\n * Compares two version numbers.\n *\n * @param {string} v1 Version of first item.\n * @param {string} v2 Version of second item.\n *\n * @return {number}  1 if first argument is higher\n *                   0 if arguments are equal\n *                  -1 if second argument is higher.\n * @deprecated Use goog.string.compareVersions.\n */\ngoog.userAgent.compare = function(v1, v2) {\n  return goog.string.compareVersions(v1, v2);\n};\n\n\n/**\n * Cache for {@link goog.userAgent.isVersionOrHigher}.\n * Calls to compareVersions are surprisingly expensive and, as a browser's\n * version number is unlikely to change during a session, we cache the results.\n * @const\n * @private\n */\ngoog.userAgent.isVersionOrHigherCache_ = {};\n\n\n/**\n * Whether the user agent version is higher or the same as the given version.\n * NOTE: When checking the version numbers for Firefox and Safari, be sure to\n * use the engine's version, not the browser's version number.  For example,\n * Firefox 3.0 corresponds to Gecko 1.9 and Safari 3.0 to Webkit 522.11.\n * Opera and Internet Explorer versions match the product release number.<br>\n * @see <a href=\"http://en.wikipedia.org/wiki/Safari_version_history\">\n *     Webkit</a>\n * @see <a href=\"http://en.wikipedia.org/wiki/Gecko_engine\">Gecko</a>\n *\n * @param {string|number} version The version to check.\n * @return {boolean} Whether the user agent version is higher or the same as\n *     the given version.\n */\ngoog.userAgent.isVersionOrHigher = function(version) {\n  return goog.userAgent.ASSUME_ANY_VERSION ||\n      goog.reflect.cache(\n          goog.userAgent.isVersionOrHigherCache_, version, function() {\n            return goog.string.compareVersions(\n                       goog.userAgent.VERSION, version) >= 0;\n          });\n};\n\n\n/**\n * Deprecated alias to `goog.userAgent.isVersionOrHigher`.\n * @param {string|number} version The version to check.\n * @return {boolean} Whether the user agent version is higher or the same as\n *     the given version.\n * @deprecated Use goog.userAgent.isVersionOrHigher().\n */\ngoog.userAgent.isVersion = goog.userAgent.isVersionOrHigher;\n\n\n/**\n * Whether the IE effective document mode is higher or the same as the given\n * document mode version.\n * NOTE: Only for IE, return false for another browser.\n *\n * @param {number} documentMode The document mode version to check.\n * @return {boolean} Whether the IE effective document mode is higher or the\n *     same as the given version.\n */\ngoog.userAgent.isDocumentModeOrHigher = function(documentMode) {\n  return Number(goog.userAgent.DOCUMENT_MODE) >= documentMode;\n};\n\n\n/**\n * Deprecated alias to `goog.userAgent.isDocumentModeOrHigher`.\n * @param {number} version The version to check.\n * @return {boolean} Whether the IE effective document mode is higher or the\n *      same as the given version.\n * @deprecated Use goog.userAgent.isDocumentModeOrHigher().\n */\ngoog.userAgent.isDocumentMode = goog.userAgent.isDocumentModeOrHigher;\n\n\n/**\n * For IE version < 7, documentMode is undefined, so attempt to use the\n * CSS1Compat property to see if we are in standards mode. If we are in\n * standards mode, treat the browser version as the document mode. Otherwise,\n * IE is emulating version 5.\n * @type {number|undefined}\n * @const\n */\ngoog.userAgent.DOCUMENT_MODE = (function() {\n  var doc = goog.global['document'];\n  var mode = goog.userAgent.getDocumentMode_();\n  if (!doc || !goog.userAgent.IE) {\n    return undefined;\n  }\n  return mode || (doc['compatMode'] == 'CSS1Compat' ?\n                      parseInt(goog.userAgent.VERSION, 10) :\n                      5);\n})();\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Closure user agent detection (Browser).\n * @see <a href=\"http://www.useragentstring.com/\">User agent strings</a>\n * For more information on rendering engine, platform, or device see the other\n * sub-namespaces in goog.labs.userAgent, goog.labs.userAgent.platform,\n * goog.labs.userAgent.device respectively.)\n *\n * @author martone@google.com (Andy Martone)\n */\n\ngoog.provide('goog.labs.userAgent.browser');\n\ngoog.require('goog.array');\ngoog.require('goog.labs.userAgent.util');\ngoog.require('goog.object');\ngoog.require('goog.string');\n\n\n// TODO(nnaze): Refactor to remove excessive exclusion logic in matching\n// functions.\n\n\n/**\n * @return {boolean} Whether the user's browser is Opera.  Note: Chromium\n *     based Opera (Opera 15+) is detected as Chrome to avoid unnecessary\n *     special casing.\n * @private\n */\ngoog.labs.userAgent.browser.matchOpera_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Opera');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is IE.\n * @private\n */\ngoog.labs.userAgent.browser.matchIE_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Trident') ||\n      goog.labs.userAgent.util.matchUserAgent('MSIE');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Edge.\n * @private\n */\ngoog.labs.userAgent.browser.matchEdge_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Edge');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Firefox.\n * @private\n */\ngoog.labs.userAgent.browser.matchFirefox_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Firefox');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Safari.\n * @private\n */\ngoog.labs.userAgent.browser.matchSafari_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Safari') &&\n      !(goog.labs.userAgent.browser.matchChrome_() ||\n        goog.labs.userAgent.browser.matchCoast_() ||\n        goog.labs.userAgent.browser.matchOpera_() ||\n        goog.labs.userAgent.browser.matchEdge_() ||\n        goog.labs.userAgent.browser.isSilk() ||\n        goog.labs.userAgent.util.matchUserAgent('Android'));\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Coast (Opera's Webkit-based\n *     iOS browser).\n * @private\n */\ngoog.labs.userAgent.browser.matchCoast_ = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Coast');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is iOS Webview.\n * @private\n */\ngoog.labs.userAgent.browser.matchIosWebview_ = function() {\n  // iOS Webview does not show up as Chrome or Safari. Also check for Opera's\n  // WebKit-based iOS browser, Coast.\n  return (goog.labs.userAgent.util.matchUserAgent('iPad') ||\n          goog.labs.userAgent.util.matchUserAgent('iPhone')) &&\n      !goog.labs.userAgent.browser.matchSafari_() &&\n      !goog.labs.userAgent.browser.matchChrome_() &&\n      !goog.labs.userAgent.browser.matchCoast_() &&\n      goog.labs.userAgent.util.matchUserAgent('AppleWebKit');\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Chrome.\n * @private\n */\ngoog.labs.userAgent.browser.matchChrome_ = function() {\n  return (goog.labs.userAgent.util.matchUserAgent('Chrome') ||\n          goog.labs.userAgent.util.matchUserAgent('CriOS')) &&\n      !goog.labs.userAgent.browser.matchEdge_();\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is the Android browser.\n * @private\n */\ngoog.labs.userAgent.browser.matchAndroidBrowser_ = function() {\n  // Android can appear in the user agent string for Chrome on Android.\n  // This is not the Android standalone browser if it does.\n  return goog.labs.userAgent.util.matchUserAgent('Android') &&\n      !(goog.labs.userAgent.browser.isChrome() ||\n        goog.labs.userAgent.browser.isFirefox() ||\n        goog.labs.userAgent.browser.isOpera() ||\n        goog.labs.userAgent.browser.isSilk());\n};\n\n\n/**\n * @return {boolean} Whether the user's browser is Opera.\n */\ngoog.labs.userAgent.browser.isOpera = goog.labs.userAgent.browser.matchOpera_;\n\n\n/**\n * @return {boolean} Whether the user's browser is IE.\n */\ngoog.labs.userAgent.browser.isIE = goog.labs.userAgent.browser.matchIE_;\n\n\n/**\n * @return {boolean} Whether the user's browser is Edge.\n */\ngoog.labs.userAgent.browser.isEdge = goog.labs.userAgent.browser.matchEdge_;\n\n\n/**\n * @return {boolean} Whether the user's browser is Firefox.\n */\ngoog.labs.userAgent.browser.isFirefox =\n    goog.labs.userAgent.browser.matchFirefox_;\n\n\n/**\n * @return {boolean} Whether the user's browser is Safari.\n */\ngoog.labs.userAgent.browser.isSafari = goog.labs.userAgent.browser.matchSafari_;\n\n\n/**\n * @return {boolean} Whether the user's browser is Coast (Opera's Webkit-based\n *     iOS browser).\n */\ngoog.labs.userAgent.browser.isCoast = goog.labs.userAgent.browser.matchCoast_;\n\n\n/**\n * @return {boolean} Whether the user's browser is iOS Webview.\n */\ngoog.labs.userAgent.browser.isIosWebview =\n    goog.labs.userAgent.browser.matchIosWebview_;\n\n\n/**\n * @return {boolean} Whether the user's browser is Chrome.\n */\ngoog.labs.userAgent.browser.isChrome = goog.labs.userAgent.browser.matchChrome_;\n\n\n/**\n * @return {boolean} Whether the user's browser is the Android browser.\n */\ngoog.labs.userAgent.browser.isAndroidBrowser =\n    goog.labs.userAgent.browser.matchAndroidBrowser_;\n\n\n/**\n * For more information, see:\n * http://docs.aws.amazon.com/silk/latest/developerguide/user-agent.html\n * @return {boolean} Whether the user's browser is Silk.\n */\ngoog.labs.userAgent.browser.isSilk = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Silk');\n};\n\n\n/**\n * @return {string} The browser version or empty string if version cannot be\n *     determined. Note that for Internet Explorer, this returns the version of\n *     the browser, not the version of the rendering engine. (IE 8 in\n *     compatibility mode will return 8.0 rather than 7.0. To determine the\n *     rendering engine version, look at document.documentMode instead. See\n *     http://msdn.microsoft.com/en-us/library/cc196988(v=vs.85).aspx for more\n *     details.)\n */\ngoog.labs.userAgent.browser.getVersion = function() {\n  var userAgentString = goog.labs.userAgent.util.getUserAgent();\n  // Special case IE since IE's version is inside the parenthesis and\n  // without the '/'.\n  if (goog.labs.userAgent.browser.isIE()) {\n    return goog.labs.userAgent.browser.getIEVersion_(userAgentString);\n  }\n\n  var versionTuples =\n      goog.labs.userAgent.util.extractVersionTuples(userAgentString);\n\n  // Construct a map for easy lookup.\n  var versionMap = {};\n  goog.array.forEach(versionTuples, function(tuple) {\n    // Note that the tuple is of length three, but we only care about the\n    // first two.\n    var key = tuple[0];\n    var value = tuple[1];\n    versionMap[key] = value;\n  });\n\n  var versionMapHasKey = goog.partial(goog.object.containsKey, versionMap);\n\n  // Gives the value with the first key it finds, otherwise empty string.\n  function lookUpValueWithKeys(keys) {\n    var key = goog.array.find(keys, versionMapHasKey);\n    return versionMap[key] || '';\n  }\n\n  // Check Opera before Chrome since Opera 15+ has \"Chrome\" in the string.\n  // See\n  // http://my.opera.com/ODIN/blog/2013/07/15/opera-user-agent-strings-opera-15-and-beyond\n  if (goog.labs.userAgent.browser.isOpera()) {\n    // Opera 10 has Version/10.0 but Opera/9.8, so look for \"Version\" first.\n    // Opera uses 'OPR' for more recent UAs.\n    return lookUpValueWithKeys(['Version', 'Opera']);\n  }\n\n  // Check Edge before Chrome since it has Chrome in the string.\n  if (goog.labs.userAgent.browser.isEdge()) {\n    return lookUpValueWithKeys(['Edge']);\n  }\n\n  if (goog.labs.userAgent.browser.isChrome()) {\n    return lookUpValueWithKeys(['Chrome', 'CriOS']);\n  }\n\n  // Usually products browser versions are in the third tuple after \"Mozilla\"\n  // and the engine.\n  var tuple = versionTuples[2];\n  return tuple && tuple[1] || '';\n};\n\n\n/**\n * @param {string|number} version The version to check.\n * @return {boolean} Whether the browser version is higher or the same as the\n *     given version.\n */\ngoog.labs.userAgent.browser.isVersionOrHigher = function(version) {\n  return goog.string.compareVersions(\n             goog.labs.userAgent.browser.getVersion(), version) >= 0;\n};\n\n\n/**\n * Determines IE version. More information:\n * http://msdn.microsoft.com/en-us/library/ie/bg182625(v=vs.85).aspx#uaString\n * http://msdn.microsoft.com/en-us/library/hh869301(v=vs.85).aspx\n * http://blogs.msdn.com/b/ie/archive/2010/03/23/introducing-ie9-s-user-agent-string.aspx\n * http://blogs.msdn.com/b/ie/archive/2009/01/09/the-internet-explorer-8-user-agent-string-updated-edition.aspx\n *\n * @param {string} userAgent the User-Agent.\n * @return {string}\n * @private\n */\ngoog.labs.userAgent.browser.getIEVersion_ = function(userAgent) {\n  // IE11 may identify itself as MSIE 9.0 or MSIE 10.0 due to an IE 11 upgrade\n  // bug. Example UA:\n  // Mozilla/5.0 (MSIE 9.0; Windows NT 6.1; WOW64; Trident/7.0; rv:11.0)\n  // like Gecko.\n  // See http://www.whatismybrowser.com/developers/unknown-user-agent-fragments.\n  var rv = /rv: *([\\d\\.]*)/.exec(userAgent);\n  if (rv && rv[1]) {\n    return rv[1];\n  }\n\n  var version = '';\n  var msie = /MSIE +([\\d\\.]+)/.exec(userAgent);\n  if (msie && msie[1]) {\n    // IE in compatibility mode usually identifies itself as MSIE 7.0; in this\n    // case, use the Trident version to determine the version of IE. For more\n    // details, see the links above.\n    var tridentVersion = /Trident\\/(\\d.\\d)/.exec(userAgent);\n    if (msie[1] == '7.0') {\n      if (tridentVersion && tridentVersion[1]) {\n        switch (tridentVersion[1]) {\n          case '4.0':\n            version = '8.0';\n            break;\n          case '5.0':\n            version = '9.0';\n            break;\n          case '6.0':\n            version = '10.0';\n            break;\n          case '7.0':\n            version = '11.0';\n            break;\n        }\n      } else {\n        version = '7.0';\n      }\n    } else {\n      version = msie[1];\n    }\n  }\n  return version;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Closure user agent detection.\n * @see http://en.wikipedia.org/wiki/User_agent\n * For more information on browser brand, platform, or device see the other\n * sub-namespaces in goog.labs.userAgent (browser, platform, and device).\n *\n */\n\ngoog.provide('goog.labs.userAgent.engine');\n\ngoog.require('goog.array');\ngoog.require('goog.labs.userAgent.util');\ngoog.require('goog.string');\n\n\n/**\n * @return {boolean} Whether the rendering engine is Presto.\n */\ngoog.labs.userAgent.engine.isPresto = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Presto');\n};\n\n\n/**\n * @return {boolean} Whether the rendering engine is Trident.\n */\ngoog.labs.userAgent.engine.isTrident = function() {\n  // IE only started including the Trident token in IE8.\n  return goog.labs.userAgent.util.matchUserAgent('Trident') ||\n      goog.labs.userAgent.util.matchUserAgent('MSIE');\n};\n\n\n/**\n * @return {boolean} Whether the rendering engine is Edge.\n */\ngoog.labs.userAgent.engine.isEdge = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Edge');\n};\n\n\n/**\n * @return {boolean} Whether the rendering engine is WebKit.\n */\ngoog.labs.userAgent.engine.isWebKit = function() {\n  return goog.labs.userAgent.util.matchUserAgentIgnoreCase('WebKit') &&\n      !goog.labs.userAgent.engine.isEdge();\n};\n\n\n/**\n * @return {boolean} Whether the rendering engine is Gecko.\n */\ngoog.labs.userAgent.engine.isGecko = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Gecko') &&\n      !goog.labs.userAgent.engine.isWebKit() &&\n      !goog.labs.userAgent.engine.isTrident() &&\n      !goog.labs.userAgent.engine.isEdge();\n};\n\n\n/**\n * @return {string} The rendering engine's version or empty string if version\n *     can't be determined.\n */\ngoog.labs.userAgent.engine.getVersion = function() {\n  var userAgentString = goog.labs.userAgent.util.getUserAgent();\n  if (userAgentString) {\n    var tuples = goog.labs.userAgent.util.extractVersionTuples(userAgentString);\n\n    var engineTuple = goog.labs.userAgent.engine.getEngineTuple_(tuples);\n    if (engineTuple) {\n      // In Gecko, the version string is either in the browser info or the\n      // Firefox version.  See Gecko user agent string reference:\n      // http://goo.gl/mULqa\n      if (engineTuple[0] == 'Gecko') {\n        return goog.labs.userAgent.engine.getVersionForKey_(tuples, 'Firefox');\n      }\n\n      return engineTuple[1];\n    }\n\n    // MSIE has only one version identifier, and the Trident version is\n    // specified in the parenthetical. IE Edge is covered in the engine tuple\n    // detection.\n    var browserTuple = tuples[0];\n    var info;\n    if (browserTuple && (info = browserTuple[2])) {\n      var match = /Trident\\/([^\\s;]+)/.exec(info);\n      if (match) {\n        return match[1];\n      }\n    }\n  }\n  return '';\n};\n\n\n/**\n * @param {!Array<!Array<string>>} tuples Extracted version tuples.\n * @return {!Array<string>|undefined} The engine tuple or undefined if not\n *     found.\n * @private\n */\ngoog.labs.userAgent.engine.getEngineTuple_ = function(tuples) {\n  if (!goog.labs.userAgent.engine.isEdge()) {\n    return tuples[1];\n  }\n  for (var i = 0; i < tuples.length; i++) {\n    var tuple = tuples[i];\n    if (tuple[0] == 'Edge') {\n      return tuple;\n    }\n  }\n};\n\n\n/**\n * @param {string|number} version The version to check.\n * @return {boolean} Whether the rendering engine version is higher or the same\n *     as the given version.\n */\ngoog.labs.userAgent.engine.isVersionOrHigher = function(version) {\n  return goog.string.compareVersions(\n             goog.labs.userAgent.engine.getVersion(), version) >= 0;\n};\n\n\n/**\n * @param {!Array<!Array<string>>} tuples Version tuples.\n * @param {string} key The key to look for.\n * @return {string} The version string of the given key, if present.\n *     Otherwise, the empty string.\n * @private\n */\ngoog.labs.userAgent.engine.getVersionForKey_ = function(tuples, key) {\n  // TODO(nnaze): Move to util if useful elsewhere.\n\n  var pair = goog.array.find(tuples, function(pair) { return key == pair[0]; });\n\n  return pair && pair[1] || '';\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Closure user agent platform detection.\n * @see <a href=\"http://www.useragentstring.com/\">User agent strings</a>\n * For more information on browser brand, rendering engine, or device see the\n * other sub-namespaces in goog.labs.userAgent (browser, engine, and device\n * respectively).\n *\n */\n\ngoog.provide('goog.labs.userAgent.platform');\n\ngoog.require('goog.labs.userAgent.util');\ngoog.require('goog.string');\n\n\n/**\n * @return {boolean} Whether the platform is Android.\n */\ngoog.labs.userAgent.platform.isAndroid = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Android');\n};\n\n\n/**\n * @return {boolean} Whether the platform is iPod.\n */\ngoog.labs.userAgent.platform.isIpod = function() {\n  return goog.labs.userAgent.util.matchUserAgent('iPod');\n};\n\n\n/**\n * @return {boolean} Whether the platform is iPhone.\n */\ngoog.labs.userAgent.platform.isIphone = function() {\n  return goog.labs.userAgent.util.matchUserAgent('iPhone') &&\n      !goog.labs.userAgent.util.matchUserAgent('iPod') &&\n      !goog.labs.userAgent.util.matchUserAgent('iPad');\n};\n\n\n/**\n * @return {boolean} Whether the platform is iPad.\n */\ngoog.labs.userAgent.platform.isIpad = function() {\n  return goog.labs.userAgent.util.matchUserAgent('iPad');\n};\n\n\n/**\n * @return {boolean} Whether the platform is iOS.\n */\ngoog.labs.userAgent.platform.isIos = function() {\n  return goog.labs.userAgent.platform.isIphone() ||\n      goog.labs.userAgent.platform.isIpad() ||\n      goog.labs.userAgent.platform.isIpod();\n};\n\n\n/**\n * @return {boolean} Whether the platform is Mac.\n */\ngoog.labs.userAgent.platform.isMacintosh = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Macintosh');\n};\n\n\n/**\n * Note: ChromeOS is not considered to be Linux as it does not report itself\n * as Linux in the user agent string.\n * @return {boolean} Whether the platform is Linux.\n */\ngoog.labs.userAgent.platform.isLinux = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Linux');\n};\n\n\n/**\n * @return {boolean} Whether the platform is Windows.\n */\ngoog.labs.userAgent.platform.isWindows = function() {\n  return goog.labs.userAgent.util.matchUserAgent('Windows');\n};\n\n\n/**\n * @return {boolean} Whether the platform is ChromeOS.\n */\ngoog.labs.userAgent.platform.isChromeOS = function() {\n  return goog.labs.userAgent.util.matchUserAgent('CrOS');\n};\n\n/**\n * @return {boolean} Whether the platform is Chromecast.\n */\ngoog.labs.userAgent.platform.isChromecast = function() {\n  return goog.labs.userAgent.util.matchUserAgent('CrKey');\n};\n\n/**\n * @return {boolean} Whether the platform is KaiOS.\n */\ngoog.labs.userAgent.platform.isKaiOS = function() {\n  return goog.labs.userAgent.util.matchUserAgentIgnoreCase('KaiOS');\n};\n\n/**\n * The version of the platform. We only determine the version for Windows,\n * Mac, and Chrome OS. It doesn't make much sense on Linux. For Windows, we only\n * look at the NT version. Non-NT-based versions (e.g. 95, 98, etc.) are given\n * version 0.0.\n *\n * @return {string} The platform version or empty string if version cannot be\n *     determined.\n */\ngoog.labs.userAgent.platform.getVersion = function() {\n  var userAgentString = goog.labs.userAgent.util.getUserAgent();\n  var version = '', re;\n  if (goog.labs.userAgent.platform.isWindows()) {\n    re = /Windows (?:NT|Phone) ([0-9.]+)/;\n    var match = re.exec(userAgentString);\n    if (match) {\n      version = match[1];\n    } else {\n      version = '0.0';\n    }\n  } else if (goog.labs.userAgent.platform.isIos()) {\n    re = /(?:iPhone|iPod|iPad|CPU)\\s+OS\\s+(\\S+)/;\n    var match = re.exec(userAgentString);\n    // Report the version as x.y.z and not x_y_z\n    version = match && match[1].replace(/_/g, '.');\n  } else if (goog.labs.userAgent.platform.isMacintosh()) {\n    re = /Mac OS X ([0-9_.]+)/;\n    var match = re.exec(userAgentString);\n    // Note: some old versions of Camino do not report an OSX version.\n    // Default to 10.\n    version = match ? match[1].replace(/_/g, '.') : '10';\n  } else if (goog.labs.userAgent.platform.isAndroid()) {\n    re = /Android\\s+([^\\);]+)(\\)|;)/;\n    var match = re.exec(userAgentString);\n    version = match && match[1];\n  } else if (goog.labs.userAgent.platform.isChromeOS()) {\n    re = /(?:CrOS\\s+(?:i686|x86_64)\\s+([0-9.]+))/;\n    var match = re.exec(userAgentString);\n    version = match && match[1];\n  }\n  return version || '';\n};\n\n\n/**\n * @param {string|number} version The version to check.\n * @return {boolean} Whether the browser version is higher or the same as the\n *     given version.\n */\ngoog.labs.userAgent.platform.isVersionOrHigher = function(version) {\n  return goog.string.compareVersions(\n             goog.labs.userAgent.platform.getVersion(), version) >= 0;\n};\n","// Copyright 2010 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Browser capability checks for the dom package.\n *\n */\n\n\ngoog.provide('goog.dom.BrowserFeature');\n\ngoog.require('goog.userAgent');\n\n\n/**\n * Enum of browser capabilities.\n * @enum {boolean}\n */\ngoog.dom.BrowserFeature = {\n  /**\n   * Whether attributes 'name' and 'type' can be added to an element after it's\n   * created. False in Internet Explorer prior to version 9.\n   */\n  CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:\n      !goog.userAgent.IE || goog.userAgent.isDocumentModeOrHigher(9),\n\n  /**\n   * Whether we can use element.children to access an element's Element\n   * children. Available since Gecko 1.9.1, IE 9. (IE<9 also includes comment\n   * nodes in the collection.)\n   */\n  CAN_USE_CHILDREN_ATTRIBUTE: !goog.userAgent.GECKO && !goog.userAgent.IE ||\n      goog.userAgent.IE && goog.userAgent.isDocumentModeOrHigher(9) ||\n      goog.userAgent.GECKO && goog.userAgent.isVersionOrHigher('1.9.1'),\n\n  /**\n   * Opera, Safari 3, and Internet Explorer 9 all support innerText but they\n   * include text nodes in script and style tags. Not document-mode-dependent.\n   */\n  CAN_USE_INNER_TEXT:\n      (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('9')),\n\n  /**\n   * MSIE, Opera, and Safari>=4 support element.parentElement to access an\n   * element's parent if it is an Element.\n   */\n  CAN_USE_PARENT_ELEMENT_PROPERTY:\n      goog.userAgent.IE || goog.userAgent.OPERA || goog.userAgent.WEBKIT,\n\n  /**\n   * Whether NoScope elements need a scoped element written before them in\n   * innerHTML.\n   * MSDN: http://msdn.microsoft.com/en-us/library/ms533897(VS.85).aspx#1\n   */\n  INNER_HTML_NEEDS_SCOPED_ELEMENT: goog.userAgent.IE,\n\n  /**\n   * Whether we use legacy IE range API.\n   */\n  LEGACY_IE_RANGES:\n      goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(9)\n};\n","// Copyright 2014 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for HTML element tag names.\n */\ngoog.provide('goog.dom.tags');\n\ngoog.require('goog.object');\n\n\n/**\n * The void elements specified by\n * http://www.w3.org/TR/html-markup/syntax.html#void-elements.\n * @const @private {!Object<string, boolean>}\n */\ngoog.dom.tags.VOID_TAGS_ = goog.object.createSet(\n    'area', 'base', 'br', 'col', 'command', 'embed', 'hr', 'img', 'input',\n    'keygen', 'link', 'meta', 'param', 'source', 'track', 'wbr');\n\n\n/**\n * Checks whether the tag is void (with no contents allowed and no legal end\n * tag), for example 'br'.\n * @param {string} tagName The tag name in lower case.\n * @return {boolean}\n */\ngoog.dom.tags.isVoidTag = function(tagName) {\n  return goog.dom.tags.VOID_TAGS_[tagName] === true;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\ngoog.provide('goog.string.Const');\n\ngoog.require('goog.asserts');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * Wrapper for compile-time-constant strings.\n *\n * Const is a wrapper for strings that can only be created from program\n * constants (i.e., string literals).  This property relies on a custom Closure\n * compiler check that `goog.string.Const.from` is only invoked on\n * compile-time-constant expressions.\n *\n * Const is useful in APIs whose correct and secure use requires that certain\n * arguments are not attacker controlled: Compile-time constants are inherently\n * under the control of the application and not under control of external\n * attackers, and hence are safe to use in such contexts.\n *\n * Instances of this type must be created via its factory method\n * `goog.string.Const.from` and not by invoking its constructor.  The\n * constructor intentionally takes no parameters and the type is immutable;\n * hence only a default instance corresponding to the empty string can be\n * obtained via constructor invocation.  Use goog.string.Const.EMPTY\n * instead of using this constructor to get an empty Const string.\n *\n * @see goog.string.Const#from\n * @constructor\n * @final\n * @struct\n * @implements {goog.string.TypedString}\n * @param {Object=} opt_token package-internal implementation detail.\n * @param {string=} opt_content package-internal implementation detail.\n */\ngoog.string.Const = function(opt_token, opt_content) {\n  /**\n   * The wrapped value of this Const object.  The field has a purposely ugly\n   * name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.stringConstValueWithSecurityContract__googStringSecurityPrivate_ =\n      ((opt_token ===\n        goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_) &&\n       opt_content) ||\n      '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.string.Const#unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_ =\n      goog.string.Const.TYPE_MARKER_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.string.Const.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Returns this Const's value a string.\n *\n * IMPORTANT: In code where it is security-relevant that an object's type is\n * indeed `goog.string.Const`, use `goog.string.Const.unwrap`\n * instead of this method.\n *\n * @see goog.string.Const#unwrap\n * @override\n */\ngoog.string.Const.prototype.getTypedStringValue = function() {\n  return this.stringConstValueWithSecurityContract__googStringSecurityPrivate_;\n};\n\n\n/**\n * Returns a debug-string representation of this value.\n *\n * To obtain the actual string value wrapped inside an object of this type,\n * use `goog.string.Const.unwrap`.\n *\n * @see goog.string.Const#unwrap\n * @override\n */\ngoog.string.Const.prototype.toString = function() {\n  return 'Const{' +\n      this.stringConstValueWithSecurityContract__googStringSecurityPrivate_ +\n      '}';\n};\n\n\n/**\n * Performs a runtime check that the provided object is indeed an instance\n * of `goog.string.Const`, and returns its value.\n * @param {!goog.string.Const} stringConst The object to extract from.\n * @return {string} The Const object's contained string, unless the run-time\n *     type check fails. In that case, `unwrap` returns an innocuous\n *     string, or, if assertions are enabled, throws\n *     `goog.asserts.AssertionError`.\n */\ngoog.string.Const.unwrap = function(stringConst) {\n  // Perform additional run-time type-checking to ensure that stringConst is\n  // indeed an instance of the expected type.  This provides some additional\n  // protection against security bugs due to application code that disables type\n  // checks.\n  if (stringConst instanceof goog.string.Const &&\n      stringConst.constructor === goog.string.Const &&\n      stringConst.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_ ===\n          goog.string.Const.TYPE_MARKER_) {\n    return stringConst\n        .stringConstValueWithSecurityContract__googStringSecurityPrivate_;\n  } else {\n    goog.asserts.fail(\n        'expected object of type Const, got \\'' + stringConst + '\\'');\n    return 'type_error:Const';\n  }\n};\n\n\n/**\n * Creates a Const object from a compile-time constant string.\n *\n * It is illegal to invoke this function on an expression whose\n * compile-time-constant value cannot be determined by the Closure compiler.\n *\n * Correct invocations include,\n * <pre>\n *   var s = goog.string.Const.from('hello');\n *   var t = goog.string.Const.from('hello' + 'world');\n * </pre>\n *\n * In contrast, the following are illegal:\n * <pre>\n *   var s = goog.string.Const.from(getHello());\n *   var t = goog.string.Const.from('hello' + world);\n * </pre>\n *\n * @param {string} s A constant string from which to create a Const.\n * @return {!goog.string.Const} A Const object initialized to stringConst.\n */\ngoog.string.Const.from = function(s) {\n  return new goog.string.Const(\n      goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_, s);\n};\n\n/**\n * Type marker for the Const type, used to implement additional run-time\n * type checking.\n * @const {!Object}\n * @private\n */\ngoog.string.Const.TYPE_MARKER_ = {};\n\n/**\n * @type {!Object}\n * @private\n * @const\n */\ngoog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_ = {};\n\n/**\n * A Const instance wrapping the empty string.\n * @const {!goog.string.Const}\n */\ngoog.string.Const.EMPTY = goog.string.Const.from('');\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview The TrustedResourceUrl type and its builders.\n *\n * TODO(xtof): Link to document stating type contract.\n */\n\ngoog.provide('goog.html.TrustedResourceUrl');\n\ngoog.require('goog.asserts');\ngoog.require('goog.i18n.bidi.Dir');\ngoog.require('goog.i18n.bidi.DirectionalString');\ngoog.require('goog.string.Const');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * A URL which is under application control and from which script, CSS, and\n * other resources that represent executable code, can be fetched.\n *\n * Given that the URL can only be constructed from strings under application\n * control and is used to load resources, bugs resulting in a malformed URL\n * should not have a security impact and are likely to be easily detectable\n * during testing. Given the wide number of non-RFC compliant URLs in use,\n * stricter validation could prevent some applications from being able to use\n * this type.\n *\n * Instances of this type must be created via the factory method,\n * (`fromConstant`, `fromConstants`, `format` or\n * `formatWithParams`), and not by invoking its constructor. The constructor\n * intentionally takes no parameters and the type is immutable; hence only a\n * default instance corresponding to the empty string can be obtained via\n * constructor invocation.\n *\n * @see goog.html.TrustedResourceUrl#fromConstant\n * @constructor\n * @final\n * @struct\n * @implements {goog.i18n.bidi.DirectionalString}\n * @implements {goog.string.TypedString}\n */\ngoog.html.TrustedResourceUrl = function() {\n  /**\n   * The contained value of this TrustedResourceUrl.  The field has a purposely\n   * ugly name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_ = '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.html.TrustedResourceUrl#unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ =\n      goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.TrustedResourceUrl.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Returns this TrustedResourceUrl's value as a string.\n *\n * IMPORTANT: In code where it is security relevant that an object's type is\n * indeed `TrustedResourceUrl`, use\n * `goog.html.TrustedResourceUrl.unwrap` instead of this method. If in\n * doubt, assume that it's security relevant. In particular, note that\n * goog.html functions which return a goog.html type do not guarantee that\n * the returned instance is of the right type. For example:\n *\n * <pre>\n * var fakeSafeHtml = new String('fake');\n * fakeSafeHtml.__proto__ = goog.html.SafeHtml.prototype;\n * var newSafeHtml = goog.html.SafeHtml.htmlEscape(fakeSafeHtml);\n * // newSafeHtml is just an alias for fakeSafeHtml, it's passed through by\n * // goog.html.SafeHtml.htmlEscape() as fakeSafeHtml instanceof\n * // goog.html.SafeHtml.\n * </pre>\n *\n * @see goog.html.TrustedResourceUrl#unwrap\n * @override\n */\ngoog.html.TrustedResourceUrl.prototype.getTypedStringValue = function() {\n  return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.TrustedResourceUrl.prototype.implementsGoogI18nBidiDirectionalString =\n    true;\n\n\n/**\n * Returns this URLs directionality, which is always `LTR`.\n * @override\n */\ngoog.html.TrustedResourceUrl.prototype.getDirection = function() {\n  return goog.i18n.bidi.Dir.LTR;\n};\n\n\n/**\n * Creates a new TrustedResourceUrl with params added to URL.\n * @param {!Object<string, *>} params Parameters to add to URL. Parameters with\n *     value `null` or `undefined` are skipped. Both keys and values\n *     are encoded. If the value is an array then the same parameter is added\n *     for every element in the array. Note that JavaScript doesn't guarantee\n *     the order of values in an object which might result in non-deterministic\n *     order of the parameters. However, browsers currently preserve the order.\n * @return {!goog.html.TrustedResourceUrl} New TrustedResourceUrl with params.\n * @throws {!Error} If the url contains #.\n */\ngoog.html.TrustedResourceUrl.prototype.cloneWithParams = function(params) {\n  var url = goog.html.TrustedResourceUrl.unwrap(this);\n  if (/#/.test(url)) {\n    throw new Error(\n        'Found a hash in url (' + url + '), appending not supported.');\n  }\n  var separator = /\\?/.test(url) ? '&' : '?';\n  for (var key in params) {\n    var values = goog.isArray(params[key]) ?\n        /** @type {!Array<*>} */ (params[key]) :\n        [params[key]];\n    for (var i = 0; i < values.length; i++) {\n      if (values[i] == null) {\n        continue;\n      }\n      url += separator + encodeURIComponent(key) + '=' +\n          encodeURIComponent(String(values[i]));\n      separator = '&';\n    }\n  }\n  return goog.html.TrustedResourceUrl\n      .createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(url);\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a debug string-representation of this value.\n   *\n   * To obtain the actual string value wrapped in a TrustedResourceUrl, use\n   * `goog.html.TrustedResourceUrl.unwrap`.\n   *\n   * @see goog.html.TrustedResourceUrl#unwrap\n   * @override\n   */\n  goog.html.TrustedResourceUrl.prototype.toString = function() {\n    return 'TrustedResourceUrl{' +\n        this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_ + '}';\n  };\n}\n\n\n/**\n * Performs a runtime check that the provided object is indeed a\n * TrustedResourceUrl object, and returns its value.\n *\n * @param {!goog.html.TrustedResourceUrl} trustedResourceUrl The object to\n *     extract from.\n * @return {string} The trustedResourceUrl object's contained string, unless\n *     the run-time type check fails. In that case, `unwrap` returns an\n *     innocuous string, or, if assertions are enabled, throws\n *     `goog.asserts.AssertionError`.\n */\ngoog.html.TrustedResourceUrl.unwrap = function(trustedResourceUrl) {\n  // Perform additional Run-time type-checking to ensure that\n  // trustedResourceUrl is indeed an instance of the expected type.  This\n  // provides some additional protection against security bugs due to\n  // application code that disables type checks.\n  // Specifically, the following checks are performed:\n  // 1. The object is an instance of the expected type.\n  // 2. The object is not an instance of a subclass.\n  // 3. The object carries a type marker for the expected type. \"Faking\" an\n  // object requires a reference to the type marker, which has names intended\n  // to stand out in code reviews.\n  if (trustedResourceUrl instanceof goog.html.TrustedResourceUrl &&\n      trustedResourceUrl.constructor === goog.html.TrustedResourceUrl &&\n      trustedResourceUrl\n              .TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ ===\n          goog.html.TrustedResourceUrl\n              .TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_) {\n    return trustedResourceUrl\n        .privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_;\n  } else {\n    goog.asserts.fail('expected object of type TrustedResourceUrl, got \\'' +\n        trustedResourceUrl + '\\' of type ' + goog.typeOf(trustedResourceUrl));\n    return 'type_error:TrustedResourceUrl';\n  }\n};\n\n\n/**\n * Creates a TrustedResourceUrl from a format string and arguments.\n *\n * The arguments for interpolation into the format string map labels to values.\n * Values of type `goog.string.Const` are interpolated without modifcation.\n * Values of other types are cast to string and encoded with\n * encodeURIComponent.\n *\n * `%{<label>}` markers are used in the format string to indicate locations\n * to be interpolated with the valued mapped to the given label. `<label>`\n * must contain only alphanumeric and `_` characters.\n *\n * The format string must start with one of the following:\n * - `https://<origin>/`\n * - `//<origin>/`\n * - `/<pathStart>`\n * - `about:blank#`\n *\n * `<origin>` must contain only alphanumeric or any of the following: `-.:[]`.\n * `<pathStart>` is any character except `/` and `\\`.\n *\n * Example usage:\n *\n *    var url = goog.html.TrustedResourceUrl.format(goog.string.Const.from(\n *        'https://www.google.com/search?q=%{query}'), {'query': searchTerm});\n *\n *    var url = goog.html.TrustedResourceUrl.format(goog.string.Const.from(\n *        '//www.youtube.com/v/%{videoId}?hl=en&fs=1%{autoplay}'), {\n *        'videoId': videoId,\n *        'autoplay': opt_autoplay ?\n *            goog.string.Const.from('&autoplay=1') : goog.string.Const.EMPTY\n *    });\n *\n * While this function can be used to create a TrustedResourceUrl from only\n * constants, fromConstant() and fromConstants() are generally preferable for\n * that purpose.\n *\n * @param {!goog.string.Const} format The format string.\n * @param {!Object<string, (string|number|!goog.string.Const)>} args Mapping\n *     of labels to values to be interpolated into the format string.\n *     goog.string.Const values are interpolated without encoding.\n * @return {!goog.html.TrustedResourceUrl}\n * @throws {!Error} On an invalid format string or if a label used in the\n *     the format string is not present in args.\n */\ngoog.html.TrustedResourceUrl.format = function(format, args) {\n  var formatStr = goog.string.Const.unwrap(format);\n  if (!goog.html.TrustedResourceUrl.BASE_URL_.test(formatStr)) {\n    throw new Error('Invalid TrustedResourceUrl format: ' + formatStr);\n  }\n  var result = formatStr.replace(\n      goog.html.TrustedResourceUrl.FORMAT_MARKER_, function(match, id) {\n        if (!Object.prototype.hasOwnProperty.call(args, id)) {\n          throw new Error(\n              'Found marker, \"' + id + '\", in format string, \"' + formatStr +\n              '\", but no valid label mapping found ' +\n              'in args: ' + JSON.stringify(args));\n        }\n        var arg = args[id];\n        if (arg instanceof goog.string.Const) {\n          return goog.string.Const.unwrap(arg);\n        } else {\n          return encodeURIComponent(String(arg));\n        }\n      });\n  return goog.html.TrustedResourceUrl\n      .createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(result);\n};\n\n\n/**\n * @private @const {!RegExp}\n */\ngoog.html.TrustedResourceUrl.FORMAT_MARKER_ = /%{(\\w+)}/g;\n\n\n/**\n * The URL must be absolute, scheme-relative or path-absolute. So it must\n * start with:\n * - https:// followed by allowed origin characters.\n * - // followed by allowed origin characters.\n * - / not followed by / or \\. There will only be an absolute path.\n *\n * Based on\n * https://url.spec.whatwg.org/commit-snapshots/56b74ce7cca8883eab62e9a12666e2fac665d03d/#url-parsing\n * an initial / which is not followed by another / or \\ will end up in the \"path\n * state\" and from there it can only go to \"fragment state\" and \"query state\".\n *\n * We don't enforce a well-formed domain name. So '.' or '1.2' are valid.\n * That's ok because the origin comes from a compile-time constant.\n *\n * A regular expression is used instead of goog.uri for several reasons:\n * - Strictness. E.g. we don't want any userinfo component and we don't\n *   want '/./, nor \\' in the first path component.\n * - Small trusted base. goog.uri is generic and might need to change,\n *   reasoning about all the ways it can parse a URL now and in the future\n *   is error-prone.\n * - Code size. We expect many calls to .format(), many of which might\n *   not be using goog.uri.\n * - Simplicity. Using goog.uri would likely not result in simpler nor shorter\n *   code.\n * @private @const {!RegExp}\n */\ngoog.html.TrustedResourceUrl.BASE_URL_ =\n    /^(?:https:)?\\/\\/[0-9a-z.:[\\]-]+\\/|^\\/[^\\/\\\\]|^about:blank#/i;\n\n\n/**\n * Formats the URL same as TrustedResourceUrl.format and then adds extra URL\n * parameters.\n *\n * Example usage:\n *\n *     // Creates '//www.youtube.com/v/abc?autoplay=1' for videoId='abc' and\n *     // opt_autoplay=1. Creates '//www.youtube.com/v/abc' for videoId='abc'\n *     // and opt_autoplay=undefined.\n *     var url = goog.html.TrustedResourceUrl.formatWithParams(\n *         goog.string.Const.from('//www.youtube.com/v/%{videoId}'),\n *         {'videoId': videoId},\n *         {'autoplay': opt_autoplay});\n *\n * @param {!goog.string.Const} format The format string.\n * @param {!Object<string, (string|number|!goog.string.Const)>} args Mapping\n *     of labels to values to be interpolated into the format string.\n *     goog.string.Const values are interpolated without encoding.\n * @param {!Object<string, *>} params Parameters to add to URL. Parameters with\n *     value `null` or `undefined` are skipped. Both keys and values\n *     are encoded. If the value is an array then the same parameter is added\n *     for every element in the array. Note that JavaScript doesn't guarantee\n *     the order of values in an object which might result in non-deterministic\n *     order of the parameters. However, browsers currently preserve the order.\n * @return {!goog.html.TrustedResourceUrl}\n * @throws {!Error} On an invalid format string or if a label used in the\n *     the format string is not present in args.\n */\ngoog.html.TrustedResourceUrl.formatWithParams = function(format, args, params) {\n  var url = goog.html.TrustedResourceUrl.format(format, args);\n  return url.cloneWithParams(params);\n};\n\n\n/**\n * Creates a TrustedResourceUrl object from a compile-time constant string.\n *\n * Compile-time constant strings are inherently program-controlled and hence\n * trusted.\n *\n * @param {!goog.string.Const} url A compile-time-constant string from which to\n *     create a TrustedResourceUrl.\n * @return {!goog.html.TrustedResourceUrl} A TrustedResourceUrl object\n *     initialized to `url`.\n */\ngoog.html.TrustedResourceUrl.fromConstant = function(url) {\n  return goog.html.TrustedResourceUrl\n      .createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(\n          goog.string.Const.unwrap(url));\n};\n\n\n/**\n * Creates a TrustedResourceUrl object from a compile-time constant strings.\n *\n * Compile-time constant strings are inherently program-controlled and hence\n * trusted.\n *\n * @param {!Array<!goog.string.Const>} parts Compile-time-constant strings from\n *     which to create a TrustedResourceUrl.\n * @return {!goog.html.TrustedResourceUrl} A TrustedResourceUrl object\n *     initialized to concatenation of `parts`.\n */\ngoog.html.TrustedResourceUrl.fromConstants = function(parts) {\n  var unwrapped = '';\n  for (var i = 0; i < parts.length; i++) {\n    unwrapped += goog.string.Const.unwrap(parts[i]);\n  }\n  return goog.html.TrustedResourceUrl\n      .createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(unwrapped);\n};\n\n\n/**\n * Type marker for the TrustedResourceUrl type, used to implement additional\n * run-time type checking.\n * @const {!Object}\n * @private\n */\ngoog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ = {};\n\n\n/**\n * Package-internal utility method to create TrustedResourceUrl instances.\n *\n * @param {string} url The string to initialize the TrustedResourceUrl object\n *     with.\n * @return {!goog.html.TrustedResourceUrl} The initialized TrustedResourceUrl\n *     object.\n * @package\n */\ngoog.html.TrustedResourceUrl\n    .createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse = function(url) {\n  var trustedResourceUrl = new goog.html.TrustedResourceUrl();\n  trustedResourceUrl.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_ =\n      url;\n  return trustedResourceUrl;\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utility functions for supporting Bidi issues.\n */\n\n\n/**\n * Namespace for bidi supporting functions.\n */\ngoog.provide('goog.i18n.bidi');\ngoog.provide('goog.i18n.bidi.Dir');\ngoog.provide('goog.i18n.bidi.DirectionalString');\ngoog.provide('goog.i18n.bidi.Format');\n\n\n/**\n * @define {boolean} FORCE_RTL forces the {@link goog.i18n.bidi.IS_RTL} constant\n * to say that the current locale is a RTL locale.  This should only be used\n * if you want to override the default behavior for deciding whether the\n * current locale is RTL or not.\n *\n * {@see goog.i18n.bidi.IS_RTL}\n */\ngoog.define('goog.i18n.bidi.FORCE_RTL', false);\n\n\n/**\n * Constant that defines whether or not the current locale is a RTL locale.\n * If {@link goog.i18n.bidi.FORCE_RTL} is not true, this constant will default\n * to check that {@link goog.LOCALE} is one of a few major RTL locales.\n *\n * <p>This is designed to be a maximally efficient compile-time constant. For\n * example, for the default goog.LOCALE, compiling\n * \"if (goog.i18n.bidi.IS_RTL) alert('rtl') else {}\" should produce no code. It\n * is this design consideration that limits the implementation to only\n * supporting a few major RTL locales, as opposed to the broader repertoire of\n * something like goog.i18n.bidi.isRtlLanguage.\n *\n * <p>Since this constant refers to the directionality of the locale, it is up\n * to the caller to determine if this constant should also be used for the\n * direction of the UI.\n *\n * {@see goog.LOCALE}\n *\n * @type {boolean}\n *\n * TODO(user): write a test that checks that this is a compile-time constant.\n */\ngoog.i18n.bidi.IS_RTL =\n    goog.i18n.bidi.FORCE_RTL ||\n    ((goog.LOCALE.substring(0, 2).toLowerCase() == 'ar' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'fa' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'he' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'iw' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'ps' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'sd' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'ug' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'ur' ||\n      goog.LOCALE.substring(0, 2).toLowerCase() == 'yi') &&\n     (goog.LOCALE.length == 2 || goog.LOCALE.substring(2, 3) == '-' ||\n      goog.LOCALE.substring(2, 3) == '_')) ||\n    (  // Specific to CKB (Central Kurdish)\n        goog.LOCALE.length >= 3 &&\n        goog.LOCALE.substring(0, 3).toLowerCase() == 'ckb' &&\n        (goog.LOCALE.length == 3 || goog.LOCALE.substring(3, 4) == '-' ||\n         goog.LOCALE.substring(3, 4) == '_')) ||\n    (  // Fulbe (aka Fulani, Pular) with Adlam or Arabic script\n        goog.LOCALE.length >= 7 &&\n        goog.LOCALE.substring(0, 2).toLowerCase() == 'ff' &&\n        (goog.LOCALE.substring(2, 3) == '-' ||\n         goog.LOCALE.substring(2, 3) == '_') &&\n        (goog.LOCALE.substring(3, 7).toLowerCase() == 'adlm' ||\n         goog.LOCALE.substring(3, 7).toLowerCase() == 'arab'));\n// TODO(b/77919903): Add additional scripts and languages that are RTL,\n// e.g., mende, samaritan, etc.\n\n\n/**\n * Unicode formatting characters and directionality string constants.\n * @enum {string}\n */\ngoog.i18n.bidi.Format = {\n  /** Unicode \"Left-To-Right Embedding\" (LRE) character. */\n  LRE: '\\u202A',\n  /** Unicode \"Right-To-Left Embedding\" (RLE) character. */\n  RLE: '\\u202B',\n  /** Unicode \"Pop Directional Formatting\" (PDF) character. */\n  PDF: '\\u202C',\n  /** Unicode \"Left-To-Right Mark\" (LRM) character. */\n  LRM: '\\u200E',\n  /** Unicode \"Right-To-Left Mark\" (RLM) character. */\n  RLM: '\\u200F'\n};\n\n\n/**\n * Directionality enum.\n * @enum {number}\n */\ngoog.i18n.bidi.Dir = {\n  /**\n   * Left-to-right.\n   */\n  LTR: 1,\n\n  /**\n   * Right-to-left.\n   */\n  RTL: -1,\n\n  /**\n   * Neither left-to-right nor right-to-left.\n   */\n  NEUTRAL: 0\n};\n\n\n/**\n * 'right' string constant.\n * @type {string}\n */\ngoog.i18n.bidi.RIGHT = 'right';\n\n\n/**\n * 'left' string constant.\n * @type {string}\n */\ngoog.i18n.bidi.LEFT = 'left';\n\n\n/**\n * 'left' if locale is RTL, 'right' if not.\n * @type {string}\n */\ngoog.i18n.bidi.I18N_RIGHT =\n    goog.i18n.bidi.IS_RTL ? goog.i18n.bidi.LEFT : goog.i18n.bidi.RIGHT;\n\n\n/**\n * 'right' if locale is RTL, 'left' if not.\n * @type {string}\n */\ngoog.i18n.bidi.I18N_LEFT =\n    goog.i18n.bidi.IS_RTL ? goog.i18n.bidi.RIGHT : goog.i18n.bidi.LEFT;\n\n\n/**\n * Convert a directionality given in various formats to a goog.i18n.bidi.Dir\n * constant. Useful for interaction with different standards of directionality\n * representation.\n *\n * @param {goog.i18n.bidi.Dir|number|boolean|null} givenDir Directionality given\n *     in one of the following formats:\n *     1. A goog.i18n.bidi.Dir constant.\n *     2. A number (positive = LTR, negative = RTL, 0 = neutral).\n *     3. A boolean (true = RTL, false = LTR).\n *     4. A null for unknown directionality.\n * @param {boolean=} opt_noNeutral Whether a givenDir of zero or\n *     goog.i18n.bidi.Dir.NEUTRAL should be treated as null, i.e. unknown, in\n *     order to preserve legacy behavior.\n * @return {?goog.i18n.bidi.Dir} A goog.i18n.bidi.Dir constant matching the\n *     given directionality. If given null, returns null (i.e. unknown).\n */\ngoog.i18n.bidi.toDir = function(givenDir, opt_noNeutral) {\n  if (typeof givenDir == 'number') {\n    // This includes the non-null goog.i18n.bidi.Dir case.\n    return givenDir > 0 ? goog.i18n.bidi.Dir.LTR : givenDir < 0 ?\n                          goog.i18n.bidi.Dir.RTL :\n                          opt_noNeutral ? null : goog.i18n.bidi.Dir.NEUTRAL;\n  } else if (givenDir == null) {\n    return null;\n  } else {\n    // Must be typeof givenDir == 'boolean'.\n    return givenDir ? goog.i18n.bidi.Dir.RTL : goog.i18n.bidi.Dir.LTR;\n  }\n};\n\n\n/**\n * A practical pattern to identify strong LTR character in the BMP.\n * This pattern is not theoretically correct according to the Unicode\n * standard. It is simplified for performance and small code size.\n * It includes high surrogates in LTR, but not low surrogates or private use.\n * @type {string}\n * @private\n */\ngoog.i18n.bidi.ltrChars_ =\n    'A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02B8\\u0300-\\u0590\\u0900-\\u1FFF' +\n    '\\u200E\\u2C00-\\uD801\\uD804-\\uD839\\uD83C-\\uDBFF' +\n    '\\uF900-\\uFB1C\\uFE00-\\uFE6F\\uFEFD-\\uFFFF';\n\n/**\n * A practical pattern to identify strong RTL character. This pattern is not\n * theoretically correct according to the Unicode standard. It is simplified\n * for performance and small code size.\n * It includes high surrogates for RTL, but not low surrogates or private use.\n * @type {string}\n * @private\n */\ngoog.i18n.bidi.rtlChars_ =\n    '\\u0591-\\u06EF\\u06FA-\\u08FF\\u200F\\uD802-\\uD803\\uD83A-\\uD83B' +\n    '\\uFB1D-\\uFDFF\\uFE70-\\uFEFC';\n/**\n * A practical pattern to identify the high (leading) surrogate for\n * strong RTL character in the Supplementary Multilingual Planes (SMP.)\n * This set of first 16-bit values covers the RTL range for Unicode 11.\n * It is simplified for performance and small code size.\n * Note that this may need to be recomputed with updates to Unicode standard.\n * @type {string}\n * @private\n */\ngoog.i18n.bidi.lowSurrogate_ = '\\uDC00-\\uDFFF';\n\n/**\n * Simplified regular expression for an HTML tag (opening or closing) or an HTML\n * escape. We might want to skip over such expressions when estimating the text\n * directionality.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.htmlSkipReg_ = /<[^>]*>|&[^;]+;/g;\n\n\n/**\n * Returns the input text with spaces instead of HTML tags or HTML escapes, if\n * opt_isStripNeeded is true. Else returns the input as is.\n * Useful for text directionality estimation.\n * Note: the function should not be used in other contexts; it is not 100%\n * correct, but rather a good-enough implementation for directionality\n * estimation purposes.\n * @param {string} str The given string.\n * @param {boolean=} opt_isStripNeeded Whether to perform the stripping.\n *     Default: false (to retain consistency with calling functions).\n * @return {string} The given string cleaned of HTML tags / escapes.\n * @private\n */\ngoog.i18n.bidi.stripHtmlIfNeeded_ = function(str, opt_isStripNeeded) {\n  return opt_isStripNeeded ? str.replace(goog.i18n.bidi.htmlSkipReg_, '') : str;\n};\n\n\n/**\n * Regular expression to check for RTL characters, BMP and high surrogate.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rtlCharReg_ = new RegExp('[' + goog.i18n.bidi.rtlChars_ + ']');\n\n\n/**\n * Regular expression to check for LTR characters.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.ltrCharReg_ = new RegExp('[' + goog.i18n.bidi.ltrChars_ + ']');\n\n\n/**\n * Test whether the given string has any RTL characters in it.\n * @param {string} str The given string that need to be tested.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether the string contains RTL characters.\n */\ngoog.i18n.bidi.hasAnyRtl = function(str, opt_isHtml) {\n  return goog.i18n.bidi.rtlCharReg_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Test whether the given string has any RTL characters in it.\n * @param {string} str The given string that need to be tested.\n * @return {boolean} Whether the string contains RTL characters.\n * @deprecated Use hasAnyRtl.\n */\ngoog.i18n.bidi.hasRtlChar = goog.i18n.bidi.hasAnyRtl;\n\n\n/**\n * Test whether the given string has any LTR characters in it.\n * @param {string} str The given string that need to be tested.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether the string contains LTR characters.\n */\ngoog.i18n.bidi.hasAnyLtr = function(str, opt_isHtml) {\n  return goog.i18n.bidi.ltrCharReg_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Regular expression pattern to check if the first character in the string\n * is LTR.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.ltrRe_ = new RegExp('^[' + goog.i18n.bidi.ltrChars_ + ']');\n\n\n/**\n * Regular expression pattern to check if the first character in the string\n * is RTL.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rtlRe_ = new RegExp('^[' + goog.i18n.bidi.rtlChars_ + ']');\n\n\n/**\n * Check if the first character in the string is RTL or not.\n * @param {string} str The given string that need to be tested.\n * @return {boolean} Whether the first character in str is an RTL char.\n */\ngoog.i18n.bidi.isRtlChar = function(str) {\n  return goog.i18n.bidi.rtlRe_.test(str);\n};\n\n\n/**\n * Check if the first character in the string is LTR or not.\n * @param {string} str The given string that need to be tested.\n * @return {boolean} Whether the first character in str is an LTR char.\n */\ngoog.i18n.bidi.isLtrChar = function(str) {\n  return goog.i18n.bidi.ltrRe_.test(str);\n};\n\n\n/**\n * Check if the first character in the string is neutral or not.\n * @param {string} str The given string that need to be tested.\n * @return {boolean} Whether the first character in str is a neutral char.\n */\ngoog.i18n.bidi.isNeutralChar = function(str) {\n  return !goog.i18n.bidi.isLtrChar(str) && !goog.i18n.bidi.isRtlChar(str);\n};\n\n\n/**\n * Regular expressions to check if a piece of text is of LTR directionality\n * on first character with strong directionality.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.ltrDirCheckRe_ = new RegExp(\n    '^[^' + goog.i18n.bidi.rtlChars_ + ']*[' + goog.i18n.bidi.ltrChars_ + ']');\n\n\n/**\n * Regular expressions to check if a piece of text is of RTL directionality\n * on first character with strong directionality.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rtlDirCheckRe_ = new RegExp(\n    '^[^' + goog.i18n.bidi.ltrChars_ + ']*[' + goog.i18n.bidi.rtlChars_ + ']');\n\n\n/**\n * Check whether the first strongly directional character (if any) is RTL.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether RTL directionality is detected using the first\n *     strongly-directional character method.\n */\ngoog.i18n.bidi.startsWithRtl = function(str, opt_isHtml) {\n  return goog.i18n.bidi.rtlDirCheckRe_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Check whether the first strongly directional character (if any) is RTL.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether RTL directionality is detected using the first\n *     strongly-directional character method.\n * @deprecated Use startsWithRtl.\n */\ngoog.i18n.bidi.isRtlText = goog.i18n.bidi.startsWithRtl;\n\n\n/**\n * Check whether the first strongly directional character (if any) is LTR.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether LTR directionality is detected using the first\n *     strongly-directional character method.\n */\ngoog.i18n.bidi.startsWithLtr = function(str, opt_isHtml) {\n  return goog.i18n.bidi.ltrDirCheckRe_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Check whether the first strongly directional character (if any) is LTR.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether LTR directionality is detected using the first\n *     strongly-directional character method.\n * @deprecated Use startsWithLtr.\n */\ngoog.i18n.bidi.isLtrText = goog.i18n.bidi.startsWithLtr;\n\n\n/**\n * Regular expression to check if a string looks like something that must\n * always be LTR even in RTL text, e.g. a URL. When estimating the\n * directionality of text containing these, we treat these as weakly LTR,\n * like numbers.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.isRequiredLtrRe_ = /^http:\\/\\/.*/;\n\n\n/**\n * Check whether the input string either contains no strongly directional\n * characters or looks like a url.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether neutral directionality is detected.\n */\ngoog.i18n.bidi.isNeutralText = function(str, opt_isHtml) {\n  str = goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml);\n  return goog.i18n.bidi.isRequiredLtrRe_.test(str) ||\n      !goog.i18n.bidi.hasAnyLtr(str) && !goog.i18n.bidi.hasAnyRtl(str);\n};\n\n\n/**\n * Regular expressions to check if the last strongly-directional character in a\n * piece of text is LTR.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.ltrExitDirCheckRe_ = new RegExp(\n    '[' + goog.i18n.bidi.ltrChars_ + ']' +\n    '(' + goog.i18n.bidi.lowSurrogate_ + ')?' +\n    '[^' + goog.i18n.bidi.rtlChars_ + ']*$');\n\n\n/**\n * Regular expressions to check if the last strongly-directional character in a\n * piece of text is RTL.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rtlExitDirCheckRe_ = new RegExp(\n    '[' + goog.i18n.bidi.rtlChars_ + ']' +\n    '(' + goog.i18n.bidi.lowSurrogate_ + ')?' +\n    '[^' + goog.i18n.bidi.ltrChars_ + ']*$');\n\n\n/**\n * Check if the exit directionality a piece of text is LTR, i.e. if the last\n * strongly-directional character in the string is LTR.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether LTR exit directionality was detected.\n */\ngoog.i18n.bidi.endsWithLtr = function(str, opt_isHtml) {\n  return goog.i18n.bidi.ltrExitDirCheckRe_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Check if the exit directionality a piece of text is LTR, i.e. if the last\n * strongly-directional character in the string is LTR.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether LTR exit directionality was detected.\n * @deprecated Use endsWithLtr.\n */\ngoog.i18n.bidi.isLtrExitText = goog.i18n.bidi.endsWithLtr;\n\n\n/**\n * Check if the exit directionality a piece of text is RTL, i.e. if the last\n * strongly-directional character in the string is RTL.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether RTL exit directionality was detected.\n */\ngoog.i18n.bidi.endsWithRtl = function(str, opt_isHtml) {\n  return goog.i18n.bidi.rtlExitDirCheckRe_.test(\n      goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml));\n};\n\n\n/**\n * Check if the exit directionality a piece of text is RTL, i.e. if the last\n * strongly-directional character in the string is RTL.\n * @param {string} str String being checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether RTL exit directionality was detected.\n * @deprecated Use endsWithRtl.\n */\ngoog.i18n.bidi.isRtlExitText = goog.i18n.bidi.endsWithRtl;\n\n\n/**\n * A regular expression for matching right-to-left language codes.\n * See {@link #isRtlLanguage} for the design.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rtlLocalesRe_ = new RegExp(\n    '^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|' +\n        '.*[-_](Adlm|Arab|Hebr|Thaa|Nkoo|Tfng))' +\n        '(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)',\n    'i');\n\n\n/**\n * Check if a BCP 47 / III language code indicates an RTL language, i.e. either:\n * - a language code explicitly specifying one of the right-to-left scripts,\n *   e.g. \"az-Arab\", or<p>\n * - a language code specifying one of the languages normally written in a\n *   right-to-left script, e.g. \"fa\" (Farsi), except ones explicitly specifying\n *   Latin or Cyrillic script (which are the usual LTR alternatives).<p>\n * The list of right-to-left scripts appears in the 100-199 range in\n * http://www.unicode.org/iso15924/iso15924-num.html, of which Arabic and\n * Hebrew are by far the most widely used. We also recognize Thaana, N'Ko, and\n * Tifinagh, which also have significant modern usage. The rest (Syriac,\n * Samaritan, Mandaic, etc.) seem to have extremely limited or no modern usage\n * and are not recognized to save on code size.\n * The languages usually written in a right-to-left script are taken as those\n * with Suppress-Script: Hebr|Arab|Thaa|Nkoo|Tfng  in\n * http://www.iana.org/assignments/language-subtag-registry,\n * as well as Central (or Sorani) Kurdish (ckb), Sindhi (sd) and Uyghur (ug).\n * Other subtags of the language code, e.g. regions like EG (Egypt), are\n * ignored.\n * @param {string} lang BCP 47 (a.k.a III) language code.\n * @return {boolean} Whether the language code is an RTL language.\n */\ngoog.i18n.bidi.isRtlLanguage = function(lang) {\n  return goog.i18n.bidi.rtlLocalesRe_.test(lang);\n};\n\n\n/**\n * Regular expression for bracket guard replacement in text.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.bracketGuardTextRe_ =\n    /(\\(.*?\\)+)|(\\[.*?\\]+)|(\\{.*?\\}+)|(<.*?>+)/g;\n\n\n/**\n * Apply bracket guard using LRM and RLM. This is to address the problem of\n * messy bracket display frequently happens in RTL layout.\n * This function works for plain text, not for HTML. In HTML, the opening\n * bracket might be in a different context than the closing bracket (such as\n * an attribute value).\n * @param {string} s The string that need to be processed.\n * @param {boolean=} opt_isRtlContext specifies default direction (usually\n *     direction of the UI).\n * @return {string} The processed string, with all bracket guarded.\n */\ngoog.i18n.bidi.guardBracketInText = function(s, opt_isRtlContext) {\n  var useRtl = opt_isRtlContext === undefined ? goog.i18n.bidi.hasAnyRtl(s) :\n                                                opt_isRtlContext;\n  var mark = useRtl ? goog.i18n.bidi.Format.RLM : goog.i18n.bidi.Format.LRM;\n  return s.replace(goog.i18n.bidi.bracketGuardTextRe_, mark + '$&' + mark);\n};\n\n\n/**\n * Enforce the html snippet in RTL directionality regardless of overall context.\n * If the html piece was enclosed by tag, dir will be applied to existing\n * tag, otherwise a span tag will be added as wrapper. For this reason, if\n * html snippet starts with a tag, this tag must enclose the whole piece. If\n * the tag already has a dir specified, this new one will override existing\n * one in behavior (tested on FF and IE).\n * @param {string} html The string that need to be processed.\n * @return {string} The processed string, with directionality enforced to RTL.\n */\ngoog.i18n.bidi.enforceRtlInHtml = function(html) {\n  if (html.charAt(0) == '<') {\n    return html.replace(/<\\w+/, '$& dir=rtl');\n  }\n  // '\\n' is important for FF so that it won't incorrectly merge span groups\n  return '\\n<span dir=rtl>' + html + '</span>';\n};\n\n\n/**\n * Enforce RTL on both end of the given text piece using unicode BiDi formatting\n * characters RLE and PDF.\n * @param {string} text The piece of text that need to be wrapped.\n * @return {string} The wrapped string after process.\n */\ngoog.i18n.bidi.enforceRtlInText = function(text) {\n  return goog.i18n.bidi.Format.RLE + text + goog.i18n.bidi.Format.PDF;\n};\n\n\n/**\n * Enforce the html snippet in RTL directionality regardless or overall context.\n * If the html piece was enclosed by tag, dir will be applied to existing\n * tag, otherwise a span tag will be added as wrapper. For this reason, if\n * html snippet starts with a tag, this tag must enclose the whole piece. If\n * the tag already has a dir specified, this new one will override existing\n * one in behavior (tested on FF and IE).\n * @param {string} html The string that need to be processed.\n * @return {string} The processed string, with directionality enforced to RTL.\n */\ngoog.i18n.bidi.enforceLtrInHtml = function(html) {\n  if (html.charAt(0) == '<') {\n    return html.replace(/<\\w+/, '$& dir=ltr');\n  }\n  // '\\n' is important for FF so that it won't incorrectly merge span groups\n  return '\\n<span dir=ltr>' + html + '</span>';\n};\n\n\n/**\n * Enforce LTR on both end of the given text piece using unicode BiDi formatting\n * characters LRE and PDF.\n * @param {string} text The piece of text that need to be wrapped.\n * @return {string} The wrapped string after process.\n */\ngoog.i18n.bidi.enforceLtrInText = function(text) {\n  return goog.i18n.bidi.Format.LRE + text + goog.i18n.bidi.Format.PDF;\n};\n\n\n/**\n * Regular expression to find dimensions such as \"padding: .3 0.4ex 5px 6;\"\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.dimensionsRe_ =\n    /:\\s*([.\\d][.\\w]*)\\s+([.\\d][.\\w]*)\\s+([.\\d][.\\w]*)\\s+([.\\d][.\\w]*)/g;\n\n\n/**\n * Regular expression for left.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.leftRe_ = /left/gi;\n\n\n/**\n * Regular expression for right.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.rightRe_ = /right/gi;\n\n\n/**\n * Placeholder regular expression for swapping.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.tempRe_ = /%%%%/g;\n\n\n/**\n * Swap location parameters and 'left'/'right' in CSS specification. The\n * processed string will be suited for RTL layout. Though this function can\n * cover most cases, there are always exceptions. It is suggested to put\n * those exceptions in separate group of CSS string.\n * @param {string} cssStr CSS spefication string.\n * @return {string} Processed CSS specification string.\n */\ngoog.i18n.bidi.mirrorCSS = function(cssStr) {\n  return cssStr\n      .\n      // reverse dimensions\n      replace(goog.i18n.bidi.dimensionsRe_, ':$1 $4 $3 $2')\n      .replace(goog.i18n.bidi.leftRe_, '%%%%')\n      .  // swap left and right\n      replace(goog.i18n.bidi.rightRe_, goog.i18n.bidi.LEFT)\n      .replace(goog.i18n.bidi.tempRe_, goog.i18n.bidi.RIGHT);\n};\n\n\n/**\n * Regular expression for hebrew double quote substitution, finding quote\n * directly after hebrew characters.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.doubleQuoteSubstituteRe_ = /([\\u0591-\\u05f2])\"/g;\n\n\n/**\n * Regular expression for hebrew single quote substitution, finding quote\n * directly after hebrew characters.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.singleQuoteSubstituteRe_ = /([\\u0591-\\u05f2])'/g;\n\n\n/**\n * Replace the double and single quote directly after a Hebrew character with\n * GERESH and GERSHAYIM. In such case, most likely that's user intention.\n * @param {string} str String that need to be processed.\n * @return {string} Processed string with double/single quote replaced.\n */\ngoog.i18n.bidi.normalizeHebrewQuote = function(str) {\n  return str.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_, '$1\\u05f4')\n      .replace(goog.i18n.bidi.singleQuoteSubstituteRe_, '$1\\u05f3');\n};\n\n\n/**\n * Regular expression to split a string into \"words\" for directionality\n * estimation based on relative word counts.\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.wordSeparatorRe_ = /\\s+/;\n\n\n/**\n * Regular expression to check if a string contains any numerals. Used to\n * differentiate between completely neutral strings and those containing\n * numbers, which are weakly LTR.\n *\n * Native Arabic digits (\\u0660 - \\u0669) are not included because although they\n * do flow left-to-right inside a number, this is the case even if the  overall\n * directionality is RTL, and a mathematical expression using these digits is\n * supposed to flow right-to-left overall, including unary plus and minus\n * appearing to the right of a number, and this does depend on the overall\n * directionality being RTL. The digits used in Farsi (\\u06F0 - \\u06F9), on the\n * other hand, are included, since Farsi math (including unary plus and minus)\n * does flow left-to-right.\n * TODO: Consider other systems of digits, e.g., Adlam.\n *\n * @type {RegExp}\n * @private\n */\ngoog.i18n.bidi.hasNumeralsRe_ = /[\\d\\u06f0-\\u06f9]/;\n\n\n/**\n * This constant controls threshold of RTL directionality.\n * @type {number}\n * @private\n */\ngoog.i18n.bidi.rtlDetectionThreshold_ = 0.40;\n\n\n/**\n * Estimates the directionality of a string based on relative word counts.\n * If the number of RTL words is above a certain percentage of the total number\n * of strongly directional words, returns RTL.\n * Otherwise, if any words are strongly or weakly LTR, returns LTR.\n * Otherwise, returns UNKNOWN, which is used to mean \"neutral\".\n * Numbers are counted as weakly LTR.\n * @param {string} str The string to be checked.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {goog.i18n.bidi.Dir} Estimated overall directionality of `str`.\n */\ngoog.i18n.bidi.estimateDirection = function(str, opt_isHtml) {\n  var rtlCount = 0;\n  var totalCount = 0;\n  var hasWeaklyLtr = false;\n  var tokens = goog.i18n.bidi.stripHtmlIfNeeded_(str, opt_isHtml)\n                   .split(goog.i18n.bidi.wordSeparatorRe_);\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n    if (goog.i18n.bidi.startsWithRtl(token)) {\n      rtlCount++;\n      totalCount++;\n    } else if (goog.i18n.bidi.isRequiredLtrRe_.test(token)) {\n      hasWeaklyLtr = true;\n    } else if (goog.i18n.bidi.hasAnyLtr(token)) {\n      totalCount++;\n    } else if (goog.i18n.bidi.hasNumeralsRe_.test(token)) {\n      hasWeaklyLtr = true;\n    }\n  }\n\n  return totalCount == 0 ?\n      (hasWeaklyLtr ? goog.i18n.bidi.Dir.LTR : goog.i18n.bidi.Dir.NEUTRAL) :\n      (rtlCount / totalCount > goog.i18n.bidi.rtlDetectionThreshold_ ?\n           goog.i18n.bidi.Dir.RTL :\n           goog.i18n.bidi.Dir.LTR);\n};\n\n\n/**\n * Check the directionality of a piece of text, return true if the piece of\n * text should be laid out in RTL direction.\n * @param {string} str The piece of text that need to be detected.\n * @param {boolean=} opt_isHtml Whether str is HTML / HTML-escaped.\n *     Default: false.\n * @return {boolean} Whether this piece of text should be laid out in RTL.\n */\ngoog.i18n.bidi.detectRtlDirectionality = function(str, opt_isHtml) {\n  return goog.i18n.bidi.estimateDirection(str, opt_isHtml) ==\n      goog.i18n.bidi.Dir.RTL;\n};\n\n\n/**\n * Sets text input element's directionality and text alignment based on a\n * given directionality. Does nothing if the given directionality is unknown or\n * neutral.\n * @param {Element} element Input field element to set directionality to.\n * @param {goog.i18n.bidi.Dir|number|boolean|null} dir Desired directionality,\n *     given in one of the following formats:\n *     1. A goog.i18n.bidi.Dir constant.\n *     2. A number (positive = LRT, negative = RTL, 0 = neutral).\n *     3. A boolean (true = RTL, false = LTR).\n *     4. A null for unknown directionality.\n */\ngoog.i18n.bidi.setElementDirAndAlign = function(element, dir) {\n  if (element) {\n    var htmlElement = /** @type {!HTMLElement} */ (element);\n    dir = goog.i18n.bidi.toDir(dir);\n    if (dir) {\n      htmlElement.style.textAlign = dir == goog.i18n.bidi.Dir.RTL ?\n          goog.i18n.bidi.RIGHT :\n          goog.i18n.bidi.LEFT;\n      htmlElement.dir = dir == goog.i18n.bidi.Dir.RTL ? 'rtl' : 'ltr';\n    }\n  }\n};\n\n\n/**\n * Sets element dir based on estimated directionality of the given text.\n * @param {!Element} element\n * @param {string} text\n */\ngoog.i18n.bidi.setElementDirByTextDirectionality = function(element, text) {\n  var htmlElement = /** @type {!HTMLElement} */ (element);\n  switch (goog.i18n.bidi.estimateDirection(text)) {\n    case (goog.i18n.bidi.Dir.LTR):\n      htmlElement.dir = 'ltr';\n      break;\n    case (goog.i18n.bidi.Dir.RTL):\n      htmlElement.dir = 'rtl';\n      break;\n    default:\n      // Default for no direction, inherit from document.\n      htmlElement.removeAttribute('dir');\n  }\n};\n\n\n\n/**\n * Strings that have an (optional) known direction.\n *\n * Implementations of this interface are string-like objects that carry an\n * attached direction, if known.\n * @interface\n */\ngoog.i18n.bidi.DirectionalString = function() {};\n\n\n/**\n * Interface marker of the DirectionalString interface.\n *\n * This property can be used to determine at runtime whether or not an object\n * implements this interface.  All implementations of this interface set this\n * property to `true`.\n * @type {boolean}\n */\ngoog.i18n.bidi.DirectionalString.prototype\n    .implementsGoogI18nBidiDirectionalString;\n\n\n/**\n * Retrieves this object's known direction (if any).\n * @return {?goog.i18n.bidi.Dir} The known direction. Null if unknown.\n */\ngoog.i18n.bidi.DirectionalString.prototype.getDirection;\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview The SafeUrl type and its builders.\n *\n * TODO(xtof): Link to document stating type contract.\n */\n\ngoog.provide('goog.html.SafeUrl');\n\ngoog.require('goog.asserts');\ngoog.require('goog.fs.url');\ngoog.require('goog.html.TrustedResourceUrl');\ngoog.require('goog.i18n.bidi.Dir');\ngoog.require('goog.i18n.bidi.DirectionalString');\ngoog.require('goog.string');\ngoog.require('goog.string.Const');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * A string that is safe to use in URL context in DOM APIs and HTML documents.\n *\n * A SafeUrl is a string-like object that carries the security type contract\n * that its value as a string will not cause untrusted script execution\n * when evaluated as a hyperlink URL in a browser.\n *\n * Values of this type are guaranteed to be safe to use in URL/hyperlink\n * contexts, such as assignment to URL-valued DOM properties, in the sense that\n * the use will not result in a Cross-Site-Scripting vulnerability. Similarly,\n * SafeUrls can be interpolated into the URL context of an HTML template (e.g.,\n * inside a href attribute). However, appropriate HTML-escaping must still be\n * applied.\n *\n * Note that, as documented in `goog.html.SafeUrl.unwrap`, this type's\n * contract does not guarantee that instances are safe to interpolate into HTML\n * without appropriate escaping.\n *\n * Note also that this type's contract does not imply any guarantees regarding\n * the resource the URL refers to.  In particular, SafeUrls are <b>not</b>\n * safe to use in a context where the referred-to resource is interpreted as\n * trusted code, e.g., as the src of a script tag.\n *\n * Instances of this type must be created via the factory methods\n * (`goog.html.SafeUrl.fromConstant`, `goog.html.SafeUrl.sanitize`),\n * etc and not by invoking its constructor.  The constructor intentionally\n * takes no parameters and the type is immutable; hence only a default instance\n * corresponding to the empty string can be obtained via constructor invocation.\n *\n * @see goog.html.SafeUrl#fromConstant\n * @see goog.html.SafeUrl#from\n * @see goog.html.SafeUrl#sanitize\n * @constructor\n * @final\n * @struct\n * @implements {goog.i18n.bidi.DirectionalString}\n * @implements {goog.string.TypedString}\n */\ngoog.html.SafeUrl = function() {\n  /**\n   * The contained value of this SafeUrl.  The field has a purposely ugly\n   * name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.privateDoNotAccessOrElseSafeHtmlWrappedValue_ = '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.html.SafeUrl#unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ =\n      goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;\n};\n\n\n/**\n * The innocuous string generated by goog.html.SafeUrl.sanitize when passed\n * an unsafe URL.\n *\n * about:invalid is registered in\n * http://www.w3.org/TR/css3-values/#about-invalid.\n * http://tools.ietf.org/html/rfc6694#section-2.2.1 permits about URLs to\n * contain a fragment, which is not to be considered when determining if an\n * about URL is well-known.\n *\n * Using about:invalid seems preferable to using a fixed data URL, since\n * browsers might choose to not report CSP violations on it, as legitimate\n * CSS function calls to attr() can result in this URL being produced. It is\n * also a standard URL which matches exactly the semantics we need:\n * \"The about:invalid URI references a non-existent document with a generic\n * error condition. It can be used when a URI is necessary, but the default\n * value shouldn't be resolveable as any type of document\".\n *\n * @const {string}\n */\ngoog.html.SafeUrl.INNOCUOUS_STRING = 'about:invalid#zClosurez';\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeUrl.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Returns this SafeUrl's value a string.\n *\n * IMPORTANT: In code where it is security relevant that an object's type is\n * indeed `SafeUrl`, use `goog.html.SafeUrl.unwrap` instead of this\n * method. If in doubt, assume that it's security relevant. In particular, note\n * that goog.html functions which return a goog.html type do not guarantee that\n * the returned instance is of the right type. For example:\n *\n * <pre>\n * var fakeSafeHtml = new String('fake');\n * fakeSafeHtml.__proto__ = goog.html.SafeHtml.prototype;\n * var newSafeHtml = goog.html.SafeHtml.htmlEscape(fakeSafeHtml);\n * // newSafeHtml is just an alias for fakeSafeHtml, it's passed through by\n * // goog.html.SafeHtml.htmlEscape() as fakeSafeHtml instanceof\n * // goog.html.SafeHtml.\n * </pre>\n *\n * IMPORTANT: The guarantees of the SafeUrl type contract only extend to the\n * behavior of browsers when interpreting URLs. Values of SafeUrl objects MUST\n * be appropriately escaped before embedding in a HTML document. Note that the\n * required escaping is context-sensitive (e.g. a different escaping is\n * required for embedding a URL in a style property within a style\n * attribute, as opposed to embedding in a href attribute).\n *\n * @see goog.html.SafeUrl#unwrap\n * @override\n */\ngoog.html.SafeUrl.prototype.getTypedStringValue = function() {\n  return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeUrl.prototype.implementsGoogI18nBidiDirectionalString = true;\n\n\n/**\n * Returns this URLs directionality, which is always `LTR`.\n * @override\n */\ngoog.html.SafeUrl.prototype.getDirection = function() {\n  return goog.i18n.bidi.Dir.LTR;\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a debug string-representation of this value.\n   *\n   * To obtain the actual string value wrapped in a SafeUrl, use\n   * `goog.html.SafeUrl.unwrap`.\n   *\n   * @see goog.html.SafeUrl#unwrap\n   * @override\n   */\n  goog.html.SafeUrl.prototype.toString = function() {\n    return 'SafeUrl{' + this.privateDoNotAccessOrElseSafeHtmlWrappedValue_ +\n        '}';\n  };\n}\n\n\n/**\n * Performs a runtime check that the provided object is indeed a SafeUrl\n * object, and returns its value.\n *\n * IMPORTANT: The guarantees of the SafeUrl type contract only extend to the\n * behavior of  browsers when interpreting URLs. Values of SafeUrl objects MUST\n * be appropriately escaped before embedding in a HTML document. Note that the\n * required escaping is context-sensitive (e.g. a different escaping is\n * required for embedding a URL in a style property within a style\n * attribute, as opposed to embedding in a href attribute).\n *\n * @param {!goog.html.SafeUrl} safeUrl The object to extract from.\n * @return {string} The SafeUrl object's contained string, unless the run-time\n *     type check fails. In that case, `unwrap` returns an innocuous\n *     string, or, if assertions are enabled, throws\n *     `goog.asserts.AssertionError`.\n */\ngoog.html.SafeUrl.unwrap = function(safeUrl) {\n  // Perform additional Run-time type-checking to ensure that safeUrl is indeed\n  // an instance of the expected type.  This provides some additional protection\n  // against security bugs due to application code that disables type checks.\n  // Specifically, the following checks are performed:\n  // 1. The object is an instance of the expected type.\n  // 2. The object is not an instance of a subclass.\n  // 3. The object carries a type marker for the expected type. \"Faking\" an\n  // object requires a reference to the type marker, which has names intended\n  // to stand out in code reviews.\n  if (safeUrl instanceof goog.html.SafeUrl &&\n      safeUrl.constructor === goog.html.SafeUrl &&\n      safeUrl.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ ===\n          goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_) {\n    return safeUrl.privateDoNotAccessOrElseSafeHtmlWrappedValue_;\n  } else {\n    goog.asserts.fail('expected object of type SafeUrl, got \\'' +\n        safeUrl + '\\' of type ' + goog.typeOf(safeUrl));\n    return 'type_error:SafeUrl';\n  }\n};\n\n\n/**\n * Creates a SafeUrl object from a compile-time constant string.\n *\n * Compile-time constant strings are inherently program-controlled and hence\n * trusted.\n *\n * @param {!goog.string.Const} url A compile-time-constant string from which to\n *         create a SafeUrl.\n * @return {!goog.html.SafeUrl} A SafeUrl object initialized to `url`.\n */\ngoog.html.SafeUrl.fromConstant = function(url) {\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(\n      goog.string.Const.unwrap(url));\n};\n\n\n/**\n * A pattern that matches Blob or data types that can have SafeUrls created\n * from URL.createObjectURL(blob) or via a data: URI.\n * @const\n * @private\n */\ngoog.html.SAFE_MIME_TYPE_PATTERN_ = new RegExp(\n    // Note: Due to content-sniffing concerns, only add MIME types for\n    // media formats.\n    '^(?:audio/(?:3gpp2|3gpp|aac|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-wav|wav|webm)|' +\n        'image/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|' +\n        // TODO(b/68188949): Due to content-sniffing concerns, text/csv should\n        // be removed from the whitelist.\n        'text/csv|' +\n        'video/(?:mpeg|mp4|ogg|webm|quicktime))$',\n    'i');\n\n\n/**\n * Creates a SafeUrl wrapping a blob URL for the given `blob`.\n *\n * The blob URL is created with `URL.createObjectURL`. If the MIME type\n * for `blob` is not of a known safe audio, image or video MIME type,\n * then the SafeUrl will wrap {@link #INNOCUOUS_STRING}.\n *\n * @see http://www.w3.org/TR/FileAPI/#url\n * @param {!Blob} blob\n * @return {!goog.html.SafeUrl} The blob URL, or an innocuous string wrapped\n *   as a SafeUrl.\n */\ngoog.html.SafeUrl.fromBlob = function(blob) {\n  var url = goog.html.SAFE_MIME_TYPE_PATTERN_.test(blob.type) ?\n      goog.fs.url.createObjectUrl(blob) :\n      goog.html.SafeUrl.INNOCUOUS_STRING;\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url);\n};\n\n\n/**\n * Matches a base-64 data URL, with the first match group being the MIME type.\n * @const\n * @private\n */\ngoog.html.DATA_URL_PATTERN_ = /^data:([^;,]*);base64,[a-z0-9+\\/]+=*$/i;\n\n\n/**\n * Creates a SafeUrl wrapping a data: URL, after validating it matches a\n * known-safe audio, image or video MIME type.\n *\n * @param {string} dataUrl A valid base64 data URL with one of the whitelisted\n *     audio, image or video MIME types.\n * @return {!goog.html.SafeUrl} A matching safe URL, or {@link INNOCUOUS_STRING}\n *     wrapped as a SafeUrl if it does not pass.\n */\ngoog.html.SafeUrl.fromDataUrl = function(dataUrl) {\n  // RFC4648 suggest to ignore CRLF in base64 encoding.\n  // See https://tools.ietf.org/html/rfc4648.\n  // Remove the CR (%0D) and LF (%0A) from the dataUrl.\n  var filteredDataUrl = dataUrl.replace(/(%0A|%0D)/g, '');\n  // There's a slight risk here that a browser sniffs the content type if it\n  // doesn't know the MIME type and executes HTML within the data: URL. For this\n  // to cause XSS it would also have to execute the HTML in the same origin\n  // of the page with the link. It seems unlikely that both of these will\n  // happen, particularly in not really old IEs.\n  var match = filteredDataUrl.match(goog.html.DATA_URL_PATTERN_);\n  var valid = match && goog.html.SAFE_MIME_TYPE_PATTERN_.test(match[1]);\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(\n      valid ? filteredDataUrl : goog.html.SafeUrl.INNOCUOUS_STRING);\n};\n\n\n/**\n * Creates a SafeUrl wrapping a tel: URL.\n *\n * @param {string} telUrl A tel URL.\n * @return {!goog.html.SafeUrl} A matching safe URL, or {@link INNOCUOUS_STRING}\n *     wrapped as a SafeUrl if it does not pass.\n */\ngoog.html.SafeUrl.fromTelUrl = function(telUrl) {\n  // There's a risk that a tel: URL could immediately place a call once\n  // clicked, without requiring user confirmation. For that reason it is\n  // handled in this separate function.\n  if (!goog.string.caseInsensitiveStartsWith(telUrl, 'tel:')) {\n    telUrl = goog.html.SafeUrl.INNOCUOUS_STRING;\n  }\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(\n      telUrl);\n};\n\n\n/**\n * Matches a sip/sips URL. We only allow urls that consist of an email address.\n * The characters '?' and '#' are not allowed in the local part of the email\n * address.\n * @const\n * @private\n */\ngoog.html.SIP_URL_PATTERN_ = new RegExp(\n    '^sip[s]?:[+a-z0-9_.!$%&\\'*\\\\/=^`{|}~-]+@([a-z0-9-]+\\\\.)+[a-z0-9]{2,63}$',\n    'i');\n\n\n/**\n * Creates a SafeUrl wrapping a sip: URL. We only allow urls that consist of an\n * email address. The characters '?' and '#' are not allowed in the local part\n * of the email address.\n *\n * @param {string} sipUrl A sip URL.\n * @return {!goog.html.SafeUrl} A matching safe URL, or {@link INNOCUOUS_STRING}\n *     wrapped as a SafeUrl if it does not pass.\n */\ngoog.html.SafeUrl.fromSipUrl = function(sipUrl) {\n  if (!goog.html.SIP_URL_PATTERN_.test(decodeURIComponent(sipUrl))) {\n    sipUrl = goog.html.SafeUrl.INNOCUOUS_STRING;\n  }\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(\n      sipUrl);\n};\n\n\n/**\n * Creates a SafeUrl wrapping a sms: URL.\n *\n * @param {string} smsUrl A sms URL.\n * @return {!goog.html.SafeUrl} A matching safe URL, or {@link INNOCUOUS_STRING}\n *     wrapped as a SafeUrl if it does not pass.\n */\ngoog.html.SafeUrl.fromSmsUrl = function(smsUrl) {\n  if (!goog.string.caseInsensitiveStartsWith(smsUrl, 'sms:') ||\n      !goog.html.SafeUrl.isSmsUrlBodyValid_(smsUrl)) {\n    smsUrl = goog.html.SafeUrl.INNOCUOUS_STRING;\n  }\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(\n      smsUrl);\n};\n\n\n/**\n * Validates SMS URL `body` parameter, which is optional and should appear at\n * most once and should be percent-encoded if present. Rejects many malformed\n * bodies, but may spuriously reject some URLs and does not reject all malformed\n * sms: URLs.\n *\n * @param {string} smsUrl A sms URL.\n * @return {boolean} Whether SMS URL has a valid `body` parameter if it exists.\n * @private\n */\ngoog.html.SafeUrl.isSmsUrlBodyValid_ = function(smsUrl) {\n  var hash = smsUrl.indexOf('#');\n  if (hash > 0) {\n    smsUrl = smsUrl.substring(0, hash);\n  }\n  var bodyParams = smsUrl.match(/[?&]body=/gi);\n  // \"body\" param is optional\n  if (!bodyParams) {\n    return true;\n  }\n  // \"body\" MUST only appear once\n  if (bodyParams.length > 1) {\n    return false;\n  }\n  // Get the encoded `body` parameter value.\n  var bodyValue = smsUrl.match(/[?&]body=([^&]*)/)[1];\n  if (!bodyValue) {\n    return true;\n  }\n  try {\n    decodeURIComponent(bodyValue);\n  } catch (error) {\n    return false;\n  }\n  return /^(?:[a-z0-9\\-_.~]|%[0-9a-f]{2})+$/i.test(bodyValue);\n};\n\n\n/**\n * Creates a SafeUrl from TrustedResourceUrl. This is safe because\n * TrustedResourceUrl is more tightly restricted than SafeUrl.\n *\n * @param {!goog.html.TrustedResourceUrl} trustedResourceUrl\n * @return {!goog.html.SafeUrl}\n */\ngoog.html.SafeUrl.fromTrustedResourceUrl = function(trustedResourceUrl) {\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(\n      goog.html.TrustedResourceUrl.unwrap(trustedResourceUrl));\n};\n\n\n/**\n * A pattern that recognizes a commonly useful subset of URLs that satisfy\n * the SafeUrl contract.\n *\n * This regular expression matches a subset of URLs that will not cause script\n * execution if used in URL context within a HTML document. Specifically, this\n * regular expression matches if (comment from here on and regex copied from\n * Soy's EscapingConventions):\n * (1) Either a protocol in a whitelist (http, https, mailto or ftp).\n * (2) or no protocol.  A protocol must be followed by a colon. The below\n *     allows that by allowing colons only after one of the characters [/?#].\n *     A colon after a hash (#) must be in the fragment.\n *     Otherwise, a colon after a (?) must be in a query.\n *     Otherwise, a colon after a single solidus (/) must be in a path.\n *     Otherwise, a colon after a double solidus (//) must be in the authority\n *     (before port).\n *\n * @private\n * @const {!RegExp}\n */\ngoog.html.SAFE_URL_PATTERN_ =\n    /^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;\n\n/**\n * Public version of goog.html.SAFE_URL_PATTERN_. Updating\n * goog.html.SAFE_URL_PATTERN_ doesn't seem to be backward compatible.\n * Namespace is also changed to goog.html.SafeUrl so it can be imported using\n * goog.require('goog.dom.SafeUrl').\n *\n * TODO(bangert): Remove SAFE_URL_PATTERN_\n * @const {!RegExp}\n */\ngoog.html.SafeUrl.SAFE_URL_PATTERN = goog.html.SAFE_URL_PATTERN_;\n\n\n/**\n * Creates a SafeUrl object from `url`. If `url` is a\n * goog.html.SafeUrl then it is simply returned. Otherwise the input string is\n * validated to match a pattern of commonly used safe URLs.\n *\n * `url` may be a URL with the http, https, mailto or ftp scheme,\n * or a relative URL (i.e., a URL without a scheme; specifically, a\n * scheme-relative, absolute-path-relative, or path-relative URL).\n *\n * @see http://url.spec.whatwg.org/#concept-relative-url\n * @param {string|!goog.string.TypedString} url The URL to validate.\n * @return {!goog.html.SafeUrl} The validated URL, wrapped as a SafeUrl.\n */\ngoog.html.SafeUrl.sanitize = function(url) {\n  if (url instanceof goog.html.SafeUrl) {\n    return url;\n  } else if (typeof url == 'object' && url.implementsGoogStringTypedString) {\n    url = /** @type {!goog.string.TypedString} */ (url).getTypedStringValue();\n  } else {\n    url = String(url);\n  }\n  if (!goog.html.SAFE_URL_PATTERN_.test(url)) {\n    url = goog.html.SafeUrl.INNOCUOUS_STRING;\n  }\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url);\n};\n\n/**\n * Creates a SafeUrl object from `url`. If `url` is a\n * goog.html.SafeUrl then it is simply returned. Otherwise the input string is\n * validated to match a pattern of commonly used safe URLs.\n *\n * `url` may be a URL with the http, https, mailto or ftp scheme,\n * or a relative URL (i.e., a URL without a scheme; specifically, a\n * scheme-relative, absolute-path-relative, or path-relative URL).\n *\n * This function asserts (using goog.asserts) that the URL matches this pattern.\n * If it does not, in addition to failing the assert, an innocous URL will be\n * returned.\n *\n * @see http://url.spec.whatwg.org/#concept-relative-url\n * @param {string|!goog.string.TypedString} url The URL to validate.\n * @return {!goog.html.SafeUrl} The validated URL, wrapped as a SafeUrl.\n */\ngoog.html.SafeUrl.sanitizeAssertUnchanged = function(url) {\n  if (url instanceof goog.html.SafeUrl) {\n    return url;\n  } else if (typeof url == 'object' && url.implementsGoogStringTypedString) {\n    url = /** @type {!goog.string.TypedString} */ (url).getTypedStringValue();\n  } else {\n    url = String(url);\n  }\n  if (!goog.asserts.assert(goog.html.SAFE_URL_PATTERN_.test(url))) {\n    url = goog.html.SafeUrl.INNOCUOUS_STRING;\n  }\n  return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url);\n};\n\n\n\n/**\n * Type marker for the SafeUrl type, used to implement additional run-time\n * type checking.\n * @const {!Object}\n * @private\n */\ngoog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ = {};\n\n\n/**\n * Package-internal utility method to create SafeUrl instances.\n *\n * @param {string} url The string to initialize the SafeUrl object with.\n * @return {!goog.html.SafeUrl} The initialized SafeUrl object.\n * @package\n */\ngoog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse = function(\n    url) {\n  var safeUrl = new goog.html.SafeUrl();\n  safeUrl.privateDoNotAccessOrElseSafeHtmlWrappedValue_ = url;\n  return safeUrl;\n};\n\n\n/**\n * A SafeUrl corresponding to the special about:blank url.\n * @const {!goog.html.SafeUrl}\n */\ngoog.html.SafeUrl.ABOUT_BLANK =\n    goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(\n        'about:blank');\n","// Copyright 2014 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview The SafeStyle type and its builders.\n *\n * TODO(xtof): Link to document stating type contract.\n */\n\ngoog.provide('goog.html.SafeStyle');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.html.SafeUrl');\ngoog.require('goog.string');\ngoog.require('goog.string.Const');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * A string-like object which represents a sequence of CSS declarations\n * ({@code propertyName1: propertyvalue1; propertyName2: propertyValue2; ...})\n * and that carries the security type contract that its value, as a string,\n * will not cause untrusted script execution (XSS) when evaluated as CSS in a\n * browser.\n *\n * Instances of this type must be created via the factory methods\n * (`goog.html.SafeStyle.create` or\n * `goog.html.SafeStyle.fromConstant`) and not by invoking its\n * constructor. The constructor intentionally takes no parameters and the type\n * is immutable; hence only a default instance corresponding to the empty string\n * can be obtained via constructor invocation.\n *\n * SafeStyle's string representation can safely be:\n * <ul>\n *   <li>Interpolated as the content of a *quoted* HTML style attribute.\n *       However, the SafeStyle string *must be HTML-attribute-escaped* before\n *       interpolation.\n *   <li>Interpolated as the content of a {}-wrapped block within a stylesheet.\n *       '<' characters in the SafeStyle string *must be CSS-escaped* before\n *       interpolation. The SafeStyle string is also guaranteed not to be able\n *       to introduce new properties or elide existing ones.\n *   <li>Interpolated as the content of a {}-wrapped block within an HTML\n *       &lt;style&gt; element. '<' characters in the SafeStyle string\n *       *must be CSS-escaped* before interpolation.\n *   <li>Assigned to the style property of a DOM node. The SafeStyle string\n *       should not be escaped before being assigned to the property.\n * </ul>\n *\n * A SafeStyle may never contain literal angle brackets. Otherwise, it could\n * be unsafe to place a SafeStyle into a &lt;style&gt; tag (where it can't\n * be HTML escaped). For example, if the SafeStyle containing\n * \"{@code font: 'foo &lt;style/&gt;&lt;script&gt;evil&lt;/script&gt;'}\" were\n * interpolated within a &lt;style&gt; tag, this would then break out of the\n * style context into HTML.\n *\n * A SafeStyle may contain literal single or double quotes, and as such the\n * entire style string must be escaped when used in a style attribute (if\n * this were not the case, the string could contain a matching quote that\n * would escape from the style attribute).\n *\n * Values of this type must be composable, i.e. for any two values\n * `style1` and `style2` of this type,\n * {@code goog.html.SafeStyle.unwrap(style1) +\n * goog.html.SafeStyle.unwrap(style2)} must itself be a value that satisfies\n * the SafeStyle type constraint. This requirement implies that for any value\n * `style` of this type, `goog.html.SafeStyle.unwrap(style)` must\n * not end in a \"property value\" or \"property name\" context. For example,\n * a value of {@code background:url(\"} or {@code font-} would not satisfy the\n * SafeStyle contract. This is because concatenating such strings with a\n * second value that itself does not contain unsafe CSS can result in an\n * overall string that does. For example, if {@code javascript:evil())\"} is\n * appended to {@code background:url(\"}, the resulting string may result in\n * the execution of a malicious script.\n *\n * TODO(mlourenco): Consider whether we should implement UTF-8 interchange\n * validity checks and blacklisting of newlines (including Unicode ones) and\n * other whitespace characters (\\t, \\f). Document here if so and also update\n * SafeStyle.fromConstant().\n *\n * The following example values comply with this type's contract:\n * <ul>\n *   <li><pre>width: 1em;</pre>\n *   <li><pre>height:1em;</pre>\n *   <li><pre>width: 1em;height: 1em;</pre>\n *   <li><pre>background:url('http://url');</pre>\n * </ul>\n * In addition, the empty string is safe for use in a CSS attribute.\n *\n * The following example values do NOT comply with this type's contract:\n * <ul>\n *   <li><pre>background: red</pre> (missing a trailing semi-colon)\n *   <li><pre>background:</pre> (missing a value and a trailing semi-colon)\n *   <li><pre>1em</pre> (missing an attribute name, which provides context for\n *       the value)\n * </ul>\n *\n * @see goog.html.SafeStyle#create\n * @see goog.html.SafeStyle#fromConstant\n * @see http://www.w3.org/TR/css3-syntax/\n * @constructor\n * @final\n * @struct\n * @implements {goog.string.TypedString}\n */\ngoog.html.SafeStyle = function() {\n  /**\n   * The contained value of this SafeStyle.  The field has a purposely\n   * ugly name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.privateDoNotAccessOrElseSafeStyleWrappedValue_ = '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.html.SafeStyle#unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ =\n      goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeStyle.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Type marker for the SafeStyle type, used to implement additional\n * run-time type checking.\n * @const {!Object}\n * @private\n */\ngoog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ = {};\n\n\n/**\n * Creates a SafeStyle object from a compile-time constant string.\n *\n * `style` should be in the format\n * {@code name: value; [name: value; ...]} and must not have any < or >\n * characters in it. This is so that SafeStyle's contract is preserved,\n * allowing the SafeStyle to correctly be interpreted as a sequence of CSS\n * declarations and without affecting the syntactic structure of any\n * surrounding CSS and HTML.\n *\n * This method performs basic sanity checks on the format of `style`\n * but does not constrain the format of `name` and `value`, except\n * for disallowing tag characters.\n *\n * @param {!goog.string.Const} style A compile-time-constant string from which\n *     to create a SafeStyle.\n * @return {!goog.html.SafeStyle} A SafeStyle object initialized to\n *     `style`.\n */\ngoog.html.SafeStyle.fromConstant = function(style) {\n  var styleString = goog.string.Const.unwrap(style);\n  if (styleString.length === 0) {\n    return goog.html.SafeStyle.EMPTY;\n  }\n  goog.html.SafeStyle.checkStyle_(styleString);\n  goog.asserts.assert(\n      goog.string.endsWith(styleString, ';'),\n      'Last character of style string is not \\';\\': ' + styleString);\n  goog.asserts.assert(\n      goog.string.contains(styleString, ':'),\n      'Style string must contain at least one \\':\\', to ' +\n          'specify a \"name: value\" pair: ' + styleString);\n  return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(\n      styleString);\n};\n\n\n/**\n * Checks if the style definition is valid.\n * @param {string} style\n * @private\n */\ngoog.html.SafeStyle.checkStyle_ = function(style) {\n  goog.asserts.assert(\n      !/[<>]/.test(style), 'Forbidden characters in style string: ' + style);\n};\n\n\n/**\n * Returns this SafeStyle's value as a string.\n *\n * IMPORTANT: In code where it is security relevant that an object's type is\n * indeed `SafeStyle`, use `goog.html.SafeStyle.unwrap` instead of\n * this method. If in doubt, assume that it's security relevant. In particular,\n * note that goog.html functions which return a goog.html type do not guarantee\n * the returned instance is of the right type. For example:\n *\n * <pre>\n * var fakeSafeHtml = new String('fake');\n * fakeSafeHtml.__proto__ = goog.html.SafeHtml.prototype;\n * var newSafeHtml = goog.html.SafeHtml.htmlEscape(fakeSafeHtml);\n * // newSafeHtml is just an alias for fakeSafeHtml, it's passed through by\n * // goog.html.SafeHtml.htmlEscape() as fakeSafeHtml\n * // instanceof goog.html.SafeHtml.\n * </pre>\n *\n * @see goog.html.SafeStyle#unwrap\n * @override\n */\ngoog.html.SafeStyle.prototype.getTypedStringValue = function() {\n  return this.privateDoNotAccessOrElseSafeStyleWrappedValue_;\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a debug string-representation of this value.\n   *\n   * To obtain the actual string value wrapped in a SafeStyle, use\n   * `goog.html.SafeStyle.unwrap`.\n   *\n   * @see goog.html.SafeStyle#unwrap\n   * @override\n   */\n  goog.html.SafeStyle.prototype.toString = function() {\n    return 'SafeStyle{' + this.privateDoNotAccessOrElseSafeStyleWrappedValue_ +\n        '}';\n  };\n}\n\n\n/**\n * Performs a runtime check that the provided object is indeed a\n * SafeStyle object, and returns its value.\n *\n * @param {!goog.html.SafeStyle} safeStyle The object to extract from.\n * @return {string} The safeStyle object's contained string, unless\n *     the run-time type check fails. In that case, `unwrap` returns an\n *     innocuous string, or, if assertions are enabled, throws\n *     `goog.asserts.AssertionError`.\n */\ngoog.html.SafeStyle.unwrap = function(safeStyle) {\n  // Perform additional Run-time type-checking to ensure that\n  // safeStyle is indeed an instance of the expected type.  This\n  // provides some additional protection against security bugs due to\n  // application code that disables type checks.\n  // Specifically, the following checks are performed:\n  // 1. The object is an instance of the expected type.\n  // 2. The object is not an instance of a subclass.\n  // 3. The object carries a type marker for the expected type. \"Faking\" an\n  // object requires a reference to the type marker, which has names intended\n  // to stand out in code reviews.\n  if (safeStyle instanceof goog.html.SafeStyle &&\n      safeStyle.constructor === goog.html.SafeStyle &&\n      safeStyle.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ ===\n          goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_) {\n    return safeStyle.privateDoNotAccessOrElseSafeStyleWrappedValue_;\n  } else {\n    goog.asserts.fail('expected object of type SafeStyle, got \\'' +\n        safeStyle + '\\' of type ' + goog.typeOf(safeStyle));\n    return 'type_error:SafeStyle';\n  }\n};\n\n\n/**\n * Package-internal utility method to create SafeStyle instances.\n *\n * @param {string} style The string to initialize the SafeStyle object with.\n * @return {!goog.html.SafeStyle} The initialized SafeStyle object.\n * @package\n */\ngoog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse = function(\n    style) {\n  return new goog.html.SafeStyle().initSecurityPrivateDoNotAccessOrElse_(style);\n};\n\n\n/**\n * Called from createSafeStyleSecurityPrivateDoNotAccessOrElse(). This\n * method exists only so that the compiler can dead code eliminate static\n * fields (like EMPTY) when they're not accessed.\n * @param {string} style\n * @return {!goog.html.SafeStyle}\n * @private\n */\ngoog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_ = function(\n    style) {\n  this.privateDoNotAccessOrElseSafeStyleWrappedValue_ = style;\n  return this;\n};\n\n\n/**\n * A SafeStyle instance corresponding to the empty string.\n * @const {!goog.html.SafeStyle}\n */\ngoog.html.SafeStyle.EMPTY =\n    goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse('');\n\n\n/**\n * The innocuous string generated by goog.html.SafeStyle.create when passed\n * an unsafe value.\n * @const {string}\n */\ngoog.html.SafeStyle.INNOCUOUS_STRING = 'zClosurez';\n\n\n/**\n * A single property value.\n * @typedef {string|!goog.string.Const|!goog.html.SafeUrl}\n */\ngoog.html.SafeStyle.PropertyValue;\n\n\n/**\n * Mapping of property names to their values.\n * We don't support numbers even though some values might be numbers (e.g.\n * line-height or 0 for any length). The reason is that most numeric values need\n * units (e.g. '1px') and allowing numbers could cause users forgetting about\n * them.\n * @typedef {!Object<string, ?goog.html.SafeStyle.PropertyValue|\n *     ?Array<!goog.html.SafeStyle.PropertyValue>>}\n */\ngoog.html.SafeStyle.PropertyMap;\n\n\n/**\n * Creates a new SafeStyle object from the properties specified in the map.\n * @param {goog.html.SafeStyle.PropertyMap} map Mapping of property names to\n *     their values, for example {'margin': '1px'}. Names must consist of\n *     [-_a-zA-Z0-9]. Values might be strings consisting of\n *     [-,.'\"%_!# a-zA-Z0-9[\\]], where \", ', and [] must be properly balanced.\n *     We also allow simple functions like rgb() and url() which sanitizes its\n *     contents. Other values must be wrapped in goog.string.Const. URLs might\n *     be passed as goog.html.SafeUrl which will be wrapped into url(\"\"). We\n *     also support array whose elements are joined with ' '. Null value causes\n *     skipping the property.\n * @return {!goog.html.SafeStyle}\n * @throws {Error} If invalid name is provided.\n * @throws {goog.asserts.AssertionError} If invalid value is provided. With\n *     disabled assertions, invalid value is replaced by\n *     goog.html.SafeStyle.INNOCUOUS_STRING.\n */\ngoog.html.SafeStyle.create = function(map) {\n  var style = '';\n  for (var name in map) {\n    if (!/^[-_a-zA-Z0-9]+$/.test(name)) {\n      throw new Error('Name allows only [-_a-zA-Z0-9], got: ' + name);\n    }\n    var value = map[name];\n    if (value == null) {\n      continue;\n    }\n    if (goog.isArray(value)) {\n      value = goog.array.map(value, goog.html.SafeStyle.sanitizePropertyValue_)\n                  .join(' ');\n    } else {\n      value = goog.html.SafeStyle.sanitizePropertyValue_(value);\n    }\n    style += name + ':' + value + ';';\n  }\n  if (!style) {\n    return goog.html.SafeStyle.EMPTY;\n  }\n  goog.html.SafeStyle.checkStyle_(style);\n  return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(\n      style);\n};\n\n\n/**\n * Checks and converts value to string.\n * @param {!goog.html.SafeStyle.PropertyValue} value\n * @return {string}\n * @private\n */\ngoog.html.SafeStyle.sanitizePropertyValue_ = function(value) {\n  if (value instanceof goog.html.SafeUrl) {\n    var url = goog.html.SafeUrl.unwrap(value);\n    return 'url(\"' + url.replace(/</g, '%3c').replace(/[\\\\\"]/g, '\\\\$&') + '\")';\n  }\n  var result = value instanceof goog.string.Const ?\n      goog.string.Const.unwrap(value) :\n      goog.html.SafeStyle.sanitizePropertyValueString_(String(value));\n  // These characters can be used to change context and we don't want that even\n  // with const values.\n  goog.asserts.assert(!/[{;}]/.test(result), 'Value does not allow [{;}].');\n  return result;\n};\n\n\n/**\n * Checks string value.\n * @param {string} value\n * @return {string}\n * @private\n */\ngoog.html.SafeStyle.sanitizePropertyValueString_ = function(value) {\n  // Some CSS property values permit nested functions. We allow one level of\n  // nesting, and all nested functions must also be in the FUNCTIONS_RE_ list.\n  var valueWithoutFunctions =\n      value.replace(goog.html.SafeStyle.FUNCTIONS_RE_, '$1')\n          .replace(goog.html.SafeStyle.FUNCTIONS_RE_, '$1')\n          .replace(goog.html.SafeStyle.URL_RE_, 'url');\n  if (!goog.html.SafeStyle.VALUE_RE_.test(valueWithoutFunctions)) {\n    goog.asserts.fail(\n        'String value allows only ' + goog.html.SafeStyle.VALUE_ALLOWED_CHARS_ +\n        ' and simple functions, got: ' + value);\n    return goog.html.SafeStyle.INNOCUOUS_STRING;\n  } else if (goog.html.SafeStyle.COMMENT_RE_.test(value)) {\n    goog.asserts.fail('String value disallows comments, got: ' + value);\n    return goog.html.SafeStyle.INNOCUOUS_STRING;\n  } else if (!goog.html.SafeStyle.hasBalancedQuotes_(value)) {\n    goog.asserts.fail('String value requires balanced quotes, got: ' + value);\n    return goog.html.SafeStyle.INNOCUOUS_STRING;\n  } else if (!goog.html.SafeStyle.hasBalancedSquareBrackets_(value)) {\n    goog.asserts.fail(\n        'String value requires balanced square brackets and one' +\n        ' identifier per pair of brackets, got: ' + value);\n    return goog.html.SafeStyle.INNOCUOUS_STRING;\n  }\n  return goog.html.SafeStyle.sanitizeUrl_(value);\n};\n\n\n/**\n * Checks that quotes (\" and ') are properly balanced inside a string. Assumes\n * that neither escape (\\) nor any other character that could result in\n * breaking out of a string parsing context are allowed;\n * see http://www.w3.org/TR/css3-syntax/#string-token-diagram.\n * @param {string} value Untrusted CSS property value.\n * @return {boolean} True if property value is safe with respect to quote\n *     balancedness.\n * @private\n */\ngoog.html.SafeStyle.hasBalancedQuotes_ = function(value) {\n  var outsideSingle = true;\n  var outsideDouble = true;\n  for (var i = 0; i < value.length; i++) {\n    var c = value.charAt(i);\n    if (c == \"'\" && outsideDouble) {\n      outsideSingle = !outsideSingle;\n    } else if (c == '\"' && outsideSingle) {\n      outsideDouble = !outsideDouble;\n    }\n  }\n  return outsideSingle && outsideDouble;\n};\n\n\n/**\n * Checks that square brackets ([ and ]) are properly balanced inside a string,\n * and that the content in the square brackets is one ident-token;\n * see https://www.w3.org/TR/css-syntax-3/#ident-token-diagram.\n * For practicality, and in line with other restrictions posed on SafeStyle\n * strings, we restrict the character set allowable in the ident-token to\n * [-_a-zA-Z0-9].\n * @param {string} value Untrusted CSS property value.\n * @return {boolean} True if property value is safe with respect to square\n *     bracket balancedness.\n * @private\n */\ngoog.html.SafeStyle.hasBalancedSquareBrackets_ = function(value) {\n  var outside = true;\n  var tokenRe = /^[-_a-zA-Z0-9]$/;\n  for (var i = 0; i < value.length; i++) {\n    var c = value.charAt(i);\n    if (c == ']') {\n      if (outside) return false;  // Unbalanced ].\n      outside = true;\n    } else if (c == '[') {\n      if (!outside) return false;  // No nesting.\n      outside = false;\n    } else if (!outside && !tokenRe.test(c)) {\n      return false;\n    }\n  }\n  return outside;\n};\n\n\n/**\n * Characters allowed in goog.html.SafeStyle.VALUE_RE_.\n * @private {string}\n */\ngoog.html.SafeStyle.VALUE_ALLOWED_CHARS_ = '[-,.\"\\'%_!# a-zA-Z0-9\\\\[\\\\]]';\n\n\n/**\n * Regular expression for safe values.\n *\n * Quotes (\" and ') are allowed, but a check must be done elsewhere to ensure\n * they're balanced.\n *\n * Square brackets ([ and ]) are allowed, but a check must be done elsewhere\n * to ensure they're balanced. The content inside a pair of square brackets must\n * be one alphanumeric identifier.\n *\n * ',' allows multiple values to be assigned to the same property\n * (e.g. background-attachment or font-family) and hence could allow\n * multiple values to get injected, but that should pose no risk of XSS.\n *\n * The expression checks only for XSS safety, not for CSS validity.\n * @const {!RegExp}\n * @private\n */\ngoog.html.SafeStyle.VALUE_RE_ =\n    new RegExp('^' + goog.html.SafeStyle.VALUE_ALLOWED_CHARS_ + '+$');\n\n\n/**\n * Regular expression for url(). We support URLs allowed by\n * https://www.w3.org/TR/css-syntax-3/#url-token-diagram without using escape\n * sequences. Use percent-encoding if you need to use special characters like\n * backslash.\n * @private @const {!RegExp}\n */\ngoog.html.SafeStyle.URL_RE_ = new RegExp(\n    '\\\\b(url\\\\([ \\t\\n]*)(' +\n        '\\'[ -&(-\\\\[\\\\]-~]*\\'' +  // Printable characters except ' and \\.\n        '|\"[ !#-\\\\[\\\\]-~]*\"' +    // Printable characters except \" and \\.\n        '|[!#-&*-\\\\[\\\\]-~]*' +    // Printable characters except [ \"'()\\\\].\n        ')([ \\t\\n]*\\\\))',\n    'g');\n\n\n/**\n * Regular expression for simple functions.\n * @private @const {!RegExp}\n */\ngoog.html.SafeStyle.FUNCTIONS_RE_ = new RegExp(\n    '\\\\b(hsl|hsla|rgb|rgba|matrix|calc|minmax|fit-content|repeat|' +\n        '(rotate|scale|translate)(X|Y|Z|3d)?)' +\n        '\\\\([-+*/0-9a-z.%\\\\[\\\\], ]+\\\\)',\n    'g');\n\n\n/**\n * Regular expression for comments. These are disallowed in CSS property values.\n * @private @const {!RegExp}\n */\ngoog.html.SafeStyle.COMMENT_RE_ = /\\/\\*/;\n\n\n/**\n * Sanitize URLs inside url().\n *\n * NOTE: We could also consider using CSS.escape once that's available in the\n * browsers. However, loosely matching URL e.g. with url\\(.*\\) and then escaping\n * the contents would result in a slightly different language than CSS leading\n * to confusion of users. E.g. url(\")\") is valid in CSS but it would be invalid\n * as seen by our parser. On the other hand, url(\\) is invalid in CSS but our\n * parser would be fine with it.\n *\n * @param {string} value Untrusted CSS property value.\n * @return {string}\n * @private\n */\ngoog.html.SafeStyle.sanitizeUrl_ = function(value) {\n  return value.replace(\n      goog.html.SafeStyle.URL_RE_, function(match, before, url, after) {\n        var quote = '';\n        url = url.replace(/^(['\"])(.*)\\1$/, function(match, start, inside) {\n          quote = start;\n          return inside;\n        });\n        var sanitized = goog.html.SafeUrl.sanitize(url).getTypedStringValue();\n        return before + quote + sanitized + quote + after;\n      });\n};\n\n\n/**\n * Creates a new SafeStyle object by concatenating the values.\n * @param {...(!goog.html.SafeStyle|!Array<!goog.html.SafeStyle>)} var_args\n *     SafeStyles to concatenate.\n * @return {!goog.html.SafeStyle}\n */\ngoog.html.SafeStyle.concat = function(var_args) {\n  var style = '';\n\n  /**\n   * @param {!goog.html.SafeStyle|!Array<!goog.html.SafeStyle>} argument\n   */\n  var addArgument = function(argument) {\n    if (goog.isArray(argument)) {\n      goog.array.forEach(argument, addArgument);\n    } else {\n      style += goog.html.SafeStyle.unwrap(argument);\n    }\n  };\n\n  goog.array.forEach(arguments, addArgument);\n  if (!style) {\n    return goog.html.SafeStyle.EMPTY;\n  }\n  return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(\n      style);\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/**\n * @fileoverview The SafeHtml type and its builders.\n *\n * TODO(xtof): Link to document stating type contract.\n */\n\ngoog.provide('goog.html.SafeHtml');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.tags');\ngoog.require('goog.html.SafeScript');\ngoog.require('goog.html.SafeStyle');\ngoog.require('goog.html.SafeStyleSheet');\ngoog.require('goog.html.SafeUrl');\ngoog.require('goog.html.TrustedResourceUrl');\ngoog.require('goog.i18n.bidi.Dir');\ngoog.require('goog.i18n.bidi.DirectionalString');\ngoog.require('goog.labs.userAgent.browser');\ngoog.require('goog.object');\ngoog.require('goog.string');\ngoog.require('goog.string.Const');\ngoog.require('goog.string.TypedString');\n\n\n\n/**\n * A string that is safe to use in HTML context in DOM APIs and HTML documents.\n *\n * A SafeHtml is a string-like object that carries the security type contract\n * that its value as a string will not cause untrusted script execution when\n * evaluated as HTML in a browser.\n *\n * Values of this type are guaranteed to be safe to use in HTML contexts,\n * such as, assignment to the innerHTML DOM property, or interpolation into\n * a HTML template in HTML PC_DATA context, in the sense that the use will not\n * result in a Cross-Site-Scripting vulnerability.\n *\n * Instances of this type must be created via the factory methods\n * (`goog.html.SafeHtml.create`, `goog.html.SafeHtml.htmlEscape`),\n * etc and not by invoking its constructor.  The constructor intentionally\n * takes no parameters and the type is immutable; hence only a default instance\n * corresponding to the empty string can be obtained via constructor invocation.\n *\n * Note that there is no `goog.html.SafeHtml.fromConstant`. The reason is that\n * the following code would create an unsafe HTML:\n *\n * ```\n * goog.html.SafeHtml.concat(\n *     goog.html.SafeHtml.fromConstant(goog.string.Const.from('<script>')),\n *     goog.html.SafeHtml.htmlEscape(userInput),\n *     goog.html.SafeHtml.fromConstant(goog.string.Const.from('<\\/script>')));\n * ```\n *\n * There's `goog.dom.constHtmlToNode` to create a node from constant strings\n * only.\n *\n * @see goog.html.SafeHtml.create\n * @see goog.html.SafeHtml.htmlEscape\n * @constructor\n * @final\n * @struct\n * @implements {goog.i18n.bidi.DirectionalString}\n * @implements {goog.string.TypedString}\n */\ngoog.html.SafeHtml = function() {\n  /**\n   * The contained value of this SafeHtml.  The field has a purposely ugly\n   * name to make (non-compiled) code that attempts to directly access this\n   * field stand out.\n   * @private {string}\n   */\n  this.privateDoNotAccessOrElseSafeHtmlWrappedValue_ = '';\n\n  /**\n   * A type marker used to implement additional run-time type checking.\n   * @see goog.html.SafeHtml.unwrap\n   * @const {!Object}\n   * @private\n   */\n  this.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ =\n      goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;\n\n  /**\n   * This SafeHtml's directionality, or null if unknown.\n   * @private {?goog.i18n.bidi.Dir}\n   */\n  this.dir_ = null;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeHtml.prototype.implementsGoogI18nBidiDirectionalString = true;\n\n\n/** @override */\ngoog.html.SafeHtml.prototype.getDirection = function() {\n  return this.dir_;\n};\n\n\n/**\n * @override\n * @const\n */\ngoog.html.SafeHtml.prototype.implementsGoogStringTypedString = true;\n\n\n/**\n * Returns this SafeHtml's value as string.\n *\n * IMPORTANT: In code where it is security relevant that an object's type is\n * indeed `SafeHtml`, use `goog.html.SafeHtml.unwrap` instead of\n * this method. If in doubt, assume that it's security relevant. In particular,\n * note that goog.html functions which return a goog.html type do not guarantee\n * that the returned instance is of the right type. For example:\n *\n * <pre>\n * var fakeSafeHtml = new String('fake');\n * fakeSafeHtml.__proto__ = goog.html.SafeHtml.prototype;\n * var newSafeHtml = goog.html.SafeHtml.htmlEscape(fakeSafeHtml);\n * // newSafeHtml is just an alias for fakeSafeHtml, it's passed through by\n * // goog.html.SafeHtml.htmlEscape() as fakeSafeHtml\n * // instanceof goog.html.SafeHtml.\n * </pre>\n *\n * @see goog.html.SafeHtml.unwrap\n * @override\n */\ngoog.html.SafeHtml.prototype.getTypedStringValue = function() {\n  return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_;\n};\n\n\nif (goog.DEBUG) {\n  /**\n   * Returns a debug string-representation of this value.\n   *\n   * To obtain the actual string value wrapped in a SafeHtml, use\n   * `goog.html.SafeHtml.unwrap`.\n   *\n   * @see goog.html.SafeHtml.unwrap\n   * @override\n   */\n  goog.html.SafeHtml.prototype.toString = function() {\n    return 'SafeHtml{' + this.privateDoNotAccessOrElseSafeHtmlWrappedValue_ +\n        '}';\n  };\n}\n\n\n/**\n * Performs a runtime check that the provided object is indeed a SafeHtml\n * object, and returns its value.\n * @param {!goog.html.SafeHtml} safeHtml The object to extract from.\n * @return {string} The SafeHtml object's contained string, unless the run-time\n *     type check fails. In that case, `unwrap` returns an innocuous\n *     string, or, if assertions are enabled, throws\n *     `goog.asserts.AssertionError`.\n */\ngoog.html.SafeHtml.unwrap = function(safeHtml) {\n  // Perform additional run-time type-checking to ensure that safeHtml is indeed\n  // an instance of the expected type.  This provides some additional protection\n  // against security bugs due to application code that disables type checks.\n  // Specifically, the following checks are performed:\n  // 1. The object is an instance of the expected type.\n  // 2. The object is not an instance of a subclass.\n  // 3. The object carries a type marker for the expected type. \"Faking\" an\n  // object requires a reference to the type marker, which has names intended\n  // to stand out in code reviews.\n  if (safeHtml instanceof goog.html.SafeHtml &&\n      safeHtml.constructor === goog.html.SafeHtml &&\n      safeHtml.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ ===\n          goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_) {\n    return safeHtml.privateDoNotAccessOrElseSafeHtmlWrappedValue_;\n  } else {\n    goog.asserts.fail('expected object of type SafeHtml, got \\'' +\n        safeHtml + '\\' of type ' + goog.typeOf(safeHtml));\n    return 'type_error:SafeHtml';\n  }\n};\n\n\n/**\n * Shorthand for union of types that can sensibly be converted to strings\n * or might already be SafeHtml (as SafeHtml is a goog.string.TypedString).\n * @private\n * @typedef {string|number|boolean|!goog.string.TypedString|\n *           !goog.i18n.bidi.DirectionalString}\n */\ngoog.html.SafeHtml.TextOrHtml_;\n\n\n/**\n * Returns HTML-escaped text as a SafeHtml object.\n *\n * If text is of a type that implements\n * `goog.i18n.bidi.DirectionalString`, the directionality of the new\n * `SafeHtml` object is set to `text`'s directionality, if known.\n * Otherwise, the directionality of the resulting SafeHtml is unknown (i.e.,\n * `null`).\n *\n * @param {!goog.html.SafeHtml.TextOrHtml_} textOrHtml The text to escape. If\n *     the parameter is of type SafeHtml it is returned directly (no escaping\n *     is done).\n * @return {!goog.html.SafeHtml} The escaped text, wrapped as a SafeHtml.\n */\ngoog.html.SafeHtml.htmlEscape = function(textOrHtml) {\n  if (textOrHtml instanceof goog.html.SafeHtml) {\n    return textOrHtml;\n  }\n  var textIsObject = typeof textOrHtml == 'object';\n  var dir = null;\n  if (textIsObject && textOrHtml.implementsGoogI18nBidiDirectionalString) {\n    dir = /** @type {!goog.i18n.bidi.DirectionalString} */ (textOrHtml)\n              .getDirection();\n  }\n  var textAsString;\n  if (textIsObject && textOrHtml.implementsGoogStringTypedString) {\n    textAsString = /** @type {!goog.string.TypedString} */ (textOrHtml)\n                       .getTypedStringValue();\n  } else {\n    textAsString = String(textOrHtml);\n  }\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      goog.string.htmlEscape(textAsString), dir);\n};\n\n\n/**\n * Returns HTML-escaped text as a SafeHtml object, with newlines changed to\n * &lt;br&gt;.\n * @param {!goog.html.SafeHtml.TextOrHtml_} textOrHtml The text to escape. If\n *     the parameter is of type SafeHtml it is returned directly (no escaping\n *     is done).\n * @return {!goog.html.SafeHtml} The escaped text, wrapped as a SafeHtml.\n */\ngoog.html.SafeHtml.htmlEscapePreservingNewlines = function(textOrHtml) {\n  if (textOrHtml instanceof goog.html.SafeHtml) {\n    return textOrHtml;\n  }\n  var html = goog.html.SafeHtml.htmlEscape(textOrHtml);\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      goog.string.newLineToBr(goog.html.SafeHtml.unwrap(html)),\n      html.getDirection());\n};\n\n\n/**\n * Returns HTML-escaped text as a SafeHtml object, with newlines changed to\n * &lt;br&gt; and escaping whitespace to preserve spatial formatting. Character\n * entity #160 is used to make it safer for XML.\n * @param {!goog.html.SafeHtml.TextOrHtml_} textOrHtml The text to escape. If\n *     the parameter is of type SafeHtml it is returned directly (no escaping\n *     is done).\n * @return {!goog.html.SafeHtml} The escaped text, wrapped as a SafeHtml.\n */\ngoog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces = function(\n    textOrHtml) {\n  if (textOrHtml instanceof goog.html.SafeHtml) {\n    return textOrHtml;\n  }\n  var html = goog.html.SafeHtml.htmlEscape(textOrHtml);\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      goog.string.whitespaceEscape(goog.html.SafeHtml.unwrap(html)),\n      html.getDirection());\n};\n\n\n/**\n * Coerces an arbitrary object into a SafeHtml object.\n *\n * If `textOrHtml` is already of type `goog.html.SafeHtml`, the same\n * object is returned. Otherwise, `textOrHtml` is coerced to string, and\n * HTML-escaped. If `textOrHtml` is of a type that implements\n * `goog.i18n.bidi.DirectionalString`, its directionality, if known, is\n * preserved.\n *\n * @param {!goog.html.SafeHtml.TextOrHtml_} textOrHtml The text or SafeHtml to\n *     coerce.\n * @return {!goog.html.SafeHtml} The resulting SafeHtml object.\n * @deprecated Use goog.html.SafeHtml.htmlEscape.\n */\ngoog.html.SafeHtml.from = goog.html.SafeHtml.htmlEscape;\n\n\n/**\n * @const\n * @private\n */\ngoog.html.SafeHtml.VALID_NAMES_IN_TAG_ = /^[a-zA-Z0-9-]+$/;\n\n\n/**\n * Set of attributes containing URL as defined at\n * http://www.w3.org/TR/html5/index.html#attributes-1.\n * @private @const {!Object<string,boolean>}\n */\ngoog.html.SafeHtml.URL_ATTRIBUTES_ = goog.object.createSet(\n    'action', 'cite', 'data', 'formaction', 'href', 'manifest', 'poster',\n    'src');\n\n\n/**\n * Tags which are unsupported via create(). They might be supported via a\n * tag-specific create method. These are tags which might require a\n * TrustedResourceUrl in one of their attributes or a restricted type for\n * their content.\n * @private @const {!Object<string,boolean>}\n */\ngoog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_ = goog.object.createSet(\n    goog.dom.TagName.APPLET, goog.dom.TagName.BASE, goog.dom.TagName.EMBED,\n    goog.dom.TagName.IFRAME, goog.dom.TagName.LINK, goog.dom.TagName.MATH,\n    goog.dom.TagName.META, goog.dom.TagName.OBJECT, goog.dom.TagName.SCRIPT,\n    goog.dom.TagName.STYLE, goog.dom.TagName.SVG, goog.dom.TagName.TEMPLATE);\n\n\n/**\n * @typedef {string|number|goog.string.TypedString|\n *     goog.html.SafeStyle.PropertyMap|undefined}\n */\ngoog.html.SafeHtml.AttributeValue;\n\n\n/**\n * Creates a SafeHtml content consisting of a tag with optional attributes and\n * optional content.\n *\n * For convenience tag names and attribute names are accepted as regular\n * strings, instead of goog.string.Const. Nevertheless, you should not pass\n * user-controlled values to these parameters. Note that these parameters are\n * syntactically validated at runtime, and invalid values will result in\n * an exception.\n *\n * Example usage:\n *\n * goog.html.SafeHtml.create('br');\n * goog.html.SafeHtml.create('div', {'class': 'a'});\n * goog.html.SafeHtml.create('p', {}, 'a');\n * goog.html.SafeHtml.create('p', {}, goog.html.SafeHtml.create('br'));\n *\n * goog.html.SafeHtml.create('span', {\n *   'style': {'margin': '0'}\n * });\n *\n * To guarantee SafeHtml's type contract is upheld there are restrictions on\n * attribute values and tag names.\n *\n * - For attributes which contain script code (on*), a goog.string.Const is\n *   required.\n * - For attributes which contain style (style), a goog.html.SafeStyle or a\n *   goog.html.SafeStyle.PropertyMap is required.\n * - For attributes which are interpreted as URLs (e.g. src, href) a\n *   goog.html.SafeUrl, goog.string.Const or string is required. If a string\n *   is passed, it will be sanitized with SafeUrl.sanitize().\n * - For tags which can load code or set security relevant page metadata,\n *   more specific goog.html.SafeHtml.create*() functions must be used. Tags\n *   which are not supported by this function are applet, base, embed, iframe,\n *   link, math, object, script, style, svg, and template.\n *\n * @param {!goog.dom.TagName|string} tagName The name of the tag. Only tag names\n *     consisting of [a-zA-Z0-9-] are allowed. Tag names documented above are\n *     disallowed.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined causes\n *     the attribute to be omitted.\n * @param {!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>=} opt_content Content to\n *     HTML-escape and put inside the tag. This must be empty for void tags\n *     like <br>. Array elements are concatenated.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid tag name, attribute name, or attribute value is\n *     provided.\n * @throws {goog.asserts.AssertionError} If content for void tag is provided.\n */\ngoog.html.SafeHtml.create = function(tagName, opt_attributes, opt_content) {\n  goog.html.SafeHtml.verifyTagName(String(tagName));\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      String(tagName), opt_attributes, opt_content);\n};\n\n\n/**\n * Verifies if the tag name is valid and if it doesn't change the context.\n * E.g. STRONG is fine but SCRIPT throws because it changes context. See\n * goog.html.SafeHtml.create for an explanation of allowed tags.\n * @param {string} tagName\n * @throws {Error} If invalid tag name is provided.\n * @package\n */\ngoog.html.SafeHtml.verifyTagName = function(tagName) {\n  if (!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(tagName)) {\n    throw new Error('Invalid tag name <' + tagName + '>.');\n  }\n  if (tagName.toUpperCase() in goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_) {\n    throw new Error('Tag name <' + tagName + '> is not allowed for SafeHtml.');\n  }\n};\n\n\n/**\n * Creates a SafeHtml representing an iframe tag.\n *\n * This by default restricts the iframe as much as possible by setting the\n * sandbox attribute to the empty string. If the iframe requires less\n * restrictions, set the sandbox attribute as tight as possible, but do not rely\n * on the sandbox as a security feature because it is not supported by older\n * browsers. If a sandbox is essential to security (e.g. for third-party\n * frames), use createSandboxIframe which checks for browser support.\n *\n * @see https://developer.mozilla.org/en/docs/Web/HTML/Element/iframe#attr-sandbox\n *\n * @param {?goog.html.TrustedResourceUrl=} opt_src The value of the src\n *     attribute. If null or undefined src will not be set.\n * @param {?goog.html.SafeHtml=} opt_srcdoc The value of the srcdoc attribute.\n *     If null or undefined srcdoc will not be set.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined causes\n *     the attribute to be omitted.\n * @param {!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>=} opt_content Content to\n *     HTML-escape and put inside the tag. Array elements are concatenated.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid tag name, attribute name, or attribute value is\n *     provided. If opt_attributes contains the src or srcdoc attributes.\n */\ngoog.html.SafeHtml.createIframe = function(\n    opt_src, opt_srcdoc, opt_attributes, opt_content) {\n  if (opt_src) {\n    // Check whether this is really TrustedResourceUrl.\n    goog.html.TrustedResourceUrl.unwrap(opt_src);\n  }\n\n  var fixedAttributes = {};\n  fixedAttributes['src'] = opt_src || null;\n  fixedAttributes['srcdoc'] =\n      opt_srcdoc && goog.html.SafeHtml.unwrap(opt_srcdoc);\n  var defaultAttributes = {'sandbox': ''};\n  var attributes = goog.html.SafeHtml.combineAttributes(\n      fixedAttributes, defaultAttributes, opt_attributes);\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'iframe', attributes, opt_content);\n};\n\n\n/**\n * Creates a SafeHtml representing a sandboxed iframe tag.\n *\n * The sandbox attribute is enforced in its most restrictive mode, an empty\n * string. Consequently, the security requirements for the src and srcdoc\n * attributes are relaxed compared to SafeHtml.createIframe. This function\n * will throw on browsers that do not support the sandbox attribute, as\n * determined by SafeHtml.canUseSandboxIframe.\n *\n * The SafeHtml returned by this function can trigger downloads with no\n * user interaction on Chrome (though only a few, further attempts are blocked).\n * Firefox and IE will block all downloads from the sandbox.\n *\n * @see https://developer.mozilla.org/en/docs/Web/HTML/Element/iframe#attr-sandbox\n * @see https://lists.w3.org/Archives/Public/public-whatwg-archive/2013Feb/0112.html\n *\n * @param {string|!goog.html.SafeUrl=} opt_src The value of the src\n *     attribute. If null or undefined src will not be set.\n * @param {string=} opt_srcdoc The value of the srcdoc attribute.\n *     If null or undefined srcdoc will not be set. Will not be sanitized.\n * @param {!Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined causes\n *     the attribute to be omitted.\n * @param {!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>=} opt_content Content to\n *     HTML-escape and put inside the tag. Array elements are concatenated.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid tag name, attribute name, or attribute value is\n *     provided. If opt_attributes contains the src, srcdoc or sandbox\n *     attributes. If browser does not support the sandbox attribute on iframe.\n */\ngoog.html.SafeHtml.createSandboxIframe = function(\n    opt_src, opt_srcdoc, opt_attributes, opt_content) {\n  if (!goog.html.SafeHtml.canUseSandboxIframe()) {\n    throw new Error('The browser does not support sandboxed iframes.');\n  }\n\n  var fixedAttributes = {};\n  if (opt_src) {\n    // Note that sanitize is a no-op on SafeUrl.\n    fixedAttributes['src'] =\n        goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(opt_src));\n  } else {\n    fixedAttributes['src'] = null;\n  }\n  fixedAttributes['srcdoc'] = opt_srcdoc || null;\n  fixedAttributes['sandbox'] = '';\n  var attributes =\n      goog.html.SafeHtml.combineAttributes(fixedAttributes, {}, opt_attributes);\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'iframe', attributes, opt_content);\n};\n\n\n/**\n * Checks if the user agent supports sandboxed iframes.\n * @return {boolean}\n */\ngoog.html.SafeHtml.canUseSandboxIframe = function() {\n  return goog.global['HTMLIFrameElement'] &&\n      ('sandbox' in goog.global['HTMLIFrameElement'].prototype);\n};\n\n\n/**\n * Creates a SafeHtml representing a script tag with the src attribute.\n * @param {!goog.html.TrustedResourceUrl} src The value of the src\n * attribute.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=}\n * opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined\n *     causes the attribute to be omitted.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid attribute name or value is provided. If\n *     opt_attributes contains the src attribute.\n */\ngoog.html.SafeHtml.createScriptSrc = function(src, opt_attributes) {\n  // TODO(mlourenco): The charset attribute should probably be blocked. If\n  // its value is attacker controlled, the script contains attacker controlled\n  // sub-strings (even if properly escaped) and the server does not set charset\n  // then XSS is likely possible.\n  // https://html.spec.whatwg.org/multipage/scripting.html#dom-script-charset\n\n  // Check whether this is really TrustedResourceUrl.\n  goog.html.TrustedResourceUrl.unwrap(src);\n\n  var fixedAttributes = {'src': src};\n  var defaultAttributes = {};\n  var attributes = goog.html.SafeHtml.combineAttributes(\n      fixedAttributes, defaultAttributes, opt_attributes);\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'script', attributes);\n};\n\n\n/**\n * Creates a SafeHtml representing a script tag. Does not allow the language,\n * src, text or type attributes to be set.\n * @param {!goog.html.SafeScript|!Array<!goog.html.SafeScript>}\n *     script Content to put inside the tag. Array elements are\n *     concatenated.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined causes\n *     the attribute to be omitted.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid attribute name or attribute value is provided. If\n *     opt_attributes contains the language, src, text or type attribute.\n */\ngoog.html.SafeHtml.createScript = function(script, opt_attributes) {\n  for (var attr in opt_attributes) {\n    var attrLower = attr.toLowerCase();\n    if (attrLower == 'language' || attrLower == 'src' || attrLower == 'text' ||\n        attrLower == 'type') {\n      throw new Error('Cannot set \"' + attrLower + '\" attribute');\n    }\n  }\n\n  var content = '';\n  script = goog.array.concat(script);\n  for (var i = 0; i < script.length; i++) {\n    content += goog.html.SafeScript.unwrap(script[i]);\n  }\n  // Convert to SafeHtml so that it's not HTML-escaped. This is safe because\n  // as part of its contract, SafeScript should have no dangerous '<'.\n  var htmlContent =\n      goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n          content, goog.i18n.bidi.Dir.NEUTRAL);\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'script', opt_attributes, htmlContent);\n};\n\n\n/**\n * Creates a SafeHtml representing a style tag. The type attribute is set\n * to \"text/css\".\n * @param {!goog.html.SafeStyleSheet|!Array<!goog.html.SafeStyleSheet>}\n *     styleSheet Content to put inside the tag. Array elements are\n *     concatenated.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Mapping from attribute names to their values. Only attribute names\n *     consisting of [a-zA-Z0-9-] are allowed. Value of null or undefined causes\n *     the attribute to be omitted.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n * @throws {Error} If invalid attribute name or attribute value is provided. If\n *     opt_attributes contains the type attribute.\n */\ngoog.html.SafeHtml.createStyle = function(styleSheet, opt_attributes) {\n  var fixedAttributes = {'type': 'text/css'};\n  var defaultAttributes = {};\n  var attributes = goog.html.SafeHtml.combineAttributes(\n      fixedAttributes, defaultAttributes, opt_attributes);\n\n  var content = '';\n  styleSheet = goog.array.concat(styleSheet);\n  for (var i = 0; i < styleSheet.length; i++) {\n    content += goog.html.SafeStyleSheet.unwrap(styleSheet[i]);\n  }\n  // Convert to SafeHtml so that it's not HTML-escaped. This is safe because\n  // as part of its contract, SafeStyleSheet should have no dangerous '<'.\n  var htmlContent =\n      goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n          content, goog.i18n.bidi.Dir.NEUTRAL);\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'style', attributes, htmlContent);\n};\n\n\n/**\n * Creates a SafeHtml representing a meta refresh tag.\n * @param {!goog.html.SafeUrl|string} url Where to redirect. If a string is\n *     passed, it will be sanitized with SafeUrl.sanitize().\n * @param {number=} opt_secs Number of seconds until the page should be\n *     reloaded. Will be set to 0 if unspecified.\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n */\ngoog.html.SafeHtml.createMetaRefresh = function(url, opt_secs) {\n\n  // Note that sanitize is a no-op on SafeUrl.\n  var unwrappedUrl = goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(url));\n\n  if (goog.labs.userAgent.browser.isIE() ||\n      goog.labs.userAgent.browser.isEdge()) {\n    // IE/EDGE can't parse the content attribute if the url contains a\n    // semicolon. We can fix this by adding quotes around the url, but then we\n    // can't parse quotes in the URL correctly. Also, it seems that IE/EDGE\n    // did not unescape semicolons in these URLs at some point in the past. We\n    // take a best-effort approach.\n    //\n    // If the URL has semicolons (which may happen in some cases, see\n    // http://www.w3.org/TR/1999/REC-html401-19991224/appendix/notes.html#h-B.2\n    // for instance), wrap it in single quotes to protect the semicolons.\n    // If the URL has semicolons and single quotes, url-encode the single quotes\n    // as well.\n    //\n    // This is imperfect. Notice that both ' and ; are reserved characters in\n    // URIs, so this could do the wrong thing, but at least it will do the wrong\n    // thing in only rare cases.\n    if (goog.string.contains(unwrappedUrl, ';')) {\n      unwrappedUrl = \"'\" + unwrappedUrl.replace(/'/g, '%27') + \"'\";\n    }\n  }\n  var attributes = {\n    'http-equiv': 'refresh',\n    'content': (opt_secs || 0) + '; url=' + unwrappedUrl\n  };\n\n  // This function will handle the HTML escaping for attributes.\n  return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(\n      'meta', attributes);\n};\n\n\n/**\n * @param {string} tagName The tag name.\n * @param {string} name The attribute name.\n * @param {!goog.html.SafeHtml.AttributeValue} value The attribute value.\n * @return {string} A \"name=value\" string.\n * @throws {Error} If attribute value is unsafe for the given tag and attribute.\n * @private\n */\ngoog.html.SafeHtml.getAttrNameAndValue_ = function(tagName, name, value) {\n  // If it's goog.string.Const, allow any valid attribute name.\n  if (value instanceof goog.string.Const) {\n    value = goog.string.Const.unwrap(value);\n  } else if (name.toLowerCase() == 'style') {\n    value = goog.html.SafeHtml.getStyleValue_(value);\n  } else if (/^on/i.test(name)) {\n    // TODO(jakubvrana): Disallow more attributes with a special meaning.\n    throw new Error(\n        'Attribute \"' + name + '\" requires goog.string.Const value, \"' + value +\n        '\" given.');\n    // URL attributes handled differently according to tag.\n  } else if (name.toLowerCase() in goog.html.SafeHtml.URL_ATTRIBUTES_) {\n    if (value instanceof goog.html.TrustedResourceUrl) {\n      value = goog.html.TrustedResourceUrl.unwrap(value);\n    } else if (value instanceof goog.html.SafeUrl) {\n      value = goog.html.SafeUrl.unwrap(value);\n    } else if (goog.isString(value)) {\n      value = goog.html.SafeUrl.sanitize(value).getTypedStringValue();\n    } else {\n      throw new Error(\n          'Attribute \"' + name + '\" on tag \"' + tagName +\n          '\" requires goog.html.SafeUrl, goog.string.Const, or string,' +\n          ' value \"' + value + '\" given.');\n    }\n  }\n\n  // Accept SafeUrl, TrustedResourceUrl, etc. for attributes which only require\n  // HTML-escaping.\n  if (value.implementsGoogStringTypedString) {\n    // Ok to call getTypedStringValue() since there's no reliance on the type\n    // contract for security here.\n    value =\n        /** @type {!goog.string.TypedString} */ (value).getTypedStringValue();\n  }\n\n  goog.asserts.assert(\n      goog.isString(value) || goog.isNumber(value),\n      'String or number value expected, got ' + (typeof value) +\n          ' with value: ' + value);\n  return name + '=\"' + goog.string.htmlEscape(String(value)) + '\"';\n};\n\n\n/**\n * Gets value allowed in \"style\" attribute.\n * @param {!goog.html.SafeHtml.AttributeValue} value It could be SafeStyle or a\n *     map which will be passed to goog.html.SafeStyle.create.\n * @return {string} Unwrapped value.\n * @throws {Error} If string value is given.\n * @private\n */\ngoog.html.SafeHtml.getStyleValue_ = function(value) {\n  if (!goog.isObject(value)) {\n    throw new Error(\n        'The \"style\" attribute requires goog.html.SafeStyle or map ' +\n        'of style properties, ' + (typeof value) + ' given: ' + value);\n  }\n  if (!(value instanceof goog.html.SafeStyle)) {\n    // Process the property bag into a style object.\n    value = goog.html.SafeStyle.create(value);\n  }\n  return goog.html.SafeStyle.unwrap(value);\n};\n\n\n/**\n * Creates a SafeHtml content with known directionality consisting of a tag with\n * optional attributes and optional content.\n * @param {!goog.i18n.bidi.Dir} dir Directionality.\n * @param {string} tagName\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n * @param {!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>=} opt_content\n * @return {!goog.html.SafeHtml} The SafeHtml content with the tag.\n */\ngoog.html.SafeHtml.createWithDir = function(\n    dir, tagName, opt_attributes, opt_content) {\n  var html = goog.html.SafeHtml.create(tagName, opt_attributes, opt_content);\n  html.dir_ = dir;\n  return html;\n};\n\n\n/**\n * Creates a new SafeHtml object by concatenating values.\n * @param {...(!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>)} var_args Values to concatenate.\n * @return {!goog.html.SafeHtml}\n */\ngoog.html.SafeHtml.concat = function(var_args) {\n  var dir = goog.i18n.bidi.Dir.NEUTRAL;\n  var content = '';\n\n  /**\n   * @param {!goog.html.SafeHtml.TextOrHtml_|\n   *     !Array<!goog.html.SafeHtml.TextOrHtml_>} argument\n   */\n  var addArgument = function(argument) {\n    if (goog.isArray(argument)) {\n      goog.array.forEach(argument, addArgument);\n    } else {\n      var html = goog.html.SafeHtml.htmlEscape(argument);\n      content += goog.html.SafeHtml.unwrap(html);\n      var htmlDir = html.getDirection();\n      if (dir == goog.i18n.bidi.Dir.NEUTRAL) {\n        dir = htmlDir;\n      } else if (htmlDir != goog.i18n.bidi.Dir.NEUTRAL && dir != htmlDir) {\n        dir = null;\n      }\n    }\n  };\n\n  goog.array.forEach(arguments, addArgument);\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      content, dir);\n};\n\n\n/**\n * Creates a new SafeHtml object with known directionality by concatenating the\n * values.\n * @param {!goog.i18n.bidi.Dir} dir Directionality.\n * @param {...(!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>)} var_args Elements of array\n *     arguments would be processed recursively.\n * @return {!goog.html.SafeHtml}\n */\ngoog.html.SafeHtml.concatWithDir = function(dir, var_args) {\n  var html = goog.html.SafeHtml.concat(goog.array.slice(arguments, 1));\n  html.dir_ = dir;\n  return html;\n};\n\n\n/**\n * Type marker for the SafeHtml type, used to implement additional run-time\n * type checking.\n * @const {!Object}\n * @private\n */\ngoog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_ = {};\n\n\n/**\n * Package-internal utility method to create SafeHtml instances.\n *\n * @param {string} html The string to initialize the SafeHtml object with.\n * @param {?goog.i18n.bidi.Dir} dir The directionality of the SafeHtml to be\n *     constructed, or null if unknown.\n * @return {!goog.html.SafeHtml} The initialized SafeHtml object.\n * @package\n */\ngoog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse = function(\n    html, dir) {\n  return new goog.html.SafeHtml().initSecurityPrivateDoNotAccessOrElse_(\n      html, dir);\n};\n\n\n/**\n * Called from createSafeHtmlSecurityPrivateDoNotAccessOrElse(). This\n * method exists only so that the compiler can dead code eliminate static\n * fields (like EMPTY) when they're not accessed.\n * @param {string} html\n * @param {?goog.i18n.bidi.Dir} dir\n * @return {!goog.html.SafeHtml}\n * @private\n */\ngoog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_ = function(\n    html, dir) {\n  this.privateDoNotAccessOrElseSafeHtmlWrappedValue_ = html;\n  this.dir_ = dir;\n  return this;\n};\n\n\n/**\n * Like create() but does not restrict which tags can be constructed.\n *\n * @param {string} tagName Tag name. Set or validated by caller.\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n * @param {(!goog.html.SafeHtml.TextOrHtml_|\n *     !Array<!goog.html.SafeHtml.TextOrHtml_>)=} opt_content\n * @return {!goog.html.SafeHtml}\n * @throws {Error} If invalid or unsafe attribute name or value is provided.\n * @throws {goog.asserts.AssertionError} If content for void tag is provided.\n * @package\n */\ngoog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse = function(\n    tagName, opt_attributes, opt_content) {\n  var dir = null;\n  var result = '<' + tagName;\n  result += goog.html.SafeHtml.stringifyAttributes(tagName, opt_attributes);\n\n  var content = opt_content;\n  if (!goog.isDefAndNotNull(content)) {\n    content = [];\n  } else if (!goog.isArray(content)) {\n    content = [content];\n  }\n\n  if (goog.dom.tags.isVoidTag(tagName.toLowerCase())) {\n    goog.asserts.assert(\n        !content.length, 'Void tag <' + tagName + '> does not allow content.');\n    result += '>';\n  } else {\n    var html = goog.html.SafeHtml.concat(content);\n    result += '>' + goog.html.SafeHtml.unwrap(html) + '</' + tagName + '>';\n    dir = html.getDirection();\n  }\n\n  var dirAttribute = opt_attributes && opt_attributes['dir'];\n  if (dirAttribute) {\n    if (/^(ltr|rtl|auto)$/i.test(dirAttribute)) {\n      // If the tag has the \"dir\" attribute specified then its direction is\n      // neutral because it can be safely used in any context.\n      dir = goog.i18n.bidi.Dir.NEUTRAL;\n    } else {\n      dir = null;\n    }\n  }\n\n  return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n      result, dir);\n};\n\n\n/**\n * Creates a string with attributes to insert after tagName.\n * @param {string} tagName\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n * @return {string} Returns an empty string if there are no attributes, returns\n *     a string starting with a space otherwise.\n * @throws {Error} If attribute value is unsafe for the given tag and attribute.\n * @package\n */\ngoog.html.SafeHtml.stringifyAttributes = function(tagName, opt_attributes) {\n  var result = '';\n  if (opt_attributes) {\n    for (var name in opt_attributes) {\n      if (!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(name)) {\n        throw new Error('Invalid attribute name \"' + name + '\".');\n      }\n      var value = opt_attributes[name];\n      if (!goog.isDefAndNotNull(value)) {\n        continue;\n      }\n      result +=\n          ' ' + goog.html.SafeHtml.getAttrNameAndValue_(tagName, name, value);\n    }\n  }\n  return result;\n};\n\n\n/**\n * @param {!Object<string, ?goog.html.SafeHtml.AttributeValue>} fixedAttributes\n * @param {!Object<string, string>} defaultAttributes\n * @param {?Object<string, ?goog.html.SafeHtml.AttributeValue>=} opt_attributes\n *     Optional attributes passed to create*().\n * @return {!Object<string, ?goog.html.SafeHtml.AttributeValue>}\n * @throws {Error} If opt_attributes contains an attribute with the same name\n *     as an attribute in fixedAttributes.\n * @package\n */\ngoog.html.SafeHtml.combineAttributes = function(\n    fixedAttributes, defaultAttributes, opt_attributes) {\n  var combinedAttributes = {};\n  var name;\n\n  for (name in fixedAttributes) {\n    goog.asserts.assert(name.toLowerCase() == name, 'Must be lower case');\n    combinedAttributes[name] = fixedAttributes[name];\n  }\n  for (name in defaultAttributes) {\n    goog.asserts.assert(name.toLowerCase() == name, 'Must be lower case');\n    combinedAttributes[name] = defaultAttributes[name];\n  }\n\n  for (name in opt_attributes) {\n    var nameLower = name.toLowerCase();\n    if (nameLower in fixedAttributes) {\n      throw new Error(\n          'Cannot override \"' + nameLower + '\" attribute, got \"' + name +\n          '\" with value \"' + opt_attributes[name] + '\"');\n    }\n    if (nameLower in defaultAttributes) {\n      delete combinedAttributes[nameLower];\n    }\n    combinedAttributes[name] = opt_attributes[name];\n  }\n\n  return combinedAttributes;\n};\n\n\n/**\n * A SafeHtml instance corresponding to the HTML doctype: \"<!DOCTYPE html>\".\n * @const {!goog.html.SafeHtml}\n */\ngoog.html.SafeHtml.DOCTYPE_HTML =\n    goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n        '<!DOCTYPE html>', goog.i18n.bidi.Dir.NEUTRAL);\n\n\n/**\n * A SafeHtml instance corresponding to the empty string.\n * @const {!goog.html.SafeHtml}\n */\ngoog.html.SafeHtml.EMPTY =\n    goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n        '', goog.i18n.bidi.Dir.NEUTRAL);\n\n\n/**\n * A SafeHtml instance corresponding to the <br> tag.\n * @const {!goog.html.SafeHtml}\n */\ngoog.html.SafeHtml.BR =\n    goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(\n        '<br>', goog.i18n.bidi.Dir.NEUTRAL);\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Implements the disposable interface. The dispose method is used\n * to clean up references and resources.\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\ngoog.provide('goog.Disposable');\ngoog.provide('goog.dispose');\ngoog.provide('goog.disposeAll');\n\ngoog.require('goog.disposable.IDisposable');\n\n\n\n/**\n * Class that provides the basic implementation for disposable objects. If your\n * class holds one or more references to COM objects, DOM nodes, or other\n * disposable objects, it should extend this class or implement the disposable\n * interface (defined in goog.disposable.IDisposable).\n * @constructor\n * @implements {goog.disposable.IDisposable}\n */\ngoog.Disposable = function() {\n  /**\n   * If monitoring the goog.Disposable instances is enabled, stores the creation\n   * stack trace of the Disposable instance.\n   * @type {string|undefined}\n   */\n  this.creationStack;\n\n  if (goog.Disposable.MONITORING_MODE != goog.Disposable.MonitoringMode.OFF) {\n    if (goog.Disposable.INCLUDE_STACK_ON_CREATION) {\n      this.creationStack = new Error().stack;\n    }\n    goog.Disposable.instances_[goog.getUid(this)] = this;\n  }\n  // Support sealing\n  this.disposed_ = this.disposed_;\n  this.onDisposeCallbacks_ = this.onDisposeCallbacks_;\n};\n\n\n/**\n * @enum {number} Different monitoring modes for Disposable.\n */\ngoog.Disposable.MonitoringMode = {\n  /**\n   * No monitoring.\n   */\n  OFF: 0,\n  /**\n   * Creating and disposing the goog.Disposable instances is monitored. All\n   * disposable objects need to call the `goog.Disposable` base\n   * constructor. The PERMANENT mode must be switched on before creating any\n   * goog.Disposable instances.\n   */\n  PERMANENT: 1,\n  /**\n   * INTERACTIVE mode can be switched on and off on the fly without producing\n   * errors. It also doesn't warn if the disposable objects don't call the\n   * `goog.Disposable` base constructor.\n   */\n  INTERACTIVE: 2\n};\n\n\n/**\n * @define {number} The monitoring mode of the goog.Disposable\n *     instances. Default is OFF. Switching on the monitoring is only\n *     recommended for debugging because it has a significant impact on\n *     performance and memory usage. If switched off, the monitoring code\n *     compiles down to 0 bytes.\n */\ngoog.define('goog.Disposable.MONITORING_MODE', 0);\n\n\n/**\n * @define {boolean} Whether to attach creation stack to each created disposable\n *     instance; This is only relevant for when MonitoringMode != OFF.\n */\ngoog.define('goog.Disposable.INCLUDE_STACK_ON_CREATION', true);\n\n\n/**\n * Maps the unique ID of every undisposed `goog.Disposable` object to\n * the object itself.\n * @type {!Object<number, !goog.Disposable>}\n * @private\n */\ngoog.Disposable.instances_ = {};\n\n\n/**\n * @return {!Array<!goog.Disposable>} All `goog.Disposable` objects that\n *     haven't been disposed of.\n */\ngoog.Disposable.getUndisposedObjects = function() {\n  var ret = [];\n  for (var id in goog.Disposable.instances_) {\n    if (goog.Disposable.instances_.hasOwnProperty(id)) {\n      ret.push(goog.Disposable.instances_[Number(id)]);\n    }\n  }\n  return ret;\n};\n\n\n/**\n * Clears the registry of undisposed objects but doesn't dispose of them.\n */\ngoog.Disposable.clearUndisposedObjects = function() {\n  goog.Disposable.instances_ = {};\n};\n\n\n/**\n * Whether the object has been disposed of.\n * @type {boolean}\n * @private\n */\ngoog.Disposable.prototype.disposed_ = false;\n\n\n/**\n * Callbacks to invoke when this object is disposed.\n * @type {Array<!Function>}\n * @private\n */\ngoog.Disposable.prototype.onDisposeCallbacks_;\n\n\n/**\n * @return {boolean} Whether the object has been disposed of.\n * @override\n */\ngoog.Disposable.prototype.isDisposed = function() {\n  return this.disposed_;\n};\n\n\n/**\n * @return {boolean} Whether the object has been disposed of.\n * @deprecated Use {@link #isDisposed} instead.\n */\ngoog.Disposable.prototype.getDisposed = goog.Disposable.prototype.isDisposed;\n\n\n/**\n * Disposes of the object. If the object hasn't already been disposed of, calls\n * {@link #disposeInternal}. Classes that extend `goog.Disposable` should\n * override {@link #disposeInternal} in order to delete references to COM\n * objects, DOM nodes, and other disposable objects. Reentrant.\n *\n * @return {void} Nothing.\n * @override\n */\ngoog.Disposable.prototype.dispose = function() {\n  if (!this.disposed_) {\n    // Set disposed_ to true first, in case during the chain of disposal this\n    // gets disposed recursively.\n    this.disposed_ = true;\n    this.disposeInternal();\n    if (goog.Disposable.MONITORING_MODE != goog.Disposable.MonitoringMode.OFF) {\n      var uid = goog.getUid(this);\n      if (goog.Disposable.MONITORING_MODE ==\n              goog.Disposable.MonitoringMode.PERMANENT &&\n          !goog.Disposable.instances_.hasOwnProperty(uid)) {\n        throw new Error(\n            this + ' did not call the goog.Disposable base ' +\n            'constructor or was disposed of after a clearUndisposedObjects ' +\n            'call');\n      }\n      if (goog.Disposable.MONITORING_MODE !=\n              goog.Disposable.MonitoringMode.OFF &&\n          this.onDisposeCallbacks_ && this.onDisposeCallbacks_.length > 0) {\n        throw new Error(\n            this + ' did not empty its onDisposeCallbacks queue. This ' +\n            'probably means it overrode dispose() or disposeInternal() ' +\n            'without calling the superclass\\' method.');\n      }\n      delete goog.Disposable.instances_[uid];\n    }\n  }\n};\n\n\n/**\n * Associates a disposable object with this object so that they will be disposed\n * together.\n * @param {goog.disposable.IDisposable} disposable that will be disposed when\n *     this object is disposed.\n */\ngoog.Disposable.prototype.registerDisposable = function(disposable) {\n  this.addOnDisposeCallback(goog.partial(goog.dispose, disposable));\n};\n\n\n/**\n * Invokes a callback function when this object is disposed. Callbacks are\n * invoked in the order in which they were added. If a callback is added to\n * an already disposed Disposable, it will be called immediately.\n * @param {function(this:T):?} callback The callback function.\n * @param {T=} opt_scope An optional scope to call the callback in.\n * @template T\n */\ngoog.Disposable.prototype.addOnDisposeCallback = function(callback, opt_scope) {\n  if (this.disposed_) {\n    goog.isDef(opt_scope) ? callback.call(opt_scope) : callback();\n    return;\n  }\n  if (!this.onDisposeCallbacks_) {\n    this.onDisposeCallbacks_ = [];\n  }\n\n  this.onDisposeCallbacks_.push(\n      goog.isDef(opt_scope) ? goog.bind(callback, opt_scope) : callback);\n};\n\n\n/**\n * Deletes or nulls out any references to COM objects, DOM nodes, or other\n * disposable objects. Classes that extend `goog.Disposable` should\n * override this method.\n * Not reentrant. To avoid calling it twice, it must only be called from the\n * subclass' `disposeInternal` method. Everywhere else the public\n * `dispose` method must be used.\n * For example:\n * <pre>\n *   mypackage.MyClass = function() {\n *     mypackage.MyClass.base(this, 'constructor');\n *     // Constructor logic specific to MyClass.\n *     ...\n *   };\n *   goog.inherits(mypackage.MyClass, goog.Disposable);\n *\n *   mypackage.MyClass.prototype.disposeInternal = function() {\n *     // Dispose logic specific to MyClass.\n *     ...\n *     // Call superclass's disposeInternal at the end of the subclass's, like\n *     // in C++, to avoid hard-to-catch issues.\n *     mypackage.MyClass.base(this, 'disposeInternal');\n *   };\n * </pre>\n * @protected\n */\ngoog.Disposable.prototype.disposeInternal = function() {\n  if (this.onDisposeCallbacks_) {\n    while (this.onDisposeCallbacks_.length) {\n      this.onDisposeCallbacks_.shift()();\n    }\n  }\n};\n\n\n/**\n * Returns True if we can verify the object is disposed.\n * Calls `isDisposed` on the argument if it supports it.  If obj\n * is not an object with an isDisposed() method, return false.\n * @param {*} obj The object to investigate.\n * @return {boolean} True if we can verify the object is disposed.\n */\ngoog.Disposable.isDisposed = function(obj) {\n  if (obj && typeof obj.isDisposed == 'function') {\n    return obj.isDisposed();\n  }\n  return false;\n};\n\n\n/**\n * Calls `dispose` on the argument if it supports it. If obj is not an\n *     object with a dispose() method, this is a no-op.\n * @param {*} obj The object to dispose of.\n */\ngoog.dispose = function(obj) {\n  if (obj && typeof obj.dispose == 'function') {\n    obj.dispose();\n  }\n};\n\n\n/**\n * Calls `dispose` on each member of the list that supports it. (If the\n * member is an ArrayLike, then `goog.disposeAll()` will be called\n * recursively on each of its members.) If the member is not an object with a\n * `dispose()` method, then it is ignored.\n * @param {...*} var_args The list.\n */\ngoog.disposeAll = function(var_args) {\n  for (var i = 0, len = arguments.length; i < len; ++i) {\n    var disposable = arguments[i];\n    if (goog.isArrayLike(disposable)) {\n      goog.disposeAll.apply(null, disposable);\n    } else {\n      goog.dispose(disposable);\n    }\n  }\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Logging and debugging utilities.\n *\n * @see ../demos/debug.html\n */\n\ngoog.provide('goog.debug');\n\ngoog.require('goog.array');\ngoog.require('goog.debug.errorcontext');\ngoog.require('goog.userAgent');\n\n\n/** @define {boolean} Whether logging should be enabled. */\ngoog.define('goog.debug.LOGGING_ENABLED', goog.DEBUG);\n\n\n/** @define {boolean} Whether to force \"sloppy\" stack building. */\ngoog.define('goog.debug.FORCE_SLOPPY_STACKS', false);\n\n\n/**\n * Catches onerror events fired by windows and similar objects.\n * @param {function(Object)} logFunc The function to call with the error\n *    information.\n * @param {boolean=} opt_cancel Whether to stop the error from reaching the\n *    browser.\n * @param {Object=} opt_target Object that fires onerror events.\n * @suppress {strictMissingProperties} onerror is not defined as a property\n *    on Object.\n */\ngoog.debug.catchErrors = function(logFunc, opt_cancel, opt_target) {\n  var target = opt_target || goog.global;\n  var oldErrorHandler = target.onerror;\n  var retVal = !!opt_cancel;\n\n  // Chrome interprets onerror return value backwards (http://crbug.com/92062)\n  // until it was fixed in webkit revision r94061 (Webkit 535.3). This\n  // workaround still needs to be skipped in Safari after the webkit change\n  // gets pushed out in Safari.\n  // See https://bugs.webkit.org/show_bug.cgi?id=67119\n  if (goog.userAgent.WEBKIT && !goog.userAgent.isVersionOrHigher('535.3')) {\n    retVal = !retVal;\n  }\n\n  /**\n   * New onerror handler for this target. This onerror handler follows the spec\n   * according to\n   * http://www.whatwg.org/specs/web-apps/current-work/#runtime-script-errors\n   * The spec was changed in August 2013 to support receiving column information\n   * and an error object for all scripts on the same origin or cross origin\n   * scripts with the proper headers. See\n   * https://mikewest.org/2013/08/debugging-runtime-errors-with-window-onerror\n   *\n   * @param {string} message The error message. For cross-origin errors, this\n   *     will be scrubbed to just \"Script error.\". For new browsers that have\n   *     updated to follow the latest spec, errors that come from origins that\n   *     have proper cross origin headers will not be scrubbed.\n   * @param {string} url The URL of the script that caused the error. The URL\n   *     will be scrubbed to \"\" for cross origin scripts unless the script has\n   *     proper cross origin headers and the browser has updated to the latest\n   *     spec.\n   * @param {number} line The line number in the script that the error\n   *     occurred on.\n   * @param {number=} opt_col The optional column number that the error\n   *     occurred on. Only browsers that have updated to the latest spec will\n   *     include this.\n   * @param {Error=} opt_error The optional actual error object for this\n   *     error that should include the stack. Only browsers that have updated\n   *     to the latest spec will inlude this parameter.\n   * @return {boolean} Whether to prevent the error from reaching the browser.\n   */\n  target.onerror = function(message, url, line, opt_col, opt_error) {\n    if (oldErrorHandler) {\n      oldErrorHandler(message, url, line, opt_col, opt_error);\n    }\n    logFunc({\n      message: message,\n      fileName: url,\n      line: line,\n      lineNumber: line,\n      col: opt_col,\n      error: opt_error\n    });\n    return retVal;\n  };\n};\n\n\n/**\n * Creates a string representing an object and all its properties.\n * @param {Object|null|undefined} obj Object to expose.\n * @param {boolean=} opt_showFn Show the functions as well as the properties,\n *     default is false.\n * @return {string} The string representation of `obj`.\n */\ngoog.debug.expose = function(obj, opt_showFn) {\n  if (typeof obj == 'undefined') {\n    return 'undefined';\n  }\n  if (obj == null) {\n    return 'NULL';\n  }\n  var str = [];\n\n  for (var x in obj) {\n    if (!opt_showFn && goog.isFunction(obj[x])) {\n      continue;\n    }\n    var s = x + ' = ';\n\n    try {\n      s += obj[x];\n    } catch (e) {\n      s += '*** ' + e + ' ***';\n    }\n    str.push(s);\n  }\n  return str.join('\\n');\n};\n\n\n/**\n * Creates a string representing a given primitive or object, and for an\n * object, all its properties and nested objects. NOTE: The output will include\n * Uids on all objects that were exposed. Any added Uids will be removed before\n * returning.\n * @param {*} obj Object to expose.\n * @param {boolean=} opt_showFn Also show properties that are functions (by\n *     default, functions are omitted).\n * @return {string} A string representation of `obj`.\n */\ngoog.debug.deepExpose = function(obj, opt_showFn) {\n  var str = [];\n\n  // Track any objects where deepExpose added a Uid, so they can be cleaned up\n  // before return. We do this globally, rather than only on ancestors so that\n  // if the same object appears in the output, you can see it.\n  var uidsToCleanup = [];\n  var ancestorUids = {};\n\n  var helper = function(obj, space) {\n    var nestspace = space + '  ';\n\n    var indentMultiline = function(str) {\n      return str.replace(/\\n/g, '\\n' + space);\n    };\n\n\n    try {\n      if (!goog.isDef(obj)) {\n        str.push('undefined');\n      } else if (goog.isNull(obj)) {\n        str.push('NULL');\n      } else if (goog.isString(obj)) {\n        str.push('\"' + indentMultiline(obj) + '\"');\n      } else if (goog.isFunction(obj)) {\n        str.push(indentMultiline(String(obj)));\n      } else if (goog.isObject(obj)) {\n        // Add a Uid if needed. The struct calls implicitly adds them.\n        if (!goog.hasUid(obj)) {\n          uidsToCleanup.push(obj);\n        }\n        var uid = goog.getUid(obj);\n        if (ancestorUids[uid]) {\n          str.push('*** reference loop detected (id=' + uid + ') ***');\n        } else {\n          ancestorUids[uid] = true;\n          str.push('{');\n          for (var x in obj) {\n            if (!opt_showFn && goog.isFunction(obj[x])) {\n              continue;\n            }\n            str.push('\\n');\n            str.push(nestspace);\n            str.push(x + ' = ');\n            helper(obj[x], nestspace);\n          }\n          str.push('\\n' + space + '}');\n          delete ancestorUids[uid];\n        }\n      } else {\n        str.push(obj);\n      }\n    } catch (e) {\n      str.push('*** ' + e + ' ***');\n    }\n  };\n\n  helper(obj, '');\n\n  // Cleanup any Uids that were added by the deepExpose.\n  for (var i = 0; i < uidsToCleanup.length; i++) {\n    goog.removeUid(uidsToCleanup[i]);\n  }\n\n  return str.join('');\n};\n\n\n/**\n * Recursively outputs a nested array as a string.\n * @param {Array<?>} arr The array.\n * @return {string} String representing nested array.\n */\ngoog.debug.exposeArray = function(arr) {\n  var str = [];\n  for (var i = 0; i < arr.length; i++) {\n    if (goog.isArray(arr[i])) {\n      str.push(goog.debug.exposeArray(arr[i]));\n    } else {\n      str.push(arr[i]);\n    }\n  }\n  return '[ ' + str.join(', ') + ' ]';\n};\n\n\n/**\n * Normalizes the error/exception object between browsers.\n * @param {*} err Raw error object.\n * @return {{\n *    message: (?|undefined),\n *    name: (?|undefined),\n *    lineNumber: (?|undefined),\n *    fileName: (?|undefined),\n *    stack: (?|undefined)\n * }} Normalized error object.\n * @suppress {strictMissingProperties} properties not defined on err\n */\ngoog.debug.normalizeErrorObject = function(err) {\n  var href = goog.getObjectByName('window.location.href');\n  if (goog.isString(err)) {\n    return {\n      'message': err,\n      'name': 'Unknown error',\n      'lineNumber': 'Not available',\n      'fileName': href,\n      'stack': 'Not available'\n    };\n  }\n\n  var lineNumber, fileName;\n  var threwError = false;\n\n  try {\n    lineNumber = err.lineNumber || err.line || 'Not available';\n  } catch (e) {\n    // Firefox 2 sometimes throws an error when accessing 'lineNumber':\n    // Message: Permission denied to get property UnnamedClass.lineNumber\n    lineNumber = 'Not available';\n    threwError = true;\n  }\n\n  try {\n    fileName = err.fileName || err.filename || err.sourceURL ||\n        // $googDebugFname may be set before a call to eval to set the filename\n        // that the eval is supposed to present.\n        goog.global['$googDebugFname'] || href;\n  } catch (e) {\n    // Firefox 2 may also throw an error when accessing 'filename'.\n    fileName = 'Not available';\n    threwError = true;\n  }\n\n  // The IE Error object contains only the name and the message.\n  // The Safari Error object uses the line and sourceURL fields.\n  if (threwError || !err.lineNumber || !err.fileName || !err.stack ||\n      !err.message || !err.name) {\n    return {\n      'message': err.message || 'Not available',\n      'name': err.name || 'UnknownError',\n      'lineNumber': lineNumber,\n      'fileName': fileName,\n      'stack': err.stack || 'Not available'\n    };\n  }\n\n  // Standards error object\n  // Typed !Object. Should be a subtype of the return type, but it's not.\n  return /** @type {?} */ (err);\n};\n\n\n/**\n * Converts an object to an Error using the object's toString if it's not\n * already an Error, adds a stacktrace if there isn't one, and optionally adds\n * an extra message.\n * @param {*} err The original thrown error, object, or string.\n * @param {string=} opt_message  optional additional message to add to the\n *     error.\n * @return {!Error} If err is an Error, it is enhanced and returned. Otherwise,\n *     it is converted to an Error which is enhanced and returned.\n */\ngoog.debug.enhanceError = function(err, opt_message) {\n  var error;\n  if (!(err instanceof Error)) {\n    error = Error(err);\n    if (Error.captureStackTrace) {\n      // Trim this function off the call stack, if we can.\n      Error.captureStackTrace(error, goog.debug.enhanceError);\n    }\n  } else {\n    error = err;\n  }\n\n  if (!error.stack) {\n    error.stack = goog.debug.getStacktrace(goog.debug.enhanceError);\n  }\n  if (opt_message) {\n    // find the first unoccupied 'messageX' property\n    var x = 0;\n    while (error['message' + x]) {\n      ++x;\n    }\n    error['message' + x] = String(opt_message);\n  }\n  return error;\n};\n\n\n/**\n * Converts an object to an Error using the object's toString if it's not\n * already an Error, adds a stacktrace if there isn't one, and optionally adds\n * context to the Error, which is reported by the closure error reporter.\n * @param {*} err The original thrown error, object, or string.\n * @param {!Object<string, string>=} opt_context Key-value context to add to the\n *     Error.\n * @return {!Error} If err is an Error, it is enhanced and returned. Otherwise,\n *     it is converted to an Error which is enhanced and returned.\n */\ngoog.debug.enhanceErrorWithContext = function(err, opt_context) {\n  var error = goog.debug.enhanceError(err);\n  if (opt_context) {\n    for (var key in opt_context) {\n      goog.debug.errorcontext.addErrorContext(error, key, opt_context[key]);\n    }\n  }\n  return error;\n};\n\n\n/**\n * Gets the current stack trace. Simple and iterative - doesn't worry about\n * catching circular references or getting the args.\n * @param {number=} opt_depth Optional maximum depth to trace back to.\n * @return {string} A string with the function names of all functions in the\n *     stack, separated by \\n.\n * @suppress {es5Strict}\n */\ngoog.debug.getStacktraceSimple = function(opt_depth) {\n  if (!goog.debug.FORCE_SLOPPY_STACKS) {\n    var stack = goog.debug.getNativeStackTrace_(goog.debug.getStacktraceSimple);\n    if (stack) {\n      return stack;\n    }\n    // NOTE: browsers that have strict mode support also have native \"stack\"\n    // properties.  Fall-through for legacy browser support.\n  }\n\n  var sb = [];\n  var fn = arguments.callee.caller;\n  var depth = 0;\n\n  while (fn && (!opt_depth || depth < opt_depth)) {\n    sb.push(goog.debug.getFunctionName(fn));\n    sb.push('()\\n');\n\n    try {\n      fn = fn.caller;\n    } catch (e) {\n      sb.push('[exception trying to get caller]\\n');\n      break;\n    }\n    depth++;\n    if (depth >= goog.debug.MAX_STACK_DEPTH) {\n      sb.push('[...long stack...]');\n      break;\n    }\n  }\n  if (opt_depth && depth >= opt_depth) {\n    sb.push('[...reached max depth limit...]');\n  } else {\n    sb.push('[end]');\n  }\n\n  return sb.join('');\n};\n\n\n/**\n * Max length of stack to try and output\n * @type {number}\n */\ngoog.debug.MAX_STACK_DEPTH = 50;\n\n\n/**\n * @param {Function} fn The function to start getting the trace from.\n * @return {?string}\n * @private\n */\ngoog.debug.getNativeStackTrace_ = function(fn) {\n  var tempErr = new Error();\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(tempErr, fn);\n    return String(tempErr.stack);\n  } else {\n    // IE10, only adds stack traces when an exception is thrown.\n    try {\n      throw tempErr;\n    } catch (e) {\n      tempErr = e;\n    }\n    var stack = tempErr.stack;\n    if (stack) {\n      return String(stack);\n    }\n  }\n  return null;\n};\n\n\n/**\n * Gets the current stack trace, either starting from the caller or starting\n * from a specified function that's currently on the call stack.\n * @param {?Function=} fn If provided, when collecting the stack trace all\n *     frames above the topmost call to this function, including that call,\n *     will be left out of the stack trace.\n * @return {string} Stack trace.\n * @suppress {es5Strict}\n */\ngoog.debug.getStacktrace = function(fn) {\n  var stack;\n  if (!goog.debug.FORCE_SLOPPY_STACKS) {\n    // Try to get the stack trace from the environment if it is available.\n    var contextFn = fn || goog.debug.getStacktrace;\n    stack = goog.debug.getNativeStackTrace_(contextFn);\n  }\n  if (!stack) {\n    // NOTE: browsers that have strict mode support also have native \"stack\"\n    // properties. This function will throw in strict mode.\n    stack = goog.debug.getStacktraceHelper_(fn || arguments.callee.caller, []);\n  }\n  return stack;\n};\n\n\n/**\n * Private helper for getStacktrace().\n * @param {?Function} fn If provided, when collecting the stack trace all\n *     frames above the topmost call to this function, including that call,\n *     will be left out of the stack trace.\n * @param {Array<!Function>} visited List of functions visited so far.\n * @return {string} Stack trace starting from function fn.\n * @suppress {es5Strict}\n * @private\n */\ngoog.debug.getStacktraceHelper_ = function(fn, visited) {\n  var sb = [];\n\n  // Circular reference, certain functions like bind seem to cause a recursive\n  // loop so we need to catch circular references\n  if (goog.array.contains(visited, fn)) {\n    sb.push('[...circular reference...]');\n\n    // Traverse the call stack until function not found or max depth is reached\n  } else if (fn && visited.length < goog.debug.MAX_STACK_DEPTH) {\n    sb.push(goog.debug.getFunctionName(fn) + '(');\n    var args = fn.arguments;\n    // Args may be null for some special functions such as host objects or eval.\n    for (var i = 0; args && i < args.length; i++) {\n      if (i > 0) {\n        sb.push(', ');\n      }\n      var argDesc;\n      var arg = args[i];\n      switch (typeof arg) {\n        case 'object':\n          argDesc = arg ? 'object' : 'null';\n          break;\n\n        case 'string':\n          argDesc = arg;\n          break;\n\n        case 'number':\n          argDesc = String(arg);\n          break;\n\n        case 'boolean':\n          argDesc = arg ? 'true' : 'false';\n          break;\n\n        case 'function':\n          argDesc = goog.debug.getFunctionName(arg);\n          argDesc = argDesc ? argDesc : '[fn]';\n          break;\n\n        case 'undefined':\n        default:\n          argDesc = typeof arg;\n          break;\n      }\n\n      if (argDesc.length > 40) {\n        argDesc = argDesc.substr(0, 40) + '...';\n      }\n      sb.push(argDesc);\n    }\n    visited.push(fn);\n    sb.push(')\\n');\n\n    try {\n      sb.push(goog.debug.getStacktraceHelper_(fn.caller, visited));\n    } catch (e) {\n      sb.push('[exception trying to get caller]\\n');\n    }\n\n  } else if (fn) {\n    sb.push('[...long stack...]');\n  } else {\n    sb.push('[end]');\n  }\n  return sb.join('');\n};\n\n\n/**\n * Set a custom function name resolver.\n * @param {function(Function): string} resolver Resolves functions to their\n *     names.\n */\ngoog.debug.setFunctionResolver = function(resolver) {\n  goog.debug.fnNameResolver_ = resolver;\n};\n\n\n/**\n * Gets a function name\n * @param {Function} fn Function to get name of.\n * @return {string} Function's name.\n */\ngoog.debug.getFunctionName = function(fn) {\n  if (goog.debug.fnNameCache_[fn]) {\n    return goog.debug.fnNameCache_[fn];\n  }\n  if (goog.debug.fnNameResolver_) {\n    var name = goog.debug.fnNameResolver_(fn);\n    if (name) {\n      goog.debug.fnNameCache_[fn] = name;\n      return name;\n    }\n  }\n\n  // Heuristically determine function name based on code.\n  var functionSource = String(fn);\n  if (!goog.debug.fnNameCache_[functionSource]) {\n    var matches = /function\\s+([^\\(]+)/m.exec(functionSource);\n    if (matches) {\n      var method = matches[1];\n      goog.debug.fnNameCache_[functionSource] = method;\n    } else {\n      goog.debug.fnNameCache_[functionSource] = '[Anonymous]';\n    }\n  }\n\n  return goog.debug.fnNameCache_[functionSource];\n};\n\n\n/**\n * Makes whitespace visible by replacing it with printable characters.\n * This is useful in finding diffrences between the expected and the actual\n * output strings of a testcase.\n * @param {string} string whose whitespace needs to be made visible.\n * @return {string} string whose whitespace is made visible.\n */\ngoog.debug.makeWhitespaceVisible = function(string) {\n  return string.replace(/ /g, '[_]')\n      .replace(/\\f/g, '[f]')\n      .replace(/\\n/g, '[n]\\n')\n      .replace(/\\r/g, '[r]')\n      .replace(/\\t/g, '[t]');\n};\n\n\n/**\n * Returns the type of a value. If a constructor is passed, and a suitable\n * string cannot be found, 'unknown type name' will be returned.\n *\n * <p>Forked rather than moved from {@link goog.asserts.getType_}\n * to avoid adding a dependency to goog.asserts.\n * @param {*} value A constructor, object, or primitive.\n * @return {string} The best display name for the value, or 'unknown type name'.\n */\ngoog.debug.runtimeType = function(value) {\n  if (value instanceof Function) {\n    return value.displayName || value.name || 'unknown type name';\n  } else if (value instanceof Object) {\n    return /** @type {string} */ (value.constructor.displayName) ||\n        value.constructor.name || Object.prototype.toString.call(value);\n  } else {\n    return value === null ? 'null' : typeof value;\n  }\n};\n\n\n/**\n * Hash map for storing function names that have already been looked up.\n * @type {Object}\n * @private\n */\ngoog.debug.fnNameCache_ = {};\n\n\n/**\n * Resolves functions to their names.  Resolved function names will be cached.\n * @type {function(Function):string}\n * @private\n */\ngoog.debug.fnNameResolver_;\n\n\n/**\n * Private internal function to support goog.debug.freeze.\n * @param {T} arg\n * @return {T}\n * @template T\n * @private\n */\ngoog.debug.freezeInternal_ = goog.DEBUG && Object.freeze || function(arg) {\n  return arg;\n};\n\n\n/**\n * Freezes the given object, but only in debug mode (and in browsers that\n * support it).  Note that this is a shallow freeze, so for deeply nested\n * objects it must be called at every level to ensure deep immutability.\n * @param {T} arg\n * @return {T}\n * @template T\n */\ngoog.debug.freeze = function(arg) {\n  // NOTE: this compiles to nothing, but hides the possible side effect of\n  // freezeInternal_ from the compiler so that the entire call can be\n  // removed if the result is not used.\n  return {\n    valueOf: function() {\n      return goog.debug.freezeInternal_(arg);\n    }\n  }.valueOf();\n};\n","// Copyright 2010 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Browser capability checks for the events package.\n *\n */\n\n\ngoog.provide('goog.events.BrowserFeature');\n\ngoog.require('goog.userAgent');\ngoog.scope(function() {\n\n\n\n/**\n * Enum of browser capabilities.\n * @enum {boolean}\n */\ngoog.events.BrowserFeature = {\n  /**\n   * Whether the button attribute of the event is W3C compliant.  False in\n   * Internet Explorer prior to version 9; document-version dependent.\n   */\n  HAS_W3C_BUTTON:\n      !goog.userAgent.IE || goog.userAgent.isDocumentModeOrHigher(9),\n\n  /**\n   * Whether the browser supports full W3C event model.\n   */\n  HAS_W3C_EVENT_SUPPORT:\n      !goog.userAgent.IE || goog.userAgent.isDocumentModeOrHigher(9),\n\n  /**\n   * To prevent default in IE7-8 for certain keydown events we need set the\n   * keyCode to -1.\n   */\n  SET_KEY_CODE_TO_PREVENT_DEFAULT:\n      goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('9'),\n\n  /**\n   * Whether the `navigator.onLine` property is supported.\n   */\n  HAS_NAVIGATOR_ONLINE_PROPERTY:\n      !goog.userAgent.WEBKIT || goog.userAgent.isVersionOrHigher('528'),\n\n  /**\n   * Whether HTML5 network online/offline events are supported.\n   */\n  HAS_HTML5_NETWORK_EVENT_SUPPORT:\n      goog.userAgent.GECKO && goog.userAgent.isVersionOrHigher('1.9b') ||\n      goog.userAgent.IE && goog.userAgent.isVersionOrHigher('8') ||\n      goog.userAgent.OPERA && goog.userAgent.isVersionOrHigher('9.5') ||\n      goog.userAgent.WEBKIT && goog.userAgent.isVersionOrHigher('528'),\n\n  /**\n   * Whether HTML5 network events fire on document.body, or otherwise the\n   * window.\n   */\n  HTML5_NETWORK_EVENTS_FIRE_ON_BODY:\n      goog.userAgent.GECKO && !goog.userAgent.isVersionOrHigher('8') ||\n      goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('9'),\n\n  /**\n   * Whether touch is enabled in the browser.\n   */\n  TOUCH_ENABLED:\n      ('ontouchstart' in goog.global ||\n       !!(goog.global['document'] && document.documentElement &&\n          'ontouchstart' in document.documentElement) ||\n       // IE10 uses non-standard touch events, so it has a different check.\n       !!(goog.global['navigator'] &&\n          (goog.global['navigator']['maxTouchPoints'] ||\n           goog.global['navigator']['msMaxTouchPoints']))),\n\n  /**\n   * Whether addEventListener supports W3C standard pointer events.\n   * http://www.w3.org/TR/pointerevents/\n   */\n  POINTER_EVENTS: ('PointerEvent' in goog.global),\n\n  /**\n   * Whether addEventListener supports MSPointer events (only used in IE10).\n   * http://msdn.microsoft.com/en-us/library/ie/hh772103(v=vs.85).aspx\n   * http://msdn.microsoft.com/library/hh673557(v=vs.85).aspx\n   */\n  MSPOINTER_EVENTS:\n      ('MSPointerEvent' in goog.global &&\n       !!(goog.global['navigator'] &&\n          goog.global['navigator']['msPointerEnabled'])),\n\n  /**\n   * Whether addEventListener supports {passive: true}.\n   * https://developers.google.com/web/updates/2016/06/passive-event-listeners\n   */\n  PASSIVE_EVENTS: purify(function() {\n    // If we're in a web worker or other custom environment, we can't tell.\n    if (!goog.global.addEventListener || !Object.defineProperty) {  // IE 8\n      return false;\n    }\n\n    var passive = false;\n    var options = Object.defineProperty({}, 'passive', {\n      get: function() {\n        passive = true;\n      }\n    });\n    try {\n      goog.global.addEventListener('test', goog.nullFunction, options);\n      goog.global.removeEventListener('test', goog.nullFunction, options);\n    } catch (e) {\n    }\n\n    return passive;\n  })\n};\n\n\n/**\n * Tricks Closure Compiler into believing that a function is pure.  The compiler\n * assumes that any `valueOf` function is pure, without analyzing its contents.\n *\n * @param {function(): T} fn\n * @return {T}\n * @template T\n */\nfunction purify(fn) {\n  return ({valueOf: fn}).valueOf();\n}\n});  // goog.scope\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A base class for event objects.\n *\n */\n\n\ngoog.provide('goog.events.Event');\ngoog.provide('goog.events.EventLike');\n\n/**\n * goog.events.Event no longer depends on goog.Disposable. Keep requiring\n * goog.Disposable here to not break projects which assume this dependency.\n * @suppress {extraRequire}\n */\ngoog.require('goog.Disposable');\ngoog.require('goog.events.EventId');\n\n\n/**\n * A typedef for event like objects that are dispatchable via the\n * goog.events.dispatchEvent function. strings are treated as the type for a\n * goog.events.Event. Objects are treated as an extension of a new\n * goog.events.Event with the type property of the object being used as the type\n * of the Event.\n * @typedef {string|Object|goog.events.Event|goog.events.EventId}\n */\ngoog.events.EventLike;\n\n\n\n/**\n * A base class for event objects, so that they can support preventDefault and\n * stopPropagation.\n *\n * @suppress {underscore} Several properties on this class are technically\n *     public, but referencing these properties outside this package is strongly\n *     discouraged.\n *\n * @param {string|!goog.events.EventId} type Event Type.\n * @param {Object=} opt_target Reference to the object that is the target of\n *     this event. It has to implement the `EventTarget` interface\n *     declared at {@link http://developer.mozilla.org/en/DOM/EventTarget}.\n * @constructor\n */\ngoog.events.Event = function(type, opt_target) {\n  /**\n   * Event type.\n   * @type {string}\n   */\n  this.type = type instanceof goog.events.EventId ? String(type) : type;\n\n  /**\n   * TODO(tbreisacher): The type should probably be\n   * EventTarget|goog.events.EventTarget.\n   *\n   * Target of the event.\n   * @type {Object|undefined}\n   */\n  this.target = opt_target;\n\n  /**\n   * Object that had the listener attached.\n   * @type {Object|undefined}\n   */\n  this.currentTarget = this.target;\n\n  /**\n   * Whether to cancel the event in internal capture/bubble processing for IE.\n   * @type {boolean}\n   * @public\n   */\n  this.propagationStopped_ = false;\n\n  /**\n   * Whether the default action has been prevented.\n   * This is a property to match the W3C specification at\n   * {@link http://www.w3.org/TR/DOM-Level-3-Events/\n   * #events-event-type-defaultPrevented}.\n   * Must be treated as read-only outside the class.\n   * @type {boolean}\n   */\n  this.defaultPrevented = false;\n\n  /**\n   * Return value for in internal capture/bubble processing for IE.\n   * @type {boolean}\n   * @public\n   */\n  this.returnValue_ = true;\n};\n\n\n/**\n * Stops event propagation.\n */\ngoog.events.Event.prototype.stopPropagation = function() {\n  this.propagationStopped_ = true;\n};\n\n\n/**\n * Prevents the default action, for example a link redirecting to a url.\n */\ngoog.events.Event.prototype.preventDefault = function() {\n  this.defaultPrevented = true;\n  this.returnValue_ = false;\n};\n\n\n/**\n * Stops the propagation of the event. It is equivalent to\n * `e.stopPropagation()`, but can be used as the callback argument of\n * {@link goog.events.listen} without declaring another function.\n * @param {!goog.events.Event} e An event.\n */\ngoog.events.Event.stopPropagation = function(e) {\n  e.stopPropagation();\n};\n\n\n/**\n * Prevents the default action. It is equivalent to\n * `e.preventDefault()`, but can be used as the callback argument of\n * {@link goog.events.listen} without declaring another function.\n * @param {!goog.events.Event} e An event.\n */\ngoog.events.Event.preventDefault = function(e) {\n  e.preventDefault();\n};\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A patched, standardized event object for browser events.\n *\n * <pre>\n * The patched event object contains the following members:\n * - type           {string}    Event type, e.g. 'click'\n * - target         {Object}    The element that actually triggered the event\n * - currentTarget  {Object}    The element the listener is attached to\n * - relatedTarget  {Object}    For mouseover and mouseout, the previous object\n * - offsetX        {number}    X-coordinate relative to target\n * - offsetY        {number}    Y-coordinate relative to target\n * - clientX        {number}    X-coordinate relative to viewport\n * - clientY        {number}    Y-coordinate relative to viewport\n * - screenX        {number}    X-coordinate relative to the edge of the screen\n * - screenY        {number}    Y-coordinate relative to the edge of the screen\n * - button         {number}    Mouse button. Use isButton() to test.\n * - keyCode        {number}    Key-code\n * - ctrlKey        {boolean}   Was ctrl key depressed\n * - altKey         {boolean}   Was alt key depressed\n * - shiftKey       {boolean}   Was shift key depressed\n * - metaKey        {boolean}   Was meta key depressed\n * - pointerId      {number}    Pointer ID\n * - pointerType    {string}    Pointer type, e.g. 'mouse', 'pen', or 'touch'\n * - defaultPrevented {boolean} Whether the default action has been prevented\n * - state          {Object}    History state object\n *\n * NOTE: The keyCode member contains the raw browser keyCode. For normalized\n * key and character code use {@link goog.events.KeyHandler}.\n * </pre>\n *\n * @author arv@google.com (Erik Arvidsson)\n */\n\ngoog.provide('goog.events.BrowserEvent');\ngoog.provide('goog.events.BrowserEvent.MouseButton');\ngoog.provide('goog.events.BrowserEvent.PointerType');\n\ngoog.require('goog.debug');\ngoog.require('goog.events.BrowserFeature');\ngoog.require('goog.events.Event');\ngoog.require('goog.events.EventType');\ngoog.require('goog.reflect');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * Accepts a browser event object and creates a patched, cross browser event\n * object.\n * The content of this object will not be initialized if no event object is\n * provided. If this is the case, init() needs to be invoked separately.\n * @param {Event=} opt_e Browser event object.\n * @param {EventTarget=} opt_currentTarget Current target for event.\n * @constructor\n * @extends {goog.events.Event}\n */\ngoog.events.BrowserEvent = function(opt_e, opt_currentTarget) {\n  goog.events.BrowserEvent.base(this, 'constructor', opt_e ? opt_e.type : '');\n\n  /**\n   * Target that fired the event.\n   * @override\n   * @type {Node}\n   */\n  this.target = null;\n\n  /**\n   * Node that had the listener attached.\n   * @override\n   * @type {Node|undefined}\n   */\n  this.currentTarget = null;\n\n  /**\n   * For mouseover and mouseout events, the related object for the event.\n   * @type {Node}\n   */\n  this.relatedTarget = null;\n\n  /**\n   * X-coordinate relative to target.\n   * @type {number}\n   */\n  this.offsetX = 0;\n\n  /**\n   * Y-coordinate relative to target.\n   * @type {number}\n   */\n  this.offsetY = 0;\n\n  /**\n   * X-coordinate relative to the window.\n   * @type {number}\n   */\n  this.clientX = 0;\n\n  /**\n   * Y-coordinate relative to the window.\n   * @type {number}\n   */\n  this.clientY = 0;\n\n  /**\n   * X-coordinate relative to the monitor.\n   * @type {number}\n   */\n  this.screenX = 0;\n\n  /**\n   * Y-coordinate relative to the monitor.\n   * @type {number}\n   */\n  this.screenY = 0;\n\n  /**\n   * Which mouse button was pressed.\n   * @type {number}\n   */\n  this.button = 0;\n\n  /**\n   * Key of key press.\n   * @type {string}\n   */\n  this.key = '';\n\n  /**\n   * Keycode of key press.\n   * @type {number}\n   */\n  this.keyCode = 0;\n\n  /**\n   * Keycode of key press.\n   * @type {number}\n   */\n  this.charCode = 0;\n\n  /**\n   * Whether control was pressed at time of event.\n   * @type {boolean}\n   */\n  this.ctrlKey = false;\n\n  /**\n   * Whether alt was pressed at time of event.\n   * @type {boolean}\n   */\n  this.altKey = false;\n\n  /**\n   * Whether shift was pressed at time of event.\n   * @type {boolean}\n   */\n  this.shiftKey = false;\n\n  /**\n   * Whether the meta key was pressed at time of event.\n   * @type {boolean}\n   */\n  this.metaKey = false;\n\n  /**\n   * History state object, only set for PopState events where it's a copy of the\n   * state object provided to pushState or replaceState.\n   * @type {Object}\n   */\n  this.state = null;\n\n  /**\n   * Whether the default platform modifier key was pressed at time of event.\n   * (This is control for all platforms except Mac, where it's Meta.)\n   * @type {boolean}\n   */\n  this.platformModifierKey = false;\n\n  /**\n   * @type {number}\n   */\n  this.pointerId = 0;\n\n  /**\n   * @type {string}\n   */\n  this.pointerType = '';\n\n  /**\n   * The browser event object.\n   * @private {Event}\n   */\n  this.event_ = null;\n\n  if (opt_e) {\n    this.init(opt_e, opt_currentTarget);\n  }\n};\ngoog.inherits(goog.events.BrowserEvent, goog.events.Event);\n\n\n/**\n * Normalized button constants for the mouse.\n * @enum {number}\n */\ngoog.events.BrowserEvent.MouseButton = {\n  LEFT: 0,\n  MIDDLE: 1,\n  RIGHT: 2\n};\n\n\n/**\n * Normalized pointer type constants for pointer events.\n * @enum {string}\n */\ngoog.events.BrowserEvent.PointerType = {\n  MOUSE: 'mouse',\n  PEN: 'pen',\n  TOUCH: 'touch'\n};\n\n\n/**\n * Static data for mapping mouse buttons.\n * @type {!Array<number>}\n * @deprecated Use `goog.events.BrowserEvent.IE_BUTTON_MAP` instead.\n */\ngoog.events.BrowserEvent.IEButtonMap = goog.debug.freeze([\n  1,  // LEFT\n  4,  // MIDDLE\n  2   // RIGHT\n]);\n\n\n/**\n * Static data for mapping mouse buttons.\n * @const {!Array<number>}\n */\ngoog.events.BrowserEvent.IE_BUTTON_MAP = goog.events.BrowserEvent.IEButtonMap;\n\n\n/**\n * Static data for mapping MSPointerEvent types to PointerEvent types.\n * @const {!Object<number, goog.events.BrowserEvent.PointerType>}\n */\ngoog.events.BrowserEvent.IE_POINTER_TYPE_MAP = goog.debug.freeze({\n  2: goog.events.BrowserEvent.PointerType.TOUCH,\n  3: goog.events.BrowserEvent.PointerType.PEN,\n  4: goog.events.BrowserEvent.PointerType.MOUSE\n});\n\n\n/**\n * Accepts a browser event object and creates a patched, cross browser event\n * object.\n * @param {Event} e Browser event object.\n * @param {EventTarget=} opt_currentTarget Current target for event.\n */\ngoog.events.BrowserEvent.prototype.init = function(e, opt_currentTarget) {\n  var type = this.type = e.type;\n\n  /**\n   * On touch devices use the first \"changed touch\" as the relevant touch.\n   * @type {Touch}\n   */\n  var relevantTouch = e.changedTouches ? e.changedTouches[0] : null;\n\n  // TODO(nicksantos): Change this.target to type EventTarget.\n  this.target = /** @type {Node} */ (e.target) || e.srcElement;\n\n  // TODO(nicksantos): Change this.currentTarget to type EventTarget.\n  this.currentTarget = /** @type {Node} */ (opt_currentTarget);\n\n  var relatedTarget = /** @type {Node} */ (e.relatedTarget);\n  if (relatedTarget) {\n    // There's a bug in FireFox where sometimes, relatedTarget will be a\n    // chrome element, and accessing any property of it will get a permission\n    // denied exception. See:\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=497780\n    if (goog.userAgent.GECKO) {\n      if (!goog.reflect.canAccessProperty(relatedTarget, 'nodeName')) {\n        relatedTarget = null;\n      }\n    }\n  } else if (type == goog.events.EventType.MOUSEOVER) {\n    relatedTarget = e.fromElement;\n  } else if (type == goog.events.EventType.MOUSEOUT) {\n    relatedTarget = e.toElement;\n  }\n\n  this.relatedTarget = relatedTarget;\n\n  if (!goog.isNull(relevantTouch)) {\n    this.clientX = relevantTouch.clientX !== undefined ? relevantTouch.clientX :\n                                                         relevantTouch.pageX;\n    this.clientY = relevantTouch.clientY !== undefined ? relevantTouch.clientY :\n                                                         relevantTouch.pageY;\n    this.screenX = relevantTouch.screenX || 0;\n    this.screenY = relevantTouch.screenY || 0;\n  } else {\n    // Webkit emits a lame warning whenever layerX/layerY is accessed.\n    // http://code.google.com/p/chromium/issues/detail?id=101733\n    this.offsetX = (goog.userAgent.WEBKIT || e.offsetX !== undefined) ?\n        e.offsetX :\n        e.layerX;\n    this.offsetY = (goog.userAgent.WEBKIT || e.offsetY !== undefined) ?\n        e.offsetY :\n        e.layerY;\n    this.clientX = e.clientX !== undefined ? e.clientX : e.pageX;\n    this.clientY = e.clientY !== undefined ? e.clientY : e.pageY;\n    this.screenX = e.screenX || 0;\n    this.screenY = e.screenY || 0;\n  }\n\n  this.button = e.button;\n\n  this.keyCode = e.keyCode || 0;\n  this.key = e.key || '';\n  this.charCode = e.charCode || (type == 'keypress' ? e.keyCode : 0);\n  this.ctrlKey = e.ctrlKey;\n  this.altKey = e.altKey;\n  this.shiftKey = e.shiftKey;\n  this.metaKey = e.metaKey;\n  this.platformModifierKey = goog.userAgent.MAC ? e.metaKey : e.ctrlKey;\n  this.pointerId = e.pointerId || 0;\n  this.pointerType = goog.events.BrowserEvent.getPointerType_(e);\n  this.state = e.state;\n  this.event_ = e;\n  if (e.defaultPrevented) {\n    this.preventDefault();\n  }\n};\n\n\n/**\n * Tests to see which button was pressed during the event. This is really only\n * useful in IE and Gecko browsers. And in IE, it's only useful for\n * mousedown/mouseup events, because click only fires for the left mouse button.\n *\n * Safari 2 only reports the left button being clicked, and uses the value '1'\n * instead of 0. Opera only reports a mousedown event for the middle button, and\n * no mouse events for the right button. Opera has default behavior for left and\n * middle click that can only be overridden via a configuration setting.\n *\n * There's a nice table of this mess at http://www.unixpapa.com/js/mouse.html.\n *\n * @param {goog.events.BrowserEvent.MouseButton} button The button\n *     to test for.\n * @return {boolean} True if button was pressed.\n */\ngoog.events.BrowserEvent.prototype.isButton = function(button) {\n  if (!goog.events.BrowserFeature.HAS_W3C_BUTTON) {\n    if (this.type == 'click') {\n      return button == goog.events.BrowserEvent.MouseButton.LEFT;\n    } else {\n      return !!(\n          this.event_.button & goog.events.BrowserEvent.IE_BUTTON_MAP[button]);\n    }\n  } else {\n    return this.event_.button == button;\n  }\n};\n\n\n/**\n * Whether this has an \"action\"-producing mouse button.\n *\n * By definition, this includes left-click on windows/linux, and left-click\n * without the ctrl key on Macs.\n *\n * @return {boolean} The result.\n */\ngoog.events.BrowserEvent.prototype.isMouseActionButton = function() {\n  // Webkit does not ctrl+click to be a right-click, so we\n  // normalize it to behave like Gecko and Opera.\n  return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT) &&\n      !(goog.userAgent.WEBKIT && goog.userAgent.MAC && this.ctrlKey);\n};\n\n\n/**\n * @override\n */\ngoog.events.BrowserEvent.prototype.stopPropagation = function() {\n  goog.events.BrowserEvent.superClass_.stopPropagation.call(this);\n  if (this.event_.stopPropagation) {\n    this.event_.stopPropagation();\n  } else {\n    this.event_.cancelBubble = true;\n  }\n};\n\n\n/**\n * @override\n */\ngoog.events.BrowserEvent.prototype.preventDefault = function() {\n  goog.events.BrowserEvent.superClass_.preventDefault.call(this);\n  var be = this.event_;\n  if (!be.preventDefault) {\n    be.returnValue = false;\n    if (goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT) {\n\n      try {\n        // Most keys can be prevented using returnValue. Some special keys\n        // require setting the keyCode to -1 as well:\n        //\n        // In IE7:\n        // F3, F5, F10, F11, Ctrl+P, Crtl+O, Ctrl+F (these are taken from IE6)\n        //\n        // In IE8:\n        // Ctrl+P, Crtl+O, Ctrl+F (F1-F12 cannot be stopped through the event)\n        //\n        // We therefore do this for all function keys as well as when Ctrl key\n        // is pressed.\n        var VK_F1 = 112;\n        var VK_F12 = 123;\n        if (be.ctrlKey || be.keyCode >= VK_F1 && be.keyCode <= VK_F12) {\n          be.keyCode = -1;\n        }\n      } catch (ex) {\n        // IE throws an 'access denied' exception when trying to change\n        // keyCode in some situations (e.g. srcElement is input[type=file],\n        // or srcElement is an anchor tag rewritten by parent's innerHTML).\n        // Do nothing in this case.\n      }\n    }\n  } else {\n    be.preventDefault();\n  }\n};\n\n\n/**\n * @return {Event} The underlying browser event object.\n */\ngoog.events.BrowserEvent.prototype.getBrowserEvent = function() {\n  return this.event_;\n};\n\n\n/**\n * Extracts the pointer type from the given event.\n * @param {!Event} e\n * @return {string} The pointer type, e.g. 'mouse', 'pen', or 'touch'.\n * @private\n */\ngoog.events.BrowserEvent.getPointerType_ = function(e) {\n  if (goog.isString(e.pointerType)) {\n    return e.pointerType;\n  }\n  // IE10 uses integer codes for pointer type.\n  // https://msdn.microsoft.com/en-us/library/hh772359(v=vs.85).aspx\n  return goog.events.BrowserEvent.IE_POINTER_TYPE_MAP[e.pointerType] || '';\n};\n","// Copyright 2010 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Event Types.\n *\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\ngoog.provide('goog.events.EventType');\ngoog.provide('goog.events.PointerAsMouseEventType');\ngoog.provide('goog.events.PointerAsTouchEventType');\ngoog.provide('goog.events.PointerFallbackEventType');\ngoog.provide('goog.events.PointerTouchFallbackEventType');\n\ngoog.require('goog.events.BrowserFeature');\ngoog.require('goog.userAgent');\n\n\n/**\n * Returns a prefixed event name for the current browser.\n * @param {string} eventName The name of the event.\n * @return {string} The prefixed event name.\n * @suppress {missingRequire|missingProvide}\n * @private\n */\ngoog.events.getVendorPrefixedName_ = function(eventName) {\n  return goog.userAgent.WEBKIT ?\n      'webkit' + eventName :\n      (goog.userAgent.OPERA ? 'o' + eventName.toLowerCase() :\n                              eventName.toLowerCase());\n};\n\n\n/**\n * Constants for event names.\n * @enum {string}\n */\ngoog.events.EventType = {\n  // Mouse events\n  CLICK: 'click',\n  RIGHTCLICK: 'rightclick',\n  DBLCLICK: 'dblclick',\n  MOUSEDOWN: 'mousedown',\n  MOUSEUP: 'mouseup',\n  MOUSEOVER: 'mouseover',\n  MOUSEOUT: 'mouseout',\n  MOUSEMOVE: 'mousemove',\n  MOUSEENTER: 'mouseenter',\n  MOUSELEAVE: 'mouseleave',\n\n  // Non-existent event; will never fire. This exists as a mouse counterpart to\n  // POINTERCANCEL.\n  MOUSECANCEL: 'mousecancel',\n\n  // Selection events.\n  // https://www.w3.org/TR/selection-api/\n  SELECTIONCHANGE: 'selectionchange',\n  SELECTSTART: 'selectstart',  // IE, Safari, Chrome\n\n  // Wheel events\n  // http://www.w3.org/TR/DOM-Level-3-Events/#events-wheelevents\n  WHEEL: 'wheel',\n\n  // Key events\n  KEYPRESS: 'keypress',\n  KEYDOWN: 'keydown',\n  KEYUP: 'keyup',\n\n  // Focus\n  BLUR: 'blur',\n  FOCUS: 'focus',\n  DEACTIVATE: 'deactivate',  // IE only\n  FOCUSIN: 'focusin',\n  FOCUSOUT: 'focusout',\n\n  // Forms\n  CHANGE: 'change',\n  RESET: 'reset',\n  SELECT: 'select',\n  SUBMIT: 'submit',\n  INPUT: 'input',\n  PROPERTYCHANGE: 'propertychange',  // IE only\n\n  // Drag and drop\n  DRAGSTART: 'dragstart',\n  DRAG: 'drag',\n  DRAGENTER: 'dragenter',\n  DRAGOVER: 'dragover',\n  DRAGLEAVE: 'dragleave',\n  DROP: 'drop',\n  DRAGEND: 'dragend',\n\n  // Touch events\n  // Note that other touch events exist, but we should follow the W3C list here.\n  // http://www.w3.org/TR/touch-events/#list-of-touchevent-types\n  TOUCHSTART: 'touchstart',\n  TOUCHMOVE: 'touchmove',\n  TOUCHEND: 'touchend',\n  TOUCHCANCEL: 'touchcancel',\n\n  // Misc\n  BEFOREUNLOAD: 'beforeunload',\n  CONSOLEMESSAGE: 'consolemessage',\n  CONTEXTMENU: 'contextmenu',\n  DEVICECHANGE: 'devicechange',\n  DEVICEMOTION: 'devicemotion',\n  DEVICEORIENTATION: 'deviceorientation',\n  DOMCONTENTLOADED: 'DOMContentLoaded',\n  ERROR: 'error',\n  HELP: 'help',\n  LOAD: 'load',\n  LOSECAPTURE: 'losecapture',\n  ORIENTATIONCHANGE: 'orientationchange',\n  READYSTATECHANGE: 'readystatechange',\n  RESIZE: 'resize',\n  SCROLL: 'scroll',\n  UNLOAD: 'unload',\n\n  // Media events\n  CANPLAY: 'canplay',\n  CANPLAYTHROUGH: 'canplaythrough',\n  DURATIONCHANGE: 'durationchange',\n  EMPTIED: 'emptied',\n  ENDED: 'ended',\n  LOADEDDATA: 'loadeddata',\n  LOADEDMETADATA: 'loadedmetadata',\n  PAUSE: 'pause',\n  PLAY: 'play',\n  PLAYING: 'playing',\n  RATECHANGE: 'ratechange',\n  SEEKED: 'seeked',\n  SEEKING: 'seeking',\n  STALLED: 'stalled',\n  SUSPEND: 'suspend',\n  TIMEUPDATE: 'timeupdate',\n  VOLUMECHANGE: 'volumechange',\n  WAITING: 'waiting',\n\n  // Media Source Extensions events\n  // https://www.w3.org/TR/media-source/#mediasource-events\n  SOURCEOPEN: 'sourceopen',\n  SOURCEENDED: 'sourceended',\n  SOURCECLOSED: 'sourceclosed',\n  // https://www.w3.org/TR/media-source/#sourcebuffer-events\n  ABORT: 'abort',\n  UPDATE: 'update',\n  UPDATESTART: 'updatestart',\n  UPDATEEND: 'updateend',\n\n  // HTML 5 History events\n  // See http://www.w3.org/TR/html5/browsers.html#event-definitions-0\n  HASHCHANGE: 'hashchange',\n  PAGEHIDE: 'pagehide',\n  PAGESHOW: 'pageshow',\n  POPSTATE: 'popstate',\n\n  // Copy and Paste\n  // Support is limited. Make sure it works on your favorite browser\n  // before using.\n  // http://www.quirksmode.org/dom/events/cutcopypaste.html\n  COPY: 'copy',\n  PASTE: 'paste',\n  CUT: 'cut',\n  BEFORECOPY: 'beforecopy',\n  BEFORECUT: 'beforecut',\n  BEFOREPASTE: 'beforepaste',\n\n  // HTML5 online/offline events.\n  // http://www.w3.org/TR/offline-webapps/#related\n  ONLINE: 'online',\n  OFFLINE: 'offline',\n\n  // HTML 5 worker events\n  MESSAGE: 'message',\n  CONNECT: 'connect',\n\n  // Service Worker Events - ServiceWorkerGlobalScope context\n  // See https://w3c.github.io/ServiceWorker/#execution-context-events\n  // Note: message event defined in worker events section\n  INSTALL: 'install',\n  ACTIVATE: 'activate',\n  FETCH: 'fetch',\n  FOREIGNFETCH: 'foreignfetch',\n  MESSAGEERROR: 'messageerror',\n\n  // Service Worker Events - Document context\n  // See https://w3c.github.io/ServiceWorker/#document-context-events\n  STATECHANGE: 'statechange',\n  UPDATEFOUND: 'updatefound',\n  CONTROLLERCHANGE: 'controllerchange',\n\n  // CSS animation events.\n  /** @suppress {missingRequire} */\n  ANIMATIONSTART: goog.events.getVendorPrefixedName_('AnimationStart'),\n  /** @suppress {missingRequire} */\n  ANIMATIONEND: goog.events.getVendorPrefixedName_('AnimationEnd'),\n  /** @suppress {missingRequire} */\n  ANIMATIONITERATION: goog.events.getVendorPrefixedName_('AnimationIteration'),\n\n  // CSS transition events. Based on the browser support described at:\n  // https://developer.mozilla.org/en/css/css_transitions#Browser_compatibility\n  /** @suppress {missingRequire} */\n  TRANSITIONEND: goog.events.getVendorPrefixedName_('TransitionEnd'),\n\n  // W3C Pointer Events\n  // http://www.w3.org/TR/pointerevents/\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTERCANCEL: 'pointercancel',\n  POINTERMOVE: 'pointermove',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  GOTPOINTERCAPTURE: 'gotpointercapture',\n  LOSTPOINTERCAPTURE: 'lostpointercapture',\n\n  // IE specific events.\n  // See http://msdn.microsoft.com/en-us/library/ie/hh772103(v=vs.85).aspx\n  // Note: these events will be supplanted in IE11.\n  MSGESTURECHANGE: 'MSGestureChange',\n  MSGESTUREEND: 'MSGestureEnd',\n  MSGESTUREHOLD: 'MSGestureHold',\n  MSGESTURESTART: 'MSGestureStart',\n  MSGESTURETAP: 'MSGestureTap',\n  MSGOTPOINTERCAPTURE: 'MSGotPointerCapture',\n  MSINERTIASTART: 'MSInertiaStart',\n  MSLOSTPOINTERCAPTURE: 'MSLostPointerCapture',\n  MSPOINTERCANCEL: 'MSPointerCancel',\n  MSPOINTERDOWN: 'MSPointerDown',\n  MSPOINTERENTER: 'MSPointerEnter',\n  MSPOINTERHOVER: 'MSPointerHover',\n  MSPOINTERLEAVE: 'MSPointerLeave',\n  MSPOINTERMOVE: 'MSPointerMove',\n  MSPOINTEROUT: 'MSPointerOut',\n  MSPOINTEROVER: 'MSPointerOver',\n  MSPOINTERUP: 'MSPointerUp',\n\n  // Native IMEs/input tools events.\n  TEXT: 'text',\n  // The textInput event is supported in IE9+, but only in lower case. All other\n  // browsers use the camel-case event name.\n  TEXTINPUT: goog.userAgent.IE ? 'textinput' : 'textInput',\n  COMPOSITIONSTART: 'compositionstart',\n  COMPOSITIONUPDATE: 'compositionupdate',\n  COMPOSITIONEND: 'compositionend',\n\n  // The beforeinput event is initially only supported in Safari. See\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=342670 for Chrome\n  // implementation tracking.\n  BEFOREINPUT: 'beforeinput',\n\n  // Webview tag events\n  // See https://developer.chrome.com/apps/tags/webview\n  EXIT: 'exit',\n  LOADABORT: 'loadabort',\n  LOADCOMMIT: 'loadcommit',\n  LOADREDIRECT: 'loadredirect',\n  LOADSTART: 'loadstart',\n  LOADSTOP: 'loadstop',\n  RESPONSIVE: 'responsive',\n  SIZECHANGED: 'sizechanged',\n  UNRESPONSIVE: 'unresponsive',\n\n  // HTML5 Page Visibility API.  See details at\n  // `goog.labs.dom.PageVisibilityMonitor`.\n  VISIBILITYCHANGE: 'visibilitychange',\n\n  // LocalStorage event.\n  STORAGE: 'storage',\n\n  // DOM Level 2 mutation events (deprecated).\n  DOMSUBTREEMODIFIED: 'DOMSubtreeModified',\n  DOMNODEINSERTED: 'DOMNodeInserted',\n  DOMNODEREMOVED: 'DOMNodeRemoved',\n  DOMNODEREMOVEDFROMDOCUMENT: 'DOMNodeRemovedFromDocument',\n  DOMNODEINSERTEDINTODOCUMENT: 'DOMNodeInsertedIntoDocument',\n  DOMATTRMODIFIED: 'DOMAttrModified',\n  DOMCHARACTERDATAMODIFIED: 'DOMCharacterDataModified',\n\n  // Print events.\n  BEFOREPRINT: 'beforeprint',\n  AFTERPRINT: 'afterprint',\n\n  // Web app manifest events.\n  BEFOREINSTALLPROMPT: 'beforeinstallprompt',\n  APPINSTALLED: 'appinstalled'\n};\n\n\n/**\n * Returns one of the given pointer fallback event names in order of preference:\n *   1. pointerEventName\n *   2. msPointerEventName\n *   3. fallbackEventName\n * @param {string} pointerEventName\n * @param {string} msPointerEventName\n * @param {string} fallbackEventName\n * @return {string} The supported pointer or fallback (mouse or touch) event\n *     name.\n * @private\n */\ngoog.events.getPointerFallbackEventName_ = function(\n    pointerEventName, msPointerEventName, fallbackEventName) {\n  if (goog.events.BrowserFeature.POINTER_EVENTS) {\n    return pointerEventName;\n  }\n  if (goog.events.BrowserFeature.MSPOINTER_EVENTS) {\n    return msPointerEventName;\n  }\n  return fallbackEventName;\n};\n\n\n/**\n * Constants for pointer event names that fall back to corresponding mouse event\n * names on unsupported platforms. These are intended to be drop-in replacements\n * for corresponding values in `goog.events.EventType`.\n * @enum {string}\n */\ngoog.events.PointerFallbackEventType = {\n  POINTERDOWN: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTERDOWN, goog.events.EventType.MSPOINTERDOWN,\n      goog.events.EventType.MOUSEDOWN),\n  POINTERUP: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTERUP, goog.events.EventType.MSPOINTERUP,\n      goog.events.EventType.MOUSEUP),\n  POINTERCANCEL: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTERCANCEL,\n      goog.events.EventType.MSPOINTERCANCEL,\n      // When falling back to mouse events, there is no MOUSECANCEL equivalent\n      // of POINTERCANCEL. In this case POINTERUP already falls back to MOUSEUP\n      // which represents both UP and CANCEL. POINTERCANCEL does not fall back\n      // to MOUSEUP to prevent listening twice on the same event.\n      goog.events.EventType.MOUSECANCEL),\n  POINTERMOVE: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTERMOVE, goog.events.EventType.MSPOINTERMOVE,\n      goog.events.EventType.MOUSEMOVE),\n  POINTEROVER: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTEROVER, goog.events.EventType.MSPOINTEROVER,\n      goog.events.EventType.MOUSEOVER),\n  POINTEROUT: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTEROUT, goog.events.EventType.MSPOINTEROUT,\n      goog.events.EventType.MOUSEOUT),\n  POINTERENTER: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTERENTER, goog.events.EventType.MSPOINTERENTER,\n      goog.events.EventType.MOUSEENTER),\n  POINTERLEAVE: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTERLEAVE, goog.events.EventType.MSPOINTERLEAVE,\n      goog.events.EventType.MOUSELEAVE)\n};\n\n\n/**\n * Constants for pointer event names that fall back to corresponding touch event\n * names on unsupported platforms. These are intended to be drop-in replacements\n * for corresponding values in `goog.events.EventType`.\n * @enum {string}\n */\ngoog.events.PointerTouchFallbackEventType = {\n  POINTERDOWN: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTERDOWN, goog.events.EventType.MSPOINTERDOWN,\n      goog.events.EventType.TOUCHSTART),\n  POINTERUP: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTERUP, goog.events.EventType.MSPOINTERUP,\n      goog.events.EventType.TOUCHEND),\n  POINTERCANCEL: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTERCANCEL,\n      goog.events.EventType.MSPOINTERCANCEL, goog.events.EventType.TOUCHCANCEL),\n  POINTERMOVE: goog.events.getPointerFallbackEventName_(\n      goog.events.EventType.POINTERMOVE, goog.events.EventType.MSPOINTERMOVE,\n      goog.events.EventType.TOUCHMOVE)\n};\n\n\n/**\n * An alias for `goog.events.EventType.MOUSE*` event types that is overridden by\n * corresponding `POINTER*` event types.\n * @enum {string}\n */\ngoog.events.PointerAsMouseEventType = {\n  MOUSEDOWN: goog.events.PointerFallbackEventType.POINTERDOWN,\n  MOUSEUP: goog.events.PointerFallbackEventType.POINTERUP,\n  MOUSECANCEL: goog.events.PointerFallbackEventType.POINTERCANCEL,\n  MOUSEMOVE: goog.events.PointerFallbackEventType.POINTERMOVE,\n  MOUSEOVER: goog.events.PointerFallbackEventType.POINTEROVER,\n  MOUSEOUT: goog.events.PointerFallbackEventType.POINTEROUT,\n  MOUSEENTER: goog.events.PointerFallbackEventType.POINTERENTER,\n  MOUSELEAVE: goog.events.PointerFallbackEventType.POINTERLEAVE\n};\n\n\n/**\n * An alias for `goog.events.EventType.TOUCH*` event types that is overridden by\n * corresponding `POINTER*` event types.\n * @enum {string}\n */\ngoog.events.PointerAsTouchEventType = {\n  TOUCHCANCEL: goog.events.PointerTouchFallbackEventType.POINTERCANCEL,\n  TOUCHEND: goog.events.PointerTouchFallbackEventType.POINTERUP,\n  TOUCHMOVE: goog.events.PointerTouchFallbackEventType.POINTERMOVE,\n  TOUCHSTART: goog.events.PointerTouchFallbackEventType.POINTERDOWN\n};\n","// Copyright 2012 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview An interface for a listenable JavaScript object.\n * @author chrishenry@google.com (Chris Henry)\n */\n\ngoog.provide('goog.events.Listenable');\ngoog.provide('goog.events.ListenableKey');\n\n/** @suppress {extraRequire} */\ngoog.require('goog.events.EventId');\n\ngoog.forwardDeclare('goog.events.EventLike');\ngoog.forwardDeclare('goog.events.EventTarget');\n\n\n\n/**\n * A listenable interface. A listenable is an object with the ability\n * to dispatch/broadcast events to \"event listeners\" registered via\n * listen/listenOnce.\n *\n * The interface allows for an event propagation mechanism similar\n * to one offered by native browser event targets, such as\n * capture/bubble mechanism, stopping propagation, and preventing\n * default actions. Capture/bubble mechanism depends on the ancestor\n * tree constructed via `#getParentEventTarget`; this tree\n * must be directed acyclic graph. The meaning of default action(s)\n * in preventDefault is specific to a particular use case.\n *\n * Implementations that do not support capture/bubble or can not have\n * a parent listenable can simply not implement any ability to set the\n * parent listenable (and have `#getParentEventTarget` return\n * null).\n *\n * Implementation of this class can be used with or independently from\n * goog.events.\n *\n * Implementation must call `#addImplementation(implClass)`.\n *\n * @interface\n * @see goog.events\n * @see http://www.w3.org/TR/DOM-Level-2-Events/events.html\n */\ngoog.events.Listenable = function() {};\n\n\n/**\n * An expando property to indicate that an object implements\n * goog.events.Listenable.\n *\n * See addImplementation/isImplementedBy.\n *\n * @type {string}\n * @const\n */\ngoog.events.Listenable.IMPLEMENTED_BY_PROP =\n    'closure_listenable_' + ((Math.random() * 1e6) | 0);\n\n\n/**\n * Marks a given class (constructor) as an implementation of\n * Listenable, so that we can query that fact at runtime. The class\n * must have already implemented the interface.\n * @param {function(new:goog.events.Listenable,...)} cls The class constructor.\n *     The corresponding class must have already implemented the interface.\n */\ngoog.events.Listenable.addImplementation = function(cls) {\n  cls.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP] = true;\n};\n\n\n/**\n * @param {Object} obj The object to check.\n * @return {boolean} Whether a given instance implements Listenable. The\n *     class/superclass of the instance must call addImplementation.\n */\ngoog.events.Listenable.isImplementedBy = function(obj) {\n  return !!(obj && obj[goog.events.Listenable.IMPLEMENTED_BY_PROP]);\n};\n\n\n/**\n * Adds an event listener. A listener can only be added once to an\n * object and if it is added again the key for the listener is\n * returned. Note that if the existing listener is a one-off listener\n * (registered via listenOnce), it will no longer be a one-off\n * listener after a call to listen().\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>} type The event type id.\n * @param {function(this:SCOPE, EVENTOBJ):(boolean|undefined)} listener Callback\n *     method.\n * @param {boolean=} opt_useCapture Whether to fire in capture phase\n *     (defaults to false).\n * @param {SCOPE=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {!goog.events.ListenableKey} Unique key for the listener.\n * @template SCOPE,EVENTOBJ\n */\ngoog.events.Listenable.prototype.listen;\n\n\n/**\n * Adds an event listener that is removed automatically after the\n * listener fired once.\n *\n * If an existing listener already exists, listenOnce will do\n * nothing. In particular, if the listener was previously registered\n * via listen(), listenOnce() will not turn the listener into a\n * one-off listener. Similarly, if there is already an existing\n * one-off listener, listenOnce does not modify the listeners (it is\n * still a once listener).\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>} type The event type id.\n * @param {function(this:SCOPE, EVENTOBJ):(boolean|undefined)} listener Callback\n *     method.\n * @param {boolean=} opt_useCapture Whether to fire in capture phase\n *     (defaults to false).\n * @param {SCOPE=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {!goog.events.ListenableKey} Unique key for the listener.\n * @template SCOPE,EVENTOBJ\n */\ngoog.events.Listenable.prototype.listenOnce;\n\n\n/**\n * Removes an event listener which was added with listen() or listenOnce().\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>} type The event type id.\n * @param {function(this:SCOPE, EVENTOBJ):(boolean|undefined)} listener Callback\n *     method.\n * @param {boolean=} opt_useCapture Whether to fire in capture phase\n *     (defaults to false).\n * @param {SCOPE=} opt_listenerScope Object in whose scope to call\n *     the listener.\n * @return {boolean} Whether any listener was removed.\n * @template SCOPE,EVENTOBJ\n */\ngoog.events.Listenable.prototype.unlisten;\n\n\n/**\n * Removes an event listener which was added with listen() by the key\n * returned by listen().\n *\n * @param {!goog.events.ListenableKey} key The key returned by\n *     listen() or listenOnce().\n * @return {boolean} Whether any listener was removed.\n */\ngoog.events.Listenable.prototype.unlistenByKey;\n\n\n/**\n * Dispatches an event (or event like object) and calls all listeners\n * listening for events of this type. The type of the event is decided by the\n * type property on the event object.\n *\n * If any of the listeners returns false OR calls preventDefault then this\n * function will return false.  If one of the capture listeners calls\n * stopPropagation, then the bubble listeners won't fire.\n *\n * @param {goog.events.EventLike} e Event object.\n * @return {boolean} If anyone called preventDefault on the event object (or\n *     if any of the listeners returns false) this will also return false.\n */\ngoog.events.Listenable.prototype.dispatchEvent;\n\n\n/**\n * Removes all listeners from this listenable. If type is specified,\n * it will only remove listeners of the particular type. otherwise all\n * registered listeners will be removed.\n *\n * @param {string=} opt_type Type of event to remove, default is to\n *     remove all types.\n * @return {number} Number of listeners removed.\n */\ngoog.events.Listenable.prototype.removeAllListeners;\n\n\n/**\n * Returns the parent of this event target to use for capture/bubble\n * mechanism.\n *\n * NOTE(chrishenry): The name reflects the original implementation of\n * custom event target (`goog.events.EventTarget`). We decided\n * that changing the name is not worth it.\n *\n * @return {goog.events.Listenable} The parent EventTarget or null if\n *     there is no parent.\n */\ngoog.events.Listenable.prototype.getParentEventTarget;\n\n\n/**\n * Fires all registered listeners in this listenable for the given\n * type and capture mode, passing them the given eventObject. This\n * does not perform actual capture/bubble. Only implementors of the\n * interface should be using this.\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>} type The type of the\n *     listeners to fire.\n * @param {boolean} capture The capture mode of the listeners to fire.\n * @param {EVENTOBJ} eventObject The event object to fire.\n * @return {boolean} Whether all listeners succeeded without\n *     attempting to prevent default behavior. If any listener returns\n *     false or called goog.events.Event#preventDefault, this returns\n *     false.\n * @template EVENTOBJ\n */\ngoog.events.Listenable.prototype.fireListeners;\n\n\n/**\n * Gets all listeners in this listenable for the given type and\n * capture mode.\n *\n * @param {string|!goog.events.EventId} type The type of the listeners to fire.\n * @param {boolean} capture The capture mode of the listeners to fire.\n * @return {!Array<!goog.events.ListenableKey>} An array of registered\n *     listeners.\n * @template EVENTOBJ\n */\ngoog.events.Listenable.prototype.getListeners;\n\n\n/**\n * Gets the goog.events.ListenableKey for the event or null if no such\n * listener is in use.\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>} type The name of the event\n *     without the 'on' prefix.\n * @param {function(this:SCOPE, EVENTOBJ):(boolean|undefined)} listener The\n *     listener function to get.\n * @param {boolean} capture Whether the listener is a capturing listener.\n * @param {SCOPE=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {goog.events.ListenableKey} the found listener or null if not found.\n * @template SCOPE,EVENTOBJ\n */\ngoog.events.Listenable.prototype.getListener;\n\n\n/**\n * Whether there is any active listeners matching the specified\n * signature. If either the type or capture parameters are\n * unspecified, the function will match on the remaining criteria.\n *\n * @param {string|!goog.events.EventId<EVENTOBJ>=} opt_type Event type.\n * @param {boolean=} opt_capture Whether to check for capture or bubble\n *     listeners.\n * @return {boolean} Whether there is any active listeners matching\n *     the requested type and/or capture phase.\n * @template EVENTOBJ\n */\ngoog.events.Listenable.prototype.hasListener;\n\n\n\n/**\n * An interface that describes a single registered listener.\n * @interface\n */\ngoog.events.ListenableKey = function() {};\n\n\n/**\n * Counter used to create a unique key\n * @type {number}\n * @private\n */\ngoog.events.ListenableKey.counter_ = 0;\n\n\n/**\n * Reserves a key to be used for ListenableKey#key field.\n * @return {number} A number to be used to fill ListenableKey#key\n *     field.\n */\ngoog.events.ListenableKey.reserveKey = function() {\n  return ++goog.events.ListenableKey.counter_;\n};\n\n\n/**\n * The source event target.\n * @type {Object|goog.events.Listenable|goog.events.EventTarget}\n */\ngoog.events.ListenableKey.prototype.src;\n\n\n/**\n * The event type the listener is listening to.\n * @type {string}\n */\ngoog.events.ListenableKey.prototype.type;\n\n\n/**\n * The listener function.\n * @type {function(?):?|{handleEvent:function(?):?}|null}\n */\ngoog.events.ListenableKey.prototype.listener;\n\n\n/**\n * Whether the listener works on capture phase.\n * @type {boolean}\n */\ngoog.events.ListenableKey.prototype.capture;\n\n\n/**\n * The 'this' object for the listener function's scope.\n * @type {Object|undefined}\n */\ngoog.events.ListenableKey.prototype.handler;\n\n\n/**\n * A globally unique number to identify the key.\n * @type {number}\n */\ngoog.events.ListenableKey.prototype.key;\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Listener object.\n * @see ../demos/events.html\n */\n\ngoog.provide('goog.events.Listener');\n\ngoog.require('goog.events.ListenableKey');\n\n\n\n/**\n * Simple class that stores information about a listener\n * @param {function(?):?} listener Callback function.\n * @param {Function} proxy Wrapper for the listener that patches the event.\n * @param {EventTarget|goog.events.Listenable} src Source object for\n *     the event.\n * @param {string} type Event type.\n * @param {boolean} capture Whether in capture or bubble phase.\n * @param {Object=} opt_handler Object in whose context to execute the callback.\n * @implements {goog.events.ListenableKey}\n * @constructor\n */\ngoog.events.Listener = function(\n    listener, proxy, src, type, capture, opt_handler) {\n  if (goog.events.Listener.ENABLE_MONITORING) {\n    this.creationStack = new Error().stack;\n  }\n\n  /** @override */\n  this.listener = listener;\n\n  /**\n   * A wrapper over the original listener. This is used solely to\n   * handle native browser events (it is used to simulate the capture\n   * phase and to patch the event object).\n   * @type {Function}\n   */\n  this.proxy = proxy;\n\n  /**\n   * Object or node that callback is listening to\n   * @type {EventTarget|goog.events.Listenable}\n   */\n  this.src = src;\n\n  /**\n   * The event type.\n   * @const {string}\n   */\n  this.type = type;\n\n  /**\n   * Whether the listener is being called in the capture or bubble phase\n   * @const {boolean}\n   */\n  this.capture = !!capture;\n\n  /**\n   * Optional object whose context to execute the listener in\n   * @type {Object|undefined}\n   */\n  this.handler = opt_handler;\n\n  /**\n   * The key of the listener.\n   * @const {number}\n   * @override\n   */\n  this.key = goog.events.ListenableKey.reserveKey();\n\n  /**\n   * Whether to remove the listener after it has been called.\n   * @type {boolean}\n   */\n  this.callOnce = false;\n\n  /**\n   * Whether the listener has been removed.\n   * @type {boolean}\n   */\n  this.removed = false;\n};\n\n\n/**\n * @define {boolean} Whether to enable the monitoring of the\n *     goog.events.Listener instances. Switching on the monitoring is only\n *     recommended for debugging because it has a significant impact on\n *     performance and memory usage. If switched off, the monitoring code\n *     compiles down to 0 bytes.\n */\ngoog.define('goog.events.Listener.ENABLE_MONITORING', false);\n\n\n/**\n * If monitoring the goog.events.Listener instances is enabled, stores the\n * creation stack trace of the Disposable instance.\n * @type {string}\n */\ngoog.events.Listener.prototype.creationStack;\n\n\n/**\n * Marks this listener as removed. This also remove references held by\n * this listener object (such as listener and event source).\n */\ngoog.events.Listener.prototype.markAsRemoved = function() {\n  this.removed = true;\n  this.listener = null;\n  this.proxy = null;\n  this.src = null;\n  this.handler = null;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A map of listeners that provides utility functions to\n * deal with listeners on an event target. Used by\n * `goog.events.EventTarget`.\n *\n * WARNING: Do not use this class from outside goog.events package.\n */\n\ngoog.provide('goog.events.ListenerMap');\n\ngoog.require('goog.array');\ngoog.require('goog.events.Listener');\ngoog.require('goog.object');\n\n\n\n/**\n * Creates a new listener map.\n * @param {EventTarget|goog.events.Listenable} src The src object.\n * @constructor\n * @final\n */\ngoog.events.ListenerMap = function(src) {\n  /** @type {EventTarget|goog.events.Listenable} */\n  this.src = src;\n\n  /**\n   * Maps of event type to an array of listeners.\n   * @type {!Object<string, !Array<!goog.events.Listener>>}\n   */\n  this.listeners = {};\n\n  /**\n   * The count of types in this map that have registered listeners.\n   * @private {number}\n   */\n  this.typeCount_ = 0;\n};\n\n\n/**\n * @return {number} The count of event types in this map that actually\n *     have registered listeners.\n */\ngoog.events.ListenerMap.prototype.getTypeCount = function() {\n  return this.typeCount_;\n};\n\n\n/**\n * @return {number} Total number of registered listeners.\n */\ngoog.events.ListenerMap.prototype.getListenerCount = function() {\n  var count = 0;\n  for (var type in this.listeners) {\n    count += this.listeners[type].length;\n  }\n  return count;\n};\n\n\n/**\n * Adds an event listener. A listener can only be added once to an\n * object and if it is added again the key for the listener is\n * returned.\n *\n * Note that a one-off listener will not change an existing listener,\n * if any. On the other hand a normal listener will change existing\n * one-off listener to become a normal listener.\n *\n * @param {string|!goog.events.EventId} type The listener event type.\n * @param {!Function} listener This listener callback method.\n * @param {boolean} callOnce Whether the listener is a one-off\n *     listener.\n * @param {boolean=} opt_useCapture The capture mode of the listener.\n * @param {Object=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {!goog.events.ListenableKey} Unique key for the listener.\n */\ngoog.events.ListenerMap.prototype.add = function(\n    type, listener, callOnce, opt_useCapture, opt_listenerScope) {\n  var typeStr = type.toString();\n  var listenerArray = this.listeners[typeStr];\n  if (!listenerArray) {\n    listenerArray = this.listeners[typeStr] = [];\n    this.typeCount_++;\n  }\n\n  var listenerObj;\n  var index = goog.events.ListenerMap.findListenerIndex_(\n      listenerArray, listener, opt_useCapture, opt_listenerScope);\n  if (index > -1) {\n    listenerObj = listenerArray[index];\n    if (!callOnce) {\n      // Ensure that, if there is an existing callOnce listener, it is no\n      // longer a callOnce listener.\n      listenerObj.callOnce = false;\n    }\n  } else {\n    listenerObj = new goog.events.Listener(\n        listener, null, this.src, typeStr, !!opt_useCapture, opt_listenerScope);\n    listenerObj.callOnce = callOnce;\n    listenerArray.push(listenerObj);\n  }\n  return listenerObj;\n};\n\n\n/**\n * Removes a matching listener.\n * @param {string|!goog.events.EventId} type The listener event type.\n * @param {!Function} listener This listener callback method.\n * @param {boolean=} opt_useCapture The capture mode of the listener.\n * @param {Object=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {boolean} Whether any listener was removed.\n */\ngoog.events.ListenerMap.prototype.remove = function(\n    type, listener, opt_useCapture, opt_listenerScope) {\n  var typeStr = type.toString();\n  if (!(typeStr in this.listeners)) {\n    return false;\n  }\n\n  var listenerArray = this.listeners[typeStr];\n  var index = goog.events.ListenerMap.findListenerIndex_(\n      listenerArray, listener, opt_useCapture, opt_listenerScope);\n  if (index > -1) {\n    var listenerObj = listenerArray[index];\n    listenerObj.markAsRemoved();\n    goog.array.removeAt(listenerArray, index);\n    if (listenerArray.length == 0) {\n      delete this.listeners[typeStr];\n      this.typeCount_--;\n    }\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Removes the given listener object.\n * @param {!goog.events.ListenableKey} listener The listener to remove.\n * @return {boolean} Whether the listener is removed.\n */\ngoog.events.ListenerMap.prototype.removeByKey = function(listener) {\n  var type = listener.type;\n  if (!(type in this.listeners)) {\n    return false;\n  }\n\n  var removed = goog.array.remove(this.listeners[type], listener);\n  if (removed) {\n    /** @type {!goog.events.Listener} */ (listener).markAsRemoved();\n    if (this.listeners[type].length == 0) {\n      delete this.listeners[type];\n      this.typeCount_--;\n    }\n  }\n  return removed;\n};\n\n\n/**\n * Removes all listeners from this map. If opt_type is provided, only\n * listeners that match the given type are removed.\n * @param {string|!goog.events.EventId=} opt_type Type of event to remove.\n * @return {number} Number of listeners removed.\n */\ngoog.events.ListenerMap.prototype.removeAll = function(opt_type) {\n  var typeStr = opt_type && opt_type.toString();\n  var count = 0;\n  for (var type in this.listeners) {\n    if (!typeStr || type == typeStr) {\n      var listenerArray = this.listeners[type];\n      for (var i = 0; i < listenerArray.length; i++) {\n        ++count;\n        listenerArray[i].markAsRemoved();\n      }\n      delete this.listeners[type];\n      this.typeCount_--;\n    }\n  }\n  return count;\n};\n\n\n/**\n * Gets all listeners that match the given type and capture mode. The\n * returned array is a copy (but the listener objects are not).\n * @param {string|!goog.events.EventId} type The type of the listeners\n *     to retrieve.\n * @param {boolean} capture The capture mode of the listeners to retrieve.\n * @return {!Array<!goog.events.ListenableKey>} An array of matching\n *     listeners.\n */\ngoog.events.ListenerMap.prototype.getListeners = function(type, capture) {\n  var listenerArray = this.listeners[type.toString()];\n  var rv = [];\n  if (listenerArray) {\n    for (var i = 0; i < listenerArray.length; ++i) {\n      var listenerObj = listenerArray[i];\n      if (listenerObj.capture == capture) {\n        rv.push(listenerObj);\n      }\n    }\n  }\n  return rv;\n};\n\n\n/**\n * Gets the goog.events.ListenableKey for the event or null if no such\n * listener is in use.\n *\n * @param {string|!goog.events.EventId} type The type of the listener\n *     to retrieve.\n * @param {!Function} listener The listener function to get.\n * @param {boolean} capture Whether the listener is a capturing listener.\n * @param {Object=} opt_listenerScope Object in whose scope to call the\n *     listener.\n * @return {goog.events.ListenableKey} the found listener or null if not found.\n */\ngoog.events.ListenerMap.prototype.getListener = function(\n    type, listener, capture, opt_listenerScope) {\n  var listenerArray = this.listeners[type.toString()];\n  var i = -1;\n  if (listenerArray) {\n    i = goog.events.ListenerMap.findListenerIndex_(\n        listenerArray, listener, capture, opt_listenerScope);\n  }\n  return i > -1 ? listenerArray[i] : null;\n};\n\n\n/**\n * Whether there is a matching listener. If either the type or capture\n * parameters are unspecified, the function will match on the\n * remaining criteria.\n *\n * @param {string|!goog.events.EventId=} opt_type The type of the listener.\n * @param {boolean=} opt_capture The capture mode of the listener.\n * @return {boolean} Whether there is an active listener matching\n *     the requested type and/or capture phase.\n */\ngoog.events.ListenerMap.prototype.hasListener = function(\n    opt_type, opt_capture) {\n  var hasType = goog.isDef(opt_type);\n  var typeStr = hasType ? opt_type.toString() : '';\n  var hasCapture = goog.isDef(opt_capture);\n\n  return goog.object.some(this.listeners, function(listenerArray, type) {\n    for (var i = 0; i < listenerArray.length; ++i) {\n      if ((!hasType || listenerArray[i].type == typeStr) &&\n          (!hasCapture || listenerArray[i].capture == opt_capture)) {\n        return true;\n      }\n    }\n\n    return false;\n  });\n};\n\n\n/**\n * Finds the index of a matching goog.events.Listener in the given\n * listenerArray.\n * @param {!Array<!goog.events.Listener>} listenerArray Array of listener.\n * @param {!Function} listener The listener function.\n * @param {boolean=} opt_useCapture The capture flag for the listener.\n * @param {Object=} opt_listenerScope The listener scope.\n * @return {number} The index of the matching listener within the\n *     listenerArray.\n * @private\n */\ngoog.events.ListenerMap.findListenerIndex_ = function(\n    listenerArray, listener, opt_useCapture, opt_listenerScope) {\n  for (var i = 0; i < listenerArray.length; ++i) {\n    var listenerObj = listenerArray[i];\n    if (!listenerObj.removed && listenerObj.listener == listener &&\n        listenerObj.capture == !!opt_useCapture &&\n        listenerObj.handler == opt_listenerScope) {\n      return i;\n    }\n  }\n  return -1;\n};\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview An event manager for both native browser event\n * targets and custom JavaScript event targets\n * (`goog.events.Listenable`). This provides an abstraction\n * over browsers' event systems.\n *\n * It also provides a simulation of W3C event model's capture phase in\n * Internet Explorer (IE 8 and below). Caveat: the simulation does not\n * interact well with listeners registered directly on the elements\n * (bypassing goog.events) or even with listeners registered via\n * goog.events in a separate JS binary. In these cases, we provide\n * no ordering guarantees.\n *\n * The listeners will receive a \"patched\" event object. Such event object\n * contains normalized values for certain event properties that differs in\n * different browsers.\n *\n * Example usage:\n * <pre>\n * goog.events.listen(myNode, 'click', function(e) { alert('woo') });\n * goog.events.listen(myNode, 'mouseover', mouseHandler, true);\n * goog.events.unlisten(myNode, 'mouseover', mouseHandler, true);\n * goog.events.removeAll(myNode);\n * </pre>\n *\n *                                            in IE and event object patching]\n * @author arv@google.com (Erik Arvidsson)\n *\n * @see ../demos/events.html\n * @see ../demos/event-propagation.html\n * @see ../demos/stopevent.html\n */\n\n// IMPLEMENTATION NOTES:\n// goog.events stores an auxiliary data structure on each EventTarget\n// source being listened on. This allows us to take advantage of GC,\n// having the data structure GC'd when the EventTarget is GC'd. This\n// GC behavior is equivalent to using W3C DOM Events directly.\n\ngoog.provide('goog.events');\ngoog.provide('goog.events.CaptureSimulationMode');\ngoog.provide('goog.events.Key');\ngoog.provide('goog.events.ListenableType');\n\ngoog.require('goog.asserts');\ngoog.require('goog.debug.entryPointRegistry');\ngoog.require('goog.events.BrowserEvent');\ngoog.require('goog.events.BrowserFeature');\ngoog.require('goog.events.Listenable');\ngoog.require('goog.events.ListenerMap');\n\ngoog.forwardDeclare('goog.debug.ErrorHandler');\ngoog.forwardDeclare('goog.events.EventWrapper');\n\n\n/**\n * @typedef {number|goog.events.ListenableKey}\n */\ngoog.events.Key;\n\n\n/**\n * @typedef {EventTarget|goog.events.Listenable}\n */\ngoog.events.ListenableType;\n\n\n/**\n * Property name on a native event target for the listener map\n * associated with the event target.\n * @private @const {string}\n */\ngoog.events.LISTENER_MAP_PROP_ = 'closure_lm_' + ((Math.random() * 1e6) | 0);\n\n\n/**\n * String used to prepend to IE event types.\n * @const\n * @private\n */\ngoog.events.onString_ = 'on';\n\n\n/**\n * Map of computed \"on<eventname>\" strings for IE event types. Caching\n * this removes an extra object allocation in goog.events.listen which\n * improves IE6 performance.\n * @const\n * @dict\n * @private\n */\ngoog.events.onStringMap_ = {};\n\n\n/**\n * @enum {number} Different capture simulation mode for IE8-.\n */\ngoog.events.CaptureSimulationMode = {\n  /**\n   * Does not perform capture simulation. Will asserts in IE8- when you\n   * add capture listeners.\n   */\n  OFF_AND_FAIL: 0,\n\n  /**\n   * Does not perform capture simulation, silently ignore capture\n   * listeners.\n   */\n  OFF_AND_SILENT: 1,\n\n  /**\n   * Performs capture simulation.\n   */\n  ON: 2\n};\n\n\n/**\n * @define {number} The capture simulation mode for IE8-. By default,\n *     this is ON.\n */\ngoog.define('goog.events.CAPTURE_SIMULATION_MODE', 2);\n\n\n/**\n * Estimated count of total native listeners.\n * @private {number}\n */\ngoog.events.listenerCountEstimate_ = 0;\n\n\n/**\n * Adds an event listener for a specific event on a native event\n * target (such as a DOM element) or an object that has implemented\n * {@link goog.events.Listenable}. A listener can only be added once\n * to an object and if it is added again the key for the listener is\n * returned. Note that if the existing listener is a one-off listener\n * (registered via listenOnce), it will no longer be a one-off\n * listener after a call to listen().\n *\n * @param {EventTarget|goog.events.Listenable} src The node to listen\n *     to events on.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type or array of event types.\n * @param {function(this:T, EVENTOBJ):?|{handleEvent:function(?):?}|null}\n *     listener Callback method, or an object with a handleEvent function.\n *     WARNING: passing an Object is now softly deprecated.\n * @param {(boolean|!AddEventListenerOptions)=} opt_options\n * @param {T=} opt_handler Element in whose scope to call the listener.\n * @return {goog.events.Key} Unique key for the listener.\n * @template T,EVENTOBJ\n */\ngoog.events.listen = function(src, type, listener, opt_options, opt_handler) {\n  if (opt_options && opt_options.once) {\n    return goog.events.listenOnce(\n        src, type, listener, opt_options, opt_handler);\n  }\n  if (goog.isArray(type)) {\n    for (var i = 0; i < type.length; i++) {\n      goog.events.listen(src, type[i], listener, opt_options, opt_handler);\n    }\n    return null;\n  }\n\n  listener = goog.events.wrapListener(listener);\n  if (goog.events.Listenable.isImplementedBy(src)) {\n    var capture =\n        goog.isObject(opt_options) ? !!opt_options.capture : !!opt_options;\n    return src.listen(\n        /** @type {string|!goog.events.EventId} */ (type), listener, capture,\n        opt_handler);\n  } else {\n    return goog.events.listen_(\n        /** @type {!EventTarget} */ (src), type, listener,\n        /* callOnce */ false, opt_options, opt_handler);\n  }\n};\n\n\n/**\n * Adds an event listener for a specific event on a native event\n * target. A listener can only be added once to an object and if it\n * is added again the key for the listener is returned.\n *\n * Note that a one-off listener will not change an existing listener,\n * if any. On the other hand a normal listener will change existing\n * one-off listener to become a normal listener.\n *\n * @param {EventTarget} src The node to listen to events on.\n * @param {string|?goog.events.EventId<EVENTOBJ>} type Event type.\n * @param {!Function} listener Callback function.\n * @param {boolean} callOnce Whether the listener is a one-off\n *     listener or otherwise.\n * @param {(boolean|!AddEventListenerOptions)=} opt_options\n * @param {Object=} opt_handler Element in whose scope to call the listener.\n * @return {goog.events.ListenableKey} Unique key for the listener.\n * @template EVENTOBJ\n * @private\n */\ngoog.events.listen_ = function(\n    src, type, listener, callOnce, opt_options, opt_handler) {\n  if (!type) {\n    throw new Error('Invalid event type');\n  }\n\n  var capture =\n      goog.isObject(opt_options) ? !!opt_options.capture : !!opt_options;\n  if (capture && !goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT) {\n    if (goog.events.CAPTURE_SIMULATION_MODE ==\n        goog.events.CaptureSimulationMode.OFF_AND_FAIL) {\n      goog.asserts.fail('Can not register capture listener in IE8-.');\n      return null;\n    } else if (\n        goog.events.CAPTURE_SIMULATION_MODE ==\n        goog.events.CaptureSimulationMode.OFF_AND_SILENT) {\n      return null;\n    }\n  }\n\n  var listenerMap = goog.events.getListenerMap_(src);\n  if (!listenerMap) {\n    src[goog.events.LISTENER_MAP_PROP_] = listenerMap =\n        new goog.events.ListenerMap(src);\n  }\n\n  var listenerObj = /** @type {goog.events.Listener} */ (\n      listenerMap.add(type, listener, callOnce, capture, opt_handler));\n\n  // If the listenerObj already has a proxy, it has been set up\n  // previously. We simply return.\n  if (listenerObj.proxy) {\n    return listenerObj;\n  }\n\n  var proxy = goog.events.getProxy();\n  listenerObj.proxy = proxy;\n\n  proxy.src = src;\n  proxy.listener = listenerObj;\n\n  // Attach the proxy through the browser's API\n  if (src.addEventListener) {\n    // Don't pass an object as `capture` if the browser doesn't support that.\n    if (!goog.events.BrowserFeature.PASSIVE_EVENTS) {\n      opt_options = capture;\n    }\n    // Don't break tests that expect a boolean.\n    if (opt_options === undefined) opt_options = false;\n    src.addEventListener(type.toString(), proxy, opt_options);\n  } else if (src.attachEvent) {\n    // The else if above used to be an unconditional else. It would call\n    // exception on IE11, spoiling the day of some callers. The previous\n    // incarnation of this code, from 2007, indicates that it replaced an\n    // earlier still version that caused excess allocations on IE6.\n    src.attachEvent(goog.events.getOnString_(type.toString()), proxy);\n  } else if (src.addListener && src.removeListener) {\n    // In IE, MediaQueryList uses addListener() insteadd of addEventListener. In\n    // Safari, there is no global for the MediaQueryList constructor, so we just\n    // check whether the object \"looks like\" MediaQueryList.\n    goog.asserts.assert(\n        type === 'change', 'MediaQueryList only has a change event');\n    src.addListener(proxy);\n  } else {\n    throw new Error('addEventListener and attachEvent are unavailable.');\n  }\n\n  goog.events.listenerCountEstimate_++;\n  return listenerObj;\n};\n\n\n/**\n * Helper function for returning a proxy function.\n * @return {!Function} A new or reused function object.\n */\ngoog.events.getProxy = function() {\n  var proxyCallbackFunction = goog.events.handleBrowserEvent_;\n  // Use a local var f to prevent one allocation.\n  var f =\n      goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT ? function(eventObject) {\n        return proxyCallbackFunction.call(f.src, f.listener, eventObject);\n      } : function(eventObject) {\n        var v = proxyCallbackFunction.call(f.src, f.listener, eventObject);\n        // NOTE(chrishenry): In IE, we hack in a capture phase. However, if\n        // there is inline event handler which tries to prevent default (for\n        // example <a href=\"...\" onclick=\"return false\">...</a>) in a\n        // descendant element, the prevent default will be overridden\n        // by this listener if this listener were to return true. Hence, we\n        // return undefined.\n        if (!v) return v;\n      };\n  return f;\n};\n\n\n/**\n * Adds an event listener for a specific event on a native event\n * target (such as a DOM element) or an object that has implemented\n * {@link goog.events.Listenable}. After the event has fired the event\n * listener is removed from the target.\n *\n * If an existing listener already exists, listenOnce will do\n * nothing. In particular, if the listener was previously registered\n * via listen(), listenOnce() will not turn the listener into a\n * one-off listener. Similarly, if there is already an existing\n * one-off listener, listenOnce does not modify the listeners (it is\n * still a once listener).\n *\n * @param {EventTarget|goog.events.Listenable} src The node to listen\n *     to events on.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type or array of event types.\n * @param {function(this:T, EVENTOBJ):?|{handleEvent:function(?):?}|null}\n *     listener Callback method.\n * @param {(boolean|!AddEventListenerOptions)=} opt_options\n * @param {T=} opt_handler Element in whose scope to call the listener.\n * @return {goog.events.Key} Unique key for the listener.\n * @template T,EVENTOBJ\n */\ngoog.events.listenOnce = function(\n    src, type, listener, opt_options, opt_handler) {\n  if (goog.isArray(type)) {\n    for (var i = 0; i < type.length; i++) {\n      goog.events.listenOnce(src, type[i], listener, opt_options, opt_handler);\n    }\n    return null;\n  }\n\n  listener = goog.events.wrapListener(listener);\n  if (goog.events.Listenable.isImplementedBy(src)) {\n    var capture =\n        goog.isObject(opt_options) ? !!opt_options.capture : !!opt_options;\n    return src.listenOnce(\n        /** @type {string|!goog.events.EventId} */ (type), listener, capture,\n        opt_handler);\n  } else {\n    return goog.events.listen_(\n        /** @type {!EventTarget} */ (src), type, listener,\n        /* callOnce */ true, opt_options, opt_handler);\n  }\n};\n\n\n/**\n * Adds an event listener with a specific event wrapper on a DOM Node or an\n * object that has implemented {@link goog.events.Listenable}. A listener can\n * only be added once to an object.\n *\n * @param {EventTarget|goog.events.Listenable} src The target to\n *     listen to events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(this:T, ?):?|{handleEvent:function(?):?}|null} listener\n *     Callback method, or an object with a handleEvent function.\n * @param {boolean=} opt_capt Whether to fire in capture phase (defaults to\n *     false).\n * @param {T=} opt_handler Element in whose scope to call the listener.\n * @template T\n */\ngoog.events.listenWithWrapper = function(\n    src, wrapper, listener, opt_capt, opt_handler) {\n  wrapper.listen(src, listener, opt_capt, opt_handler);\n};\n\n\n/**\n * Removes an event listener which was added with listen().\n *\n * @param {EventTarget|goog.events.Listenable} src The target to stop\n *     listening to events on.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type or array of event types to unlisten to.\n * @param {function(?):?|{handleEvent:function(?):?}|null} listener The\n *     listener function to remove.\n * @param {(boolean|!EventListenerOptions)=} opt_options\n *     whether the listener is fired during the capture or bubble phase of the\n *     event.\n * @param {Object=} opt_handler Element in whose scope to call the listener.\n * @return {?boolean} indicating whether the listener was there to remove.\n * @template EVENTOBJ\n */\ngoog.events.unlisten = function(src, type, listener, opt_options, opt_handler) {\n  if (goog.isArray(type)) {\n    for (var i = 0; i < type.length; i++) {\n      goog.events.unlisten(src, type[i], listener, opt_options, opt_handler);\n    }\n    return null;\n  }\n  var capture =\n      goog.isObject(opt_options) ? !!opt_options.capture : !!opt_options;\n\n  listener = goog.events.wrapListener(listener);\n  if (goog.events.Listenable.isImplementedBy(src)) {\n    return src.unlisten(\n        /** @type {string|!goog.events.EventId} */ (type), listener, capture,\n        opt_handler);\n  }\n\n  if (!src) {\n    // TODO(chrishenry): We should tighten the API to only accept\n    // non-null objects, or add an assertion here.\n    return false;\n  }\n\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {!EventTarget} */ (src));\n  if (listenerMap) {\n    var listenerObj = listenerMap.getListener(\n        /** @type {string|!goog.events.EventId} */ (type), listener, capture,\n        opt_handler);\n    if (listenerObj) {\n      return goog.events.unlistenByKey(listenerObj);\n    }\n  }\n\n  return false;\n};\n\n\n/**\n * Removes an event listener which was added with listen() by the key\n * returned by listen().\n *\n * @param {goog.events.Key} key The key returned by listen() for this\n *     event listener.\n * @return {boolean} indicating whether the listener was there to remove.\n */\ngoog.events.unlistenByKey = function(key) {\n  // TODO(chrishenry): Remove this check when tests that rely on this\n  // are fixed.\n  if (goog.isNumber(key)) {\n    return false;\n  }\n\n  var listener = key;\n  if (!listener || listener.removed) {\n    return false;\n  }\n\n  var src = listener.src;\n  if (goog.events.Listenable.isImplementedBy(src)) {\n    return /** @type {!goog.events.Listenable} */ (src).unlistenByKey(listener);\n  }\n\n  var type = listener.type;\n  var proxy = listener.proxy;\n  if (src.removeEventListener) {\n    src.removeEventListener(type, proxy, listener.capture);\n  } else if (src.detachEvent) {\n    src.detachEvent(goog.events.getOnString_(type), proxy);\n  } else if (src.addListener && src.removeListener) {\n    src.removeListener(proxy);\n  }\n  goog.events.listenerCountEstimate_--;\n\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {!EventTarget} */ (src));\n  // TODO(chrishenry): Try to remove this conditional and execute the\n  // first branch always. This should be safe.\n  if (listenerMap) {\n    listenerMap.removeByKey(listener);\n    if (listenerMap.getTypeCount() == 0) {\n      // Null the src, just because this is simple to do (and useful\n      // for IE <= 7).\n      listenerMap.src = null;\n      // We don't use delete here because IE does not allow delete\n      // on a window object.\n      src[goog.events.LISTENER_MAP_PROP_] = null;\n    }\n  } else {\n    /** @type {!goog.events.Listener} */ (listener).markAsRemoved();\n  }\n\n  return true;\n};\n\n\n/**\n * Removes an event listener which was added with listenWithWrapper().\n *\n * @param {EventTarget|goog.events.Listenable} src The target to stop\n *     listening to events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(?):?|{handleEvent:function(?):?}|null} listener The\n *     listener function to remove.\n * @param {boolean=} opt_capt In DOM-compliant browsers, this determines\n *     whether the listener is fired during the capture or bubble phase of the\n *     event.\n * @param {Object=} opt_handler Element in whose scope to call the listener.\n */\ngoog.events.unlistenWithWrapper = function(\n    src, wrapper, listener, opt_capt, opt_handler) {\n  wrapper.unlisten(src, listener, opt_capt, opt_handler);\n};\n\n\n/**\n * Removes all listeners from an object. You can also optionally\n * remove listeners of a particular type.\n *\n * @param {Object|undefined} obj Object to remove listeners from. Must be an\n *     EventTarget or a goog.events.Listenable.\n * @param {string|!goog.events.EventId=} opt_type Type of event to remove.\n *     Default is all types.\n * @return {number} Number of listeners removed.\n */\ngoog.events.removeAll = function(obj, opt_type) {\n  // TODO(chrishenry): Change the type of obj to\n  // (!EventTarget|!goog.events.Listenable).\n\n  if (!obj) {\n    return 0;\n  }\n\n  if (goog.events.Listenable.isImplementedBy(obj)) {\n    return /** @type {?} */ (obj).removeAllListeners(opt_type);\n  }\n\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {!EventTarget} */ (obj));\n  if (!listenerMap) {\n    return 0;\n  }\n\n  var count = 0;\n  var typeStr = opt_type && opt_type.toString();\n  for (var type in listenerMap.listeners) {\n    if (!typeStr || type == typeStr) {\n      // Clone so that we don't need to worry about unlistenByKey\n      // changing the content of the ListenerMap.\n      var listeners = listenerMap.listeners[type].concat();\n      for (var i = 0; i < listeners.length; ++i) {\n        if (goog.events.unlistenByKey(listeners[i])) {\n          ++count;\n        }\n      }\n    }\n  }\n  return count;\n};\n\n\n/**\n * Gets the listeners for a given object, type and capture phase.\n *\n * @param {Object} obj Object to get listeners for.\n * @param {string|!goog.events.EventId} type Event type.\n * @param {boolean} capture Capture phase?.\n * @return {Array<!goog.events.Listener>} Array of listener objects.\n */\ngoog.events.getListeners = function(obj, type, capture) {\n  if (goog.events.Listenable.isImplementedBy(obj)) {\n    return /** @type {!goog.events.Listenable} */ (obj).getListeners(\n        type, capture);\n  } else {\n    if (!obj) {\n      // TODO(chrishenry): We should tighten the API to accept\n      // !EventTarget|goog.events.Listenable, and add an assertion here.\n      return [];\n    }\n\n    var listenerMap = goog.events.getListenerMap_(\n        /** @type {!EventTarget} */ (obj));\n    return listenerMap ? listenerMap.getListeners(type, capture) : [];\n  }\n};\n\n\n/**\n * Gets the goog.events.Listener for the event or null if no such listener is\n * in use.\n *\n * @param {EventTarget|goog.events.Listenable} src The target from\n *     which to get listeners.\n * @param {?string|!goog.events.EventId<EVENTOBJ>} type The type of the event.\n * @param {function(EVENTOBJ):?|{handleEvent:function(?):?}|null} listener The\n *     listener function to get.\n * @param {boolean=} opt_capt In DOM-compliant browsers, this determines\n *                            whether the listener is fired during the\n *                            capture or bubble phase of the event.\n * @param {Object=} opt_handler Element in whose scope to call the listener.\n * @return {goog.events.ListenableKey} the found listener or null if not found.\n * @template EVENTOBJ\n */\ngoog.events.getListener = function(src, type, listener, opt_capt, opt_handler) {\n  // TODO(chrishenry): Change type from ?string to string, or add assertion.\n  type = /** @type {string} */ (type);\n  listener = goog.events.wrapListener(listener);\n  var capture = !!opt_capt;\n  if (goog.events.Listenable.isImplementedBy(src)) {\n    return src.getListener(type, listener, capture, opt_handler);\n  }\n\n  if (!src) {\n    // TODO(chrishenry): We should tighten the API to only accept\n    // non-null objects, or add an assertion here.\n    return null;\n  }\n\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {!EventTarget} */ (src));\n  if (listenerMap) {\n    return listenerMap.getListener(type, listener, capture, opt_handler);\n  }\n  return null;\n};\n\n\n/**\n * Returns whether an event target has any active listeners matching the\n * specified signature. If either the type or capture parameters are\n * unspecified, the function will match on the remaining criteria.\n *\n * @param {EventTarget|goog.events.Listenable} obj Target to get\n *     listeners for.\n * @param {string|!goog.events.EventId=} opt_type Event type.\n * @param {boolean=} opt_capture Whether to check for capture or bubble-phase\n *     listeners.\n * @return {boolean} Whether an event target has one or more listeners matching\n *     the requested type and/or capture phase.\n */\ngoog.events.hasListener = function(obj, opt_type, opt_capture) {\n  if (goog.events.Listenable.isImplementedBy(obj)) {\n    return obj.hasListener(opt_type, opt_capture);\n  }\n\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {!EventTarget} */ (obj));\n  return !!listenerMap && listenerMap.hasListener(opt_type, opt_capture);\n};\n\n\n/**\n * Provides a nice string showing the normalized event objects public members\n * @param {Object} e Event Object.\n * @return {string} String of the public members of the normalized event object.\n */\ngoog.events.expose = function(e) {\n  var str = [];\n  for (var key in e) {\n    if (e[key] && e[key].id) {\n      str.push(key + ' = ' + e[key] + ' (' + e[key].id + ')');\n    } else {\n      str.push(key + ' = ' + e[key]);\n    }\n  }\n  return str.join('\\n');\n};\n\n\n/**\n * Returns a string with on prepended to the specified type. This is used for IE\n * which expects \"on\" to be prepended. This function caches the string in order\n * to avoid extra allocations in steady state.\n * @param {string} type Event type.\n * @return {string} The type string with 'on' prepended.\n * @private\n */\ngoog.events.getOnString_ = function(type) {\n  if (type in goog.events.onStringMap_) {\n    return goog.events.onStringMap_[type];\n  }\n  return goog.events.onStringMap_[type] = goog.events.onString_ + type;\n};\n\n\n/**\n * Fires an object's listeners of a particular type and phase\n *\n * @param {Object} obj Object whose listeners to call.\n * @param {string|!goog.events.EventId} type Event type.\n * @param {boolean} capture Which event phase.\n * @param {Object} eventObject Event object to be passed to listener.\n * @return {boolean} True if all listeners returned true else false.\n */\ngoog.events.fireListeners = function(obj, type, capture, eventObject) {\n  if (goog.events.Listenable.isImplementedBy(obj)) {\n    return /** @type {!goog.events.Listenable} */ (obj).fireListeners(\n        type, capture, eventObject);\n  }\n\n  return goog.events.fireListeners_(obj, type, capture, eventObject);\n};\n\n\n/**\n * Fires an object's listeners of a particular type and phase.\n * @param {Object} obj Object whose listeners to call.\n * @param {string|!goog.events.EventId} type Event type.\n * @param {boolean} capture Which event phase.\n * @param {Object} eventObject Event object to be passed to listener.\n * @return {boolean} True if all listeners returned true else false.\n * @private\n */\ngoog.events.fireListeners_ = function(obj, type, capture, eventObject) {\n  /** @type {boolean} */\n  var retval = true;\n\n  var listenerMap = goog.events.getListenerMap_(\n      /** @type {EventTarget} */ (obj));\n  if (listenerMap) {\n    // TODO(chrishenry): Original code avoids array creation when there\n    // is no listener, so we do the same. If this optimization turns\n    // out to be not required, we can replace this with\n    // listenerMap.getListeners(type, capture) instead, which is simpler.\n    var listenerArray = listenerMap.listeners[type.toString()];\n    if (listenerArray) {\n      listenerArray = listenerArray.concat();\n      for (var i = 0; i < listenerArray.length; i++) {\n        var listener = listenerArray[i];\n        // We might not have a listener if the listener was removed.\n        if (listener && listener.capture == capture && !listener.removed) {\n          var result = goog.events.fireListener(listener, eventObject);\n          retval = retval && (result !== false);\n        }\n      }\n    }\n  }\n  return retval;\n};\n\n\n/**\n * Fires a listener with a set of arguments\n *\n * @param {goog.events.Listener} listener The listener object to call.\n * @param {Object} eventObject The event object to pass to the listener.\n * @return {*} Result of listener.\n */\ngoog.events.fireListener = function(listener, eventObject) {\n  var listenerFn = listener.listener;\n  var listenerHandler = listener.handler || listener.src;\n\n  if (listener.callOnce) {\n    goog.events.unlistenByKey(listener);\n  }\n  return listenerFn.call(listenerHandler, eventObject);\n};\n\n\n/**\n * Gets the total number of listeners currently in the system.\n * @return {number} Number of listeners.\n * @deprecated This returns estimated count, now that Closure no longer\n * stores a central listener registry. We still return an estimation\n * to keep existing listener-related tests passing. In the near future,\n * this function will be removed.\n */\ngoog.events.getTotalListenerCount = function() {\n  return goog.events.listenerCountEstimate_;\n};\n\n\n/**\n * Dispatches an event (or event like object) and calls all listeners\n * listening for events of this type. The type of the event is decided by the\n * type property on the event object.\n *\n * If any of the listeners returns false OR calls preventDefault then this\n * function will return false.  If one of the capture listeners calls\n * stopPropagation, then the bubble listeners won't fire.\n *\n * @param {goog.events.Listenable} src The event target.\n * @param {goog.events.EventLike} e Event object.\n * @return {boolean} If anyone called preventDefault on the event object (or\n *     if any of the handlers returns false) this will also return false.\n *     If there are no handlers, or if all handlers return true, this returns\n *     true.\n */\ngoog.events.dispatchEvent = function(src, e) {\n  goog.asserts.assert(\n      goog.events.Listenable.isImplementedBy(src),\n      'Can not use goog.events.dispatchEvent with ' +\n          'non-goog.events.Listenable instance.');\n  return src.dispatchEvent(e);\n};\n\n\n/**\n * Installs exception protection for the browser event entry point using the\n * given error handler.\n *\n * @param {goog.debug.ErrorHandler} errorHandler Error handler with which to\n *     protect the entry point.\n */\ngoog.events.protectBrowserEventEntryPoint = function(errorHandler) {\n  goog.events.handleBrowserEvent_ =\n      errorHandler.protectEntryPoint(goog.events.handleBrowserEvent_);\n};\n\n\n/**\n * Handles an event and dispatches it to the correct listeners. This\n * function is a proxy for the real listener the user specified.\n *\n * @param {goog.events.Listener} listener The listener object.\n * @param {Event=} opt_evt Optional event object that gets passed in via the\n *     native event handlers.\n * @return {*} Result of the event handler.\n * @this {EventTarget} The object or Element that fired the event.\n * @private\n */\ngoog.events.handleBrowserEvent_ = function(listener, opt_evt) {\n  if (listener.removed) {\n    return true;\n  }\n\n  // Synthesize event propagation if the browser does not support W3C\n  // event model.\n  if (!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT) {\n    var ieEvent = opt_evt ||\n        /** @type {Event} */ (goog.getObjectByName('window.event'));\n    var evt = new goog.events.BrowserEvent(ieEvent, this);\n    /** @type {*} */\n    var retval = true;\n\n    if (goog.events.CAPTURE_SIMULATION_MODE ==\n        goog.events.CaptureSimulationMode.ON) {\n      // If we have not marked this event yet, we should perform capture\n      // simulation.\n      if (!goog.events.isMarkedIeEvent_(ieEvent)) {\n        goog.events.markIeEvent_(ieEvent);\n\n        var ancestors = [];\n        for (var parent = evt.currentTarget; parent;\n             parent = parent.parentNode) {\n          ancestors.push(parent);\n        }\n\n        // Fire capture listeners.\n        var type = listener.type;\n        for (var i = ancestors.length - 1; !evt.propagationStopped_ && i >= 0;\n             i--) {\n          evt.currentTarget = ancestors[i];\n          var result =\n              goog.events.fireListeners_(ancestors[i], type, true, evt);\n          retval = retval && result;\n        }\n\n        // Fire bubble listeners.\n        //\n        // We can technically rely on IE to perform bubble event\n        // propagation. However, it turns out that IE fires events in\n        // opposite order of attachEvent registration, which broke\n        // some code and tests that rely on the order. (While W3C DOM\n        // Level 2 Events TR leaves the event ordering unspecified,\n        // modern browsers and W3C DOM Level 3 Events Working Draft\n        // actually specify the order as the registration order.)\n        for (var i = 0; !evt.propagationStopped_ && i < ancestors.length; i++) {\n          evt.currentTarget = ancestors[i];\n          var result =\n              goog.events.fireListeners_(ancestors[i], type, false, evt);\n          retval = retval && result;\n        }\n      }\n    } else {\n      retval = goog.events.fireListener(listener, evt);\n    }\n    return retval;\n  }\n\n  // Otherwise, simply fire the listener.\n  return goog.events.fireListener(\n      listener, new goog.events.BrowserEvent(opt_evt, this));\n};\n\n\n/**\n * This is used to mark the IE event object so we do not do the Closure pass\n * twice for a bubbling event.\n * @param {Event} e The IE browser event.\n * @private\n */\ngoog.events.markIeEvent_ = function(e) {\n  // Only the keyCode and the returnValue can be changed. We use keyCode for\n  // non keyboard events.\n  // event.returnValue is a bit more tricky. It is undefined by default. A\n  // boolean false prevents the default action. In a window.onbeforeunload and\n  // the returnValue is non undefined it will be alerted. However, we will only\n  // modify the returnValue for keyboard events. We can get a problem if non\n  // closure events sets the keyCode or the returnValue\n\n  var useReturnValue = false;\n\n  if (e.keyCode == 0) {\n    // We cannot change the keyCode in case that srcElement is input[type=file].\n    // We could test that that is the case but that would allocate 3 objects.\n    // If we use try/catch we will only allocate extra objects in the case of a\n    // failure.\n\n    try {\n      e.keyCode = -1;\n      return;\n    } catch (ex) {\n      useReturnValue = true;\n    }\n  }\n\n  if (useReturnValue ||\n      /** @type {boolean|undefined} */ (e.returnValue) == undefined) {\n    e.returnValue = true;\n  }\n};\n\n\n/**\n * This is used to check if an IE event has already been handled by the Closure\n * system so we do not do the Closure pass twice for a bubbling event.\n * @param {Event} e  The IE browser event.\n * @return {boolean} True if the event object has been marked.\n * @private\n */\ngoog.events.isMarkedIeEvent_ = function(e) {\n  return e.keyCode < 0 || e.returnValue != undefined;\n};\n\n\n/**\n * Counter to create unique event ids.\n * @private {number}\n */\ngoog.events.uniqueIdCounter_ = 0;\n\n\n/**\n * Creates a unique event id.\n *\n * @param {string} identifier The identifier.\n * @return {string} A unique identifier.\n * @idGenerator {unique}\n */\ngoog.events.getUniqueId = function(identifier) {\n  return identifier + '_' + goog.events.uniqueIdCounter_++;\n};\n\n\n/**\n * @param {EventTarget} src The source object.\n * @return {goog.events.ListenerMap} A listener map for the given\n *     source object, or null if none exists.\n * @private\n */\ngoog.events.getListenerMap_ = function(src) {\n  var listenerMap = src[goog.events.LISTENER_MAP_PROP_];\n  // IE serializes the property as well (e.g. when serializing outer\n  // HTML). So we must check that the value is of the correct type.\n  return listenerMap instanceof goog.events.ListenerMap ? listenerMap : null;\n};\n\n\n/**\n * Expando property for listener function wrapper for Object with\n * handleEvent.\n * @private @const {string}\n */\ngoog.events.LISTENER_WRAPPER_PROP_ =\n    '__closure_events_fn_' + ((Math.random() * 1e9) >>> 0);\n\n\n/**\n * @param {Object|Function} listener The listener function or an\n *     object that contains handleEvent method.\n * @return {!Function} Either the original function or a function that\n *     calls obj.handleEvent. If the same listener is passed to this\n *     function more than once, the same function is guaranteed to be\n *     returned.\n */\ngoog.events.wrapListener = function(listener) {\n  goog.asserts.assert(listener, 'Listener can not be null.');\n\n  if (goog.isFunction(listener)) {\n    return listener;\n  }\n\n  goog.asserts.assert(\n      listener.handleEvent, 'An object listener must have handleEvent method.');\n  if (!listener[goog.events.LISTENER_WRAPPER_PROP_]) {\n    listener[goog.events.LISTENER_WRAPPER_PROP_] = function(e) {\n      return /** @type {?} */ (listener).handleEvent(e);\n    };\n  }\n  return listener[goog.events.LISTENER_WRAPPER_PROP_];\n};\n\n\n// Register the browser event handler as an entry point, so that\n// it can be monitored for exception handling, etc.\ngoog.debug.entryPointRegistry.register(\n    /**\n     * @param {function(!Function): !Function} transformer The transforming\n     *     function.\n     */\n    function(transformer) {\n      goog.events.handleBrowserEvent_ =\n          transformer(goog.events.handleBrowserEvent_);\n    });\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A disposable implementation of a custom\n * listenable/event target. See also: documentation for\n * `goog.events.Listenable`.\n *\n * @author arv@google.com (Erik Arvidsson) [Original implementation]\n * @see ../demos/eventtarget.html\n * @see goog.events.Listenable\n */\n\ngoog.provide('goog.events.EventTarget');\n\ngoog.require('goog.Disposable');\ngoog.require('goog.asserts');\ngoog.require('goog.events');\ngoog.require('goog.events.Event');\ngoog.require('goog.events.Listenable');\ngoog.require('goog.events.ListenerMap');\ngoog.require('goog.object');\n\n\n\n/**\n * An implementation of `goog.events.Listenable` with full W3C\n * EventTarget-like support (capture/bubble mechanism, stopping event\n * propagation, preventing default actions).\n *\n * You may subclass this class to turn your class into a Listenable.\n *\n * Unless propagation is stopped, an event dispatched by an\n * EventTarget will bubble to the parent returned by\n * `getParentEventTarget`. To set the parent, call\n * `setParentEventTarget`. Subclasses that don't support\n * changing the parent can override the setter to throw an error.\n *\n * Example usage:\n * <pre>\n *   var source = new goog.events.EventTarget();\n *   function handleEvent(e) {\n *     alert('Type: ' + e.type + '; Target: ' + e.target);\n *   }\n *   source.listen('foo', handleEvent);\n *   // Or: goog.events.listen(source, 'foo', handleEvent);\n *   ...\n *   source.dispatchEvent('foo');  // will call handleEvent\n *   ...\n *   source.unlisten('foo', handleEvent);\n *   // Or: goog.events.unlisten(source, 'foo', handleEvent);\n * </pre>\n *\n * @constructor\n * @extends {goog.Disposable}\n * @implements {goog.events.Listenable}\n */\ngoog.events.EventTarget = function() {\n  goog.Disposable.call(this);\n\n  /**\n   * Maps of event type to an array of listeners.\n   * @private {!goog.events.ListenerMap}\n   */\n  this.eventTargetListeners_ = new goog.events.ListenerMap(this);\n\n  /**\n   * The object to use for event.target. Useful when mixing in an\n   * EventTarget to another object.\n   * @private {!Object}\n   */\n  this.actualEventTarget_ = this;\n\n  /**\n   * Parent event target, used during event bubbling.\n   *\n   * TODO(chrishenry): Change this to goog.events.Listenable. This\n   * currently breaks people who expect getParentEventTarget to return\n   * goog.events.EventTarget.\n   *\n   * @private {goog.events.EventTarget}\n   */\n  this.parentEventTarget_ = null;\n};\ngoog.inherits(goog.events.EventTarget, goog.Disposable);\ngoog.events.Listenable.addImplementation(goog.events.EventTarget);\n\n\n/**\n * An artificial cap on the number of ancestors you can have. This is mainly\n * for loop detection.\n * @const {number}\n * @private\n */\ngoog.events.EventTarget.MAX_ANCESTORS_ = 1000;\n\n\n/**\n * Returns the parent of this event target to use for bubbling.\n *\n * @return {goog.events.EventTarget} The parent EventTarget or null if\n *     there is no parent.\n * @override\n */\ngoog.events.EventTarget.prototype.getParentEventTarget = function() {\n  return this.parentEventTarget_;\n};\n\n\n/**\n * Sets the parent of this event target to use for capture/bubble\n * mechanism.\n * @param {goog.events.EventTarget} parent Parent listenable (null if none).\n */\ngoog.events.EventTarget.prototype.setParentEventTarget = function(parent) {\n  this.parentEventTarget_ = parent;\n};\n\n\n/**\n * Adds an event listener to the event target. The same handler can only be\n * added once per the type. Even if you add the same handler multiple times\n * using the same type then it will only be called once when the event is\n * dispatched.\n *\n * @param {string|!goog.events.EventId} type The type of the event to listen for\n * @param {function(?):?|{handleEvent:function(?):?}|null} handler The function\n *     to handle the event. The handler can also be an object that implements\n *     the handleEvent method which takes the event object as argument.\n * @param {boolean=} opt_capture In DOM-compliant browsers, this determines\n *     whether the listener is fired during the capture or bubble phase\n *     of the event.\n * @param {Object=} opt_handlerScope Object in whose scope to call\n *     the listener.\n * @deprecated Use `#listen` instead, when possible. Otherwise, use\n *     `goog.events.listen` if you are passing Object\n *     (instead of Function) as handler.\n */\ngoog.events.EventTarget.prototype.addEventListener = function(\n    type, handler, opt_capture, opt_handlerScope) {\n  goog.events.listen(this, type, handler, opt_capture, opt_handlerScope);\n};\n\n\n/**\n * Removes an event listener from the event target. The handler must be the\n * same object as the one added. If the handler has not been added then\n * nothing is done.\n *\n * @param {string} type The type of the event to listen for.\n * @param {function(?):?|{handleEvent:function(?):?}|null} handler The function\n *     to handle the event. The handler can also be an object that implements\n *     the handleEvent method which takes the event object as argument.\n * @param {boolean=} opt_capture In DOM-compliant browsers, this determines\n *     whether the listener is fired during the capture or bubble phase\n *     of the event.\n * @param {Object=} opt_handlerScope Object in whose scope to call\n *     the listener.\n * @deprecated Use `#unlisten` instead, when possible. Otherwise, use\n *     `goog.events.unlisten` if you are passing Object\n *     (instead of Function) as handler.\n */\ngoog.events.EventTarget.prototype.removeEventListener = function(\n    type, handler, opt_capture, opt_handlerScope) {\n  goog.events.unlisten(this, type, handler, opt_capture, opt_handlerScope);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.dispatchEvent = function(e) {\n  this.assertInitialized_();\n\n  var ancestorsTree, ancestor = this.getParentEventTarget();\n  if (ancestor) {\n    ancestorsTree = [];\n    var ancestorCount = 1;\n    for (; ancestor; ancestor = ancestor.getParentEventTarget()) {\n      ancestorsTree.push(ancestor);\n      goog.asserts.assert(\n          (++ancestorCount < goog.events.EventTarget.MAX_ANCESTORS_),\n          'infinite loop');\n    }\n  }\n\n  return goog.events.EventTarget.dispatchEventInternal_(\n      this.actualEventTarget_, e, ancestorsTree);\n};\n\n\n/**\n * Removes listeners from this object.  Classes that extend EventTarget may\n * need to override this method in order to remove references to DOM Elements\n * and additional listeners.\n * @override\n */\ngoog.events.EventTarget.prototype.disposeInternal = function() {\n  goog.events.EventTarget.superClass_.disposeInternal.call(this);\n\n  this.removeAllListeners();\n  this.parentEventTarget_ = null;\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.listen = function(\n    type, listener, opt_useCapture, opt_listenerScope) {\n  this.assertInitialized_();\n  return this.eventTargetListeners_.add(\n      String(type), listener, false /* callOnce */, opt_useCapture,\n      opt_listenerScope);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.listenOnce = function(\n    type, listener, opt_useCapture, opt_listenerScope) {\n  return this.eventTargetListeners_.add(\n      String(type), listener, true /* callOnce */, opt_useCapture,\n      opt_listenerScope);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.unlisten = function(\n    type, listener, opt_useCapture, opt_listenerScope) {\n  return this.eventTargetListeners_.remove(\n      String(type), listener, opt_useCapture, opt_listenerScope);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.unlistenByKey = function(key) {\n  return this.eventTargetListeners_.removeByKey(key);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.removeAllListeners = function(opt_type) {\n  // TODO(chrishenry): Previously, removeAllListeners can be called on\n  // uninitialized EventTarget, so we preserve that behavior. We\n  // should remove this when usages that rely on that fact are purged.\n  if (!this.eventTargetListeners_) {\n    return 0;\n  }\n  return this.eventTargetListeners_.removeAll(opt_type);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.fireListeners = function(\n    type, capture, eventObject) {\n  // TODO(chrishenry): Original code avoids array creation when there\n  // is no listener, so we do the same. If this optimization turns\n  // out to be not required, we can replace this with\n  // getListeners(type, capture) instead, which is simpler.\n  var listenerArray = this.eventTargetListeners_.listeners[String(type)];\n  if (!listenerArray) {\n    return true;\n  }\n  listenerArray = listenerArray.concat();\n\n  var rv = true;\n  for (var i = 0; i < listenerArray.length; ++i) {\n    var listener = listenerArray[i];\n    // We might not have a listener if the listener was removed.\n    if (listener && !listener.removed && listener.capture == capture) {\n      var listenerFn = listener.listener;\n      var listenerHandler = listener.handler || listener.src;\n\n      if (listener.callOnce) {\n        this.unlistenByKey(listener);\n      }\n      rv = listenerFn.call(listenerHandler, eventObject) !== false && rv;\n    }\n  }\n\n  return rv && eventObject.returnValue_ != false;\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.getListeners = function(type, capture) {\n  return this.eventTargetListeners_.getListeners(String(type), capture);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.getListener = function(\n    type, listener, capture, opt_listenerScope) {\n  return this.eventTargetListeners_.getListener(\n      String(type), listener, capture, opt_listenerScope);\n};\n\n\n/** @override */\ngoog.events.EventTarget.prototype.hasListener = function(\n    opt_type, opt_capture) {\n  var id = goog.isDef(opt_type) ? String(opt_type) : undefined;\n  return this.eventTargetListeners_.hasListener(id, opt_capture);\n};\n\n\n/**\n * Sets the target to be used for `event.target` when firing\n * event. Mainly used for testing. For example, see\n * `goog.testing.events.mixinListenable`.\n * @param {!Object} target The target.\n */\ngoog.events.EventTarget.prototype.setTargetForTesting = function(target) {\n  this.actualEventTarget_ = target;\n};\n\n\n/**\n * Asserts that the event target instance is initialized properly.\n * @private\n */\ngoog.events.EventTarget.prototype.assertInitialized_ = function() {\n  goog.asserts.assert(\n      this.eventTargetListeners_,\n      'Event target is not initialized. Did you call the superclass ' +\n          '(goog.events.EventTarget) constructor?');\n};\n\n\n/**\n * Dispatches the given event on the ancestorsTree.\n *\n * @param {!Object} target The target to dispatch on.\n * @param {goog.events.Event|Object|string} e The event object.\n * @param {Array<goog.events.Listenable>=} opt_ancestorsTree The ancestors\n *     tree of the target, in reverse order from the closest ancestor\n *     to the root event target. May be null if the target has no ancestor.\n * @return {boolean} If anyone called preventDefault on the event object (or\n *     if any of the listeners returns false) this will also return false.\n * @private\n */\ngoog.events.EventTarget.dispatchEventInternal_ = function(\n    target, e, opt_ancestorsTree) {\n  /** @suppress {missingProperties} */\n  var type = e.type || /** @type {string} */ (e);\n\n  // If accepting a string or object, create a custom event object so that\n  // preventDefault and stopPropagation work with the event.\n  if (goog.isString(e)) {\n    e = new goog.events.Event(e, target);\n  } else if (!(e instanceof goog.events.Event)) {\n    var oldEvent = e;\n    e = new goog.events.Event(type, target);\n    goog.object.extend(e, oldEvent);\n  } else {\n    e.target = e.target || target;\n  }\n\n  var rv = true, currentTarget;\n\n  // Executes all capture listeners on the ancestors, if any.\n  if (opt_ancestorsTree) {\n    for (var i = opt_ancestorsTree.length - 1; !e.propagationStopped_ && i >= 0;\n         i--) {\n      currentTarget = e.currentTarget = opt_ancestorsTree[i];\n      rv = currentTarget.fireListeners(type, true, e) && rv;\n    }\n  }\n\n  // Executes capture and bubble listeners on the target.\n  if (!e.propagationStopped_) {\n    currentTarget = /** @type {?} */ (e.currentTarget = target);\n    rv = currentTarget.fireListeners(type, true, e) && rv;\n    if (!e.propagationStopped_) {\n      rv = currentTarget.fireListeners(type, false, e) && rv;\n    }\n  }\n\n  // Executes all bubble listeners on the ancestors, if any.\n  if (opt_ancestorsTree) {\n    for (i = 0; !e.propagationStopped_ && i < opt_ancestorsTree.length; i++) {\n      currentTarget = e.currentTarget = opt_ancestorsTree[i];\n      rv = currentTarget.fireListeners(type, false, e) && rv;\n    }\n  }\n\n  return rv;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview JSON utility functions.\n * @author arv@google.com (Erik Arvidsson)\n */\n\n\ngoog.provide('goog.json');\ngoog.provide('goog.json.Replacer');\ngoog.provide('goog.json.Reviver');\ngoog.provide('goog.json.Serializer');\n\n\n/**\n * @define {boolean} If true, use the native JSON parsing API.\n * NOTE: The default `goog.json.parse` implementation is able to handle\n * invalid JSON. JSPB used to produce invalid JSON which is not the case\n * anymore so this is safe to enable for parsing JSPB. Using native JSON is\n * faster and safer than the default implementation using `eval`.\n */\ngoog.define('goog.json.USE_NATIVE_JSON', false);\n\n/**\n * @define {boolean} If true, try the native JSON parsing API first. If it\n * fails, log an error and use `eval` instead. This is useful when\n * transitioning to `goog.json.USE_NATIVE_JSON`. The error logger needs to\n * be set by `goog.json.setErrorLogger`. If it is not set then the error\n * is ignored.\n */\ngoog.define('goog.json.TRY_NATIVE_JSON', false);\n\n\n/**\n * Tests if a string is an invalid JSON string. This only ensures that we are\n * not using any invalid characters\n * @param {string} s The string to test.\n * @return {boolean} True if the input is a valid JSON string.\n */\ngoog.json.isValid = function(s) {\n  // All empty whitespace is not valid.\n  if (/^\\s*$/.test(s)) {\n    return false;\n  }\n\n  // This is taken from http://www.json.org/json2.js which is released to the\n  // public domain.\n  // Changes: We dissallow \\u2028 Line separator and \\u2029 Paragraph separator\n  // inside strings.  We also treat \\u2028 and \\u2029 as whitespace which they\n  // are in the RFC but IE and Safari does not match \\s to these so we need to\n  // include them in the reg exps in all places where whitespace is allowed.\n  // We allowed \\x7f inside strings because some tools don't escape it,\n  // e.g. http://www.json.org/java/org/json/JSONObject.java\n\n  // Parsing happens in three stages. In the first stage, we run the text\n  // against regular expressions that look for non-JSON patterns. We are\n  // especially concerned with '()' and 'new' because they can cause invocation,\n  // and '=' because it can cause mutation. But just to be safe, we want to\n  // reject all unexpected forms.\n\n  // We split the first stage into 4 regexp operations in order to work around\n  // crippling inefficiencies in IE's and Safari's regexp engines. First we\n  // replace all backslash pairs with '@' (a non-JSON character). Second, we\n  // replace all simple value tokens with ']' characters, but only when followed\n  // by a colon, comma, closing bracket or end of string. Third, we delete all\n  // open brackets that follow a colon or comma or that begin the text. Finally,\n  // we look to see that the remaining characters are only whitespace or ']' or\n  // ',' or ':' or '{' or '}'. If that is so, then the text is safe for eval.\n\n  // Don't make these static since they have the global flag.\n  var backslashesRe = /\\\\[\"\\\\\\/bfnrtu]/g;\n  var simpleValuesRe =\n      /(?:\"[^\"\\\\\\n\\r\\u2028\\u2029\\x00-\\x08\\x0a-\\x1f]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)[\\s\\u2028\\u2029]*(?=:|,|]|}|$)/g;\n  var openBracketsRe = /(?:^|:|,)(?:[\\s\\u2028\\u2029]*\\[)+/g;\n  var remainderRe = /^[\\],:{}\\s\\u2028\\u2029]*$/;\n\n  return remainderRe.test(\n      s.replace(backslashesRe, '@')\n          .replace(simpleValuesRe, ']')\n          .replace(openBracketsRe, ''));\n};\n\n/**\n * Logs a parsing error in `JSON.parse` solvable by using `eval`\n * if `goog.json.TRY_NATIVE_JSON` is enabled.\n * @private {function(string, !Error)} The first parameter is the error message,\n *     the second is the exception thrown by `JSON.parse`.\n */\ngoog.json.errorLogger_ = goog.nullFunction;\n\n\n/**\n * Sets an error logger to use if there's a recoverable parsing error and\n * `goog.json.TRY_NATIVE_JSON` is enabled.\n * @param {function(string, !Error)} errorLogger The first parameter is the\n *     error message, the second is the exception thrown by `JSON.parse`.\n */\ngoog.json.setErrorLogger = function(errorLogger) {\n  goog.json.errorLogger_ = errorLogger;\n};\n\n\n/**\n * Parses a JSON string and returns the result. This throws an exception if\n * the string is an invalid JSON string.\n *\n * Note that this is very slow on large strings. Use JSON.parse if possible.\n *\n * @param {*} s The JSON string to parse.\n * @throws Error if s is invalid JSON.\n * @return {Object} The object generated from the JSON string, or null.\n * @deprecated Use JSON.parse.\n */\ngoog.json.parse = goog.json.USE_NATIVE_JSON ?\n    /** @type {function(*):Object} */ (goog.global['JSON']['parse']) :\n    function(s) {\n      var error;\n      if (goog.json.TRY_NATIVE_JSON) {\n        try {\n          return goog.global['JSON']['parse'](s);\n        } catch (ex) {\n          error = ex;\n        }\n      }\n      var o = String(s);\n      if (goog.json.isValid(o)) {\n\n        try {\n          var result = /** @type {?Object} */ (eval('(' + o + ')'));\n          if (error) {\n            goog.json.errorLogger_('Invalid JSON: ' + o, error);\n          }\n          return result;\n        } catch (ex) {\n        }\n      }\n      throw new Error('Invalid JSON string: ' + o);\n    };\n\n\n/**\n * JSON replacer, as defined in Section 15.12.3 of the ES5 spec.\n * @see http://ecma-international.org/ecma-262/5.1/#sec-15.12.3\n *\n * TODO(nicksantos): Array should also be a valid replacer.\n *\n * @typedef {function(this:Object, string, *): *}\n */\ngoog.json.Replacer;\n\n\n/**\n * JSON reviver, as defined in Section 15.12.2 of the ES5 spec.\n * @see http://ecma-international.org/ecma-262/5.1/#sec-15.12.3\n *\n * @typedef {function(this:Object, string, *): *}\n */\ngoog.json.Reviver;\n\n\n/**\n * Serializes an object or a value to a JSON string.\n *\n * @param {*} object The object to serialize.\n * @param {?goog.json.Replacer=} opt_replacer A replacer function\n *     called for each (key, value) pair that determines how the value\n *     should be serialized. By defult, this just returns the value\n *     and allows default serialization to kick in.\n * @throws Error if there are loops in the object graph.\n * @return {string} A JSON string representation of the input.\n */\ngoog.json.serialize = goog.json.USE_NATIVE_JSON ?\n    /** @type {function(*, ?goog.json.Replacer=):string} */\n    (goog.global['JSON']['stringify']) :\n    function(object, opt_replacer) {\n      // NOTE(nicksantos): Currently, we never use JSON.stringify.\n      //\n      // The last time I evaluated this, JSON.stringify had subtle bugs and\n      // behavior differences on all browsers, and the performance win was not\n      // large enough to justify all the issues. This may change in the future\n      // as browser implementations get better.\n      //\n      // assertSerialize in json_test contains if branches for the cases\n      // that fail.\n      return new goog.json.Serializer(opt_replacer).serialize(object);\n    };\n\n\n\n/**\n * Class that is used to serialize JSON objects to a string.\n * @param {?goog.json.Replacer=} opt_replacer Replacer.\n * @constructor\n */\ngoog.json.Serializer = function(opt_replacer) {\n  /**\n   * @type {goog.json.Replacer|null|undefined}\n   * @private\n   */\n  this.replacer_ = opt_replacer;\n};\n\n\n/**\n * Serializes an object or a value to a JSON string.\n *\n * @param {*} object The object to serialize.\n * @throws Error if there are loops in the object graph.\n * @return {string} A JSON string representation of the input.\n */\ngoog.json.Serializer.prototype.serialize = function(object) {\n  var sb = [];\n  this.serializeInternal(object, sb);\n  return sb.join('');\n};\n\n\n/**\n * Serializes a generic value to a JSON string\n * @protected\n * @param {*} object The object to serialize.\n * @param {Array<string>} sb Array used as a string builder.\n * @throws Error if there are loops in the object graph.\n */\ngoog.json.Serializer.prototype.serializeInternal = function(object, sb) {\n  if (object == null) {\n    // undefined == null so this branch covers undefined as well as null\n    sb.push('null');\n    return;\n  }\n\n  if (typeof object == 'object') {\n    if (goog.isArray(object)) {\n      this.serializeArray(object, sb);\n      return;\n    } else if (\n        object instanceof String || object instanceof Number ||\n        object instanceof Boolean) {\n      object = object.valueOf();\n      // Fall through to switch below.\n    } else {\n      this.serializeObject_(/** @type {!Object} */ (object), sb);\n      return;\n    }\n  }\n\n  switch (typeof object) {\n    case 'string':\n      this.serializeString_(object, sb);\n      break;\n    case 'number':\n      this.serializeNumber_(object, sb);\n      break;\n    case 'boolean':\n      sb.push(String(object));\n      break;\n    case 'function':\n      sb.push('null');\n      break;\n    default:\n      throw new Error('Unknown type: ' + typeof object);\n  }\n};\n\n\n/**\n * Character mappings used internally for goog.string.quote\n * @private\n * @type {!Object}\n */\ngoog.json.Serializer.charToJsonCharCache_ = {\n  '\\\"': '\\\\\"',\n  '\\\\': '\\\\\\\\',\n  '/': '\\\\/',\n  '\\b': '\\\\b',\n  '\\f': '\\\\f',\n  '\\n': '\\\\n',\n  '\\r': '\\\\r',\n  '\\t': '\\\\t',\n\n  '\\x0B': '\\\\u000b'  // '\\v' is not supported in JScript\n};\n\n\n/**\n * Regular expression used to match characters that need to be replaced.\n * The S60 browser has a bug where unicode characters are not matched by\n * regular expressions. The condition below detects such behaviour and\n * adjusts the regular expression accordingly.\n * @private\n * @type {!RegExp}\n */\ngoog.json.Serializer.charsToReplace_ = /\\uffff/.test('\\uffff') ?\n    /[\\\\\\\"\\x00-\\x1f\\x7f-\\uffff]/g :\n    /[\\\\\\\"\\x00-\\x1f\\x7f-\\xff]/g;\n\n\n/**\n * Serializes a string to a JSON string\n * @private\n * @param {string} s The string to serialize.\n * @param {Array<string>} sb Array used as a string builder.\n */\ngoog.json.Serializer.prototype.serializeString_ = function(s, sb) {\n  // The official JSON implementation does not work with international\n  // characters.\n  sb.push('\"', s.replace(goog.json.Serializer.charsToReplace_, function(c) {\n    // caching the result improves performance by a factor 2-3\n    var rv = goog.json.Serializer.charToJsonCharCache_[c];\n    if (!rv) {\n      rv = '\\\\u' + (c.charCodeAt(0) | 0x10000).toString(16).substr(1);\n      goog.json.Serializer.charToJsonCharCache_[c] = rv;\n    }\n    return rv;\n  }), '\"');\n};\n\n\n/**\n * Serializes a number to a JSON string\n * @private\n * @param {number} n The number to serialize.\n * @param {Array<string>} sb Array used as a string builder.\n */\ngoog.json.Serializer.prototype.serializeNumber_ = function(n, sb) {\n  sb.push(isFinite(n) && !isNaN(n) ? String(n) : 'null');\n};\n\n\n/**\n * Serializes an array to a JSON string\n * @param {Array<string>} arr The array to serialize.\n * @param {Array<string>} sb Array used as a string builder.\n * @protected\n */\ngoog.json.Serializer.prototype.serializeArray = function(arr, sb) {\n  var l = arr.length;\n  sb.push('[');\n  var sep = '';\n  for (var i = 0; i < l; i++) {\n    sb.push(sep);\n\n    var value = arr[i];\n    this.serializeInternal(\n        this.replacer_ ? this.replacer_.call(arr, String(i), value) : value,\n        sb);\n\n    sep = ',';\n  }\n  sb.push(']');\n};\n\n\n/**\n * Serializes an object to a JSON string\n * @private\n * @param {!Object} obj The object to serialize.\n * @param {Array<string>} sb Array used as a string builder.\n */\ngoog.json.Serializer.prototype.serializeObject_ = function(obj, sb) {\n  sb.push('{');\n  var sep = '';\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var value = obj[key];\n      // Skip functions.\n      if (typeof value != 'function') {\n        sb.push(sep);\n        this.serializeString_(key, sb);\n        sb.push(':');\n\n        this.serializeInternal(\n            this.replacer_ ? this.replacer_.call(obj, key, value) : value, sb);\n\n        sep = ',';\n      }\n    }\n  }\n  sb.push('}');\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Definition of the LogRecord class. Please minimize\n * dependencies this file has on other closure classes as any dependency it\n * takes won't be able to use the logging infrastructure.\n *\n */\n\ngoog.provide('goog.debug.LogRecord');\n\n\n\n/**\n * LogRecord objects are used to pass logging requests between\n * the logging framework and individual log Handlers.\n * @constructor\n * @param {goog.debug.Logger.Level} level One of the level identifiers.\n * @param {string} msg The string message.\n * @param {string} loggerName The name of the source logger.\n * @param {number=} opt_time Time this log record was created if other than now.\n *     If 0, we use #goog.now.\n * @param {number=} opt_sequenceNumber Sequence number of this log record. This\n *     should only be passed in when restoring a log record from persistence.\n */\ngoog.debug.LogRecord = function(\n    level, msg, loggerName, opt_time, opt_sequenceNumber) {\n  this.reset(level, msg, loggerName, opt_time, opt_sequenceNumber);\n};\n\n\n/**\n * Time the LogRecord was created.\n * @type {number}\n * @private\n */\ngoog.debug.LogRecord.prototype.time_;\n\n\n/**\n * Level of the LogRecord\n * @type {goog.debug.Logger.Level}\n * @private\n */\ngoog.debug.LogRecord.prototype.level_;\n\n\n/**\n * Message associated with the record\n * @type {string}\n * @private\n */\ngoog.debug.LogRecord.prototype.msg_;\n\n\n/**\n * Name of the logger that created the record.\n * @type {string}\n * @private\n */\ngoog.debug.LogRecord.prototype.loggerName_;\n\n\n/**\n * Sequence number for the LogRecord. Each record has a unique sequence number\n * that is greater than all log records created before it.\n * @type {number}\n * @private\n */\ngoog.debug.LogRecord.prototype.sequenceNumber_ = 0;\n\n\n/**\n * Exception associated with the record\n * @type {Object}\n * @private\n */\ngoog.debug.LogRecord.prototype.exception_ = null;\n\n\n/**\n * @define {boolean} Whether to enable log sequence numbers.\n */\ngoog.define('goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS', true);\n\n\n/**\n * A sequence counter for assigning increasing sequence numbers to LogRecord\n * objects.\n * @type {number}\n * @private\n */\ngoog.debug.LogRecord.nextSequenceNumber_ = 0;\n\n\n/**\n * Sets all fields of the log record.\n * @param {goog.debug.Logger.Level} level One of the level identifiers.\n * @param {string} msg The string message.\n * @param {string} loggerName The name of the source logger.\n * @param {number=} opt_time Time this log record was created if other than now.\n *     If 0, we use #goog.now.\n * @param {number=} opt_sequenceNumber Sequence number of this log record. This\n *     should only be passed in when restoring a log record from persistence.\n */\ngoog.debug.LogRecord.prototype.reset = function(\n    level, msg, loggerName, opt_time, opt_sequenceNumber) {\n  if (goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS) {\n    this.sequenceNumber_ = typeof opt_sequenceNumber == 'number' ?\n        opt_sequenceNumber :\n        goog.debug.LogRecord.nextSequenceNumber_++;\n  }\n\n  this.time_ = opt_time || goog.now();\n  this.level_ = level;\n  this.msg_ = msg;\n  this.loggerName_ = loggerName;\n  delete this.exception_;\n};\n\n\n/**\n * Get the source Logger's name.\n *\n * @return {string} source logger name (may be null).\n */\ngoog.debug.LogRecord.prototype.getLoggerName = function() {\n  return this.loggerName_;\n};\n\n\n/**\n * Get the exception that is part of the log record.\n *\n * @return {Object} the exception.\n */\ngoog.debug.LogRecord.prototype.getException = function() {\n  return this.exception_;\n};\n\n\n/**\n * Set the exception that is part of the log record.\n *\n * @param {Object} exception the exception.\n */\ngoog.debug.LogRecord.prototype.setException = function(exception) {\n  this.exception_ = exception;\n};\n\n\n/**\n * Get the source Logger's name.\n *\n * @param {string} loggerName source logger name (may be null).\n */\ngoog.debug.LogRecord.prototype.setLoggerName = function(loggerName) {\n  this.loggerName_ = loggerName;\n};\n\n\n/**\n * Get the logging message level, for example Level.SEVERE.\n * @return {goog.debug.Logger.Level} the logging message level.\n */\ngoog.debug.LogRecord.prototype.getLevel = function() {\n  return this.level_;\n};\n\n\n/**\n * Set the logging message level, for example Level.SEVERE.\n * @param {goog.debug.Logger.Level} level the logging message level.\n */\ngoog.debug.LogRecord.prototype.setLevel = function(level) {\n  this.level_ = level;\n};\n\n\n/**\n * Get the \"raw\" log message, before localization or formatting.\n *\n * @return {string} the raw message string.\n */\ngoog.debug.LogRecord.prototype.getMessage = function() {\n  return this.msg_;\n};\n\n\n/**\n * Set the \"raw\" log message, before localization or formatting.\n *\n * @param {string} msg the raw message string.\n */\ngoog.debug.LogRecord.prototype.setMessage = function(msg) {\n  this.msg_ = msg;\n};\n\n\n/**\n * Get event time in milliseconds since 1970.\n *\n * @return {number} event time in millis since 1970.\n */\ngoog.debug.LogRecord.prototype.getMillis = function() {\n  return this.time_;\n};\n\n\n/**\n * Set event time in milliseconds since 1970.\n *\n * @param {number} time event time in millis since 1970.\n */\ngoog.debug.LogRecord.prototype.setMillis = function(time) {\n  this.time_ = time;\n};\n\n\n/**\n * Get the sequence number.\n * <p>\n * Sequence numbers are normally assigned in the LogRecord\n * constructor, which assigns unique sequence numbers to\n * each new LogRecord in increasing order.\n * @return {number} the sequence number.\n */\ngoog.debug.LogRecord.prototype.getSequenceNumber = function() {\n  return this.sequenceNumber_;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Definition of the Logger class. Please minimize dependencies\n * this file has on other closure classes as any dependency it takes won't be\n * able to use the logging infrastructure.\n *\n * @see ../demos/debug.html\n */\n\ngoog.provide('goog.debug.LogManager');\ngoog.provide('goog.debug.Loggable');\ngoog.provide('goog.debug.Logger');\ngoog.provide('goog.debug.Logger.Level');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.debug');\ngoog.require('goog.debug.LogBuffer');\ngoog.require('goog.debug.LogRecord');\n\n\n/**\n * A message value that can be handled by a Logger.\n *\n * Functions are treated like callbacks, but are only called when the event's\n * log level is enabled. This is useful for logging messages that are expensive\n * to construct.\n *\n * @typedef {string|function(): string}\n */\ngoog.debug.Loggable;\n\n\n\n/**\n * The Logger is an object used for logging debug messages. Loggers are\n * normally named, using a hierarchical dot-separated namespace. Logger names\n * can be arbitrary strings, but they should normally be based on the package\n * name or class name of the logged component, such as goog.net.BrowserChannel.\n *\n * The Logger object is loosely based on the java class\n * java.util.logging.Logger. It supports different levels of filtering for\n * different loggers.\n *\n * The logger object should never be instantiated by application code. It\n * should always use the goog.debug.Logger.getLogger function.\n *\n * @constructor\n * @param {string} name The name of the Logger.\n * @final\n */\ngoog.debug.Logger = function(name) {\n  /**\n   * Name of the Logger. Generally a dot-separated namespace\n   * @private {string}\n   */\n  this.name_ = name;\n\n  /**\n   * Parent Logger.\n   * @private {goog.debug.Logger}\n   */\n  this.parent_ = null;\n\n  /**\n   * Level that this logger only filters above. Null indicates it should\n   * inherit from the parent.\n   * @private {goog.debug.Logger.Level}\n   */\n  this.level_ = null;\n\n  /**\n   * Map of children loggers. The keys are the leaf names of the children and\n   * the values are the child loggers.\n   * @private {Object}\n   */\n  this.children_ = null;\n\n  /**\n   * Handlers that are listening to this logger.\n   * @private {Array<Function>}\n   */\n  this.handlers_ = null;\n};\n\n\n/** @const */\ngoog.debug.Logger.ROOT_LOGGER_NAME = '';\n\n\n/**\n * @define {boolean} Toggles whether loggers other than the root logger can have\n *     log handlers attached to them and whether they can have their log level\n *     set. Logging is a bit faster when this is set to false.\n */\ngoog.define('goog.debug.Logger.ENABLE_HIERARCHY', true);\n\n\n/**\n * @define {boolean} Toggles whether active log statements are also recorded\n *     to the profiler.\n */\ngoog.define('goog.debug.Logger.ENABLE_PROFILER_LOGGING', false);\n\n\nif (!goog.debug.Logger.ENABLE_HIERARCHY) {\n  /**\n   * @type {!Array<Function>}\n   * @private\n   */\n  goog.debug.Logger.rootHandlers_ = [];\n\n\n  /**\n   * @type {goog.debug.Logger.Level}\n   * @private\n   */\n  goog.debug.Logger.rootLevel_;\n}\n\n\n\n/**\n * The Level class defines a set of standard logging levels that\n * can be used to control logging output.  The logging Level objects\n * are ordered and are specified by ordered integers.  Enabling logging\n * at a given level also enables logging at all higher levels.\n * <p>\n * Clients should normally use the predefined Level constants such\n * as Level.SEVERE.\n * <p>\n * The levels in descending order are:\n * <ul>\n * <li>SEVERE (highest value)\n * <li>WARNING\n * <li>INFO\n * <li>CONFIG\n * <li>FINE\n * <li>FINER\n * <li>FINEST  (lowest value)\n * </ul>\n * In addition there is a level OFF that can be used to turn\n * off logging, and a level ALL that can be used to enable\n * logging of all messages.\n *\n * @param {string} name The name of the level.\n * @param {number} value The numeric value of the level.\n * @constructor\n * @final\n */\ngoog.debug.Logger.Level = function(name, value) {\n  /**\n   * The name of the level\n   * @type {string}\n   */\n  this.name = name;\n\n  /**\n   * The numeric value of the level\n   * @type {number}\n   */\n  this.value = value;\n};\n\n\n/**\n * @return {string} String representation of the logger level.\n * @override\n */\ngoog.debug.Logger.Level.prototype.toString = function() {\n  return this.name;\n};\n\n\n/**\n * OFF is a special level that can be used to turn off logging.\n * This level is initialized to <CODE>Infinity</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.OFF = new goog.debug.Logger.Level('OFF', Infinity);\n\n\n/**\n * SHOUT is a message level for extra debugging loudness.\n * This level is initialized to <CODE>1200</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.SHOUT = new goog.debug.Logger.Level('SHOUT', 1200);\n\n\n/**\n * SEVERE is a message level indicating a serious failure.\n * This level is initialized to <CODE>1000</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.SEVERE = new goog.debug.Logger.Level('SEVERE', 1000);\n\n\n/**\n * WARNING is a message level indicating a potential problem.\n * This level is initialized to <CODE>900</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.WARNING = new goog.debug.Logger.Level('WARNING', 900);\n\n\n/**\n * INFO is a message level for informational messages.\n * This level is initialized to <CODE>800</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.INFO = new goog.debug.Logger.Level('INFO', 800);\n\n\n/**\n * CONFIG is a message level for static configuration messages.\n * This level is initialized to <CODE>700</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.CONFIG = new goog.debug.Logger.Level('CONFIG', 700);\n\n\n/**\n * FINE is a message level providing tracing information.\n * This level is initialized to <CODE>500</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.FINE = new goog.debug.Logger.Level('FINE', 500);\n\n\n/**\n * FINER indicates a fairly detailed tracing message.\n * This level is initialized to <CODE>400</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.FINER = new goog.debug.Logger.Level('FINER', 400);\n\n/**\n * FINEST indicates a highly detailed tracing message.\n * This level is initialized to <CODE>300</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\n\ngoog.debug.Logger.Level.FINEST = new goog.debug.Logger.Level('FINEST', 300);\n\n\n/**\n * ALL indicates that all messages should be logged.\n * This level is initialized to <CODE>0</CODE>.\n * @type {!goog.debug.Logger.Level}\n */\ngoog.debug.Logger.Level.ALL = new goog.debug.Logger.Level('ALL', 0);\n\n\n/**\n * The predefined levels.\n * @type {!Array<!goog.debug.Logger.Level>}\n * @final\n */\ngoog.debug.Logger.Level.PREDEFINED_LEVELS = [\n  goog.debug.Logger.Level.OFF, goog.debug.Logger.Level.SHOUT,\n  goog.debug.Logger.Level.SEVERE, goog.debug.Logger.Level.WARNING,\n  goog.debug.Logger.Level.INFO, goog.debug.Logger.Level.CONFIG,\n  goog.debug.Logger.Level.FINE, goog.debug.Logger.Level.FINER,\n  goog.debug.Logger.Level.FINEST, goog.debug.Logger.Level.ALL\n];\n\n\n/**\n * A lookup map used to find the level object based on the name or value of\n * the level object.\n * @type {Object}\n * @private\n */\ngoog.debug.Logger.Level.predefinedLevelsCache_ = null;\n\n\n/**\n * Creates the predefined levels cache and populates it.\n * @private\n */\ngoog.debug.Logger.Level.createPredefinedLevelsCache_ = function() {\n  goog.debug.Logger.Level.predefinedLevelsCache_ = {};\n  for (var i = 0, level; level = goog.debug.Logger.Level.PREDEFINED_LEVELS[i];\n       i++) {\n    goog.debug.Logger.Level.predefinedLevelsCache_[level.value] = level;\n    goog.debug.Logger.Level.predefinedLevelsCache_[level.name] = level;\n  }\n};\n\n\n/**\n * Gets the predefined level with the given name.\n * @param {string} name The name of the level.\n * @return {goog.debug.Logger.Level} The level, or null if none found.\n */\ngoog.debug.Logger.Level.getPredefinedLevel = function(name) {\n  if (!goog.debug.Logger.Level.predefinedLevelsCache_) {\n    goog.debug.Logger.Level.createPredefinedLevelsCache_();\n  }\n\n  return goog.debug.Logger.Level.predefinedLevelsCache_[name] || null;\n};\n\n\n/**\n * Gets the highest predefined level <= #value.\n * @param {number} value Level value.\n * @return {goog.debug.Logger.Level} The level, or null if none found.\n */\ngoog.debug.Logger.Level.getPredefinedLevelByValue = function(value) {\n  if (!goog.debug.Logger.Level.predefinedLevelsCache_) {\n    goog.debug.Logger.Level.createPredefinedLevelsCache_();\n  }\n\n  if (value in /** @type {!Object} */ (\n          goog.debug.Logger.Level.predefinedLevelsCache_)) {\n    return goog.debug.Logger.Level.predefinedLevelsCache_[value];\n  }\n\n  for (var i = 0; i < goog.debug.Logger.Level.PREDEFINED_LEVELS.length; ++i) {\n    var level = goog.debug.Logger.Level.PREDEFINED_LEVELS[i];\n    if (level.value <= value) {\n      return level;\n    }\n  }\n  return null;\n};\n\n\n/**\n * Finds or creates a logger for a named subsystem. If a logger has already been\n * created with the given name it is returned. Otherwise a new logger is\n * created. If a new logger is created its log level will be configured based\n * on the LogManager configuration and it will configured to also send logging\n * output to its parent's handlers. It will be registered in the LogManager\n * global namespace.\n *\n * @param {string} name A name for the logger. This should be a dot-separated\n * name and should normally be based on the package name or class name of the\n * subsystem, such as goog.net.BrowserChannel.\n * @return {!goog.debug.Logger} The named logger.\n * @deprecated use {@link goog.log} instead.\n */\ngoog.debug.Logger.getLogger = function(name) {\n  return goog.debug.LogManager.getLogger(name);\n};\n\n\n/**\n * Logs a message to profiling tools, if available.\n * {@see https://developers.google.com/web-toolkit/speedtracer/logging-api}\n * {@see http://msdn.microsoft.com/en-us/library/dd433074(VS.85).aspx}\n * @param {string} msg The message to log.\n */\ngoog.debug.Logger.logToProfilers = function(msg) {\n  // Some browsers also log timeStamp calls to the console, only log\n  // if actually asked.\n  if (goog.debug.Logger.ENABLE_PROFILER_LOGGING) {\n    var msWriteProfilerMark = goog.global['msWriteProfilerMark'];\n    if (msWriteProfilerMark) {\n      // Logs a message to the Microsoft profiler\n      // On IE, console['timeStamp'] may output to console\n      msWriteProfilerMark(msg);\n      return;\n    }\n\n    // Using goog.global, as loggers might be used in window-less contexts.\n    var console = goog.global['console'];\n    if (console && console['timeStamp']) {\n      // Logs a message to Firebug, Web Inspector, SpeedTracer, etc.\n      console['timeStamp'](msg);\n    }\n  }\n};\n\n\n/**\n * Gets the name of this logger.\n * @return {string} The name of this logger.\n */\ngoog.debug.Logger.prototype.getName = function() {\n  return this.name_;\n};\n\n\n/**\n * Adds a handler to the logger. This doesn't use the event system because\n * we want to be able to add logging to the event system.\n * @param {Function} handler Handler function to add.\n */\ngoog.debug.Logger.prototype.addHandler = function(handler) {\n  if (goog.debug.LOGGING_ENABLED) {\n    if (goog.debug.Logger.ENABLE_HIERARCHY) {\n      if (!this.handlers_) {\n        this.handlers_ = [];\n      }\n      this.handlers_.push(handler);\n    } else {\n      goog.asserts.assert(\n          !this.name_, 'Cannot call addHandler on a non-root logger when ' +\n              'goog.debug.Logger.ENABLE_HIERARCHY is false.');\n      goog.debug.Logger.rootHandlers_.push(handler);\n    }\n  }\n};\n\n\n/**\n * Removes a handler from the logger. This doesn't use the event system because\n * we want to be able to add logging to the event system.\n * @param {Function} handler Handler function to remove.\n * @return {boolean} Whether the handler was removed.\n */\ngoog.debug.Logger.prototype.removeHandler = function(handler) {\n  if (goog.debug.LOGGING_ENABLED) {\n    var handlers = goog.debug.Logger.ENABLE_HIERARCHY ?\n        this.handlers_ :\n        goog.debug.Logger.rootHandlers_;\n    return !!handlers && goog.array.remove(handlers, handler);\n  } else {\n    return false;\n  }\n};\n\n\n/**\n * Returns the parent of this logger.\n * @return {goog.debug.Logger} The parent logger or null if this is the root.\n */\ngoog.debug.Logger.prototype.getParent = function() {\n  return this.parent_;\n};\n\n\n/**\n * Returns the children of this logger as a map of the child name to the logger.\n * @return {!Object} The map where the keys are the child leaf names and the\n *     values are the Logger objects.\n */\ngoog.debug.Logger.prototype.getChildren = function() {\n  if (!this.children_) {\n    this.children_ = {};\n  }\n  return this.children_;\n};\n\n\n/**\n * Set the log level specifying which message levels will be logged by this\n * logger. Message levels lower than this value will be discarded.\n * The level value Level.OFF can be used to turn off logging. If the new level\n * is null, it means that this node should inherit its level from its nearest\n * ancestor with a specific (non-null) level value.\n *\n * @param {goog.debug.Logger.Level} level The new level.\n */\ngoog.debug.Logger.prototype.setLevel = function(level) {\n  if (goog.debug.LOGGING_ENABLED) {\n    if (goog.debug.Logger.ENABLE_HIERARCHY) {\n      this.level_ = level;\n    } else {\n      goog.asserts.assert(\n          !this.name_, 'Cannot call setLevel() on a non-root logger when ' +\n              'goog.debug.Logger.ENABLE_HIERARCHY is false.');\n      goog.debug.Logger.rootLevel_ = level;\n    }\n  }\n};\n\n\n/**\n * Gets the log level specifying which message levels will be logged by this\n * logger. Message levels lower than this value will be discarded.\n * The level value Level.OFF can be used to turn off logging. If the level\n * is null, it means that this node should inherit its level from its nearest\n * ancestor with a specific (non-null) level value.\n *\n * @return {goog.debug.Logger.Level} The level.\n */\ngoog.debug.Logger.prototype.getLevel = function() {\n  return goog.debug.LOGGING_ENABLED ? this.level_ : goog.debug.Logger.Level.OFF;\n};\n\n\n/**\n * Returns the effective level of the logger based on its ancestors' levels.\n * @return {goog.debug.Logger.Level} The level.\n */\ngoog.debug.Logger.prototype.getEffectiveLevel = function() {\n  if (!goog.debug.LOGGING_ENABLED) {\n    return goog.debug.Logger.Level.OFF;\n  }\n\n  if (!goog.debug.Logger.ENABLE_HIERARCHY) {\n    return goog.debug.Logger.rootLevel_;\n  }\n  if (this.level_) {\n    return this.level_;\n  }\n  if (this.parent_) {\n    return this.parent_.getEffectiveLevel();\n  }\n  goog.asserts.fail('Root logger has no level set.');\n  return null;\n};\n\n\n/**\n * Checks if a message of the given level would actually be logged by this\n * logger. This check is based on the Loggers effective level, which may be\n * inherited from its parent.\n * @param {goog.debug.Logger.Level} level The level to check.\n * @return {boolean} Whether the message would be logged.\n */\ngoog.debug.Logger.prototype.isLoggable = function(level) {\n  return goog.debug.LOGGING_ENABLED &&\n      level.value >= this.getEffectiveLevel().value;\n};\n\n\n/**\n * Logs a message. If the logger is currently enabled for the\n * given message level then the given message is forwarded to all the\n * registered output Handler objects.\n * @param {goog.debug.Logger.Level} level One of the level identifiers.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error|Object=} opt_exception An exception associated with the\n *     message.\n */\ngoog.debug.Logger.prototype.log = function(level, msg, opt_exception) {\n  // java caches the effective level, not sure it's necessary here\n  if (goog.debug.LOGGING_ENABLED && this.isLoggable(level)) {\n    // Message callbacks can be useful when a log message is expensive to build.\n    if (goog.isFunction(msg)) {\n      msg = msg();\n    }\n\n    this.doLogRecord_(this.getLogRecord(level, msg, opt_exception));\n  }\n};\n\n\n/**\n * Creates a new log record and adds the exception (if present) to it.\n * @param {goog.debug.Logger.Level} level One of the level identifiers.\n * @param {string} msg The string message.\n * @param {Error|Object=} opt_exception An exception associated with the\n *     message.\n * @return {!goog.debug.LogRecord} A log record.\n * @suppress {es5Strict}\n */\ngoog.debug.Logger.prototype.getLogRecord = function(level, msg, opt_exception) {\n  if (goog.debug.LogBuffer.isBufferingEnabled()) {\n    var logRecord =\n        goog.debug.LogBuffer.getInstance().addRecord(level, msg, this.name_);\n  } else {\n    logRecord = new goog.debug.LogRecord(level, String(msg), this.name_);\n  }\n  if (opt_exception) {\n    logRecord.setException(opt_exception);\n  }\n  return logRecord;\n};\n\n\n/**\n * Logs a message at the Logger.Level.SHOUT level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.shout = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.SHOUT, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.SEVERE level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.severe = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.SEVERE, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.WARNING level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.warning = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.WARNING, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.INFO level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.info = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.INFO, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.CONFIG level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.config = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.CONFIG, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.FINE level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.fine = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.FINE, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.FINER level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.finer = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.FINER, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Logger.Level.FINEST level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.debug.Logger.prototype.finest = function(msg, opt_exception) {\n  if (goog.debug.LOGGING_ENABLED) {\n    this.log(goog.debug.Logger.Level.FINEST, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a LogRecord. If the logger is currently enabled for the\n * given message level then the given message is forwarded to all the\n * registered output Handler objects.\n * @param {goog.debug.LogRecord} logRecord A log record to log.\n */\ngoog.debug.Logger.prototype.logRecord = function(logRecord) {\n  if (goog.debug.LOGGING_ENABLED && this.isLoggable(logRecord.getLevel())) {\n    this.doLogRecord_(logRecord);\n  }\n};\n\n\n/**\n * Logs a LogRecord.\n * @param {goog.debug.LogRecord} logRecord A log record to log.\n * @private\n */\ngoog.debug.Logger.prototype.doLogRecord_ = function(logRecord) {\n  if (goog.debug.Logger.ENABLE_PROFILER_LOGGING) {\n    goog.debug.Logger.logToProfilers('log:' + logRecord.getMessage());\n  }\n  if (goog.debug.Logger.ENABLE_HIERARCHY) {\n    var target = this;\n    while (target) {\n      target.callPublish_(logRecord);\n      target = target.getParent();\n    }\n  } else {\n    for (var i = 0, handler; handler = goog.debug.Logger.rootHandlers_[i++];) {\n      handler(logRecord);\n    }\n  }\n};\n\n\n/**\n * Calls the handlers for publish.\n * @param {goog.debug.LogRecord} logRecord The log record to publish.\n * @private\n */\ngoog.debug.Logger.prototype.callPublish_ = function(logRecord) {\n  if (this.handlers_) {\n    for (var i = 0, handler; handler = this.handlers_[i]; i++) {\n      handler(logRecord);\n    }\n  }\n};\n\n\n/**\n * Sets the parent of this logger. This is used for setting up the logger tree.\n * @param {goog.debug.Logger} parent The parent logger.\n * @private\n */\ngoog.debug.Logger.prototype.setParent_ = function(parent) {\n  this.parent_ = parent;\n};\n\n\n/**\n * Adds a child to this logger. This is used for setting up the logger tree.\n * @param {string} name The leaf name of the child.\n * @param {goog.debug.Logger} logger The child logger.\n * @private\n */\ngoog.debug.Logger.prototype.addChild_ = function(name, logger) {\n  this.getChildren()[name] = logger;\n};\n\n\n/**\n * There is a single global LogManager object that is used to maintain a set of\n * shared state about Loggers and log services. This is loosely based on the\n * java class java.util.logging.LogManager.\n * @const\n */\ngoog.debug.LogManager = {};\n\n\n/**\n * Map of logger names to logger objects.\n *\n * @type {!Object<string, !goog.debug.Logger>}\n * @private\n */\ngoog.debug.LogManager.loggers_ = {};\n\n\n/**\n * The root logger which is the root of the logger tree.\n * @type {goog.debug.Logger}\n * @private\n */\ngoog.debug.LogManager.rootLogger_ = null;\n\n\n/**\n * Initializes the LogManager if not already initialized.\n */\ngoog.debug.LogManager.initialize = function() {\n  if (!goog.debug.LogManager.rootLogger_) {\n    goog.debug.LogManager.rootLogger_ =\n        new goog.debug.Logger(goog.debug.Logger.ROOT_LOGGER_NAME);\n    goog.debug.LogManager.loggers_[goog.debug.Logger.ROOT_LOGGER_NAME] =\n        goog.debug.LogManager.rootLogger_;\n    goog.debug.LogManager.rootLogger_.setLevel(goog.debug.Logger.Level.CONFIG);\n  }\n};\n\n\n/**\n * Returns all the loggers.\n * @return {!Object<string, !goog.debug.Logger>} Map of logger names to logger\n *     objects.\n */\ngoog.debug.LogManager.getLoggers = function() {\n  return goog.debug.LogManager.loggers_;\n};\n\n\n/**\n * Returns the root of the logger tree namespace, the logger with the empty\n * string as its name.\n *\n * @return {!goog.debug.Logger} The root logger.\n */\ngoog.debug.LogManager.getRoot = function() {\n  goog.debug.LogManager.initialize();\n  return /** @type {!goog.debug.Logger} */ (goog.debug.LogManager.rootLogger_);\n};\n\n\n/**\n * Finds a named logger.\n *\n * @param {string} name A name for the logger. This should be a dot-separated\n * name and should normally be based on the package name or class name of the\n * subsystem, such as goog.net.BrowserChannel.\n * @return {!goog.debug.Logger} The named logger.\n */\ngoog.debug.LogManager.getLogger = function(name) {\n  goog.debug.LogManager.initialize();\n  var ret = goog.debug.LogManager.loggers_[name];\n  return ret || goog.debug.LogManager.createLogger_(name);\n};\n\n\n/**\n * Creates a function that can be passed to goog.debug.catchErrors. The function\n * will log all reported errors using the given logger.\n * @param {goog.debug.Logger=} opt_logger The logger to log the errors to.\n *     Defaults to the root logger.\n * @return {function(Object)} The created function.\n */\ngoog.debug.LogManager.createFunctionForCatchErrors = function(opt_logger) {\n  return function(info) {\n    var logger = opt_logger || goog.debug.LogManager.getRoot();\n    logger.severe(\n        'Error: ' + info.message + ' (' + info.fileName + ' @ Line: ' +\n        info.line + ')');\n  };\n};\n\n\n/**\n * Creates the named logger. Will also create the parents of the named logger\n * if they don't yet exist.\n * @param {string} name The name of the logger.\n * @return {!goog.debug.Logger} The named logger.\n * @private\n */\ngoog.debug.LogManager.createLogger_ = function(name) {\n  // find parent logger\n  var logger = new goog.debug.Logger(name);\n  if (goog.debug.Logger.ENABLE_HIERARCHY) {\n    var lastDotIndex = name.lastIndexOf('.');\n    var parentName = name.substr(0, lastDotIndex);\n    var leafName = name.substr(lastDotIndex + 1);\n    var parentLogger = goog.debug.LogManager.getLogger(parentName);\n\n    // tell the parent about the child and the child about the parent\n    parentLogger.addChild_(leafName, logger);\n    logger.setParent_(parentLogger);\n  }\n\n  goog.debug.LogManager.loggers_[name] = logger;\n  return logger;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Basic strippable logging definitions.\n * @see http://go/closurelogging\n *\n * @author johnlenz@google.com (John Lenz)\n */\n\ngoog.provide('goog.log');\ngoog.provide('goog.log.Level');\ngoog.provide('goog.log.LogRecord');\ngoog.provide('goog.log.Logger');\n\ngoog.require('goog.debug');\ngoog.require('goog.debug.LogManager');\ngoog.require('goog.debug.LogRecord');\ngoog.require('goog.debug.Logger');\n\n\n/** @define {boolean} Whether logging is enabled. */\ngoog.define('goog.log.ENABLED', goog.debug.LOGGING_ENABLED);\n\n\n/** @const {string} */\ngoog.log.ROOT_LOGGER_NAME = goog.debug.Logger.ROOT_LOGGER_NAME;\n\n\n\n/**\n * @constructor\n * @final\n */\ngoog.log.Logger = goog.debug.Logger;\n\n\n\n/**\n * @constructor\n * @final\n */\ngoog.log.Level = goog.debug.Logger.Level;\n\n\n\n/**\n * @constructor\n * @final\n */\ngoog.log.LogRecord = goog.debug.LogRecord;\n\n\n/**\n * Finds or creates a logger for a named subsystem. If a logger has already been\n * created with the given name it is returned. Otherwise a new logger is\n * created. If a new logger is created its log level will be configured based\n * on the goog.debug.LogManager configuration and it will configured to also\n * send logging output to its parent's handlers.\n * @see goog.debug.LogManager\n *\n * @param {string} name A name for the logger. This should be a dot-separated\n *     name and should normally be based on the package name or class name of\n *     the subsystem, such as goog.net.BrowserChannel.\n * @param {goog.log.Level=} opt_level If provided, override the\n *     default logging level with the provided level.\n * @return {goog.log.Logger} The named logger or null if logging is disabled.\n */\ngoog.log.getLogger = function(name, opt_level) {\n  if (goog.log.ENABLED) {\n    var logger = goog.debug.LogManager.getLogger(name);\n    if (opt_level && logger) {\n      logger.setLevel(opt_level);\n    }\n    return logger;\n  } else {\n    return null;\n  }\n};\n\n\n// TODO(johnlenz): try to tighten the types to these functions.\n/**\n * Adds a handler to the logger. This doesn't use the event system because\n * we want to be able to add logging to the event system.\n * @param {goog.log.Logger} logger\n * @param {Function} handler Handler function to add.\n */\ngoog.log.addHandler = function(logger, handler) {\n  if (goog.log.ENABLED && logger) {\n    logger.addHandler(handler);\n  }\n};\n\n\n/**\n * Removes a handler from the logger. This doesn't use the event system because\n * we want to be able to add logging to the event system.\n * @param {goog.log.Logger} logger\n * @param {Function} handler Handler function to remove.\n * @return {boolean} Whether the handler was removed.\n */\ngoog.log.removeHandler = function(logger, handler) {\n  if (goog.log.ENABLED && logger) {\n    return logger.removeHandler(handler);\n  } else {\n    return false;\n  }\n};\n\n\n/**\n * Logs a message. If the logger is currently enabled for the\n * given message level then the given message is forwarded to all the\n * registered output Handler objects.\n * @param {goog.log.Logger} logger\n * @param {goog.log.Level} level One of the level identifiers.\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error|Object=} opt_exception An exception associated with the\n *     message.\n */\ngoog.log.log = function(logger, level, msg, opt_exception) {\n  if (goog.log.ENABLED && logger) {\n    logger.log(level, msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Level.SEVERE level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.log.Logger} logger\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.log.error = function(logger, msg, opt_exception) {\n  if (goog.log.ENABLED && logger) {\n    logger.severe(msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Level.WARNING level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.log.Logger} logger\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.log.warning = function(logger, msg, opt_exception) {\n  if (goog.log.ENABLED && logger) {\n    logger.warning(msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Level.INFO level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.log.Logger} logger\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.log.info = function(logger, msg, opt_exception) {\n  if (goog.log.ENABLED && logger) {\n    logger.info(msg, opt_exception);\n  }\n};\n\n\n/**\n * Logs a message at the Level.Fine level.\n * If the logger is currently enabled for the given message level then the\n * given message is forwarded to all the registered output Handler objects.\n * @param {goog.log.Logger} logger\n * @param {goog.debug.Loggable} msg The message to log.\n * @param {Error=} opt_exception An exception associated with the message.\n */\ngoog.log.fine = function(logger, msg, opt_exception) {\n  if (goog.log.ENABLED && logger) {\n    logger.fine(msg, opt_exception);\n  }\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Wrapper class for handling XmlHttpRequests.\n *\n * One off requests can be sent through goog.net.XhrIo.send() or an\n * instance can be created to send multiple requests.  Each request uses its\n * own XmlHttpRequest object and handles clearing of the event callback to\n * ensure no leaks.\n *\n * XhrIo is event based, it dispatches events on success, failure, finishing,\n * ready-state change, or progress (download and upload).\n *\n * The ready-state or timeout event fires first, followed by\n * a generic completed event. Then the abort, error, or success event\n * is fired as appropriate. Progress events are fired as they are\n * received. Lastly, the ready event will fire to indicate that the\n * object may be used to make another request.\n *\n * The error event may also be called before completed and\n * ready-state-change if the XmlHttpRequest.open() or .send() methods throw.\n *\n * This class does not support multiple requests, queuing, or prioritization.\n *\n * When progress events are supported by the browser, and progress is\n * enabled via .setProgressEventsEnabled(true), the\n * goog.net.EventType.PROGRESS event will be the re-dispatched browser\n * progress event. Additionally, a DOWNLOAD_PROGRESS or UPLOAD_PROGRESS event\n * will be fired for download and upload progress respectively.\n *\n */\n\n\ngoog.provide('goog.net.XhrIo');\ngoog.provide('goog.net.XhrIo.ResponseType');\n\ngoog.require('goog.Timer');\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.debug.entryPointRegistry');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.json.hybrid');\ngoog.require('goog.log');\ngoog.require('goog.net.ErrorCode');\ngoog.require('goog.net.EventType');\ngoog.require('goog.net.HttpStatus');\ngoog.require('goog.net.XmlHttp');\ngoog.require('goog.string');\ngoog.require('goog.structs');\ngoog.require('goog.structs.Map');\ngoog.require('goog.uri.utils');\ngoog.require('goog.userAgent');\n\ngoog.forwardDeclare('goog.Uri');\n\ngoog.scope(function() {\n\n/**\n * Basic class for handling XMLHttpRequests.\n * @param {goog.net.XmlHttpFactory=} opt_xmlHttpFactory Factory to use when\n *     creating XMLHttpRequest objects.\n * @constructor\n * @extends {goog.events.EventTarget}\n */\ngoog.net.XhrIo = function(opt_xmlHttpFactory) {\n  XhrIo.base(this, 'constructor');\n\n  /**\n   * Map of default headers to add to every request, use:\n   * XhrIo.headers.set(name, value)\n   * @type {!goog.structs.Map}\n   */\n  this.headers = new goog.structs.Map();\n\n  /**\n   * Optional XmlHttpFactory\n   * @private {goog.net.XmlHttpFactory}\n   */\n  this.xmlHttpFactory_ = opt_xmlHttpFactory || null;\n\n  /**\n   * Whether XMLHttpRequest is active.  A request is active from the time send()\n   * is called until onReadyStateChange() is complete, or error() or abort()\n   * is called.\n   * @private {boolean}\n   */\n  this.active_ = false;\n\n  /**\n   * The XMLHttpRequest object that is being used for the transfer.\n   * @private {?goog.net.XhrLike.OrNative}\n   */\n  this.xhr_ = null;\n\n  /**\n   * The options to use with the current XMLHttpRequest object.\n   * @private {Object}\n   */\n  this.xhrOptions_ = null;\n\n  /**\n   * Last URL that was requested.\n   * @private {string|goog.Uri}\n   */\n  this.lastUri_ = '';\n\n  /**\n   * Method for the last request.\n   * @private {string}\n   */\n  this.lastMethod_ = '';\n\n  /**\n   * Last error code.\n   * @private {!goog.net.ErrorCode}\n   */\n  this.lastErrorCode_ = goog.net.ErrorCode.NO_ERROR;\n\n  /**\n   * Last error message.\n   * @private {Error|string}\n   */\n  this.lastError_ = '';\n\n  /**\n   * Used to ensure that we don't dispatch an multiple ERROR events. This can\n   * happen in IE when it does a synchronous load and one error is handled in\n   * the ready statte change and one is handled due to send() throwing an\n   * exception.\n   * @private {boolean}\n   */\n  this.errorDispatched_ = false;\n\n  /**\n   * Used to make sure we don't fire the complete event from inside a send call.\n   * @private {boolean}\n   */\n  this.inSend_ = false;\n\n  /**\n   * Used in determining if a call to {@link #onReadyStateChange_} is from\n   * within a call to this.xhr_.open.\n   * @private {boolean}\n   */\n  this.inOpen_ = false;\n\n  /**\n   * Used in determining if a call to {@link #onReadyStateChange_} is from\n   * within a call to this.xhr_.abort.\n   * @private {boolean}\n   */\n  this.inAbort_ = false;\n\n  /**\n   * Number of milliseconds after which an incomplete request will be aborted\n   * and a {@link goog.net.EventType.TIMEOUT} event raised; 0 means no timeout\n   * is set.\n   * @private {number}\n   */\n  this.timeoutInterval_ = 0;\n\n  /**\n   * Timer to track request timeout.\n   * @private {?number}\n   */\n  this.timeoutId_ = null;\n\n  /**\n   * The requested type for the response. The empty string means use the default\n   * XHR behavior.\n   * @private {goog.net.XhrIo.ResponseType}\n   */\n  this.responseType_ = ResponseType.DEFAULT;\n\n  /**\n   * Whether a \"credentialed\" request is to be sent (one that is aware of\n   * cookies and authentication). This is applicable only for cross-domain\n   * requests and more recent browsers that support this part of the HTTP Access\n   * Control standard.\n   *\n   * @see http://www.w3.org/TR/XMLHttpRequest/#the-withcredentials-attribute\n   *\n   * @private {boolean}\n   */\n  this.withCredentials_ = false;\n\n  /**\n   * Whether progress events are enabled for this request. This is\n   * disabled by default because setting a progress event handler\n   * causes pre-flight OPTIONS requests to be sent for CORS requests,\n   * even in cases where a pre-flight request would not otherwise be\n   * sent.\n   *\n   * @see http://xhr.spec.whatwg.org/#security-considerations\n   *\n   * Note that this can cause problems for Firefox 22 and below, as an\n   * older \"LSProgressEvent\" will be dispatched by the browser. That\n   * progress event is no longer supported, and can lead to failures,\n   * including throwing exceptions.\n   *\n   * @see http://bugzilla.mozilla.org/show_bug.cgi?id=845631\n   * @see b/23469793\n   *\n   * @private {boolean}\n   */\n  this.progressEventsEnabled_ = false;\n\n  /**\n   * True if we can use XMLHttpRequest's timeout directly.\n   * @private {boolean}\n   */\n  this.useXhr2Timeout_ = false;\n};\ngoog.inherits(goog.net.XhrIo, goog.events.EventTarget);\n\nvar XhrIo = goog.net.XhrIo;\n\n/**\n * Response types that may be requested for XMLHttpRequests.\n * @enum {string}\n * @see http://www.w3.org/TR/XMLHttpRequest/#the-responsetype-attribute\n */\ngoog.net.XhrIo.ResponseType = {\n  DEFAULT: '',\n  TEXT: 'text',\n  DOCUMENT: 'document',\n  // Not supported as of Chrome 10.0.612.1 dev\n  BLOB: 'blob',\n  ARRAY_BUFFER: 'arraybuffer'\n};\n\nvar ResponseType = goog.net.XhrIo.ResponseType;\n\n\n/**\n * A reference to the XhrIo logger\n * @private {?goog.log.Logger}\n * @const\n */\ngoog.net.XhrIo.prototype.logger_ = goog.log.getLogger('goog.net.XhrIo');\n\n\n/**\n * The Content-Type HTTP header name\n * @type {string}\n */\ngoog.net.XhrIo.CONTENT_TYPE_HEADER = 'Content-Type';\n\n\n/**\n * The Content-Transfer-Encoding HTTP header name\n * @type {string}\n */\ngoog.net.XhrIo.CONTENT_TRANSFER_ENCODING = 'Content-Transfer-Encoding';\n\n\n/**\n * The pattern matching the 'http' and 'https' URI schemes\n * @type {!RegExp}\n */\ngoog.net.XhrIo.HTTP_SCHEME_PATTERN = /^https?$/i;\n\n\n/**\n * The methods that typically come along with form data.  We set different\n * headers depending on whether the HTTP action is one of these.\n * @type {!Array<string>}\n */\ngoog.net.XhrIo.METHODS_WITH_FORM_DATA = ['POST', 'PUT'];\n\n\n/**\n * The Content-Type HTTP header value for a url-encoded form\n * @type {string}\n */\ngoog.net.XhrIo.FORM_CONTENT_TYPE =\n    'application/x-www-form-urlencoded;charset=utf-8';\n\n\n/**\n * The XMLHttpRequest Level two timeout delay ms property name.\n *\n * @see http://www.w3.org/TR/XMLHttpRequest/#the-timeout-attribute\n *\n * @private {string}\n * @const\n */\ngoog.net.XhrIo.XHR2_TIMEOUT_ = 'timeout';\n\n\n/**\n * The XMLHttpRequest Level two ontimeout handler property name.\n *\n * @see http://www.w3.org/TR/XMLHttpRequest/#the-timeout-attribute\n *\n * @private {string}\n * @const\n */\ngoog.net.XhrIo.XHR2_ON_TIMEOUT_ = 'ontimeout';\n\n\n/**\n * All non-disposed instances of goog.net.XhrIo created\n * by {@link goog.net.XhrIo.send} are in this Array.\n * @see goog.net.XhrIo.cleanup\n * @private {!Array<!goog.net.XhrIo>}\n */\ngoog.net.XhrIo.sendInstances_ = [];\n\n\n/**\n * Static send that creates a short lived instance of XhrIo to send the\n * request.\n * @see goog.net.XhrIo.cleanup\n * @param {string|goog.Uri} url Uri to make request to.\n * @param {?function(this:goog.net.XhrIo, ?)=} opt_callback Callback function\n *     for when request is complete.\n * @param {string=} opt_method Send method, default: GET.\n * @param {ArrayBuffer|ArrayBufferView|Blob|Document|FormData|string=}\n *     opt_content Body data.\n * @param {Object|goog.structs.Map=} opt_headers Map of headers to add to the\n *     request.\n * @param {number=} opt_timeoutInterval Number of milliseconds after which an\n *     incomplete request will be aborted; 0 means no timeout is set.\n * @param {boolean=} opt_withCredentials Whether to send credentials with the\n *     request. Default to false. See {@link goog.net.XhrIo#setWithCredentials}.\n * @return {!goog.net.XhrIo} The sent XhrIo.\n */\ngoog.net.XhrIo.send = function(\n    url, opt_callback, opt_method, opt_content, opt_headers,\n    opt_timeoutInterval, opt_withCredentials) {\n  var x = new goog.net.XhrIo();\n  goog.net.XhrIo.sendInstances_.push(x);\n  if (opt_callback) {\n    x.listen(goog.net.EventType.COMPLETE, opt_callback);\n  }\n  x.listenOnce(goog.net.EventType.READY, x.cleanupSend_);\n  if (opt_timeoutInterval) {\n    x.setTimeoutInterval(opt_timeoutInterval);\n  }\n  if (opt_withCredentials) {\n    x.setWithCredentials(opt_withCredentials);\n  }\n  x.send(url, opt_method, opt_content, opt_headers);\n  return x;\n};\n\n\n/**\n * Disposes all non-disposed instances of goog.net.XhrIo created by\n * {@link goog.net.XhrIo.send}.\n * {@link goog.net.XhrIo.send} cleans up the goog.net.XhrIo instance\n * it creates when the request completes or fails.  However, if\n * the request never completes, then the goog.net.XhrIo is not disposed.\n * This can occur if the window is unloaded before the request completes.\n * We could have {@link goog.net.XhrIo.send} return the goog.net.XhrIo\n * it creates and make the client of {@link goog.net.XhrIo.send} be\n * responsible for disposing it in this case.  However, this makes things\n * significantly more complicated for the client, and the whole point\n * of {@link goog.net.XhrIo.send} is that it's simple and easy to use.\n * Clients of {@link goog.net.XhrIo.send} should call\n * {@link goog.net.XhrIo.cleanup} when doing final\n * cleanup on window unload.\n */\ngoog.net.XhrIo.cleanup = function() {\n  var instances = goog.net.XhrIo.sendInstances_;\n  while (instances.length) {\n    instances.pop().dispose();\n  }\n};\n\n\n/**\n * Installs exception protection for all entry point introduced by\n * goog.net.XhrIo instances which are not protected by\n * {@link goog.debug.ErrorHandler#protectWindowSetTimeout},\n * {@link goog.debug.ErrorHandler#protectWindowSetInterval}, or\n * {@link goog.events.protectBrowserEventEntryPoint}.\n *\n * @param {goog.debug.ErrorHandler} errorHandler Error handler with which to\n *     protect the entry point(s).\n */\ngoog.net.XhrIo.protectEntryPoints = function(errorHandler) {\n  goog.net.XhrIo.prototype.onReadyStateChangeEntryPoint_ =\n      errorHandler.protectEntryPoint(\n          goog.net.XhrIo.prototype.onReadyStateChangeEntryPoint_);\n};\n\n\n/**\n * Disposes of the specified goog.net.XhrIo created by\n * {@link goog.net.XhrIo.send} and removes it from\n * {@link goog.net.XhrIo.pendingStaticSendInstances_}.\n * @private\n */\ngoog.net.XhrIo.prototype.cleanupSend_ = function() {\n  this.dispose();\n  goog.array.remove(goog.net.XhrIo.sendInstances_, this);\n};\n\n\n/**\n * Returns the number of milliseconds after which an incomplete request will be\n * aborted, or 0 if no timeout is set.\n * @return {number} Timeout interval in milliseconds.\n */\ngoog.net.XhrIo.prototype.getTimeoutInterval = function() {\n  return this.timeoutInterval_;\n};\n\n\n/**\n * Sets the number of milliseconds after which an incomplete request will be\n * aborted and a {@link goog.net.EventType.TIMEOUT} event raised; 0 means no\n * timeout is set.\n * @param {number} ms Timeout interval in milliseconds; 0 means none.\n */\ngoog.net.XhrIo.prototype.setTimeoutInterval = function(ms) {\n  this.timeoutInterval_ = Math.max(0, ms);\n};\n\n\n/**\n * Sets the desired type for the response. At time of writing, this is only\n * supported in very recent versions of WebKit (10.0.612.1 dev and later).\n *\n * If this is used, the response may only be accessed via {@link #getResponse}.\n *\n * @param {goog.net.XhrIo.ResponseType} type The desired type for the response.\n */\ngoog.net.XhrIo.prototype.setResponseType = function(type) {\n  this.responseType_ = type;\n};\n\n\n/**\n * Gets the desired type for the response.\n * @return {goog.net.XhrIo.ResponseType} The desired type for the response.\n */\ngoog.net.XhrIo.prototype.getResponseType = function() {\n  return this.responseType_;\n};\n\n\n/**\n * Sets whether a \"credentialed\" request that is aware of cookie and\n * authentication information should be made. This option is only supported by\n * browsers that support HTTP Access Control. As of this writing, this option\n * is not supported in IE.\n *\n * @param {boolean} withCredentials Whether this should be a \"credentialed\"\n *     request.\n */\ngoog.net.XhrIo.prototype.setWithCredentials = function(withCredentials) {\n  this.withCredentials_ = withCredentials;\n};\n\n\n/**\n * Gets whether a \"credentialed\" request is to be sent.\n * @return {boolean} The desired type for the response.\n */\ngoog.net.XhrIo.prototype.getWithCredentials = function() {\n  return this.withCredentials_;\n};\n\n\n/**\n * Sets whether progress events are enabled for this request. Note\n * that progress events require pre-flight OPTIONS request handling\n * for CORS requests, and may cause trouble with older browsers. See\n * progressEventsEnabled_ for details.\n * @param {boolean} enabled Whether progress events should be enabled.\n */\ngoog.net.XhrIo.prototype.setProgressEventsEnabled = function(enabled) {\n  this.progressEventsEnabled_ = enabled;\n};\n\n\n/**\n * Gets whether progress events are enabled.\n * @return {boolean} Whether progress events are enabled for this request.\n */\ngoog.net.XhrIo.prototype.getProgressEventsEnabled = function() {\n  return this.progressEventsEnabled_;\n};\n\n\n/**\n * Instance send that actually uses XMLHttpRequest to make a server call.\n * @param {string|goog.Uri} url Uri to make request to.\n * @param {string=} opt_method Send method, default: GET.\n * @param {ArrayBuffer|ArrayBufferView|Blob|Document|FormData|string=}\n *     opt_content Body data.\n * @param {Object|goog.structs.Map=} opt_headers Map of headers to add to the\n *     request.\n * @suppress {deprecated} Use deprecated goog.structs.forEach to allow different\n * types of parameters for opt_headers.\n */\ngoog.net.XhrIo.prototype.send = function(\n    url, opt_method, opt_content, opt_headers) {\n  if (this.xhr_) {\n    throw new Error(\n        '[goog.net.XhrIo] Object is active with another request=' +\n        this.lastUri_ + '; newUri=' + url);\n  }\n\n  var method = opt_method ? opt_method.toUpperCase() : 'GET';\n\n  this.lastUri_ = url;\n  this.lastError_ = '';\n  this.lastErrorCode_ = goog.net.ErrorCode.NO_ERROR;\n  this.lastMethod_ = method;\n  this.errorDispatched_ = false;\n  this.active_ = true;\n\n  // Use the factory to create the XHR object and options\n  this.xhr_ = this.createXhr();\n  this.xhrOptions_ = this.xmlHttpFactory_ ? this.xmlHttpFactory_.getOptions() :\n                                            goog.net.XmlHttp.getOptions();\n\n  // Set up the onreadystatechange callback\n  this.xhr_.onreadystatechange = goog.bind(this.onReadyStateChange_, this);\n\n  // Set up upload/download progress events, if progress events are supported.\n  if (this.getProgressEventsEnabled() && 'onprogress' in this.xhr_) {\n    this.xhr_.onprogress =\n        goog.bind(function(e) { this.onProgressHandler_(e, true); }, this);\n    if (this.xhr_.upload) {\n      this.xhr_.upload.onprogress = goog.bind(this.onProgressHandler_, this);\n    }\n  }\n\n  /**\n   * Try to open the XMLHttpRequest (always async), if an error occurs here it\n   * is generally permission denied\n   */\n  try {\n    goog.log.fine(this.logger_, this.formatMsg_('Opening Xhr'));\n    this.inOpen_ = true;\n    this.xhr_.open(method, String(url), true);  // Always async!\n    this.inOpen_ = false;\n  } catch (err) {\n    goog.log.fine(\n        this.logger_, this.formatMsg_('Error opening Xhr: ' + err.message));\n    this.error_(goog.net.ErrorCode.EXCEPTION, err);\n    return;\n  }\n\n  // We can't use null since this won't allow requests with form data to have a\n  // content length specified which will cause some proxies to return a 411\n  // error.\n  var content = opt_content || '';\n\n  var headers = this.headers.clone();\n\n  // Add headers specific to this request\n  if (opt_headers) {\n    goog.structs.forEach(\n        opt_headers, function(value, key) { headers.set(key, value); });\n  }\n\n  // Find whether a content type header is set, ignoring case.\n  // HTTP header names are case-insensitive.  See:\n  // http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2\n  var contentTypeKey =\n      goog.array.find(headers.getKeys(), goog.net.XhrIo.isContentTypeHeader_);\n\n  var contentIsFormData =\n      (goog.global['FormData'] && (content instanceof goog.global['FormData']));\n  if (goog.array.contains(goog.net.XhrIo.METHODS_WITH_FORM_DATA, method) &&\n      !contentTypeKey && !contentIsFormData) {\n    // For requests typically with form data, default to the url-encoded form\n    // content type unless this is a FormData request.  For FormData,\n    // the browser will automatically add a multipart/form-data content type\n    // with an appropriate multipart boundary.\n    headers.set(\n        goog.net.XhrIo.CONTENT_TYPE_HEADER, goog.net.XhrIo.FORM_CONTENT_TYPE);\n  }\n\n  // Add the headers to the Xhr object\n  headers.forEach(function(value, key) {\n    this.xhr_.setRequestHeader(key, value);\n  }, this);\n\n  if (this.responseType_) {\n    this.xhr_.responseType = this.responseType_;\n  }\n  // Set xhr_.withCredentials only when the value is different, or else in\n  // synchronous XMLHtppRequest.open Firefox will throw an exception.\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=736340\n  if ('withCredentials' in this.xhr_ &&\n      this.xhr_.withCredentials !== this.withCredentials_) {\n    this.xhr_.withCredentials = this.withCredentials_;\n  }\n\n  /**\n   * Try to send the request, or other wise report an error (404 not found).\n   */\n  try {\n    this.cleanUpTimeoutTimer_();  // Paranoid, should never be running.\n    if (this.timeoutInterval_ > 0) {\n      this.useXhr2Timeout_ = goog.net.XhrIo.shouldUseXhr2Timeout_(this.xhr_);\n      goog.log.fine(\n          this.logger_, this.formatMsg_(\n                            'Will abort after ' + this.timeoutInterval_ +\n                            'ms if incomplete, xhr2 ' + this.useXhr2Timeout_));\n      if (this.useXhr2Timeout_) {\n        this.xhr_[goog.net.XhrIo.XHR2_TIMEOUT_] = this.timeoutInterval_;\n        this.xhr_[goog.net.XhrIo.XHR2_ON_TIMEOUT_] =\n            goog.bind(this.timeout_, this);\n      } else {\n        this.timeoutId_ =\n            goog.Timer.callOnce(this.timeout_, this.timeoutInterval_, this);\n      }\n    }\n    goog.log.fine(this.logger_, this.formatMsg_('Sending request'));\n    this.inSend_ = true;\n    this.xhr_.send(content);\n    this.inSend_ = false;\n\n  } catch (err) {\n    goog.log.fine(this.logger_, this.formatMsg_('Send error: ' + err.message));\n    this.error_(goog.net.ErrorCode.EXCEPTION, err);\n  }\n};\n\n\n/**\n * Determines if the argument is an XMLHttpRequest that supports the level 2\n * timeout value and event.\n *\n * Currently, FF 21.0 OS X has the fields but won't actually call the timeout\n * handler.  Perhaps the confusion in the bug referenced below hasn't\n * entirely been resolved.\n *\n * @see http://www.w3.org/TR/XMLHttpRequest/#the-timeout-attribute\n * @see https://bugzilla.mozilla.org/show_bug.cgi?id=525816\n *\n * @param {!goog.net.XhrLike.OrNative} xhr The request.\n * @return {boolean} True if the request supports level 2 timeout.\n * @private\n */\ngoog.net.XhrIo.shouldUseXhr2Timeout_ = function(xhr) {\n  return goog.userAgent.IE && goog.userAgent.isVersionOrHigher(9) &&\n      goog.isNumber(xhr[goog.net.XhrIo.XHR2_TIMEOUT_]) &&\n      goog.isDef(xhr[goog.net.XhrIo.XHR2_ON_TIMEOUT_]);\n};\n\n\n/**\n * @param {string} header An HTTP header key.\n * @return {boolean} Whether the key is a content type header (ignoring\n *     case.\n * @private\n */\ngoog.net.XhrIo.isContentTypeHeader_ = function(header) {\n  return goog.string.caseInsensitiveEquals(\n      goog.net.XhrIo.CONTENT_TYPE_HEADER, header);\n};\n\n\n/**\n * Creates a new XHR object.\n * @return {!goog.net.XhrLike.OrNative} The newly created XHR object.\n * @protected\n */\ngoog.net.XhrIo.prototype.createXhr = function() {\n  return this.xmlHttpFactory_ ? this.xmlHttpFactory_.createInstance() :\n                                goog.net.XmlHttp();\n};\n\n\n/**\n * The request didn't complete after {@link goog.net.XhrIo#timeoutInterval_}\n * milliseconds; raises a {@link goog.net.EventType.TIMEOUT} event and aborts\n * the request.\n * @private\n */\ngoog.net.XhrIo.prototype.timeout_ = function() {\n  if (typeof goog == 'undefined') {\n    // If goog is undefined then the callback has occurred as the application\n    // is unloading and will error.  Thus we let it silently fail.\n  } else if (this.xhr_) {\n    this.lastError_ =\n        'Timed out after ' + this.timeoutInterval_ + 'ms, aborting';\n    this.lastErrorCode_ = goog.net.ErrorCode.TIMEOUT;\n    goog.log.fine(this.logger_, this.formatMsg_(this.lastError_));\n    this.dispatchEvent(goog.net.EventType.TIMEOUT);\n    this.abort(goog.net.ErrorCode.TIMEOUT);\n  }\n};\n\n\n/**\n * Something errorred, so inactivate, fire error callback and clean up\n * @param {goog.net.ErrorCode} errorCode The error code.\n * @param {Error} err The error object.\n * @private\n */\ngoog.net.XhrIo.prototype.error_ = function(errorCode, err) {\n  this.active_ = false;\n  if (this.xhr_) {\n    this.inAbort_ = true;\n    this.xhr_.abort();  // Ensures XHR isn't hung (FF)\n    this.inAbort_ = false;\n  }\n  this.lastError_ = err;\n  this.lastErrorCode_ = errorCode;\n  this.dispatchErrors_();\n  this.cleanUpXhr_();\n};\n\n\n/**\n * Dispatches COMPLETE and ERROR in case of an error. This ensures that we do\n * not dispatch multiple error events.\n * @private\n */\ngoog.net.XhrIo.prototype.dispatchErrors_ = function() {\n  if (!this.errorDispatched_) {\n    this.errorDispatched_ = true;\n    this.dispatchEvent(goog.net.EventType.COMPLETE);\n    this.dispatchEvent(goog.net.EventType.ERROR);\n  }\n};\n\n\n/**\n * Abort the current XMLHttpRequest\n * @param {goog.net.ErrorCode=} opt_failureCode Optional error code to use -\n *     defaults to ABORT.\n */\ngoog.net.XhrIo.prototype.abort = function(opt_failureCode) {\n  if (this.xhr_ && this.active_) {\n    goog.log.fine(this.logger_, this.formatMsg_('Aborting'));\n    this.active_ = false;\n    this.inAbort_ = true;\n    this.xhr_.abort();\n    this.inAbort_ = false;\n    this.lastErrorCode_ = opt_failureCode || goog.net.ErrorCode.ABORT;\n    this.dispatchEvent(goog.net.EventType.COMPLETE);\n    this.dispatchEvent(goog.net.EventType.ABORT);\n    this.cleanUpXhr_();\n  }\n};\n\n\n/**\n * Nullifies all callbacks to reduce risks of leaks.\n * @override\n * @protected\n */\ngoog.net.XhrIo.prototype.disposeInternal = function() {\n  if (this.xhr_) {\n    // We explicitly do not call xhr_.abort() unless active_ is still true.\n    // This is to avoid unnecessarily aborting a successful request when\n    // dispose() is called in a callback triggered by a complete response, but\n    // in which browser cleanup has not yet finished.\n    // (See http://b/issue?id=1684217.)\n    if (this.active_) {\n      this.active_ = false;\n      this.inAbort_ = true;\n      this.xhr_.abort();\n      this.inAbort_ = false;\n    }\n    this.cleanUpXhr_(true);\n  }\n\n  XhrIo.base(this, 'disposeInternal');\n};\n\n\n/**\n * Internal handler for the XHR object's readystatechange event.  This method\n * checks the status and the readystate and fires the correct callbacks.\n * If the request has ended, the handlers are cleaned up and the XHR object is\n * nullified.\n * @private\n */\ngoog.net.XhrIo.prototype.onReadyStateChange_ = function() {\n  if (this.isDisposed()) {\n    // This method is the target of an untracked goog.Timer.callOnce().\n    return;\n  }\n  if (!this.inOpen_ && !this.inSend_ && !this.inAbort_) {\n    // Were not being called from within a call to this.xhr_.send\n    // this.xhr_.abort, or this.xhr_.open, so this is an entry point\n    this.onReadyStateChangeEntryPoint_();\n  } else {\n    this.onReadyStateChangeHelper_();\n  }\n};\n\n\n/**\n * Used to protect the onreadystatechange handler entry point.  Necessary\n * as {#onReadyStateChange_} maybe called from within send or abort, this\n * method is only called when {#onReadyStateChange_} is called as an\n * entry point.\n * {@see #protectEntryPoints}\n * @private\n */\ngoog.net.XhrIo.prototype.onReadyStateChangeEntryPoint_ = function() {\n  this.onReadyStateChangeHelper_();\n};\n\n\n/**\n * Helper for {@link #onReadyStateChange_}.  This is used so that\n * entry point calls to {@link #onReadyStateChange_} can be routed through\n * {@link #onReadyStateChangeEntryPoint_}.\n * @private\n */\ngoog.net.XhrIo.prototype.onReadyStateChangeHelper_ = function() {\n  if (!this.active_) {\n    // can get called inside abort call\n    return;\n  }\n\n  if (typeof goog == 'undefined') {\n    // NOTE(user): If goog is undefined then the callback has occurred as the\n    // application is unloading and will error.  Thus we let it silently fail.\n\n  } else if (\n      this.xhrOptions_[goog.net.XmlHttp.OptionType.LOCAL_REQUEST_ERROR] &&\n      this.getReadyState() == goog.net.XmlHttp.ReadyState.COMPLETE &&\n      this.getStatus() == 2) {\n    // NOTE(user): In IE if send() errors on a *local* request the readystate\n    // is still changed to COMPLETE.  We need to ignore it and allow the\n    // try/catch around send() to pick up the error.\n    goog.log.fine(\n        this.logger_,\n        this.formatMsg_('Local request error detected and ignored'));\n\n  } else {\n    // In IE when the response has been cached we sometimes get the callback\n    // from inside the send call and this usually breaks code that assumes that\n    // XhrIo is asynchronous.  If that is the case we delay the callback\n    // using a timer.\n    if (this.inSend_ &&\n        this.getReadyState() == goog.net.XmlHttp.ReadyState.COMPLETE) {\n      goog.Timer.callOnce(this.onReadyStateChange_, 0, this);\n      return;\n    }\n\n    this.dispatchEvent(goog.net.EventType.READY_STATE_CHANGE);\n\n    // readyState indicates the transfer has finished\n    if (this.isComplete()) {\n      goog.log.fine(this.logger_, this.formatMsg_('Request complete'));\n\n      this.active_ = false;\n\n      try {\n        // Call the specific callbacks for success or failure. Only call the\n        // success if the status is 200 (HTTP_OK) or 304 (HTTP_CACHED)\n        if (this.isSuccess()) {\n          this.dispatchEvent(goog.net.EventType.COMPLETE);\n          this.dispatchEvent(goog.net.EventType.SUCCESS);\n        } else {\n          this.lastErrorCode_ = goog.net.ErrorCode.HTTP_ERROR;\n          this.lastError_ =\n              this.getStatusText() + ' [' + this.getStatus() + ']';\n          this.dispatchErrors_();\n        }\n      } finally {\n        this.cleanUpXhr_();\n      }\n    }\n  }\n};\n\n\n/**\n * Internal handler for the XHR object's onprogress event. Fires both a generic\n * PROGRESS event and either a DOWNLOAD_PROGRESS or UPLOAD_PROGRESS event to\n * allow specific binding for each XHR progress event.\n * @param {!ProgressEvent} e XHR progress event.\n * @param {boolean=} opt_isDownload Whether the current progress event is from a\n *     download. Used to determine whether DOWNLOAD_PROGRESS or UPLOAD_PROGRESS\n *     event should be dispatched.\n * @private\n */\ngoog.net.XhrIo.prototype.onProgressHandler_ = function(e, opt_isDownload) {\n  goog.asserts.assert(\n      e.type === goog.net.EventType.PROGRESS,\n      'goog.net.EventType.PROGRESS is of the same type as raw XHR progress.');\n  this.dispatchEvent(\n      goog.net.XhrIo.buildProgressEvent_(e, goog.net.EventType.PROGRESS));\n  this.dispatchEvent(\n      goog.net.XhrIo.buildProgressEvent_(\n          e, opt_isDownload ? goog.net.EventType.DOWNLOAD_PROGRESS :\n                              goog.net.EventType.UPLOAD_PROGRESS));\n};\n\n\n/**\n * Creates a representation of the native ProgressEvent. IE doesn't support\n * constructing ProgressEvent via \"new\", and the alternatives (e.g.,\n * ProgressEvent.initProgressEvent) are non-standard or deprecated.\n * @param {!ProgressEvent} e XHR progress event.\n * @param {!goog.net.EventType} eventType The type of the event.\n * @return {!ProgressEvent} The progress event.\n * @private\n */\ngoog.net.XhrIo.buildProgressEvent_ = function(e, eventType) {\n  return /** @type {!ProgressEvent} */ ({\n    type: eventType,\n    lengthComputable: e.lengthComputable,\n    loaded: e.loaded,\n    total: e.total\n  });\n};\n\n\n/**\n * Remove the listener to protect against leaks, and nullify the XMLHttpRequest\n * object.\n * @param {boolean=} opt_fromDispose If this is from the dispose (don't want to\n *     fire any events).\n * @private\n */\ngoog.net.XhrIo.prototype.cleanUpXhr_ = function(opt_fromDispose) {\n  if (this.xhr_) {\n    // Cancel any pending timeout event handler.\n    this.cleanUpTimeoutTimer_();\n\n    // Save reference so we can mark it as closed after the READY event.  The\n    // READY event may trigger another request, thus we must nullify this.xhr_\n    var xhr = this.xhr_;\n    var clearedOnReadyStateChange =\n        this.xhrOptions_[goog.net.XmlHttp.OptionType.USE_NULL_FUNCTION] ?\n        goog.nullFunction :\n        null;\n    this.xhr_ = null;\n    this.xhrOptions_ = null;\n\n    if (!opt_fromDispose) {\n      this.dispatchEvent(goog.net.EventType.READY);\n    }\n\n    try {\n      // NOTE(user): Not nullifying in FireFox can still leak if the callbacks\n      // are defined in the same scope as the instance of XhrIo. But, IE doesn't\n      // allow you to set the onreadystatechange to NULL so nullFunction is\n      // used.\n      xhr.onreadystatechange = clearedOnReadyStateChange;\n    } catch (e) {\n      // This seems to occur with a Gears HTTP request. Delayed the setting of\n      // this onreadystatechange until after READY is sent out and catching the\n      // error to see if we can track down the problem.\n      goog.log.error(\n          this.logger_,\n          'Problem encountered resetting onreadystatechange: ' + e.message);\n    }\n  }\n};\n\n\n/**\n * Make sure the timeout timer isn't running.\n * @private\n */\ngoog.net.XhrIo.prototype.cleanUpTimeoutTimer_ = function() {\n  if (this.xhr_ && this.useXhr2Timeout_) {\n    this.xhr_[goog.net.XhrIo.XHR2_ON_TIMEOUT_] = null;\n  }\n  if (this.timeoutId_) {\n    goog.Timer.clear(this.timeoutId_);\n    this.timeoutId_ = null;\n  }\n};\n\n\n/**\n * @return {boolean} Whether there is an active request.\n */\ngoog.net.XhrIo.prototype.isActive = function() {\n  return !!this.xhr_;\n};\n\n\n/**\n * @return {boolean} Whether the request has completed.\n */\ngoog.net.XhrIo.prototype.isComplete = function() {\n  return this.getReadyState() == goog.net.XmlHttp.ReadyState.COMPLETE;\n};\n\n\n/**\n * @return {boolean} Whether the request completed with a success.\n */\ngoog.net.XhrIo.prototype.isSuccess = function() {\n  var status = this.getStatus();\n  // A zero status code is considered successful for local files.\n  return goog.net.HttpStatus.isSuccess(status) ||\n      status === 0 && !this.isLastUriEffectiveSchemeHttp_();\n};\n\n\n/**\n * @return {boolean} whether the effective scheme of the last URI that was\n *     fetched was 'http' or 'https'.\n * @private\n */\ngoog.net.XhrIo.prototype.isLastUriEffectiveSchemeHttp_ = function() {\n  var scheme = goog.uri.utils.getEffectiveScheme(String(this.lastUri_));\n  return goog.net.XhrIo.HTTP_SCHEME_PATTERN.test(scheme);\n};\n\n\n/**\n * Get the readystate from the Xhr object\n * Will only return correct result when called from the context of a callback\n * @return {goog.net.XmlHttp.ReadyState} goog.net.XmlHttp.ReadyState.*.\n */\ngoog.net.XhrIo.prototype.getReadyState = function() {\n  return this.xhr_ ?\n      /** @type {goog.net.XmlHttp.ReadyState} */ (this.xhr_.readyState) :\n                                                 goog.net.XmlHttp.ReadyState\n                                                     .UNINITIALIZED;\n};\n\n\n/**\n * Get the status from the Xhr object\n * Will only return correct result when called from the context of a callback\n * @return {number} Http status.\n */\ngoog.net.XhrIo.prototype.getStatus = function() {\n  /**\n   * IE doesn't like you checking status until the readystate is greater than 2\n   * (i.e. it is receiving or complete).  The try/catch is used for when the\n   * page is unloading and an ERROR_NOT_AVAILABLE may occur when accessing xhr_.\n   */\n  try {\n    return this.getReadyState() > goog.net.XmlHttp.ReadyState.LOADED ?\n        this.xhr_.status :\n        -1;\n  } catch (e) {\n    return -1;\n  }\n};\n\n\n/**\n * Get the status text from the Xhr object\n * Will only return correct result when called from the context of a callback\n * @return {string} Status text.\n */\ngoog.net.XhrIo.prototype.getStatusText = function() {\n  /**\n   * IE doesn't like you checking status until the readystate is greater than 2\n   * (i.e. it is receiving or complete).  The try/catch is used for when the\n   * page is unloading and an ERROR_NOT_AVAILABLE may occur when accessing xhr_.\n   */\n  try {\n    return this.getReadyState() > goog.net.XmlHttp.ReadyState.LOADED ?\n        this.xhr_.statusText :\n        '';\n  } catch (e) {\n    goog.log.fine(this.logger_, 'Can not get status: ' + e.message);\n    return '';\n  }\n};\n\n\n/**\n * Get the last Uri that was requested\n * @return {string} Last Uri.\n */\ngoog.net.XhrIo.prototype.getLastUri = function() {\n  return String(this.lastUri_);\n};\n\n\n/**\n * Get the response text from the Xhr object\n * Will only return correct result when called from the context of a callback.\n * @return {string} Result from the server, or '' if no result available.\n */\ngoog.net.XhrIo.prototype.getResponseText = function() {\n  try {\n    return this.xhr_ ? this.xhr_.responseText : '';\n  } catch (e) {\n    // http://www.w3.org/TR/XMLHttpRequest/#the-responsetext-attribute\n    // states that responseText should return '' (and responseXML null)\n    // when the state is not LOADING or DONE. Instead, IE can\n    // throw unexpected exceptions, for example when a request is aborted\n    // or no data is available yet.\n    goog.log.fine(this.logger_, 'Can not get responseText: ' + e.message);\n    return '';\n  }\n};\n\n\n/**\n * Get the response body from the Xhr object. This property is only available\n * in IE since version 7 according to MSDN:\n * http://msdn.microsoft.com/en-us/library/ie/ms534368(v=vs.85).aspx\n * Will only return correct result when called from the context of a callback.\n *\n * One option is to construct a VBArray from the returned object and convert\n * it to a JavaScript array using the toArray method:\n * `(new window['VBArray'](xhrIo.getResponseBody())).toArray()`\n * This will result in an array of numbers in the range of [0..255]\n *\n * Another option is to use the VBScript CStr method to convert it into a\n * string as outlined in http://stackoverflow.com/questions/1919972\n *\n * @return {Object} Binary result from the server or null if not available.\n */\ngoog.net.XhrIo.prototype.getResponseBody = function() {\n  try {\n    if (this.xhr_ && 'responseBody' in this.xhr_) {\n      return this.xhr_['responseBody'];\n    }\n  } catch (e) {\n    // IE can throw unexpected exceptions, for example when a request is aborted\n    // or no data is yet available.\n    goog.log.fine(this.logger_, 'Can not get responseBody: ' + e.message);\n  }\n  return null;\n};\n\n\n/**\n * Get the response XML from the Xhr object\n * Will only return correct result when called from the context of a callback.\n * @return {Document} The DOM Document representing the XML file, or null\n * if no result available.\n */\ngoog.net.XhrIo.prototype.getResponseXml = function() {\n  try {\n    return this.xhr_ ? this.xhr_.responseXML : null;\n  } catch (e) {\n    goog.log.fine(this.logger_, 'Can not get responseXML: ' + e.message);\n    return null;\n  }\n};\n\n\n/**\n * Get the response and evaluates it as JSON from the Xhr object\n * Will only return correct result when called from the context of a callback\n * @param {string=} opt_xssiPrefix Optional XSSI prefix string to use for\n *     stripping of the response before parsing. This needs to be set only if\n *     your backend server prepends the same prefix string to the JSON response.\n * @throws Error if the response text is invalid JSON.\n * @return {Object|undefined} JavaScript object.\n */\ngoog.net.XhrIo.prototype.getResponseJson = function(opt_xssiPrefix) {\n  if (!this.xhr_) {\n    return undefined;\n  }\n\n  var responseText = this.xhr_.responseText;\n  if (opt_xssiPrefix && responseText.indexOf(opt_xssiPrefix) == 0) {\n    responseText = responseText.substring(opt_xssiPrefix.length);\n  }\n\n  return goog.json.hybrid.parse(responseText);\n};\n\n\n/**\n * Get the response as the type specificed by {@link #setResponseType}. At time\n * of writing, this is only directly supported in very recent versions of WebKit\n * (10.0.612.1 dev and later). If the field is not supported directly, we will\n * try to emulate it.\n *\n * Emulating the response means following the rules laid out at\n * http://www.w3.org/TR/XMLHttpRequest/#the-response-attribute\n *\n * On browsers with no support for this (Chrome < 10, Firefox < 4, etc), only\n * response types of DEFAULT or TEXT may be used, and the response returned will\n * be the text response.\n *\n * On browsers with Mozilla's draft support for array buffers (Firefox 4, 5),\n * only response types of DEFAULT, TEXT, and ARRAY_BUFFER may be used, and the\n * response returned will be either the text response or the Mozilla\n * implementation of the array buffer response.\n *\n * On browsers will full support, any valid response type supported by the\n * browser may be used, and the response provided by the browser will be\n * returned.\n *\n * @return {*} The response.\n */\ngoog.net.XhrIo.prototype.getResponse = function() {\n  try {\n    if (!this.xhr_) {\n      return null;\n    }\n    if ('response' in this.xhr_) {\n      return this.xhr_.response;\n    }\n    switch (this.responseType_) {\n      case ResponseType.DEFAULT:\n      case ResponseType.TEXT:\n        return this.xhr_.responseText;\n      // DOCUMENT and BLOB don't need to be handled here because they are\n      // introduced in the same spec that adds the .response field, and would\n      // have been caught above.\n      // ARRAY_BUFFER needs an implementation for Firefox 4, where it was\n      // implemented using a draft spec rather than the final spec.\n      case ResponseType.ARRAY_BUFFER:\n        if ('mozResponseArrayBuffer' in this.xhr_) {\n          return this.xhr_.mozResponseArrayBuffer;\n        }\n    }\n    // Fell through to a response type that is not supported on this browser.\n    goog.log.error(\n        this.logger_, 'Response type ' + this.responseType_ + ' is not ' +\n            'supported on this browser');\n    return null;\n  } catch (e) {\n    goog.log.fine(this.logger_, 'Can not get response: ' + e.message);\n    return null;\n  }\n};\n\n\n/**\n * Get the value of the response-header with the given name from the Xhr object\n * Will only return correct result when called from the context of a callback\n * and the request has completed\n * @param {string} key The name of the response-header to retrieve.\n * @return {string|undefined} The value of the response-header named key.\n */\ngoog.net.XhrIo.prototype.getResponseHeader = function(key) {\n  if (!this.xhr_ || !this.isComplete()) {\n    return undefined;\n  }\n\n  var value = this.xhr_.getResponseHeader(key);\n  return goog.isNull(value) ? undefined : value;\n};\n\n\n/**\n * Gets the text of all the headers in the response.\n * Will only return correct result when called from the context of a callback\n * and the request has completed.\n * @return {string} The value of the response headers or empty string.\n */\ngoog.net.XhrIo.prototype.getAllResponseHeaders = function() {\n  // getAllResponseHeaders can return null if no response has been received,\n  // ensure we always return an empty string.\n  return this.xhr_ && this.isComplete() ?\n      (this.xhr_.getAllResponseHeaders() || '') :\n      '';\n};\n\n\n/**\n * Returns all response headers as a key-value map.\n * Multiple values for the same header key can be combined into one,\n * separated by a comma and a space.\n * Note that the native getResponseHeader method for retrieving a single header\n * does a case insensitive match on the header name. This method does not\n * include any case normalization logic, it will just return a key-value\n * representation of the headers.\n * See: http://www.w3.org/TR/XMLHttpRequest/#the-getresponseheader()-method\n * @return {!Object<string, string>} An object with the header keys as keys\n *     and header values as values.\n */\ngoog.net.XhrIo.prototype.getResponseHeaders = function() {\n  var headersObject = {};\n  var headersArray = this.getAllResponseHeaders().split('\\r\\n');\n  for (var i = 0; i < headersArray.length; i++) {\n    if (goog.string.isEmptyOrWhitespace(headersArray[i])) {\n      continue;\n    }\n    var keyValue = goog.string.splitLimit(headersArray[i], ': ', 2);\n    if (headersObject[keyValue[0]]) {\n      headersObject[keyValue[0]] += ', ' + keyValue[1];\n    } else {\n      headersObject[keyValue[0]] = keyValue[1];\n    }\n  }\n  return headersObject;\n};\n\n\n/**\n * Get the value of the response-header with the given name from the Xhr object.\n * As opposed to {@link #getResponseHeader}, this method does not require that\n * the request has completed.\n * @param {string} key The name of the response-header to retrieve.\n * @return {?string} The value of the response-header, or null if it is\n *     unavailable.\n */\ngoog.net.XhrIo.prototype.getStreamingResponseHeader = function(key) {\n  return this.xhr_ ? this.xhr_.getResponseHeader(key) : null;\n};\n\n\n/**\n * Gets the text of all the headers in the response. As opposed to\n * {@link #getAllResponseHeaders}, this method does not require that the request\n * has completed.\n * @return {string} The value of the response headers or empty string.\n */\ngoog.net.XhrIo.prototype.getAllStreamingResponseHeaders = function() {\n  return this.xhr_ ? this.xhr_.getAllResponseHeaders() : '';\n};\n\n\n/**\n * Get the last error message\n * @return {!goog.net.ErrorCode} Last error code.\n */\ngoog.net.XhrIo.prototype.getLastErrorCode = function() {\n  return this.lastErrorCode_;\n};\n\n\n/**\n * Get the last error message\n * @return {string} Last error message.\n */\ngoog.net.XhrIo.prototype.getLastError = function() {\n  return goog.isString(this.lastError_) ? this.lastError_ :\n                                          String(this.lastError_);\n};\n\n\n/**\n * Adds the last method, status and URI to the message.  This is used to add\n * this information to the logging calls.\n * @param {string} msg The message text that we want to add the extra text to.\n * @return {string} The message with the extra text appended.\n * @private\n */\ngoog.net.XhrIo.prototype.formatMsg_ = function(msg) {\n  return msg + ' [' + this.lastMethod_ + ' ' + this.lastUri_ + ' ' +\n      this.getStatus() + ']';\n};\n\n\n// Register the xhr handler as an entry point, so that\n// it can be monitored for exception handling, etc.\ngoog.debug.entryPointRegistry.register(\n    /**\n     * @param {function(!Function): !Function} transformer The transforming\n     *     function.\n     */\n    function(transformer) {\n      goog.net.XhrIo.prototype.onReadyStateChangeEntryPoint_ =\n          transformer(goog.net.XhrIo.prototype.onReadyStateChangeEntryPoint_);\n    });\n});  // goog.scope\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Implementation of sprintf-like, python-%-operator-like,\n * .NET-String.Format-like functionality. Uses JS string's replace method to\n * extract format specifiers and sends those specifiers to a handler function,\n * which then, based on conversion type part of the specifier, calls the\n * appropriate function to handle the specific conversion.\n * For specific functionality implemented, look at formatRe below, or look\n * at the tests.\n */\n\ngoog.provide('goog.string.format');\n\ngoog.require('goog.string');\n\n\n// TODO(johnlenz): goog.string.format should not accept undefined as a parameter\n/**\n * Performs sprintf-like conversion, i.e. puts the values in a template.\n * DO NOT use it instead of built-in conversions in simple cases such as\n * 'Cost: %.2f' as it would introduce unnecessary latency opposed to\n * 'Cost: ' + cost.toFixed(2).\n * @param {string} formatString Template string containing % specifiers.\n * @param {...(string|number|undefined)} var_args Values formatString is to\n *     be filled with.\n * @return {string} Formatted string.\n */\ngoog.string.format = function(formatString, var_args) {\n\n  // Convert the arguments to an array (MDC recommended way).\n  var args = Array.prototype.slice.call(arguments);\n\n  // Try to get the template.\n  var template = args.shift();\n  if (typeof template == 'undefined') {\n    throw new Error('[goog.string.format] Template required');\n  }\n\n  // This re is used for matching, it also defines what is supported.\n  var formatRe = /%([0\\-\\ \\+]*)(\\d+)?(\\.(\\d+))?([%sfdiu])/g;\n\n  /**\n   * Chooses which conversion function to call based on type conversion\n   * specifier.\n   * @param {string} match Contains the re matched string.\n   * @param {string} flags Formatting flags.\n   * @param {string} width Replacement string minimum width.\n   * @param {string} dotp Matched precision including a dot.\n   * @param {string} precision Specifies floating point precision.\n   * @param {string} type Type conversion specifier.\n   * @param {string} offset Matching location in the original string.\n   * @param {string} wholeString Has the actualString being searched.\n   * @return {string} Formatted parameter.\n   */\n  function replacerDemuxer(\n      match, flags, width, dotp, precision, type, offset, wholeString) {\n    // The % is too simple and doesn't take an argument.\n    if (type == '%') {\n      return '%';\n    }\n\n    // Try to get the actual value from parent function.\n    var value = args.shift();\n\n    // If we didn't get any arguments, fail.\n    if (typeof value == 'undefined') {\n      throw new Error('[goog.string.format] Not enough arguments');\n    }\n\n    // Patch the value argument to the beginning of our type specific call.\n    arguments[0] = value;\n\n    return goog.string.format.demuxes_[type].apply(null, arguments);\n  }\n\n  return template.replace(formatRe, replacerDemuxer);\n};\n\n\n/**\n * Contains various conversion functions (to be filled in later on).\n * @private {!Object}\n */\ngoog.string.format.demuxes_ = {};\n\n\n/**\n * Processes %s conversion specifier.\n * @param {string} value Contains the formatRe matched string.\n * @param {string} flags Formatting flags.\n * @param {string} width Replacement string minimum width.\n * @param {string} dotp Matched precision including a dot.\n * @param {string} precision Specifies floating point precision.\n * @param {string} type Type conversion specifier.\n * @param {string} offset Matching location in the original string.\n * @param {string} wholeString Has the actualString being searched.\n * @return {string} Replacement string.\n */\ngoog.string.format.demuxes_['s'] = function(\n    value, flags, width, dotp, precision, type, offset, wholeString) {\n  var replacement = value;\n  // If no padding is necessary we're done.\n  // The check for '' is necessary because Firefox incorrectly provides the\n  // empty string instead of undefined for non-participating capture groups,\n  // and isNaN('') == false.\n  if (isNaN(width) || width == '' || replacement.length >= Number(width)) {\n    return replacement;\n  }\n\n  // Otherwise we should find out where to put spaces.\n  if (flags.indexOf('-', 0) > -1) {\n    replacement = replacement +\n        goog.string.repeat(' ', Number(width) - replacement.length);\n  } else {\n    replacement = goog.string.repeat(' ', Number(width) - replacement.length) +\n        replacement;\n  }\n  return replacement;\n};\n\n\n/**\n * Processes %f conversion specifier.\n * @param {string} value Contains the formatRe matched string.\n * @param {string} flags Formatting flags.\n * @param {string} width Replacement string minimum width.\n * @param {string} dotp Matched precision including a dot.\n * @param {string} precision Specifies floating point precision.\n * @param {string} type Type conversion specifier.\n * @param {string} offset Matching location in the original string.\n * @param {string} wholeString Has the actualString being searched.\n * @return {string} Replacement string.\n */\ngoog.string.format.demuxes_['f'] = function(\n    value, flags, width, dotp, precision, type, offset, wholeString) {\n\n  var replacement = value.toString();\n\n  // The check for '' is necessary because Firefox incorrectly provides the\n  // empty string instead of undefined for non-participating capture groups,\n  // and isNaN('') == false.\n  if (!(isNaN(precision) || precision == '')) {\n    replacement = parseFloat(value).toFixed(precision);\n  }\n\n  // Generates sign string that will be attached to the replacement.\n  var sign;\n  if (Number(value) < 0) {\n    sign = '-';\n  } else if (flags.indexOf('+') >= 0) {\n    sign = '+';\n  } else if (flags.indexOf(' ') >= 0) {\n    sign = ' ';\n  } else {\n    sign = '';\n  }\n\n  if (Number(value) >= 0) {\n    replacement = sign + replacement;\n  }\n\n  // If no padding is necessary we're done.\n  if (isNaN(width) || replacement.length >= Number(width)) {\n    return replacement;\n  }\n\n  // We need a clean signless replacement to start with\n  replacement = isNaN(precision) ? Math.abs(Number(value)).toString() :\n                                   Math.abs(Number(value)).toFixed(precision);\n\n  var padCount = Number(width) - replacement.length - sign.length;\n\n  // Find out which side to pad, and if it's left side, then which character to\n  // pad, and set the sign on the left and padding in the middle.\n  if (flags.indexOf('-', 0) >= 0) {\n    replacement = sign + replacement + goog.string.repeat(' ', padCount);\n  } else {\n    // Decides which character to pad.\n    var paddingChar = (flags.indexOf('0', 0) >= 0) ? '0' : ' ';\n    replacement =\n        sign + goog.string.repeat(paddingChar, padCount) + replacement;\n  }\n\n  return replacement;\n};\n\n\n/**\n * Processes %d conversion specifier.\n * @param {string} value Contains the formatRe matched string.\n * @param {string} flags Formatting flags.\n * @param {string} width Replacement string minimum width.\n * @param {string} dotp Matched precision including a dot.\n * @param {string} precision Specifies floating point precision.\n * @param {string} type Type conversion specifier.\n * @param {string} offset Matching location in the original string.\n * @param {string} wholeString Has the actualString being searched.\n * @return {string} Replacement string.\n */\ngoog.string.format.demuxes_['d'] = function(\n    value, flags, width, dotp, precision, type, offset, wholeString) {\n  return goog.string.format.demuxes_['f'](\n      parseInt(value, 10) /* value */, flags, width, dotp, 0 /* precision */,\n      type, offset, wholeString);\n};\n\n\n// These are additional aliases, for integer conversion.\ngoog.string.format.demuxes_['i'] = goog.string.format.demuxes_['d'];\ngoog.string.format.demuxes_['u'] = goog.string.format.demuxes_['d'];\n","// Copyright 2010 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Creates a string of a JSON object, properly indented for\n * display.\n *\n */\n\ngoog.provide('goog.format.JsonPrettyPrinter');\ngoog.provide('goog.format.JsonPrettyPrinter.SafeHtmlDelimiters');\ngoog.provide('goog.format.JsonPrettyPrinter.TextDelimiters');\n\ngoog.require('goog.html.SafeHtml');\ngoog.require('goog.json');\ngoog.require('goog.json.Serializer');\ngoog.require('goog.string');\ngoog.require('goog.string.format');\n\n\n\n/**\n * Formats a JSON object as a string, properly indented for display.  Supports\n * displaying the string as text or html.  Users can also specify their own\n * set of delimiters for different environments.  For example, the JSON object:\n *\n * <code>{\"a\": 1, \"b\": {\"c\": null, \"d\": true, \"e\": [1, 2]}}</code>\n *\n * Will be displayed like this:\n *\n * <code>{\n *   \"a\": 1,\n *   \"b\": {\n *     \"c\": null,\n *     \"d\": true,\n *     \"e\": [\n *       1,\n *       2\n *     ]\n *   }\n * }</code>\n * @param {?goog.format.JsonPrettyPrinter.TextDelimiters=} opt_delimiters\n *     Container for the various strings to use to delimit objects, arrays,\n *     newlines, and other pieces of the output.\n * @constructor\n */\ngoog.format.JsonPrettyPrinter = function(opt_delimiters) {\n\n  /**\n   * The set of characters to use as delimiters.\n   * @private @const {!goog.format.JsonPrettyPrinter.TextDelimiters}\n   */\n  this.delimiters_ =\n      opt_delimiters || new goog.format.JsonPrettyPrinter.TextDelimiters();\n\n  /**\n   * Used to serialize property names and values.\n   * @private @const {!goog.json.Serializer}\n   */\n  this.jsonSerializer_ = new goog.json.Serializer();\n};\n\n\n/**\n * Formats a JSON object as a string, properly indented for display.\n * @param {*} json The object to pretty print. It could be a JSON object, a\n *     string representing a JSON object, or any other type.\n * @return {string} Returns a string of the JSON object, properly indented for\n *     display.\n */\ngoog.format.JsonPrettyPrinter.prototype.format = function(json) {\n  var buffer = this.format_(json);\n  var output = '';\n  for (var i = 0; i < buffer.length; i++) {\n    var item = buffer[i];\n    output += item instanceof goog.html.SafeHtml ?\n        goog.html.SafeHtml.unwrap(item) :\n        item;\n  }\n  return output;\n};\n\n\n/**\n * Formats a JSON object as a SafeHtml, properly indented for display.\n * @param {*} json The object to pretty print. It could be a JSON object, a\n *     string representing a JSON object, or any other type.\n * @return {!goog.html.SafeHtml} A HTML code of the JSON object.\n */\ngoog.format.JsonPrettyPrinter.prototype.formatSafeHtml = function(json) {\n  return goog.html.SafeHtml.concat(this.format_(json));\n};\n\n\n/**\n * Formats a JSON object and returns an output buffer.\n * @param {*} json The object to pretty print.\n * @return {!Array<string|!goog.html.SafeHtml>}\n * @private\n */\ngoog.format.JsonPrettyPrinter.prototype.format_ = function(json) {\n  // If input is undefined, null, or empty, return an empty string.\n  if (!goog.isDefAndNotNull(json)) {\n    return [];\n  }\n  if (goog.isString(json)) {\n    if (goog.string.isEmptyOrWhitespace(json)) {\n      return [];\n    }\n    // Try to coerce a string into a JSON object.\n    json = JSON.parse(json);\n  }\n  var outputBuffer = [];\n  this.printObject_(json, outputBuffer, 0);\n  return outputBuffer;\n};\n\n\n/**\n * Formats a property value based on the type of the propery.\n * @param {*} val The object to format.\n * @param {!Array<string|!goog.html.SafeHtml>} outputBuffer The buffer to write\n *     the response to.\n * @param {number} indent The number of spaces to indent each line of the\n *     output.\n * @private\n */\ngoog.format.JsonPrettyPrinter.prototype.printObject_ = function(\n    val, outputBuffer, indent) {\n  var typeOf = goog.typeOf(val);\n  switch (typeOf) {\n    case 'null':\n    case 'boolean':\n    case 'number':\n    case 'string':\n      // \"null\", \"boolean\", \"number\" and \"string\" properties are printed\n      // directly to the output.\n      this.printValue_(\n          /** @type {null|string|boolean|number} */ (val), typeOf,\n          outputBuffer);\n      break;\n    case 'array':\n      // Example of how an array looks when formatted\n      // (using the default delimiters):\n      // [\n      //   1,\n      //   2,\n      //   3\n      // ]\n      outputBuffer.push(this.delimiters_.arrayStart);\n      var i = 0;\n      // Iterate through the array and format each element.\n      for (i = 0; i < val.length; i++) {\n        if (i > 0) {\n          // There are multiple elements, add a comma to separate them.\n          outputBuffer.push(this.delimiters_.propertySeparator);\n        }\n        outputBuffer.push(this.delimiters_.lineBreak);\n        this.printSpaces_(indent + this.delimiters_.indent, outputBuffer);\n        this.printObject_(\n            val[i], outputBuffer, indent + this.delimiters_.indent);\n      }\n      // If there are no properties in this object, don't put a line break\n      // between the beginning \"[\" and ending \"]\", so the output of an empty\n      // array looks like <code>[]</code>.\n      if (i > 0) {\n        outputBuffer.push(this.delimiters_.lineBreak);\n        this.printSpaces_(indent, outputBuffer);\n      }\n      outputBuffer.push(this.delimiters_.arrayEnd);\n      break;\n    case 'object':\n      // Example of how an object looks when formatted\n      // (using the default delimiters):\n      // {\n      //   \"a\": 1,\n      //   \"b\": 2,\n      //   \"c\": \"3\"\n      // }\n      outputBuffer.push(this.delimiters_.objectStart);\n      var propertyCount = 0;\n      // Iterate through the object and display each property.\n      for (var name in val) {\n        if (!val.hasOwnProperty(name)) {\n          continue;\n        }\n        if (propertyCount > 0) {\n          // There are multiple properties, add a comma to separate them.\n          outputBuffer.push(this.delimiters_.propertySeparator);\n        }\n        outputBuffer.push(this.delimiters_.lineBreak);\n        this.printSpaces_(indent + this.delimiters_.indent, outputBuffer);\n        this.printName_(name, outputBuffer);\n        outputBuffer.push(\n            this.delimiters_.nameValueSeparator, this.delimiters_.space);\n        this.printObject_(\n            val[name], outputBuffer, indent + this.delimiters_.indent);\n        propertyCount++;\n      }\n      // If there are no properties in this object, don't put a line break\n      // between the beginning \"{\" and ending \"}\", so the output of an empty\n      // object looks like <code>{}</code>.\n      if (propertyCount > 0) {\n        outputBuffer.push(this.delimiters_.lineBreak);\n        this.printSpaces_(indent, outputBuffer);\n      }\n      outputBuffer.push(this.delimiters_.objectEnd);\n      break;\n    // Other types, such as \"function\", aren't expected in JSON, and their\n    // behavior is undefined.  In these cases, just print an empty string to the\n    // output buffer.  This allows the pretty printer to continue while still\n    // outputing well-formed JSON.\n    default:\n      this.printValue_('', 'unknown', outputBuffer);\n  }\n};\n\n\n/**\n * Prints a property name to the output.\n * @param {string} name The property name.\n * @param {!Array<string|!goog.html.SafeHtml>} outputBuffer The buffer to write\n *     the response to.\n * @private\n */\ngoog.format.JsonPrettyPrinter.prototype.printName_ = function(\n    name, outputBuffer) {\n  outputBuffer.push(\n      this.delimiters_.formatName(this.jsonSerializer_.serialize(name)));\n};\n\n\n/**\n * Prints a property name to the output.\n * @param {string|boolean|number|null} val The property value.\n * @param {string} typeOf The type of the value.  Used to customize\n *     value-specific css in the display.  This allows clients to distinguish\n *     between different types in css.  For example, the client may define two\n *     classes: \"goog-jsonprettyprinter-propertyvalue-string\" and\n *     \"goog-jsonprettyprinter-propertyvalue-number\" to assign a different color\n *     to string and number values.\n * @param {!Array<string|!goog.html.SafeHtml>} outputBuffer The buffer to write\n *     the response to.\n * @private\n */\ngoog.format.JsonPrettyPrinter.prototype.printValue_ = function(\n    val, typeOf, outputBuffer) {\n  var value = this.jsonSerializer_.serialize(val);\n  outputBuffer.push(this.delimiters_.formatValue(value, typeOf));\n};\n\n\n/**\n * Print a number of space characters to the output.\n * @param {number} indent The number of spaces to indent the line.\n * @param {!Array<string|!goog.html.SafeHtml>} outputBuffer The buffer to write\n *     the response to.\n * @private\n */\ngoog.format.JsonPrettyPrinter.prototype.printSpaces_ = function(\n    indent, outputBuffer) {\n  outputBuffer.push(goog.string.repeat(this.delimiters_.space, indent));\n};\n\n\n\n/**\n * A container for the delimiting characters used to display the JSON string\n * to a text display.  Each delimiter is a publicly accessible property of\n * the object, which makes it easy to tweak delimiters to specific environments.\n * @constructor\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters = function() {};\n\n\n/**\n * Represents a space character in the output.  Used to indent properties a\n * certain number of spaces, and to separate property names from property\n * values.\n * @type {string}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.space = ' ';\n\n\n/**\n * Represents a newline character in the output.  Used to begin a new line.\n * @type {string|!goog.html.SafeHtml}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.lineBreak = '\\n';\n\n\n/**\n * Represents the start of an object in the output.\n * @type {string}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.objectStart = '{';\n\n\n/**\n * Represents the end of an object in the output.\n * @type {string}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.objectEnd = '}';\n\n\n/**\n * Represents the start of an array in the output.\n * @type {string}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.arrayStart = '[';\n\n\n/**\n * Represents the end of an array in the output.\n * @type {string}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.arrayEnd = ']';\n\n\n/**\n * Represents the string used to separate properties in the output.\n * @type {string}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.propertySeparator = ',';\n\n\n/**\n * Represents the string used to separate property names from property values in\n * the output.\n * @type {string|!goog.html.SafeHtml}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.nameValueSeparator = ':';\n\n\n/**\n * A string that's placed before a property name in the output.  Useful for\n * wrapping a property name in an html tag.\n * @type {string}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.preName = '';\n\n\n/**\n * A string that's placed after a property name in the output.  Useful for\n * wrapping a property name in an html tag.\n * @type {string}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.postName = '';\n\n\n/**\n * Formats a property name before adding it to the output.\n * @param {string} name The property name.\n * @return {string|!goog.html.SafeHtml}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.formatName = function(\n    name) {\n  return this.preName + name + this.postName;\n};\n\n\n/**\n * A string that's placed before a property value in the output.  Useful for\n * wrapping a property value in an html tag.\n * @type {string}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.preValue = '';\n\n\n/**\n * A string that's placed after a property value in the output.  Useful for\n * wrapping a property value in an html tag.\n * @type {string}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.postValue = '';\n\n\n/**\n * Formats a value before adding it to the output.\n * @param {string} value The value.\n * @param {string} typeOf The type of the value obtained by goog.typeOf.\n * @return {string|!goog.html.SafeHtml}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.formatValue = function(\n    value, typeOf) {\n  return goog.string.format(this.preValue, typeOf) + value + this.postValue;\n};\n\n\n/**\n * Represents the number of spaces to indent each sub-property of the JSON.\n * @type {number}\n */\ngoog.format.JsonPrettyPrinter.TextDelimiters.prototype.indent = 2;\n\n\n\n/**\n * A container for the delimiting characters used to display the JSON string\n * to an HTML <code>&lt;pre&gt;</code> or <code>&lt;code&gt;</code> element.\n * It escapes the names and values before they are added to the output.\n * Use this class together with goog.format.JsonPrettyPrinter#formatSafeHtml.\n * @constructor\n * @extends {goog.format.JsonPrettyPrinter.TextDelimiters}\n */\ngoog.format.JsonPrettyPrinter.SafeHtmlDelimiters = function() {\n  goog.format.JsonPrettyPrinter.TextDelimiters.call(this);\n};\ngoog.inherits(\n    goog.format.JsonPrettyPrinter.SafeHtmlDelimiters,\n    goog.format.JsonPrettyPrinter.TextDelimiters);\n\n\n/** @override */\ngoog.format.JsonPrettyPrinter.SafeHtmlDelimiters.prototype.formatName =\n    function(name) {\n  var classes = goog.getCssName('goog-jsonprettyprinter-propertyname');\n  return goog.html.SafeHtml.create('span', {'class': classes}, name);\n};\n\n\n/** @override */\ngoog.format.JsonPrettyPrinter.SafeHtmlDelimiters.prototype.formatValue =\n    function(value, typeOf) {\n  var classes = this.getValueCssName(typeOf);\n  return goog.html.SafeHtml.create('span', {'class': classes}, value);\n};\n\n\n/**\n * Return a class name for the given type.\n * @param {string} typeOf The type of the value.\n * @return {string}\n * @protected\n */\ngoog.format.JsonPrettyPrinter.SafeHtmlDelimiters.prototype.getValueCssName =\n    function(typeOf) {\n  // This switch is needed because goog.getCssName requires a constant string.\n  switch (typeOf) {\n    case 'null':\n      return goog.getCssName('goog-jsonprettyprinter-propertyvalue-null');\n    case 'boolean':\n      return goog.getCssName('goog-jsonprettyprinter-propertyvalue-boolean');\n    case 'number':\n      return goog.getCssName('goog-jsonprettyprinter-propertyvalue-number');\n    case 'string':\n      return goog.getCssName('goog-jsonprettyprinter-propertyvalue-string');\n    case 'array':\n      return goog.getCssName('goog-jsonprettyprinter-propertyvalue-array');\n    case 'object':\n      return goog.getCssName('goog-jsonprettyprinter-propertyvalue-object');\n    default:\n      return goog.getCssName('goog-jsonprettyprinter-propertyvalue-unknown');\n  }\n};\n","// Copyright 2005 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Class to create objects which want to handle multiple events\n * and have their listeners easily cleaned up via a dispose method.\n *\n * Example:\n * <pre>\n * function Something() {\n *   Something.base(this);\n *\n *   ... set up object ...\n *\n *   // Add event listeners\n *   this.listen(this.starEl, goog.events.EventType.CLICK, this.handleStar);\n *   this.listen(this.headerEl, goog.events.EventType.CLICK, this.expand);\n *   this.listen(this.collapseEl, goog.events.EventType.CLICK, this.collapse);\n *   this.listen(this.infoEl, goog.events.EventType.MOUSEOVER, this.showHover);\n *   this.listen(this.infoEl, goog.events.EventType.MOUSEOUT, this.hideHover);\n * }\n * goog.inherits(Something, goog.events.EventHandler);\n *\n * Something.prototype.disposeInternal = function() {\n *   Something.base(this, 'disposeInternal');\n *   goog.dom.removeNode(this.container);\n * };\n *\n *\n * // Then elsewhere:\n *\n * var activeSomething = null;\n * function openSomething() {\n *   activeSomething = new Something();\n * }\n *\n * function closeSomething() {\n *   if (activeSomething) {\n *     activeSomething.dispose();  // Remove event listeners\n *     activeSomething = null;\n *   }\n * }\n * </pre>\n *\n */\n\ngoog.provide('goog.events.EventHandler');\n\ngoog.require('goog.Disposable');\ngoog.require('goog.events');\ngoog.require('goog.object');\n\ngoog.forwardDeclare('goog.events.EventWrapper');\n\n\n\n/**\n * Super class for objects that want to easily manage a number of event\n * listeners.  It allows a short cut to listen and also provides a quick way\n * to remove all events listeners belonging to this object.\n * @param {SCOPE=} opt_scope Object in whose scope to call the listeners.\n * @constructor\n * @extends {goog.Disposable}\n * @template SCOPE\n */\ngoog.events.EventHandler = function(opt_scope) {\n  goog.Disposable.call(this);\n  // TODO(mknichel): Rename this to this.scope_ and fix the classes in google3\n  // that access this private variable. :(\n  this.handler_ = opt_scope;\n\n  /**\n   * Keys for events that are being listened to.\n   * @type {!Object<!goog.events.Key>}\n   * @private\n   */\n  this.keys_ = {};\n};\ngoog.inherits(goog.events.EventHandler, goog.Disposable);\n\n\n/**\n * Utility array used to unify the cases of listening for an array of types\n * and listening for a single event, without using recursion or allocating\n * an array each time.\n * @type {!Array<string>}\n * @const\n * @private\n */\ngoog.events.EventHandler.typeArray_ = [];\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted then the\n * EventHandler's handleEvent method will be used.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(this:SCOPE, EVENTOBJ):?|{handleEvent:function(?):?}|null=}\n *     opt_fn Optional callback function to be used as the listener or an object\n *     with handleEvent function.\n * @param {(boolean|!AddEventListenerOptions)=} opt_options\n * @return {THIS} This object, allowing for chaining of calls.\n * @this {THIS}\n * @template EVENTOBJ, THIS\n */\ngoog.events.EventHandler.prototype.listen = function(\n    src, type, opt_fn, opt_options) {\n  var self = /** @type {!goog.events.EventHandler} */ (this);\n  return self.listen_(src, type, opt_fn, opt_options);\n};\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted then the\n * EventHandler's handleEvent method will be used.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(this:T, EVENTOBJ):?|{handleEvent:function(this:T, ?):?}|\n *     null|undefined} fn Optional callback function to be used as the\n *     listener or an object with handleEvent function.\n * @param {boolean|!AddEventListenerOptions|undefined} options\n * @param {T} scope Object in whose scope to call the listener.\n * @return {THIS} This object, allowing for chaining of calls.\n * @this {THIS}\n * @template T, EVENTOBJ, THIS\n */\ngoog.events.EventHandler.prototype.listenWithScope = function(\n    src, type, fn, options, scope) {\n  var self = /** @type {!goog.events.EventHandler} */ (this);\n  // TODO(mknichel): Deprecate this function.\n  return self.listen_(src, type, fn, options, scope);\n};\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted then the\n * EventHandler's handleEvent method will be used.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(EVENTOBJ):?|{handleEvent:function(?):?}|null=} opt_fn\n *     Optional callback function to be used as the listener or an object with\n *     handleEvent function.\n * @param {(boolean|!AddEventListenerOptions)=} opt_options\n * @param {Object=} opt_scope Object in whose scope to call the listener.\n * @return {THIS} This object, allowing for chaining of calls.\n * @this {THIS}\n * @template EVENTOBJ, THIS\n * @private\n */\ngoog.events.EventHandler.prototype.listen_ = function(\n    src, type, opt_fn, opt_options, opt_scope) {\n  var self = /** @type {!goog.events.EventHandler} */ (this);\n  if (!goog.isArray(type)) {\n    if (type) {\n      goog.events.EventHandler.typeArray_[0] = type.toString();\n    }\n    type = goog.events.EventHandler.typeArray_;\n  }\n  for (var i = 0; i < type.length; i++) {\n    var listenerObj = goog.events.listen(\n        src, type[i], opt_fn || self.handleEvent, opt_options || false,\n        opt_scope || self.handler_ || self);\n\n    if (!listenerObj) {\n      // When goog.events.listen run on OFF_AND_FAIL or OFF_AND_SILENT\n      // (goog.events.CaptureSimulationMode) in IE8-, it will return null\n      // value.\n      return self;\n    }\n\n    var key = listenerObj.key;\n    self.keys_[key] = listenerObj;\n  }\n\n  return self;\n};\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted, then the\n * EventHandler's handleEvent method will be used. After the event has fired the\n * event listener is removed from the target. If an array of event types is\n * provided, each event type will be listened to once.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(this:SCOPE, EVENTOBJ):?|{handleEvent:function(?):?}|null=}\n * opt_fn\n *    Optional callback function to be used as the listener or an object with\n *    handleEvent function.\n * @param {(boolean|!AddEventListenerOptions)=} opt_options\n * @return {THIS} This object, allowing for chaining of calls.\n * @this {THIS}\n * @template EVENTOBJ, THIS\n */\ngoog.events.EventHandler.prototype.listenOnce = function(\n    src, type, opt_fn, opt_options) {\n  var self = /** @type {!goog.events.EventHandler} */ (this);\n  return self.listenOnce_(src, type, opt_fn, opt_options);\n};\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted, then the\n * EventHandler's handleEvent method will be used. After the event has fired the\n * event listener is removed from the target. If an array of event types is\n * provided, each event type will be listened to once.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(this:T, EVENTOBJ):?|{handleEvent:function(this:T, ?):?}|\n *     null|undefined} fn Optional callback function to be used as the\n *     listener or an object with handleEvent function.\n * @param {boolean|undefined} capture Optional whether to use capture phase.\n * @param {T} scope Object in whose scope to call the listener.\n * @return {THIS} This object, allowing for chaining of calls.\n * @this {THIS}\n * @template T, EVENTOBJ, THIS\n */\ngoog.events.EventHandler.prototype.listenOnceWithScope = function(\n    src, type, fn, capture, scope) {\n  var self = /** @type {!goog.events.EventHandler} */ (this);\n  // TODO(mknichel): Deprecate this function.\n  return self.listenOnce_(src, type, fn, capture, scope);\n};\n\n\n/**\n * Listen to an event on a Listenable.  If the function is omitted, then the\n * EventHandler's handleEvent method will be used. After the event has fired\n * the event listener is removed from the target. If an array of event types is\n * provided, each event type will be listened to once.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type to listen for or array of event types.\n * @param {function(EVENTOBJ):?|{handleEvent:function(?):?}|null=} opt_fn\n *    Optional callback function to be used as the listener or an object with\n *    handleEvent function.\n * @param {(boolean|!AddEventListenerOptions)=} opt_options\n * @param {Object=} opt_scope Object in whose scope to call the listener.\n * @return {THIS} This object, allowing for chaining of calls.\n * @this {THIS}\n * @template EVENTOBJ, THIS\n * @private\n */\ngoog.events.EventHandler.prototype.listenOnce_ = function(\n    src, type, opt_fn, opt_options, opt_scope) {\n  var self = /** @type {!goog.events.EventHandler} */ (this);\n  if (goog.isArray(type)) {\n    for (var i = 0; i < type.length; i++) {\n      self.listenOnce_(src, type[i], opt_fn, opt_options, opt_scope);\n    }\n  } else {\n    var listenerObj = goog.events.listenOnce(\n        src, type, opt_fn || self.handleEvent, opt_options,\n        opt_scope || self.handler_ || self);\n    if (!listenerObj) {\n      // When goog.events.listen run on OFF_AND_FAIL or OFF_AND_SILENT\n      // (goog.events.CaptureSimulationMode) in IE8-, it will return null\n      // value.\n      return self;\n    }\n\n    var key = listenerObj.key;\n    self.keys_[key] = listenerObj;\n  }\n\n  return self;\n};\n\n\n/**\n * Adds an event listener with a specific event wrapper on a DOM Node or an\n * object that has implemented {@link goog.events.EventTarget}. A listener can\n * only be added once to an object.\n *\n * @param {EventTarget|goog.events.EventTarget} src The node to listen to\n *     events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(this:SCOPE, ?):?|{handleEvent:function(?):?}|null} listener\n *     Callback method, or an object with a handleEvent function.\n * @param {boolean=} opt_capt Whether to fire in capture phase (defaults to\n *     false).\n * @return {THIS} This object, allowing for chaining of calls.\n * @this {THIS}\n * @template THIS\n */\ngoog.events.EventHandler.prototype.listenWithWrapper = function(\n    src, wrapper, listener, opt_capt) {\n  var self = /** @type {!goog.events.EventHandler} */ (this);\n  // TODO(mknichel): Remove the opt_scope from this function and then\n  // templatize it.\n  return self.listenWithWrapper_(src, wrapper, listener, opt_capt);\n};\n\n\n/**\n * Adds an event listener with a specific event wrapper on a DOM Node or an\n * object that has implemented {@link goog.events.EventTarget}. A listener can\n * only be added once to an object.\n *\n * @param {EventTarget|goog.events.EventTarget} src The node to listen to\n *     events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(this:T, ?):?|{handleEvent:function(this:T, ?):?}|null}\n *     listener Optional callback function to be used as the\n *     listener or an object with handleEvent function.\n * @param {boolean|undefined} capture Optional whether to use capture phase.\n * @param {T} scope Object in whose scope to call the listener.\n * @return {THIS} This object, allowing for chaining of calls.\n * @this {THIS}\n * @template T, THIS\n */\ngoog.events.EventHandler.prototype.listenWithWrapperAndScope = function(\n    src, wrapper, listener, capture, scope) {\n  var self = /** @type {!goog.events.EventHandler} */ (this);\n  // TODO(mknichel): Deprecate this function.\n  return self.listenWithWrapper_(src, wrapper, listener, capture, scope);\n};\n\n\n/**\n * Adds an event listener with a specific event wrapper on a DOM Node or an\n * object that has implemented {@link goog.events.EventTarget}. A listener can\n * only be added once to an object.\n *\n * @param {EventTarget|goog.events.EventTarget} src The node to listen to\n *     events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(?):?|{handleEvent:function(?):?}|null} listener Callback\n *     method, or an object with a handleEvent function.\n * @param {boolean=} opt_capt Whether to fire in capture phase (defaults to\n *     false).\n * @param {Object=} opt_scope Element in whose scope to call the listener.\n * @return {THIS} This object, allowing for chaining of calls.\n * @this {THIS}\n * @template THIS\n * @private\n */\ngoog.events.EventHandler.prototype.listenWithWrapper_ = function(\n    src, wrapper, listener, opt_capt, opt_scope) {\n  var self = /** @type {!goog.events.EventHandler} */ (this);\n  wrapper.listen(\n      src, listener, opt_capt, opt_scope || self.handler_ || self, self);\n  return self;\n};\n\n\n/**\n * @return {number} Number of listeners registered by this handler.\n */\ngoog.events.EventHandler.prototype.getListenerCount = function() {\n  var count = 0;\n  for (var key in this.keys_) {\n    if (Object.prototype.hasOwnProperty.call(this.keys_, key)) {\n      count++;\n    }\n  }\n  return count;\n};\n\n\n/**\n * Unlistens on an event.\n * @param {goog.events.ListenableType} src Event source.\n * @param {string|Array<string>|\n *     !goog.events.EventId<EVENTOBJ>|!Array<!goog.events.EventId<EVENTOBJ>>}\n *     type Event type or array of event types to unlisten to.\n * @param {function(this:?, EVENTOBJ):?|{handleEvent:function(?):?}|null=}\n *     opt_fn Optional callback function to be used as the listener or an object\n *     with handleEvent function.\n * @param {(boolean|!EventListenerOptions)=} opt_options\n * @param {Object=} opt_scope Object in whose scope to call the listener.\n * @return {THIS} This object, allowing for chaining of calls.\n * @this {THIS}\n * @template EVENTOBJ, THIS\n */\ngoog.events.EventHandler.prototype.unlisten = function(\n    src, type, opt_fn, opt_options, opt_scope) {\n  var self = /** @type {!goog.events.EventHandler} */ (this);\n  if (goog.isArray(type)) {\n    for (var i = 0; i < type.length; i++) {\n      self.unlisten(src, type[i], opt_fn, opt_options, opt_scope);\n    }\n  } else {\n    var capture =\n        goog.isObject(opt_options) ? !!opt_options.capture : !!opt_options;\n    var listener = goog.events.getListener(\n        src, type, opt_fn || self.handleEvent, capture,\n        opt_scope || self.handler_ || self);\n\n    if (listener) {\n      goog.events.unlistenByKey(listener);\n      delete self.keys_[listener.key];\n    }\n  }\n\n  return self;\n};\n\n\n/**\n * Removes an event listener which was added with listenWithWrapper().\n *\n * @param {EventTarget|goog.events.EventTarget} src The target to stop\n *     listening to events on.\n * @param {goog.events.EventWrapper} wrapper Event wrapper to use.\n * @param {function(?):?|{handleEvent:function(?):?}|null} listener The\n *     listener function to remove.\n * @param {boolean=} opt_capt In DOM-compliant browsers, this determines\n *     whether the listener is fired during the capture or bubble phase of the\n *     event.\n * @param {Object=} opt_scope Element in whose scope to call the listener.\n * @return {THIS} This object, allowing for chaining of calls.\n * @this {THIS}\n * @template THIS\n */\ngoog.events.EventHandler.prototype.unlistenWithWrapper = function(\n    src, wrapper, listener, opt_capt, opt_scope) {\n  var self = /** @type {!goog.events.EventHandler} */ (this);\n  wrapper.unlisten(\n      src, listener, opt_capt, opt_scope || self.handler_ || self, self);\n  return self;\n};\n\n\n/**\n * Unlistens to all events.\n */\ngoog.events.EventHandler.prototype.removeAll = function() {\n  goog.object.forEach(this.keys_, function(listenerObj, key) {\n    if (this.keys_.hasOwnProperty(key)) {\n      goog.events.unlistenByKey(listenerObj);\n    }\n  }, this);\n\n  this.keys_ = {};\n};\n\n\n/**\n * Disposes of this EventHandler and removes all listeners that it registered.\n * @override\n * @protected\n */\ngoog.events.EventHandler.prototype.disposeInternal = function() {\n  goog.events.EventHandler.superClass_.disposeInternal.call(this);\n  this.removeAll();\n};\n\n\n/**\n * Default event handler\n * @param {goog.events.Event} e Event object.\n */\ngoog.events.EventHandler.prototype.handleEvent = function(e) {\n  throw new Error('EventHandler.handleEvent not implemented');\n};\n","// Copyright 2010 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Provides a files drag and drop event detector. It works on\n * HTML5 browsers.\n *\n * @see ../demos/filedrophandler.html\n */\n\ngoog.provide('goog.events.FileDropHandler');\ngoog.provide('goog.events.FileDropHandler.EventType');\n\ngoog.require('goog.array');\ngoog.require('goog.dom');\ngoog.require('goog.events.BrowserEvent');\ngoog.require('goog.events.EventHandler');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.events.EventType');\ngoog.require('goog.log');\ngoog.require('goog.log.Level');\n\n\n\n/**\n * A files drag and drop event detector. Gets an `element` as parameter\n * and fires `goog.events.FileDropHandler.EventType.DROP` event when files\n * are dropped in the `element`.\n *\n * @param {Element|Document} element The element or document to listen on.\n * @param {boolean=} opt_preventDropOutside Whether to prevent a drop on the\n *     area outside the `element`. Default false.\n * @constructor\n * @extends {goog.events.EventTarget}\n * @final\n */\ngoog.events.FileDropHandler = function(element, opt_preventDropOutside) {\n  goog.events.EventTarget.call(this);\n\n  /**\n   * Handler for drag/drop events.\n   * @type {!goog.events.EventHandler<!goog.events.FileDropHandler>}\n   * @private\n   */\n  this.eventHandler_ = new goog.events.EventHandler(this);\n\n  var doc = element;\n  if (opt_preventDropOutside) {\n    doc = goog.dom.getOwnerDocument(element);\n  }\n\n  // Add dragenter listener to the owner document of the element.\n  this.eventHandler_.listen(\n      doc, goog.events.EventType.DRAGENTER, this.onDocDragEnter_);\n\n  // Add dragover listener to the owner document of the element only if the\n  // document is not the element itself.\n  if (doc != element) {\n    this.eventHandler_.listen(\n        doc, goog.events.EventType.DRAGOVER, this.onDocDragOver_);\n  }\n\n  // Add dragover and drop listeners to the element.\n  this.eventHandler_.listen(\n      element, goog.events.EventType.DRAGOVER, this.onElemDragOver_);\n  this.eventHandler_.listen(\n      element, goog.events.EventType.DROP, this.onElemDrop_);\n};\ngoog.inherits(goog.events.FileDropHandler, goog.events.EventTarget);\n\n\n/**\n * Whether the drag event contains files. It is initialized only in the\n * dragenter event. It is used in all the drag events to prevent default actions\n * only if the drag contains files. Preventing default actions is necessary to\n * go from dragenter to dragover and from dragover to drop. However we do not\n * always want to prevent default actions, e.g. when the user drags text or\n * links on a text area we should not prevent the browser default action that\n * inserts the text in the text area. It is also necessary to stop propagation\n * when handling drag events on the element to prevent them from propagating\n * to the document.\n * @private\n * @type {boolean}\n */\ngoog.events.FileDropHandler.prototype.dndContainsFiles_ = false;\n\n\n/**\n * A logger, used to help us debug the algorithm.\n * @type {goog.log.Logger}\n * @private\n */\ngoog.events.FileDropHandler.prototype.logger_ =\n    goog.log.getLogger('goog.events.FileDropHandler');\n\n\n/**\n * The types of events fired by this class.\n * @enum {string}\n */\ngoog.events.FileDropHandler.EventType = {\n  DROP: goog.events.EventType.DROP\n};\n\n\n/** @override */\ngoog.events.FileDropHandler.prototype.disposeInternal = function() {\n  goog.events.FileDropHandler.superClass_.disposeInternal.call(this);\n  this.eventHandler_.dispose();\n};\n\n\n/**\n * Dispatches the DROP event.\n * @param {goog.events.BrowserEvent} e The underlying browser event.\n * @private\n */\ngoog.events.FileDropHandler.prototype.dispatch_ = function(e) {\n  goog.log.fine(this.logger_, 'Firing DROP event...');\n  var event = new goog.events.BrowserEvent(e.getBrowserEvent());\n  event.type = goog.events.FileDropHandler.EventType.DROP;\n  this.dispatchEvent(event);\n};\n\n\n/**\n * Handles dragenter on the document.\n * @param {goog.events.BrowserEvent} e The dragenter event.\n * @private\n */\ngoog.events.FileDropHandler.prototype.onDocDragEnter_ = function(e) {\n  goog.log.log(\n      this.logger_, goog.log.Level.FINER,\n      '\"' + e.target.id + '\" (' + e.target + ') dispatched: ' + e.type);\n  var dt = e.getBrowserEvent().dataTransfer;\n  // Check whether the drag event contains files.\n  this.dndContainsFiles_ = !!(\n      dt && ((dt.types && (goog.array.contains(dt.types, 'Files') ||\n                           goog.array.contains(dt.types, 'public.file-url'))) ||\n             (dt.files && dt.files.length > 0)));\n  // If it does\n  if (this.dndContainsFiles_) {\n    // Prevent default actions.\n    e.preventDefault();\n  }\n  goog.log.log(\n      this.logger_, goog.log.Level.FINER,\n      'dndContainsFiles_: ' + this.dndContainsFiles_);\n};\n\n\n/**\n * Handles dragging something over the document.\n * @param {goog.events.BrowserEvent} e The dragover event.\n * @private\n */\ngoog.events.FileDropHandler.prototype.onDocDragOver_ = function(e) {\n  goog.log.log(\n      this.logger_, goog.log.Level.FINEST,\n      '\"' + e.target.id + '\" (' + e.target + ') dispatched: ' + e.type);\n  if (this.dndContainsFiles_) {\n    // Prevent default actions.\n    e.preventDefault();\n    // Disable the drop on the document outside the drop zone.\n    var dt = e.getBrowserEvent().dataTransfer;\n    dt.dropEffect = 'none';\n  }\n};\n\n\n/**\n * Handles dragging something over the element (drop zone).\n * @param {goog.events.BrowserEvent} e The dragover event.\n * @private\n */\ngoog.events.FileDropHandler.prototype.onElemDragOver_ = function(e) {\n  goog.log.log(\n      this.logger_, goog.log.Level.FINEST,\n      '\"' + e.target.id + '\" (' + e.target + ') dispatched: ' + e.type);\n  if (this.dndContainsFiles_) {\n    // Prevent default actions and stop the event from propagating further to\n    // the document. Both lines are needed! (See comment above).\n    e.preventDefault();\n    e.stopPropagation();\n    // Allow the drop on the drop zone.\n    var dt = e.getBrowserEvent().dataTransfer;\n\n    // IE bug #811625 (https://goo.gl/UWuxX0) will throw error SCRIPT65535\n    // when attempting to set property effectAllowed on IE10+.\n    // See more: https://github.com/google/closure-library/issues/485.\n    try {\n      dt.effectAllowed = 'all';\n    } catch (err) {\n    }\n    dt.dropEffect = 'copy';\n  }\n};\n\n\n/**\n * Handles dropping something onto the element (drop zone).\n * @param {goog.events.BrowserEvent} e The drop event.\n * @private\n */\ngoog.events.FileDropHandler.prototype.onElemDrop_ = function(e) {\n  goog.log.log(\n      this.logger_, goog.log.Level.FINER,\n      '\"' + e.target.id + '\" (' + e.target + ') dispatched: ' + e.type);\n  // If the drag and drop event contains files.\n  if (this.dndContainsFiles_) {\n    // Prevent default actions and stop the event from propagating further to\n    // the document. Both lines are needed! (See comment above).\n    e.preventDefault();\n    e.stopPropagation();\n    // Dispatch DROP event.\n    this.dispatch_(e);\n  }\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/**\n * @fileoverview The file contains generated enumerations for ARIA roles\n * as defined by W3C ARIA standard: http://www.w3.org/TR/wai-aria/.\n *\n * This is auto-generated code. Do not manually edit! For more details\n * about how to edit it via the generator check go/closure-ariagen.\n */\n\ngoog.provide('goog.a11y.aria.Role');\n\n\n/**\n * ARIA role values.\n * @enum {string}\n */\ngoog.a11y.aria.Role = {\n  // ARIA role for an alert element that doesn't need to be explicitly closed.\n  ALERT: 'alert',\n\n  // ARIA role for an alert dialog element that takes focus and must be closed.\n  ALERTDIALOG: 'alertdialog',\n\n  // ARIA role for an application that implements its own keyboard navigation.\n  APPLICATION: 'application',\n\n  // ARIA role for an article.\n  ARTICLE: 'article',\n\n  // ARIA role for a banner containing mostly site content, not page content.\n  BANNER: 'banner',\n\n  // ARIA role for a button element.\n  BUTTON: 'button',\n\n  // ARIA role for a checkbox button element; use with the CHECKED state.\n  CHECKBOX: 'checkbox',\n\n  // ARIA role for a column header of a table or grid.\n  COLUMNHEADER: 'columnheader',\n\n  // ARIA role for a combo box element.\n  COMBOBOX: 'combobox',\n\n  // ARIA role for a supporting section of the document.\n  COMPLEMENTARY: 'complementary',\n\n  // ARIA role for a large perceivable region that contains information\n  // about the parent document.\n  CONTENTINFO: 'contentinfo',\n\n  // ARIA role for a definition of a term or concept.\n  DEFINITION: 'definition',\n\n  // ARIA role for a dialog, some descendant must take initial focus.\n  DIALOG: 'dialog',\n\n  // ARIA role for a directory, like a table of contents.\n  DIRECTORY: 'directory',\n\n  // ARIA role for a part of a page that's a document, not a web application.\n  DOCUMENT: 'document',\n\n  // ARIA role for a landmark region logically considered one form.\n  FORM: 'form',\n\n  // ARIA role for an interactive control of tabular data.\n  GRID: 'grid',\n\n  // ARIA role for a cell in a grid.\n  GRIDCELL: 'gridcell',\n\n  // ARIA role for a group of related elements like tree item siblings.\n  GROUP: 'group',\n\n  // ARIA role for a heading element.\n  HEADING: 'heading',\n\n  // ARIA role for a container of elements that together comprise one image.\n  IMG: 'img',\n\n  // ARIA role for a link.\n  LINK: 'link',\n\n  // ARIA role for a list of non-interactive list items.\n  LIST: 'list',\n\n  // ARIA role for a listbox.\n  LISTBOX: 'listbox',\n\n  // ARIA role for a list item.\n  LISTITEM: 'listitem',\n\n  // ARIA role for a live region where new information is added.\n  LOG: 'log',\n\n  // ARIA landmark role for the main content in a document. Use only once.\n  MAIN: 'main',\n\n  // ARIA role for a live region of non-essential information that changes.\n  MARQUEE: 'marquee',\n\n  // ARIA role for a mathematical expression.\n  MATH: 'math',\n\n  // ARIA role for a popup menu.\n  MENU: 'menu',\n\n  // ARIA role for a menubar element containing menu elements.\n  MENUBAR: 'menubar',\n\n  // ARIA role for menu item elements.\n  MENU_ITEM: 'menuitem',\n\n  // ARIA role for a checkbox box element inside a menu.\n  MENU_ITEM_CHECKBOX: 'menuitemcheckbox',\n\n  // ARIA role for a radio button element inside a menu.\n  MENU_ITEM_RADIO: 'menuitemradio',\n\n  // ARIA landmark role for a collection of navigation links.\n  NAVIGATION: 'navigation',\n\n  // ARIA role for a section ancillary to the main content.\n  NOTE: 'note',\n\n  // ARIA role for option items that are  children of combobox, listbox, menu,\n  // radiogroup, or tree elements.\n  OPTION: 'option',\n\n  // ARIA role for ignorable cosmetic elements with no semantic significance.\n  PRESENTATION: 'presentation',\n\n  // ARIA role for a progress bar element.\n  PROGRESSBAR: 'progressbar',\n\n  // ARIA role for a radio button element.\n  RADIO: 'radio',\n\n  // ARIA role for a group of connected radio button elements.\n  RADIOGROUP: 'radiogroup',\n\n  // ARIA role for an important region of the page.\n  REGION: 'region',\n\n  // ARIA role for a row of cells in a grid.\n  ROW: 'row',\n\n  // ARIA role for a group of one or more rows in a grid.\n  ROWGROUP: 'rowgroup',\n\n  // ARIA role for a row header of a table or grid.\n  ROWHEADER: 'rowheader',\n\n  // ARIA role for a scrollbar element.\n  SCROLLBAR: 'scrollbar',\n\n  // ARIA landmark role for a part of the page providing search functionality.\n  SEARCH: 'search',\n\n  // ARIA role for a menu separator.\n  SEPARATOR: 'separator',\n\n  // ARIA role for a slider.\n  SLIDER: 'slider',\n\n  // ARIA role for a spin button.\n  SPINBUTTON: 'spinbutton',\n\n  // ARIA role for a live region with advisory info less severe than an alert.\n  STATUS: 'status',\n\n  // ARIA role for a tab button.\n  TAB: 'tab',\n\n  // ARIA role for a tab bar (i.e. a list of tab buttons).\n  TAB_LIST: 'tablist',\n\n  // ARIA role for a tab page (i.e. the element holding tab contents).\n  TAB_PANEL: 'tabpanel',\n\n  // ARIA role for a textbox element.\n  TEXTBOX: 'textbox',\n\n  // ARIA role for a textinfo element.\n  TEXTINFO: 'textinfo',\n\n  // ARIA role for an element displaying elapsed time or time remaining.\n  TIMER: 'timer',\n\n  // ARIA role for a toolbar element.\n  TOOLBAR: 'toolbar',\n\n  // ARIA role for a tooltip element.\n  TOOLTIP: 'tooltip',\n\n  // ARIA role for a tree.\n  TREE: 'tree',\n\n  // ARIA role for a grid whose rows can be expanded and collapsed like a tree.\n  TREEGRID: 'treegrid',\n\n  // ARIA role for a tree item that sometimes may be expanded or collapsed.\n  TREEITEM: 'treeitem'\n};\n","// Copyright 2011 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview An abstract base class for transitions. This is a simple\n * interface that allows for playing, pausing and stopping an animation. It adds\n * a simple event model, and animation status.\n */\ngoog.provide('goog.fx.TransitionBase');\ngoog.provide('goog.fx.TransitionBase.State');\n\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.fx.Transition');  // Unreferenced: interface\n\n\n\n/**\n * Constructor for a transition object.\n *\n * @constructor\n * @struct\n * @implements {goog.fx.Transition}\n * @extends {goog.events.EventTarget}\n */\ngoog.fx.TransitionBase = function() {\n  goog.fx.TransitionBase.base(this, 'constructor');\n\n  /**\n   * The internal state of the animation.\n   * @type {goog.fx.TransitionBase.State}\n   * @private\n   */\n  this.state_ = goog.fx.TransitionBase.State.STOPPED;\n\n  /**\n   * Timestamp for when the animation was started.\n   * @type {?number}\n   * @protected\n   */\n  this.startTime = null;\n\n  /**\n   * Timestamp for when the animation finished or was stopped.\n   * @type {?number}\n   * @protected\n   */\n  this.endTime = null;\n};\ngoog.inherits(goog.fx.TransitionBase, goog.events.EventTarget);\n\n\n/**\n * Enum for the possible states of an animation.\n * @enum {number}\n */\ngoog.fx.TransitionBase.State = {\n  STOPPED: 0,\n  PAUSED: -1,\n  PLAYING: 1\n};\n\n\n/**\n * Plays the animation.\n *\n * @param {boolean=} opt_restart Optional parameter to restart the animation.\n * @return {boolean} True iff the animation was started.\n * @override\n */\ngoog.fx.TransitionBase.prototype.play = goog.abstractMethod;\n\n\n/**\n * Stops the animation.\n *\n * @param {boolean=} opt_gotoEnd Optional boolean parameter to go the the end of\n *     the animation.\n * @override\n */\ngoog.fx.TransitionBase.prototype.stop = goog.abstractMethod;\n\n\n/**\n * Pauses the animation.\n */\ngoog.fx.TransitionBase.prototype.pause = goog.abstractMethod;\n\n\n/**\n * Returns the current state of the animation.\n * @return {goog.fx.TransitionBase.State} State of the animation.\n */\ngoog.fx.TransitionBase.prototype.getStateInternal = function() {\n  return this.state_;\n};\n\n\n/**\n * Sets the current state of the animation to playing.\n * @protected\n */\ngoog.fx.TransitionBase.prototype.setStatePlaying = function() {\n  this.state_ = goog.fx.TransitionBase.State.PLAYING;\n};\n\n\n/**\n * Sets the current state of the animation to paused.\n * @protected\n */\ngoog.fx.TransitionBase.prototype.setStatePaused = function() {\n  this.state_ = goog.fx.TransitionBase.State.PAUSED;\n};\n\n\n/**\n * Sets the current state of the animation to stopped.\n * @protected\n */\ngoog.fx.TransitionBase.prototype.setStateStopped = function() {\n  this.state_ = goog.fx.TransitionBase.State.STOPPED;\n};\n\n\n/**\n * @return {boolean} True iff the current state of the animation is playing.\n */\ngoog.fx.TransitionBase.prototype.isPlaying = function() {\n  return this.state_ == goog.fx.TransitionBase.State.PLAYING;\n};\n\n\n/**\n * @return {boolean} True iff the current state of the animation is paused.\n */\ngoog.fx.TransitionBase.prototype.isPaused = function() {\n  return this.state_ == goog.fx.TransitionBase.State.PAUSED;\n};\n\n\n/**\n * @return {boolean} True iff the current state of the animation is stopped.\n */\ngoog.fx.TransitionBase.prototype.isStopped = function() {\n  return this.state_ == goog.fx.TransitionBase.State.STOPPED;\n};\n\n\n/**\n * Dispatches the BEGIN event. Sub classes should override this instead\n * of listening to the event, and call this instead of dispatching the event.\n * @protected\n */\ngoog.fx.TransitionBase.prototype.onBegin = function() {\n  this.dispatchAnimationEvent(goog.fx.Transition.EventType.BEGIN);\n};\n\n\n/**\n * Dispatches the END event. Sub classes should override this instead\n * of listening to the event, and call this instead of dispatching the event.\n * @protected\n */\ngoog.fx.TransitionBase.prototype.onEnd = function() {\n  this.dispatchAnimationEvent(goog.fx.Transition.EventType.END);\n};\n\n\n/**\n * Dispatches the FINISH event. Sub classes should override this instead\n * of listening to the event, and call this instead of dispatching the event.\n * @protected\n */\ngoog.fx.TransitionBase.prototype.onFinish = function() {\n  this.dispatchAnimationEvent(goog.fx.Transition.EventType.FINISH);\n};\n\n\n/**\n * Dispatches the PAUSE event. Sub classes should override this instead\n * of listening to the event, and call this instead of dispatching the event.\n * @protected\n */\ngoog.fx.TransitionBase.prototype.onPause = function() {\n  this.dispatchAnimationEvent(goog.fx.Transition.EventType.PAUSE);\n};\n\n\n/**\n * Dispatches the PLAY event. Sub classes should override this instead\n * of listening to the event, and call this instead of dispatching the event.\n * @protected\n */\ngoog.fx.TransitionBase.prototype.onPlay = function() {\n  this.dispatchAnimationEvent(goog.fx.Transition.EventType.PLAY);\n};\n\n\n/**\n * Dispatches the RESUME event. Sub classes should override this instead\n * of listening to the event, and call this instead of dispatching the event.\n * @protected\n */\ngoog.fx.TransitionBase.prototype.onResume = function() {\n  this.dispatchAnimationEvent(goog.fx.Transition.EventType.RESUME);\n};\n\n\n/**\n * Dispatches the STOP event. Sub classes should override this instead\n * of listening to the event, and call this instead of dispatching the event.\n * @protected\n */\ngoog.fx.TransitionBase.prototype.onStop = function() {\n  this.dispatchAnimationEvent(goog.fx.Transition.EventType.STOP);\n};\n\n\n/**\n * Dispatches an event object for the current animation.\n * @param {string} type Event type that will be dispatched.\n * @protected\n */\ngoog.fx.TransitionBase.prototype.dispatchAnimationEvent = function(type) {\n  this.dispatchEvent(type);\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Defines a class useful for handling functions that must be\n * invoked after a delay, especially when that delay is frequently restarted.\n * Examples include delaying before displaying a tooltip, menu hysteresis,\n * idle timers, etc.\n * @author brenneman@google.com (Shawn Brenneman)\n * @see ../demos/timers.html\n */\n\n\ngoog.provide('goog.Delay');\ngoog.provide('goog.async.Delay');\n\ngoog.require('goog.Disposable');\ngoog.require('goog.Timer');\n\n\n\n/**\n * A Delay object invokes the associated function after a specified delay. The\n * interval duration can be specified once in the constructor, or can be defined\n * each time the delay is started. Calling start on an active delay will reset\n * the timer.\n *\n * @param {function(this:THIS)} listener Function to call when the\n *     delay completes.\n * @param {number=} opt_interval The default length of the invocation delay (in\n *     milliseconds).\n * @param {THIS=} opt_handler The object scope to invoke the function in.\n * @template THIS\n * @constructor\n * @struct\n * @extends {goog.Disposable}\n * @final\n */\ngoog.async.Delay = function(listener, opt_interval, opt_handler) {\n  goog.async.Delay.base(this, 'constructor');\n\n  /**\n   * The function that will be invoked after a delay.\n   * @private {function(this:THIS)}\n   */\n  this.listener_ = listener;\n\n  /**\n   * The default amount of time to delay before invoking the callback.\n   * @type {number}\n   * @private\n   */\n  this.interval_ = opt_interval || 0;\n\n  /**\n   * The object context to invoke the callback in.\n   * @type {Object|undefined}\n   * @private\n   */\n  this.handler_ = opt_handler;\n\n\n  /**\n   * Cached callback function invoked when the delay finishes.\n   * @type {Function}\n   * @private\n   */\n  this.callback_ = goog.bind(this.doAction_, this);\n};\ngoog.inherits(goog.async.Delay, goog.Disposable);\n\n\n\n/**\n * A deprecated alias.\n * @deprecated Use goog.async.Delay instead.\n * @constructor\n * @final\n */\ngoog.Delay = goog.async.Delay;\n\n\n/**\n * Identifier of the active delay timeout, or 0 when inactive.\n * @type {number}\n * @private\n */\ngoog.async.Delay.prototype.id_ = 0;\n\n\n/**\n * Disposes of the object, cancelling the timeout if it is still outstanding and\n * removing all object references.\n * @override\n * @protected\n */\ngoog.async.Delay.prototype.disposeInternal = function() {\n  goog.async.Delay.base(this, 'disposeInternal');\n  this.stop();\n  delete this.listener_;\n  delete this.handler_;\n};\n\n\n/**\n * Starts the delay timer. The provided listener function will be called after\n * the specified interval. Calling start on an active timer will reset the\n * delay interval.\n * @param {number=} opt_interval If specified, overrides the object's default\n *     interval with this one (in milliseconds).\n */\ngoog.async.Delay.prototype.start = function(opt_interval) {\n  this.stop();\n  this.id_ = goog.Timer.callOnce(\n      this.callback_, goog.isDef(opt_interval) ? opt_interval : this.interval_);\n};\n\n\n/**\n * Starts the delay timer if it's not already active.\n * @param {number=} opt_interval If specified and the timer is not already\n *     active, overrides the object's default interval with this one (in\n *     milliseconds).\n */\ngoog.async.Delay.prototype.startIfNotActive = function(opt_interval) {\n  if (!this.isActive()) {\n    this.start(opt_interval);\n  }\n};\n\n\n/**\n * Stops the delay timer if it is active. No action is taken if the timer is not\n * in use.\n */\ngoog.async.Delay.prototype.stop = function() {\n  if (this.isActive()) {\n    goog.Timer.clear(this.id_);\n  }\n  this.id_ = 0;\n};\n\n\n/**\n * Fires delay's action even if timer has already gone off or has not been\n * started yet; guarantees action firing. Stops the delay timer.\n */\ngoog.async.Delay.prototype.fire = function() {\n  this.stop();\n  this.doAction_();\n};\n\n\n/**\n * Fires delay's action only if timer is currently active. Stops the delay\n * timer.\n */\ngoog.async.Delay.prototype.fireIfActive = function() {\n  if (this.isActive()) {\n    this.fire();\n  }\n};\n\n\n/**\n * @return {boolean} True if the delay is currently active, false otherwise.\n */\ngoog.async.Delay.prototype.isActive = function() {\n  return this.id_ != 0;\n};\n\n\n/**\n * Invokes the callback function after the delay successfully completes.\n * @private\n */\ngoog.async.Delay.prototype.doAction_ = function() {\n  this.id_ = 0;\n  if (this.listener_) {\n    this.listener_.call(this.handler_);\n  }\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A timer class to which other classes and objects can listen on.\n * This is only an abstraction above `setInterval`.\n *\n * @see ../demos/timers.html\n */\n\ngoog.provide('goog.Timer');\n\ngoog.require('goog.Promise');\ngoog.require('goog.events.EventTarget');\n\n\n\n/**\n * Class for handling timing events.\n *\n * @param {number=} opt_interval Number of ms between ticks (default: 1ms).\n * @param {Object=} opt_timerObject  An object that has `setTimeout`,\n *     `setInterval`, `clearTimeout` and `clearInterval`\n *     (e.g., `window`).\n * @constructor\n * @extends {goog.events.EventTarget}\n */\ngoog.Timer = function(opt_interval, opt_timerObject) {\n  goog.events.EventTarget.call(this);\n\n  /**\n   * Number of ms between ticks\n   * @private {number}\n   */\n  this.interval_ = opt_interval || 1;\n\n  /**\n   * An object that implements `setTimeout`, `setInterval`,\n   * `clearTimeout` and `clearInterval`. We default to the window\n   * object. Changing this on {@link goog.Timer.prototype} changes the object\n   * for all timer instances which can be useful if your environment has some\n   * other implementation of timers than the `window` object.\n   * @private {{setTimeout:!Function, clearTimeout:!Function}}\n   */\n  this.timerObject_ = /** @type {{setTimeout, clearTimeout}} */ (\n      opt_timerObject || goog.Timer.defaultTimerObject);\n\n  /**\n   * Cached `tick_` bound to the object for later use in the timer.\n   * @private {Function}\n   * @const\n   */\n  this.boundTick_ = goog.bind(this.tick_, this);\n\n  /**\n   * Firefox browser often fires the timer event sooner (sometimes MUCH sooner)\n   * than the requested timeout. So we compare the time to when the event was\n   * last fired, and reschedule if appropriate. See also\n   * {@link goog.Timer.intervalScale}.\n   * @private {number}\n   */\n  this.last_ = goog.now();\n};\ngoog.inherits(goog.Timer, goog.events.EventTarget);\n\n\n/**\n * Maximum timeout value.\n *\n * Timeout values too big to fit into a signed 32-bit integer may cause overflow\n * in FF, Safari, and Chrome, resulting in the timeout being scheduled\n * immediately. It makes more sense simply not to schedule these timeouts, since\n * 24.8 days is beyond a reasonable expectation for the browser to stay open.\n *\n * @private {number}\n * @const\n */\ngoog.Timer.MAX_TIMEOUT_ = 2147483647;\n\n\n/**\n * A timer ID that cannot be returned by any known implementation of\n * `window.setTimeout`. Passing this value to `window.clearTimeout`\n * should therefore be a no-op.\n *\n * @private {number}\n * @const\n */\ngoog.Timer.INVALID_TIMEOUT_ID_ = -1;\n\n\n/**\n * Whether this timer is enabled\n * @type {boolean}\n */\ngoog.Timer.prototype.enabled = false;\n\n\n/**\n * An object that implements `setTimeout`, `setInterval`,\n * `clearTimeout` and `clearInterval`. We default to the global\n * object. Changing `goog.Timer.defaultTimerObject` changes the object for\n * all timer instances which can be useful if your environment has some other\n * implementation of timers you'd like to use.\n * @type {{setTimeout, clearTimeout}}\n */\ngoog.Timer.defaultTimerObject = goog.global;\n\n\n/**\n * Variable that controls the timer error correction. If the timer is called\n * before the requested interval times `intervalScale`, which often\n * happens on Mozilla, the timer is rescheduled.\n * @see {@link #last_}\n * @type {number}\n */\ngoog.Timer.intervalScale = 0.8;\n\n\n/**\n * Variable for storing the result of `setInterval`.\n * @private {?number}\n */\ngoog.Timer.prototype.timer_ = null;\n\n\n/**\n * Gets the interval of the timer.\n * @return {number} interval Number of ms between ticks.\n */\ngoog.Timer.prototype.getInterval = function() {\n  return this.interval_;\n};\n\n\n/**\n * Sets the interval of the timer.\n * @param {number} interval Number of ms between ticks.\n */\ngoog.Timer.prototype.setInterval = function(interval) {\n  this.interval_ = interval;\n  if (this.timer_ && this.enabled) {\n    // Stop and then start the timer to reset the interval.\n    this.stop();\n    this.start();\n  } else if (this.timer_) {\n    this.stop();\n  }\n};\n\n\n/**\n * Callback for the `setTimeout` used by the timer.\n * @private\n */\ngoog.Timer.prototype.tick_ = function() {\n  if (this.enabled) {\n    var elapsed = goog.now() - this.last_;\n    if (elapsed > 0 && elapsed < this.interval_ * goog.Timer.intervalScale) {\n      this.timer_ = this.timerObject_.setTimeout(\n          this.boundTick_, this.interval_ - elapsed);\n      return;\n    }\n\n    // Prevents setInterval from registering a duplicate timeout when called\n    // in the timer event handler.\n    if (this.timer_) {\n      this.timerObject_.clearTimeout(this.timer_);\n      this.timer_ = null;\n    }\n\n    this.dispatchTick();\n    // The timer could be stopped in the timer event handler.\n    if (this.enabled) {\n      // Stop and start to ensure there is always only one timeout even if\n      // start is called in the timer event handler.\n      this.stop();\n      this.start();\n    }\n  }\n};\n\n\n/**\n * Dispatches the TICK event. This is its own method so subclasses can override.\n */\ngoog.Timer.prototype.dispatchTick = function() {\n  this.dispatchEvent(goog.Timer.TICK);\n};\n\n\n/**\n * Starts the timer.\n */\ngoog.Timer.prototype.start = function() {\n  this.enabled = true;\n\n  // If there is no interval already registered, start it now\n  if (!this.timer_) {\n    // IMPORTANT!\n    // window.setInterval in FireFox has a bug - it fires based on\n    // absolute time, rather than on relative time. What this means\n    // is that if a computer is sleeping/hibernating for 24 hours\n    // and the timer interval was configured to fire every 1000ms,\n    // then after the PC wakes up the timer will fire, in rapid\n    // succession, 3600*24 times.\n    // This bug is described here and is already fixed, but it will\n    // take time to propagate, so for now I am switching this over\n    // to setTimeout logic.\n    //     https://bugzilla.mozilla.org/show_bug.cgi?id=376643\n    //\n    this.timer_ = this.timerObject_.setTimeout(this.boundTick_, this.interval_);\n    this.last_ = goog.now();\n  }\n};\n\n\n/**\n * Stops the timer.\n */\ngoog.Timer.prototype.stop = function() {\n  this.enabled = false;\n  if (this.timer_) {\n    this.timerObject_.clearTimeout(this.timer_);\n    this.timer_ = null;\n  }\n};\n\n\n/** @override */\ngoog.Timer.prototype.disposeInternal = function() {\n  goog.Timer.superClass_.disposeInternal.call(this);\n  this.stop();\n  delete this.timerObject_;\n};\n\n\n/**\n * Constant for the timer's event type.\n * @const\n */\ngoog.Timer.TICK = 'tick';\n\n\n/**\n * Calls the given function once, after the optional pause.\n * <p>\n * The function is always called asynchronously, even if the delay is 0. This\n * is a common trick to schedule a function to run after a batch of browser\n * event processing.\n *\n * @param {function(this:SCOPE)|{handleEvent:function()}|null} listener Function\n *     or object that has a handleEvent method.\n * @param {number=} opt_delay Milliseconds to wait; default is 0.\n * @param {SCOPE=} opt_handler Object in whose scope to call the listener.\n * @return {number} A handle to the timer ID.\n * @template SCOPE\n */\ngoog.Timer.callOnce = function(listener, opt_delay, opt_handler) {\n  if (goog.isFunction(listener)) {\n    if (opt_handler) {\n      listener = goog.bind(listener, opt_handler);\n    }\n  } else if (listener && typeof listener.handleEvent == 'function') {\n    // using typeof to prevent strict js warning\n    listener = goog.bind(listener.handleEvent, listener);\n  } else {\n    throw new Error('Invalid listener argument');\n  }\n\n  if (Number(opt_delay) > goog.Timer.MAX_TIMEOUT_) {\n    // Timeouts greater than MAX_INT return immediately due to integer\n    // overflow in many browsers.  Since MAX_INT is 24.8 days, just don't\n    // schedule anything at all.\n    return goog.Timer.INVALID_TIMEOUT_ID_;\n  } else {\n    return goog.Timer.defaultTimerObject.setTimeout(listener, opt_delay || 0);\n  }\n};\n\n\n/**\n * Clears a timeout initiated by {@link #callOnce}.\n * @param {?number} timerId A timer ID.\n */\ngoog.Timer.clear = function(timerId) {\n  goog.Timer.defaultTimerObject.clearTimeout(timerId);\n};\n\n\n/**\n * @param {number} delay Milliseconds to wait.\n * @param {(RESULT|goog.Thenable<RESULT>|Thenable)=} opt_result The value\n *     with which the promise will be resolved.\n * @return {!goog.Promise<RESULT>} A promise that will be resolved after\n *     the specified delay, unless it is canceled first.\n * @template RESULT\n */\ngoog.Timer.promise = function(delay, opt_result) {\n  var timerKey = null;\n  return new goog\n      .Promise(function(resolve, reject) {\n        timerKey =\n            goog.Timer.callOnce(function() { resolve(opt_result); }, delay);\n        if (timerKey == goog.Timer.INVALID_TIMEOUT_ID_) {\n          reject(new Error('Failed to schedule timer.'));\n        }\n      })\n      .thenCatch(function(error) {\n        // Clear the timer. The most likely reason is \"cancel\" signal.\n        goog.Timer.clear(timerKey);\n        throw error;\n      });\n};\n","// Copyright 2012 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview A delayed callback that pegs to the next animation frame\n * instead of a user-configurable timeout.\n *\n * @author nicksantos@google.com (Nick Santos)\n */\n\ngoog.provide('goog.async.AnimationDelay');\n\ngoog.require('goog.Disposable');\ngoog.require('goog.events');\ngoog.require('goog.functions');\n\n\n\n// TODO(nicksantos): Should we factor out the common code between this and\n// goog.async.Delay? I'm not sure if there's enough code for this to really\n// make sense. Subclassing seems like the wrong approach for a variety of\n// reasons. Maybe there should be a common interface?\n\n\n\n/**\n * A delayed callback that pegs to the next animation frame\n * instead of a user configurable timeout. By design, this should have\n * the same interface as goog.async.Delay.\n *\n * Uses requestAnimationFrame and friends when available, but falls\n * back to a timeout of goog.async.AnimationDelay.TIMEOUT.\n *\n * For more on requestAnimationFrame and how you can use it to create smoother\n * animations, see:\n * @see http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n *\n * @param {function(this:THIS, number)} listener Function to call\n *     when the delay completes. Will be passed the timestamp when it's called,\n *     in unix ms.\n * @param {Window=} opt_window The window object to execute the delay in.\n *     Defaults to the global object.\n * @param {THIS=} opt_handler The object scope to invoke the function in.\n * @template THIS\n * @constructor\n * @struct\n * @extends {goog.Disposable}\n * @final\n */\ngoog.async.AnimationDelay = function(listener, opt_window, opt_handler) {\n  goog.async.AnimationDelay.base(this, 'constructor');\n\n  /**\n   * Identifier of the active delay timeout, or event listener,\n   * or null when inactive.\n   * @private {goog.events.Key|number}\n   */\n  this.id_ = null;\n\n  /**\n   * If we're using dom listeners.\n   * @private {?boolean}\n   */\n  this.usingListeners_ = false;\n\n  /**\n   * The function that will be invoked after a delay.\n   * @const\n   * @private\n   */\n  this.listener_ = listener;\n\n  /**\n   * The object context to invoke the callback in.\n   * @const\n   * @private {(THIS|undefined)}\n   */\n  this.handler_ = opt_handler;\n\n  /**\n   * @private {Window}\n   */\n  this.win_ = opt_window || window;\n\n  /**\n   * Cached callback function invoked when the delay finishes.\n   * @private {function()}\n   */\n  this.callback_ = goog.bind(this.doAction_, this);\n};\ngoog.inherits(goog.async.AnimationDelay, goog.Disposable);\n\n\n/**\n * Default wait timeout for animations (in milliseconds).  Only used for timed\n * animation, which uses a timer (setTimeout) to schedule animation.\n *\n * @type {number}\n * @const\n */\ngoog.async.AnimationDelay.TIMEOUT = 20;\n\n\n/**\n * Name of event received from the requestAnimationFrame in Firefox.\n *\n * @type {string}\n * @const\n * @private\n */\ngoog.async.AnimationDelay.MOZ_BEFORE_PAINT_EVENT_ = 'MozBeforePaint';\n\n\n/**\n * Starts the delay timer. The provided listener function will be called\n * before the next animation frame.\n */\ngoog.async.AnimationDelay.prototype.start = function() {\n  this.stop();\n  this.usingListeners_ = false;\n\n  var raf = this.getRaf_();\n  var cancelRaf = this.getCancelRaf_();\n  if (raf && !cancelRaf && this.win_.mozRequestAnimationFrame) {\n    // Because Firefox (Gecko) runs animation in separate threads, it also saves\n    // time by running the requestAnimationFrame callbacks in that same thread.\n    // Sadly this breaks the assumption of implicit thread-safety in JS, and can\n    // thus create thread-based inconsistencies on counters etc.\n    //\n    // Calling cycleAnimations_ using the MozBeforePaint event instead of as\n    // callback fixes this.\n    //\n    // Trigger this condition only if the mozRequestAnimationFrame is available,\n    // but not the W3C requestAnimationFrame function (as in draft) or the\n    // equivalent cancel functions.\n    this.id_ = goog.events.listen(\n        this.win_, goog.async.AnimationDelay.MOZ_BEFORE_PAINT_EVENT_,\n        this.callback_);\n    this.win_.mozRequestAnimationFrame(null);\n    this.usingListeners_ = true;\n  } else if (raf && cancelRaf) {\n    this.id_ = raf.call(this.win_, this.callback_);\n  } else {\n    this.id_ = this.win_.setTimeout(\n        // Prior to Firefox 13, Gecko passed a non-standard parameter\n        // to the callback that we want to ignore.\n        goog.functions.lock(this.callback_), goog.async.AnimationDelay.TIMEOUT);\n  }\n};\n\n\n/**\n * Starts the delay timer if it's not already active.\n */\ngoog.async.AnimationDelay.prototype.startIfNotActive = function() {\n  if (!this.isActive()) {\n    this.start();\n  }\n};\n\n\n/**\n * Stops the delay timer if it is active. No action is taken if the timer is not\n * in use.\n */\ngoog.async.AnimationDelay.prototype.stop = function() {\n  if (this.isActive()) {\n    var raf = this.getRaf_();\n    var cancelRaf = this.getCancelRaf_();\n    if (raf && !cancelRaf && this.win_.mozRequestAnimationFrame) {\n      goog.events.unlistenByKey(this.id_);\n    } else if (raf && cancelRaf) {\n      cancelRaf.call(this.win_, /** @type {number} */ (this.id_));\n    } else {\n      this.win_.clearTimeout(/** @type {number} */ (this.id_));\n    }\n  }\n  this.id_ = null;\n};\n\n\n/**\n * Fires delay's action even if timer has already gone off or has not been\n * started yet; guarantees action firing. Stops the delay timer.\n */\ngoog.async.AnimationDelay.prototype.fire = function() {\n  this.stop();\n  this.doAction_();\n};\n\n\n/**\n * Fires delay's action only if timer is currently active. Stops the delay\n * timer.\n */\ngoog.async.AnimationDelay.prototype.fireIfActive = function() {\n  if (this.isActive()) {\n    this.fire();\n  }\n};\n\n\n/**\n * @return {boolean} True if the delay is currently active, false otherwise.\n */\ngoog.async.AnimationDelay.prototype.isActive = function() {\n  return this.id_ != null;\n};\n\n\n/**\n * Invokes the callback function after the delay successfully completes.\n * @private\n */\ngoog.async.AnimationDelay.prototype.doAction_ = function() {\n  if (this.usingListeners_ && this.id_) {\n    goog.events.unlistenByKey(this.id_);\n  }\n  this.id_ = null;\n\n  // We are not using the timestamp returned by requestAnimationFrame\n  // because it may be either a Date.now-style time or a\n  // high-resolution time (depending on browser implementation). Using\n  // goog.now() will ensure that the timestamp used is consistent and\n  // compatible with goog.fx.Animation.\n  this.listener_.call(this.handler_, goog.now());\n};\n\n\n/** @override */\ngoog.async.AnimationDelay.prototype.disposeInternal = function() {\n  this.stop();\n  goog.async.AnimationDelay.base(this, 'disposeInternal');\n};\n\n\n/**\n * @return {?function(function(number)): number} The requestAnimationFrame\n *     function, or null if not available on this browser.\n * @private\n */\ngoog.async.AnimationDelay.prototype.getRaf_ = function() {\n  var win = this.win_;\n  return win.requestAnimationFrame || win.webkitRequestAnimationFrame ||\n      win.mozRequestAnimationFrame || win.oRequestAnimationFrame ||\n      win.msRequestAnimationFrame || null;\n};\n\n\n/**\n * @return {?function(number): undefined} The cancelAnimationFrame function,\n *     or null if not available on this browser.\n * @private\n */\ngoog.async.AnimationDelay.prototype.getCancelRaf_ = function() {\n  var win = this.win_;\n  return win.cancelAnimationFrame || win.cancelRequestAnimationFrame ||\n      win.webkitCancelRequestAnimationFrame ||\n      win.mozCancelRequestAnimationFrame || win.oCancelRequestAnimationFrame ||\n      win.msCancelRequestAnimationFrame || null;\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Classes for doing animations and visual effects.\n *\n * (Based loosly on my animation code for 13thparallel.org, with extra\n * inspiration from the DojoToolkit's modifications to my code)\n * @author arv@google.com (Erik Arvidsson)\n */\n\ngoog.provide('goog.fx.Animation');\ngoog.provide('goog.fx.Animation.EventType');\ngoog.provide('goog.fx.Animation.State');\ngoog.provide('goog.fx.AnimationEvent');\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.events.Event');\ngoog.require('goog.fx.Transition');\ngoog.require('goog.fx.TransitionBase');\ngoog.require('goog.fx.anim');\ngoog.require('goog.fx.anim.Animated');\n\n\n\n/**\n * Constructor for an animation object.\n * @param {Array<number>} start Array for start coordinates.\n * @param {Array<number>} end Array for end coordinates.\n * @param {number} duration Length of animation in milliseconds.\n * @param {Function=} opt_acc Acceleration function, returns 0-1 for inputs 0-1.\n * @constructor\n * @struct\n * @implements {goog.fx.anim.Animated}\n * @implements {goog.fx.Transition}\n * @extends {goog.fx.TransitionBase}\n */\ngoog.fx.Animation = function(start, end, duration, opt_acc) {\n  goog.fx.Animation.base(this, 'constructor');\n\n  if (!goog.isArray(start) || !goog.isArray(end)) {\n    throw new Error('Start and end parameters must be arrays');\n  }\n\n  if (start.length != end.length) {\n    throw new Error('Start and end points must be the same length');\n  }\n\n  /**\n   * Start point.\n   * @type {Array<number>}\n   * @protected\n   */\n  this.startPoint = start;\n\n  /**\n   * End point.\n   * @type {Array<number>}\n   * @protected\n   */\n  this.endPoint = end;\n\n  /**\n   * Duration of animation in milliseconds.\n   * @type {number}\n   * @protected\n   */\n  this.duration = duration;\n\n  /**\n   * Acceleration function, which must return a number between 0 and 1 for\n   * inputs between 0 and 1.\n   * @type {Function|undefined}\n   * @private\n   */\n  this.accel_ = opt_acc;\n\n  /**\n   * Current coordinate for animation.\n   * @type {Array<number>}\n   * @protected\n   */\n  this.coords = [];\n\n  /**\n   * Whether the animation should use \"right\" rather than \"left\" to position\n   * elements in RTL.  This is a temporary flag to allow clients to transition\n   * to the new behavior at their convenience.  At some point it will be the\n   * default.\n   * @type {boolean}\n   * @private\n   */\n  this.useRightPositioningForRtl_ = false;\n\n  /**\n   * Current frame rate.\n   * @private {number}\n   */\n  this.fps_ = 0;\n\n  /**\n   * Percent of the way through the animation.\n   * @protected {number}\n   */\n  this.progress = 0;\n\n  /**\n   * Timestamp for when last frame was run.\n   * @protected {?number}\n   */\n  this.lastFrame = null;\n};\ngoog.inherits(goog.fx.Animation, goog.fx.TransitionBase);\n\n\n/**\n * @return {number} The duration of this animation in milliseconds.\n */\ngoog.fx.Animation.prototype.getDuration = function() {\n  return this.duration;\n};\n\n\n/**\n * Sets whether the animation should use \"right\" rather than \"left\" to position\n * elements.  This is a temporary flag to allow clients to transition\n * to the new component at their convenience.  At some point \"right\" will be\n * used for RTL elements by default.\n * @param {boolean} useRightPositioningForRtl True if \"right\" should be used for\n *     positioning, false if \"left\" should be used for positioning.\n */\ngoog.fx.Animation.prototype.enableRightPositioningForRtl = function(\n    useRightPositioningForRtl) {\n  this.useRightPositioningForRtl_ = useRightPositioningForRtl;\n};\n\n\n/**\n * Whether the animation should use \"right\" rather than \"left\" to position\n * elements.  This is a temporary flag to allow clients to transition\n * to the new component at their convenience.  At some point \"right\" will be\n * used for RTL elements by default.\n * @return {boolean} True if \"right\" should be used for positioning, false if\n *     \"left\" should be used for positioning.\n */\ngoog.fx.Animation.prototype.isRightPositioningForRtlEnabled = function() {\n  return this.useRightPositioningForRtl_;\n};\n\n\n/**\n * Events fired by the animation.\n * @enum {string}\n */\ngoog.fx.Animation.EventType = {\n  /**\n   * Dispatched when played for the first time OR when it is resumed.\n   * @deprecated Use goog.fx.Transition.EventType.PLAY.\n   */\n  PLAY: goog.fx.Transition.EventType.PLAY,\n\n  /**\n   * Dispatched only when the animation starts from the beginning.\n   * @deprecated Use goog.fx.Transition.EventType.BEGIN.\n   */\n  BEGIN: goog.fx.Transition.EventType.BEGIN,\n\n  /**\n   * Dispatched only when animation is restarted after a pause.\n   * @deprecated Use goog.fx.Transition.EventType.RESUME.\n   */\n  RESUME: goog.fx.Transition.EventType.RESUME,\n\n  /**\n   * Dispatched when animation comes to the end of its duration OR stop\n   * is called.\n   * @deprecated Use goog.fx.Transition.EventType.END.\n   */\n  END: goog.fx.Transition.EventType.END,\n\n  /**\n   * Dispatched only when stop is called.\n   * @deprecated Use goog.fx.Transition.EventType.STOP.\n   */\n  STOP: goog.fx.Transition.EventType.STOP,\n\n  /**\n   * Dispatched only when animation comes to its end naturally.\n   * @deprecated Use goog.fx.Transition.EventType.FINISH.\n   */\n  FINISH: goog.fx.Transition.EventType.FINISH,\n\n  /**\n   * Dispatched when an animation is paused.\n   * @deprecated Use goog.fx.Transition.EventType.PAUSE.\n   */\n  PAUSE: goog.fx.Transition.EventType.PAUSE,\n\n  /**\n   * Dispatched each frame of the animation.  This is where the actual animator\n   * will listen.\n   */\n  ANIMATE: 'animate',\n\n  /**\n   * Dispatched when the animation is destroyed.\n   */\n  DESTROY: 'destroy'\n};\n\n\n/**\n * @deprecated Use goog.fx.anim.TIMEOUT.\n */\ngoog.fx.Animation.TIMEOUT = goog.fx.anim.TIMEOUT;\n\n\n/**\n * Enum for the possible states of an animation.\n * @deprecated Use goog.fx.Transition.State instead.\n * @enum {number}\n */\ngoog.fx.Animation.State = goog.fx.TransitionBase.State;\n\n\n/**\n * @deprecated Use goog.fx.anim.setAnimationWindow.\n * @param {Window} animationWindow The window in which to animate elements.\n */\ngoog.fx.Animation.setAnimationWindow = function(animationWindow) {\n  goog.fx.anim.setAnimationWindow(animationWindow);\n};\n\n\n/**\n * Starts or resumes an animation.\n * @param {boolean=} opt_restart Whether to restart the\n *     animation from the beginning if it has been paused.\n * @return {boolean} Whether animation was started.\n * @override\n */\ngoog.fx.Animation.prototype.play = function(opt_restart) {\n  if (opt_restart || this.isStopped()) {\n    this.progress = 0;\n    this.coords = this.startPoint;\n  } else if (this.isPlaying()) {\n    return false;\n  }\n\n  goog.fx.anim.unregisterAnimation(this);\n\n  var now = /** @type {number} */ (goog.now());\n\n  this.startTime = now;\n  if (this.isPaused()) {\n    this.startTime -= this.duration * this.progress;\n  }\n\n  this.endTime = this.startTime + this.duration;\n  this.lastFrame = this.startTime;\n\n  if (!this.progress) {\n    this.onBegin();\n  }\n\n  this.onPlay();\n\n  if (this.isPaused()) {\n    this.onResume();\n  }\n\n  this.setStatePlaying();\n\n  goog.fx.anim.registerAnimation(this);\n  this.cycle(now);\n\n  return true;\n};\n\n\n/**\n * Stops the animation.\n * @param {boolean=} opt_gotoEnd If true the animation will move to the\n *     end coords.\n * @override\n */\ngoog.fx.Animation.prototype.stop = function(opt_gotoEnd) {\n  goog.fx.anim.unregisterAnimation(this);\n  this.setStateStopped();\n\n  if (opt_gotoEnd) {\n    this.progress = 1;\n  }\n\n  this.updateCoords_(this.progress);\n\n  this.onStop();\n  this.onEnd();\n};\n\n\n/**\n * Pauses the animation (iff it's playing).\n * @override\n */\ngoog.fx.Animation.prototype.pause = function() {\n  if (this.isPlaying()) {\n    goog.fx.anim.unregisterAnimation(this);\n    this.setStatePaused();\n    this.onPause();\n  }\n};\n\n\n/**\n * @return {number} The current progress of the animation, the number\n *     is between 0 and 1 inclusive.\n */\ngoog.fx.Animation.prototype.getProgress = function() {\n  return this.progress;\n};\n\n\n/**\n * Sets the progress of the animation.\n * @param {number} progress The new progress of the animation.\n */\ngoog.fx.Animation.prototype.setProgress = function(progress) {\n  this.progress = progress;\n  if (this.isPlaying()) {\n    var now = goog.now();\n    // If the animation is already playing, we recompute startTime and endTime\n    // such that the animation plays consistently, that is:\n    // now = startTime + progress * duration.\n    this.startTime = now - this.duration * this.progress;\n    this.endTime = this.startTime + this.duration;\n  }\n};\n\n\n/**\n * Disposes of the animation.  Stops an animation, fires a 'destroy' event and\n * then removes all the event handlers to clean up memory.\n * @override\n * @protected\n */\ngoog.fx.Animation.prototype.disposeInternal = function() {\n  if (!this.isStopped()) {\n    this.stop(false);\n  }\n  this.onDestroy();\n  goog.fx.Animation.base(this, 'disposeInternal');\n};\n\n\n/**\n * Stops an animation, fires a 'destroy' event and then removes all the event\n * handlers to clean up memory.\n * @deprecated Use dispose() instead.\n */\ngoog.fx.Animation.prototype.destroy = function() {\n  this.dispose();\n};\n\n\n/** @override */\ngoog.fx.Animation.prototype.onAnimationFrame = function(now) {\n  this.cycle(now);\n};\n\n\n/**\n * Handles the actual iteration of the animation in a timeout\n * @param {number} now The current time.\n */\ngoog.fx.Animation.prototype.cycle = function(now) {\n  goog.asserts.assertNumber(this.startTime);\n  goog.asserts.assertNumber(this.endTime);\n  goog.asserts.assertNumber(this.lastFrame);\n  // Happens in rare system clock reset.\n  if (now < this.startTime) {\n    this.endTime = now + this.endTime - this.startTime;\n    this.startTime = now;\n  }\n  this.progress = (now - this.startTime) / (this.endTime - this.startTime);\n\n  if (this.progress > 1) {\n    this.progress = 1;\n  }\n\n  this.fps_ = 1000 / (now - this.lastFrame);\n  this.lastFrame = now;\n\n  this.updateCoords_(this.progress);\n\n  // Animation has finished.\n  if (this.progress == 1) {\n    this.setStateStopped();\n    goog.fx.anim.unregisterAnimation(this);\n\n    this.onFinish();\n    this.onEnd();\n\n    // Animation is still under way.\n  } else if (this.isPlaying()) {\n    this.onAnimate();\n  }\n};\n\n\n/**\n * Calculates current coordinates, based on the current state.  Applies\n * the acceleration function if it exists.\n * @param {number} t Percentage of the way through the animation as a decimal.\n * @private\n */\ngoog.fx.Animation.prototype.updateCoords_ = function(t) {\n  if (goog.isFunction(this.accel_)) {\n    t = this.accel_(t);\n  }\n  this.coords = new Array(this.startPoint.length);\n  for (var i = 0; i < this.startPoint.length; i++) {\n    this.coords[i] =\n        (this.endPoint[i] - this.startPoint[i]) * t + this.startPoint[i];\n  }\n};\n\n\n/**\n * Dispatches the ANIMATE event. Sub classes should override this instead\n * of listening to the event.\n * @protected\n */\ngoog.fx.Animation.prototype.onAnimate = function() {\n  this.dispatchAnimationEvent(goog.fx.Animation.EventType.ANIMATE);\n};\n\n\n/**\n * Dispatches the DESTROY event. Sub classes should override this instead\n * of listening to the event.\n * @protected\n */\ngoog.fx.Animation.prototype.onDestroy = function() {\n  this.dispatchAnimationEvent(goog.fx.Animation.EventType.DESTROY);\n};\n\n\n/** @override */\ngoog.fx.Animation.prototype.dispatchAnimationEvent = function(type) {\n  this.dispatchEvent(new goog.fx.AnimationEvent(type, this));\n};\n\n\n\n/**\n * Class for an animation event object.\n * @param {string} type Event type.\n * @param {goog.fx.Animation} anim An animation object.\n * @constructor\n * @struct\n * @extends {goog.events.Event}\n */\ngoog.fx.AnimationEvent = function(type, anim) {\n  goog.fx.AnimationEvent.base(this, 'constructor', type);\n\n  /**\n   * The current coordinates.\n   * @type {Array<number>}\n   */\n  this.coords = anim.coords;\n\n  /**\n   * The x coordinate.\n   * @type {number}\n   */\n  this.x = anim.coords[0];\n\n  /**\n   * The y coordinate.\n   * @type {number}\n   */\n  this.y = anim.coords[1];\n\n  /**\n   * The z coordinate.\n   * @type {number}\n   */\n  this.z = anim.coords[2];\n\n  /**\n   * The current duration.\n   * @type {number}\n   */\n  this.duration = anim.duration;\n\n  /**\n   * The current progress.\n   * @type {number}\n   */\n  this.progress = anim.getProgress();\n\n  /**\n   * Frames per second so far.\n   */\n  this.fps = anim.fps_;\n\n  /**\n   * The state of the animation.\n   * @type {number}\n   */\n  this.state = anim.getStateInternal();\n\n  /**\n   * The animation object.\n   * @type {goog.fx.Animation}\n   */\n  // TODO(arv): This can be removed as this is the same as the target\n  this.anim = anim;\n};\ngoog.inherits(goog.fx.AnimationEvent, goog.events.Event);\n\n\n/**\n * Returns the coordinates as integers (rounded to nearest integer).\n * @return {!Array<number>} An array of the coordinates rounded to\n *     the nearest integer.\n */\ngoog.fx.AnimationEvent.prototype.coordsAsInts = function() {\n  return goog.array.map(this.coords, Math.round);\n};\n","// Copyright 2011 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview An interface for transition animation. This is a simple\n * interface that allows for playing and stopping a transition. It adds\n * a simple event model with BEGIN and END event.\n *\n * @author chrishenry@google.com (Chris Henry)\n */\n\ngoog.provide('goog.fx.Transition');\ngoog.provide('goog.fx.Transition.EventType');\n\n\n\n/**\n * An interface for programmatic transition. Must extend\n * `goog.events.EventTarget`.\n * @interface\n */\ngoog.fx.Transition = function() {};\n\n\n/**\n * Transition event types.\n * @enum {string}\n */\ngoog.fx.Transition.EventType = {\n  /** Dispatched when played for the first time OR when it is resumed. */\n  PLAY: 'play',\n\n  /** Dispatched only when the animation starts from the beginning. */\n  BEGIN: 'begin',\n\n  /** Dispatched only when animation is restarted after a pause. */\n  RESUME: 'resume',\n\n  /**\n   * Dispatched when animation comes to the end of its duration OR stop\n   * is called.\n   */\n  END: 'end',\n\n  /** Dispatched only when stop is called. */\n  STOP: 'stop',\n\n  /** Dispatched only when animation comes to its end naturally. */\n  FINISH: 'finish',\n\n  /** Dispatched when an animation is paused. */\n  PAUSE: 'pause'\n};\n\n\n/**\n * @type {function()}\n * Plays the transition.\n */\ngoog.fx.Transition.prototype.play;\n\n\n/**\n * @type {function()}\n * Stops the transition.\n */\ngoog.fx.Transition.prototype.stop;\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/**\n * @fileoverview Utilities for adding, removing and setting ARIA roles and\n * states as defined by W3C ARIA standard: http://www.w3.org/TR/wai-aria/\n * All modern browsers have some form of ARIA support, so no browser checks are\n * performed when adding ARIA to components.\n *\n */\n\ngoog.provide('goog.a11y.aria');\n\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.a11y.aria.datatables');\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.object');\ngoog.require('goog.string');\n\n\n/**\n * ARIA states/properties prefix.\n * @private\n */\ngoog.a11y.aria.ARIA_PREFIX_ = 'aria-';\n\n\n/**\n * ARIA role attribute.\n * @private\n */\ngoog.a11y.aria.ROLE_ATTRIBUTE_ = 'role';\n\n\n/**\n * A list of tag names for which we don't need to set ARIA role and states\n * because they have well supported semantics for screen readers or because\n * they don't contain content to be made accessible.\n * @private\n */\ngoog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_ = goog.object.createSet([\n  goog.dom.TagName.A, goog.dom.TagName.AREA, goog.dom.TagName.BUTTON,\n  goog.dom.TagName.HEAD, goog.dom.TagName.INPUT, goog.dom.TagName.LINK,\n  goog.dom.TagName.MENU, goog.dom.TagName.META, goog.dom.TagName.OPTGROUP,\n  goog.dom.TagName.OPTION, goog.dom.TagName.PROGRESS, goog.dom.TagName.STYLE,\n  goog.dom.TagName.SELECT, goog.dom.TagName.SOURCE, goog.dom.TagName.TEXTAREA,\n  goog.dom.TagName.TITLE, goog.dom.TagName.TRACK\n]);\n\n\n/**\n * A list of roles which are considered container roles.\n * Container roles are ARIA roles which use the aria-activedescendant property\n * to manage their active descendants or children. See\n * {@link http://www.w3.org/TR/wai-aria/states_and_properties\n * #aria-activedescendant} for more information.\n * @private @const {!Array<goog.a11y.aria.Role>}\n */\ngoog.a11y.aria.CONTAINER_ROLES_ = [\n  goog.a11y.aria.Role.COMBOBOX, goog.a11y.aria.Role.GRID,\n  goog.a11y.aria.Role.GROUP, goog.a11y.aria.Role.LISTBOX,\n  goog.a11y.aria.Role.MENU, goog.a11y.aria.Role.MENUBAR,\n  goog.a11y.aria.Role.RADIOGROUP, goog.a11y.aria.Role.ROW,\n  goog.a11y.aria.Role.ROWGROUP, goog.a11y.aria.Role.TAB_LIST,\n  goog.a11y.aria.Role.TEXTBOX, goog.a11y.aria.Role.TOOLBAR,\n  goog.a11y.aria.Role.TREE, goog.a11y.aria.Role.TREEGRID\n];\n\n\n/**\n * Sets the role of an element. If the roleName is\n * empty string or null, the role for the element is removed.\n * We encourage clients to call the goog.a11y.aria.removeRole\n * method instead of setting null and empty string values.\n * Special handling for this case is added to ensure\n * backword compatibility with existing code.\n *\n * @param {!Element} element DOM node to set role of.\n * @param {!goog.a11y.aria.Role|string} roleName role name(s).\n */\ngoog.a11y.aria.setRole = function(element, roleName) {\n  if (!roleName) {\n    // Setting the ARIA role to empty string is not allowed\n    // by the ARIA standard.\n    goog.a11y.aria.removeRole(element);\n  } else {\n    if (goog.asserts.ENABLE_ASSERTS) {\n      goog.asserts.assert(\n          goog.object.containsValue(goog.a11y.aria.Role, roleName),\n          'No such ARIA role ' + roleName);\n    }\n    element.setAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_, roleName);\n  }\n};\n\n\n/**\n * Gets role of an element.\n * @param {!Element} element DOM element to get role of.\n * @return {?goog.a11y.aria.Role} ARIA Role name.\n */\ngoog.a11y.aria.getRole = function(element) {\n  var role = element.getAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_);\n  return /** @type {goog.a11y.aria.Role} */ (role) || null;\n};\n\n\n/**\n * Removes role of an element.\n * @param {!Element} element DOM element to remove the role from.\n */\ngoog.a11y.aria.removeRole = function(element) {\n  element.removeAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_);\n};\n\n\n/**\n * Sets the state or property of an element.\n * @param {!Element} element DOM node where we set state.\n * @param {!(goog.a11y.aria.State|string)} stateName State attribute being set.\n *     Automatically adds prefix 'aria-' to the state name if the attribute is\n *     not an extra attribute.\n * @param {string|boolean|number|!Array<string>} value Value\n * for the state attribute.\n */\ngoog.a11y.aria.setState = function(element, stateName, value) {\n  if (goog.isArray(value)) {\n    value = value.join(' ');\n  }\n  var attrStateName = goog.a11y.aria.getAriaAttributeName_(stateName);\n  if (value === '' || value == undefined) {\n    var defaultValueMap = goog.a11y.aria.datatables.getDefaultValuesMap();\n    // Work around for browsers that don't properly support ARIA.\n    // According to the ARIA W3C standard, user agents should allow\n    // setting empty value which results in setting the default value\n    // for the ARIA state if such exists. The exact text from the ARIA W3C\n    // standard (http://www.w3.org/TR/wai-aria/states_and_properties):\n    // \"When a value is indicated as the default, the user agent\n    // MUST follow the behavior prescribed by this value when the state or\n    // property is empty or undefined.\"\n    // The defaultValueMap contains the default values for the ARIA states\n    // and has as a key the goog.a11y.aria.State constant for the state.\n    if (stateName in defaultValueMap) {\n      element.setAttribute(attrStateName, defaultValueMap[stateName]);\n    } else {\n      element.removeAttribute(attrStateName);\n    }\n  } else {\n    element.setAttribute(attrStateName, value);\n  }\n};\n\n\n/**\n * Toggles the ARIA attribute of an element.\n * Meant for attributes with a true/false value, but works with any attribute.\n * If the attribute does not have a true/false value, the following rules apply:\n * A not empty attribute will be removed.\n * An empty attribute will be set to true.\n * @param {!Element} el DOM node for which to set attribute.\n * @param {!(goog.a11y.aria.State|string)} attr ARIA attribute being set.\n *     Automatically adds prefix 'aria-' to the attribute name if the attribute\n *     is not an extra attribute.\n */\ngoog.a11y.aria.toggleState = function(el, attr) {\n  var val = goog.a11y.aria.getState(el, attr);\n  if (!goog.string.isEmptyOrWhitespace(goog.string.makeSafe(val)) &&\n      !(val == 'true' || val == 'false')) {\n    goog.a11y.aria.removeState(el, /** @type {!goog.a11y.aria.State} */ (attr));\n    return;\n  }\n  goog.a11y.aria.setState(el, attr, val == 'true' ? 'false' : 'true');\n};\n\n\n/**\n * Remove the state or property for the element.\n * @param {!Element} element DOM node where we set state.\n * @param {!goog.a11y.aria.State} stateName State name.\n */\ngoog.a11y.aria.removeState = function(element, stateName) {\n  element.removeAttribute(goog.a11y.aria.getAriaAttributeName_(stateName));\n};\n\n\n/**\n * Gets value of specified state or property.\n * @param {!Element} element DOM node to get state from.\n * @param {!goog.a11y.aria.State|string} stateName State name.\n * @return {string} Value of the state attribute.\n */\ngoog.a11y.aria.getState = function(element, stateName) {\n  // TODO(user): return properly typed value result --\n  // boolean, number, string, null. We should be able to chain\n  // getState(...) and setState(...) methods.\n\n  var attr =\n      /** @type {string|number|boolean} */ (\n          element.getAttribute(\n              goog.a11y.aria.getAriaAttributeName_(stateName)));\n  var isNullOrUndefined = attr == null || attr == undefined;\n  return isNullOrUndefined ? '' : String(attr);\n};\n\n\n/**\n * Returns the activedescendant element for the input element by\n * using the activedescendant ARIA property of the given element.\n * @param {!Element} element DOM node to get activedescendant\n *     element for.\n * @return {?Element} DOM node of the activedescendant, if found.\n */\ngoog.a11y.aria.getActiveDescendant = function(element) {\n  var id =\n      goog.a11y.aria.getState(element, goog.a11y.aria.State.ACTIVEDESCENDANT);\n  return goog.dom.getOwnerDocument(element).getElementById(id);\n};\n\n\n/**\n * Sets the activedescendant ARIA property value for an element.\n * If the activeElement is not null, it should have an id set.\n * @param {!Element} element DOM node to set activedescendant ARIA property to.\n * @param {?Element} activeElement DOM node being set as activedescendant.\n */\ngoog.a11y.aria.setActiveDescendant = function(element, activeElement) {\n  var id = '';\n  if (activeElement) {\n    id = activeElement.id;\n    goog.asserts.assert(id, 'The active element should have an id.');\n  }\n\n  goog.a11y.aria.setState(element, goog.a11y.aria.State.ACTIVEDESCENDANT, id);\n};\n\n\n/**\n * Gets the label of the given element.\n * @param {!Element} element DOM node to get label from.\n * @return {string} label The label.\n */\ngoog.a11y.aria.getLabel = function(element) {\n  return goog.a11y.aria.getState(element, goog.a11y.aria.State.LABEL);\n};\n\n\n/**\n * Sets the label of the given element.\n * @param {!Element} element DOM node to set label to.\n * @param {string} label The label to set.\n */\ngoog.a11y.aria.setLabel = function(element, label) {\n  goog.a11y.aria.setState(element, goog.a11y.aria.State.LABEL, label);\n};\n\n\n/**\n * Asserts that the element has a role set if it's not an HTML element whose\n * semantics is well supported by most screen readers.\n * Only to be used internally by the ARIA library in goog.a11y.aria.*.\n * @param {!Element} element The element to assert an ARIA role set.\n * @param {!IArrayLike<string>} allowedRoles The child roles of\n * the roles.\n */\ngoog.a11y.aria.assertRoleIsSetInternalUtil = function(element, allowedRoles) {\n  if (goog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_[element.tagName]) {\n    return;\n  }\n  var elementRole = /** @type {string}*/ (goog.a11y.aria.getRole(element));\n  goog.asserts.assert(\n      elementRole != null, 'The element ARIA role cannot be null.');\n\n  goog.asserts.assert(\n      goog.array.contains(allowedRoles, elementRole),\n      'Non existing or incorrect role set for element.' +\n          'The role set is \"' + elementRole + '\". The role should be any of \"' +\n          allowedRoles + '\". Check the ARIA specification for more details ' +\n          'http://www.w3.org/TR/wai-aria/roles.');\n};\n\n\n/**\n * Gets the boolean value of an ARIA state/property.\n * @param {!Element} element The element to get the ARIA state for.\n * @param {!goog.a11y.aria.State|string} stateName the ARIA state name.\n * @return {?boolean} Boolean value for the ARIA state value or null if\n *     the state value is not 'true', not 'false', or not set.\n */\ngoog.a11y.aria.getStateBoolean = function(element, stateName) {\n  var attr =\n      /** @type {string|boolean|null} */ (element.getAttribute(\n          goog.a11y.aria.getAriaAttributeName_(stateName)));\n  goog.asserts.assert(\n      goog.isBoolean(attr) || attr == null || attr == 'true' ||\n      attr == 'false');\n  if (attr == null) {\n    return attr;\n  }\n  return goog.isBoolean(attr) ? attr : attr == 'true';\n};\n\n\n/**\n * Gets the number value of an ARIA state/property.\n * @param {!Element} element The element to get the ARIA state for.\n * @param {!goog.a11y.aria.State|string} stateName the ARIA state name.\n * @return {?number} Number value for the ARIA state value or null if\n *     the state value is not a number or not set.\n */\ngoog.a11y.aria.getStateNumber = function(element, stateName) {\n  var attr =\n      /** @type {string|number} */ (\n          element.getAttribute(\n              goog.a11y.aria.getAriaAttributeName_(stateName)));\n  goog.asserts.assert(\n      (attr == null || !isNaN(Number(attr))) && !goog.isBoolean(attr));\n  return attr == null ? null : Number(attr);\n};\n\n\n/**\n * Gets the string value of an ARIA state/property.\n * @param {!Element} element The element to get the ARIA state for.\n * @param {!goog.a11y.aria.State|string} stateName the ARIA state name.\n * @return {?string} String value for the ARIA state value or null if\n *     the state value is empty string or not set.\n */\ngoog.a11y.aria.getStateString = function(element, stateName) {\n  var attr =\n      element.getAttribute(goog.a11y.aria.getAriaAttributeName_(stateName));\n  goog.asserts.assert(\n      (attr == null || goog.isString(attr)) &&\n      (attr == '' || isNaN(Number(attr))) && attr != 'true' && attr != 'false');\n  return (attr == null || attr == '') ? null : attr;\n};\n\n\n/**\n * Gets array of strings value of the specified state or\n * property for the element.\n * Only to be used internally by the ARIA library in goog.a11y.aria.*.\n * @param {!Element} element DOM node to get state from.\n * @param {!goog.a11y.aria.State} stateName State name.\n * @return {!IArrayLike<string>} string Array\n *     value of the state attribute.\n */\ngoog.a11y.aria.getStringArrayStateInternalUtil = function(element, stateName) {\n  var attrValue =\n      element.getAttribute(goog.a11y.aria.getAriaAttributeName_(stateName));\n  return goog.a11y.aria.splitStringOnWhitespace_(attrValue);\n};\n\n\n/**\n * Returns true if element has an ARIA state/property, false otherwise.\n * @param {!Element} element The element to get the ARIA state for.\n * @param {!goog.a11y.aria.State|string} stateName the ARIA state name.\n * @return {boolean}\n */\ngoog.a11y.aria.hasState = function(element, stateName) {\n  return element.hasAttribute(goog.a11y.aria.getAriaAttributeName_(stateName));\n};\n\n\n/**\n * Returns whether the element has a container ARIA role.\n * Container roles are ARIA roles that use the aria-activedescendant property\n * to manage their active descendants or children. See\n * {@link http://www.w3.org/TR/wai-aria/states_and_properties\n * #aria-activedescendant} for more information.\n * @param {!Element} element\n * @return {boolean}\n */\ngoog.a11y.aria.isContainerRole = function(element) {\n  var role = goog.a11y.aria.getRole(element);\n  return goog.array.contains(goog.a11y.aria.CONTAINER_ROLES_, role);\n};\n\n\n/**\n * Splits the input stringValue on whitespace.\n * @param {string} stringValue The value of the string to split.\n * @return {!IArrayLike<string>} string Array\n *     value as result of the split.\n * @private\n */\ngoog.a11y.aria.splitStringOnWhitespace_ = function(stringValue) {\n  return stringValue ? stringValue.split(/\\s+/) : [];\n};\n\n\n/**\n * Adds the 'aria-' prefix to ariaName.\n * @param {string} ariaName ARIA state/property name.\n * @private\n * @return {string} The ARIA attribute name with added 'aria-' prefix.\n * @throws {Error} If no such attribute exists.\n */\ngoog.a11y.aria.getAriaAttributeName_ = function(ariaName) {\n  if (goog.asserts.ENABLE_ASSERTS) {\n    goog.asserts.assert(ariaName, 'ARIA attribute cannot be empty.');\n    goog.asserts.assert(\n        goog.object.containsValue(goog.a11y.aria.State, ariaName),\n        'No such ARIA attribute ' + ariaName);\n  }\n  return goog.a11y.aria.ARIA_PREFIX_ + ariaName;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n/**\n * @fileoverview The file contains data tables generated from the ARIA\n * standard schema http://www.w3.org/TR/wai-aria/.\n *\n * This is auto-generated code. Do not manually edit!\n */\n\ngoog.provide('goog.a11y.aria.datatables');\n\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.object');\n\n\n/**\n * A map that contains mapping between an ARIA state and the default value\n * for it. Note that not all ARIA states have default values.\n *\n * @type {Object<!(goog.a11y.aria.State|string), (string|boolean|number)>}\n */\ngoog.a11y.aria.DefaultStateValueMap_;\n\n\n/**\n * A method that creates a map that contains mapping between an ARIA state and\n * the default value for it. Note that not all ARIA states have default values.\n *\n * @return {!Object<!(goog.a11y.aria.State|string), (string|boolean|number)>}\n *      The names for each of the notification methods.\n */\ngoog.a11y.aria.datatables.getDefaultValuesMap = function() {\n  if (!goog.a11y.aria.DefaultStateValueMap_) {\n    goog.a11y.aria.DefaultStateValueMap_ = goog.object.create(\n        goog.a11y.aria.State.ATOMIC, false, goog.a11y.aria.State.AUTOCOMPLETE,\n        'none', goog.a11y.aria.State.DROPEFFECT, 'none',\n        goog.a11y.aria.State.HASPOPUP, false, goog.a11y.aria.State.LIVE, 'off',\n        goog.a11y.aria.State.MULTILINE, false,\n        goog.a11y.aria.State.MULTISELECTABLE, false,\n        goog.a11y.aria.State.ORIENTATION, 'vertical',\n        goog.a11y.aria.State.READONLY, false, goog.a11y.aria.State.RELEVANT,\n        'additions text', goog.a11y.aria.State.REQUIRED, false,\n        goog.a11y.aria.State.SORT, 'none', goog.a11y.aria.State.BUSY, false,\n        goog.a11y.aria.State.DISABLED, false, goog.a11y.aria.State.HIDDEN,\n        false, goog.a11y.aria.State.INVALID, 'false');\n  }\n\n  return goog.a11y.aria.DefaultStateValueMap_;\n};\n","// Copyright 2013 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/**\n * @fileoverview The file contains generated enumerations for ARIA states\n * and properties as defined by W3C ARIA standard:\n * http://www.w3.org/TR/wai-aria/.\n *\n * This is auto-generated code. Do not manually edit! For more details\n * about how to edit it via the generator check go/closure-ariagen.\n */\n\ngoog.provide('goog.a11y.aria.AutoCompleteValues');\ngoog.provide('goog.a11y.aria.CheckedValues');\ngoog.provide('goog.a11y.aria.DropEffectValues');\ngoog.provide('goog.a11y.aria.ExpandedValues');\ngoog.provide('goog.a11y.aria.GrabbedValues');\ngoog.provide('goog.a11y.aria.InvalidValues');\ngoog.provide('goog.a11y.aria.LivePriority');\ngoog.provide('goog.a11y.aria.OrientationValues');\ngoog.provide('goog.a11y.aria.PressedValues');\ngoog.provide('goog.a11y.aria.RelevantValues');\ngoog.provide('goog.a11y.aria.SelectedValues');\ngoog.provide('goog.a11y.aria.SortValues');\ngoog.provide('goog.a11y.aria.State');\n\n\n/**\n * ARIA states and properties.\n * @enum {string}\n */\ngoog.a11y.aria.State = {\n  // ARIA property for setting the currently active descendant of an element,\n  // for example the selected item in a list box. Value: ID of an element.\n  ACTIVEDESCENDANT: 'activedescendant',\n\n  // ARIA property that, if true, indicates that all of a changed region should\n  // be presented, instead of only parts. Value: one of {true, false}.\n  ATOMIC: 'atomic',\n\n  // ARIA property to specify that input completion is provided. Value:\n  // one of {'inline', 'list', 'both', 'none'}.\n  AUTOCOMPLETE: 'autocomplete',\n\n  // ARIA state to indicate that an element and its subtree are being updated.\n  // Value: one of {true, false}.\n  BUSY: 'busy',\n\n  // ARIA state for a checked item. Value: one of {'true', 'false', 'mixed',\n  // undefined}.\n  CHECKED: 'checked',\n\n  // ARIA state that defines an element's column index or position with respect\n  // to the total number of columns within a table, grid, or treegrid.\n  // Value: number.\n  COLINDEX: 'colindex',\n\n  // ARIA property that identifies the element or elements whose contents or\n  // presence are controlled by this element.\n  // Value: space-separated IDs of other elements.\n  CONTROLS: 'controls',\n\n  // ARIA property that identifies the element or elements that describe\n  // this element. Value: space-separated IDs of other elements.\n  DESCRIBEDBY: 'describedby',\n\n  // ARIA state for a disabled item. Value: one of {true, false}.\n  DISABLED: 'disabled',\n\n  // ARIA property that indicates what functions can be performed when a\n  // dragged object is released on the drop target.  Value: one of\n  // {'copy', 'move', 'link', 'execute', 'popup', 'none'}.\n  DROPEFFECT: 'dropeffect',\n\n  // ARIA state for setting whether the element like a tree node is expanded.\n  // Value: one of {true, false, undefined}.\n  EXPANDED: 'expanded',\n\n  // ARIA property that identifies the next element (or elements) in the\n  // recommended reading order of content. Value: space-separated ids of\n  // elements to flow to.\n  FLOWTO: 'flowto',\n\n  // ARIA state that indicates an element's \"grabbed\" state in drag-and-drop.\n  // Value: one of {true, false, undefined}.\n  GRABBED: 'grabbed',\n\n  // ARIA property indicating whether the element has a popup.\n  // Value: one of {true, false}.\n  HASPOPUP: 'haspopup',\n\n  // ARIA state indicating that the element is not visible or perceivable\n  // to any user. Value: one of {true, false}.\n  HIDDEN: 'hidden',\n\n  // ARIA state indicating that the entered value does not conform. Value:\n  // one of {false, true, 'grammar', 'spelling'}\n  INVALID: 'invalid',\n\n  // ARIA property that provides a label to override any other text, value, or\n  // contents used to describe this element. Value: string.\n  LABEL: 'label',\n\n  // ARIA property for setting the element which labels another element.\n  // Value: space-separated IDs of elements.\n  LABELLEDBY: 'labelledby',\n\n  // ARIA property for setting the level of an element in the hierarchy.\n  // Value: integer.\n  LEVEL: 'level',\n\n  // ARIA property indicating that an element will be updated, and\n  // describes the types of updates the user agents, assistive technologies,\n  // and user can expect from the live region. Value: one of {'off', 'polite',\n  // 'assertive'}.\n  LIVE: 'live',\n\n  // ARIA property indicating whether a text box can accept multiline input.\n  // Value: one of {true, false}.\n  MULTILINE: 'multiline',\n\n  // ARIA property indicating if the user may select more than one item.\n  // Value: one of {true, false}.\n  MULTISELECTABLE: 'multiselectable',\n\n  // ARIA property indicating if the element is horizontal or vertical.\n  // Value: one of {'vertical', 'horizontal'}.\n  ORIENTATION: 'orientation',\n\n  // ARIA property creating a visual, functional, or contextual parent/child\n  // relationship when the DOM hierarchy can't be used to represent it.\n  // Value: Space-separated IDs of elements.\n  OWNS: 'owns',\n\n  // ARIA property that defines an element's number of position in a list.\n  // Value: integer.\n  POSINSET: 'posinset',\n\n  // ARIA state for a pressed item.\n  // Value: one of {true, false, undefined, 'mixed'}.\n  PRESSED: 'pressed',\n\n  // ARIA property indicating that an element is not editable.\n  // Value: one of {true, false}.\n  READONLY: 'readonly',\n\n  // ARIA property indicating that change notifications within this subtree\n  // of a live region should be announced. Value: one of {'additions',\n  // 'removals', 'text', 'all', 'additions text'}.\n  RELEVANT: 'relevant',\n\n  // ARIA property indicating that user input is required on this element\n  // before a form may be submitted. Value: one of {true, false}.\n  REQUIRED: 'required',\n\n  // ARIA state that defines an element's row index or position with respect\n  // to the total number of rows within a table, grid, or treegrid.\n  // Value: number.\n  ROWINDEX: 'rowindex',\n\n  // ARIA state for setting the currently selected item in the list.\n  // Value: one of {true, false, undefined}.\n  SELECTED: 'selected',\n\n  // ARIA property defining the number of items in a list. Value: integer.\n  SETSIZE: 'setsize',\n\n  // ARIA property indicating if items are sorted. Value: one of {'ascending',\n  // 'descending', 'none', 'other'}.\n  SORT: 'sort',\n\n  // ARIA property for slider maximum value. Value: number.\n  VALUEMAX: 'valuemax',\n\n  // ARIA property for slider minimum value. Value: number.\n  VALUEMIN: 'valuemin',\n\n  // ARIA property for slider active value. Value: number.\n  VALUENOW: 'valuenow',\n\n  // ARIA property for slider active value represented as text.\n  // Value: string.\n  VALUETEXT: 'valuetext'\n};\n\n\n/**\n * ARIA state values for AutoCompleteValues.\n * @enum {string}\n */\ngoog.a11y.aria.AutoCompleteValues = {\n  // The system provides text after the caret as a suggestion\n  // for how to complete the field.\n  INLINE: 'inline',\n  // A list of choices appears from which the user can choose,\n  // but the edit box retains focus.\n  LIST: 'list',\n  // A list of choices appears and the currently selected suggestion\n  // also appears inline.\n  BOTH: 'both',\n  // No input completion suggestions are provided.\n  NONE: 'none'\n};\n\n\n/**\n * ARIA state values for DropEffectValues.\n * @enum {string}\n */\ngoog.a11y.aria.DropEffectValues = {\n  // A duplicate of the source object will be dropped into the target.\n  COPY: 'copy',\n  // The source object will be removed from its current location\n  // and dropped into the target.\n  MOVE: 'move',\n  // A reference or shortcut to the dragged object\n  // will be created in the target object.\n  LINK: 'link',\n  // A function supported by the drop target is\n  // executed, using the drag source as an input.\n  EXECUTE: 'execute',\n  // There is a popup menu or dialog that allows the user to choose\n  // one of the drag operations (copy, move, link, execute) and any other\n  // drag functionality, such as cancel.\n  POPUP: 'popup',\n  // No operation can be performed; effectively\n  // cancels the drag operation if an attempt is made to drop on this object.\n  NONE: 'none'\n};\n\n\n/**\n * ARIA state values for LivePriority.\n * @enum {string}\n */\ngoog.a11y.aria.LivePriority = {\n  // Updates to the region will not be presented to the user\n  // unless the assitive technology is currently focused on that region.\n  OFF: 'off',\n  // (Background change) Assistive technologies SHOULD announce\n  // updates at the next graceful opportunity, such as at the end of\n  // speaking the current sentence or when the user pauses typing.\n  POLITE: 'polite',\n  // This information has the highest priority and assistive\n  // technologies SHOULD notify the user immediately.\n  // Because an interruption may disorient users or cause them to not complete\n  // their current task, authors SHOULD NOT use the assertive value unless the\n  // interruption is imperative.\n  ASSERTIVE: 'assertive'\n};\n\n\n/**\n * ARIA state values for OrientationValues.\n * @enum {string}\n */\ngoog.a11y.aria.OrientationValues = {\n  // The element is oriented vertically.\n  VERTICAL: 'vertical',\n  // The element is oriented horizontally.\n  HORIZONTAL: 'horizontal'\n};\n\n\n/**\n * ARIA state values for RelevantValues.\n * @enum {string}\n */\ngoog.a11y.aria.RelevantValues = {\n  // Element nodes are added to the DOM within the live region.\n  ADDITIONS: 'additions',\n  // Text or element nodes within the live region are removed from the DOM.\n  REMOVALS: 'removals',\n  // Text is added to any DOM descendant nodes of the live region.\n  TEXT: 'text',\n  // Equivalent to the combination of all values, \"additions removals text\".\n  ALL: 'all'\n};\n\n\n/**\n * ARIA state values for SortValues.\n * @enum {string}\n */\ngoog.a11y.aria.SortValues = {\n  // Items are sorted in ascending order by this column.\n  ASCENDING: 'ascending',\n  // Items are sorted in descending order by this column.\n  DESCENDING: 'descending',\n  // There is no defined sort applied to the column.\n  NONE: 'none',\n  // A sort algorithm other than ascending or descending has been applied.\n  OTHER: 'other'\n};\n\n\n/**\n * ARIA state values for CheckedValues.\n * @enum {string}\n */\ngoog.a11y.aria.CheckedValues = {\n  // The selectable element is checked.\n  TRUE: 'true',\n  // The selectable element is not checked.\n  FALSE: 'false',\n  // Indicates a mixed mode value for a tri-state\n  // checkbox or menuitemcheckbox.\n  MIXED: 'mixed',\n  // The element does not support being checked.\n  UNDEFINED: 'undefined'\n};\n\n\n/**\n * ARIA state values for ExpandedValues.\n * @enum {string}\n */\ngoog.a11y.aria.ExpandedValues = {\n  // The element, or another grouping element it controls, is expanded.\n  TRUE: 'true',\n  // The element, or another grouping element it controls, is collapsed.\n  FALSE: 'false',\n  // The element, or another grouping element\n  // it controls, is neither expandable nor collapsible; all its\n  // child elements are shown or there are no child elements.\n  UNDEFINED: 'undefined'\n};\n\n\n/**\n * ARIA state values for GrabbedValues.\n * @enum {string}\n */\ngoog.a11y.aria.GrabbedValues = {\n  // Indicates that the element has been \"grabbed\" for dragging.\n  TRUE: 'true',\n  // Indicates that the element supports being dragged.\n  FALSE: 'false',\n  // Indicates that the element does not support being dragged.\n  UNDEFINED: 'undefined'\n};\n\n\n/**\n * ARIA state values for InvalidValues.\n * @enum {string}\n */\ngoog.a11y.aria.InvalidValues = {\n  // There are no detected errors in the value.\n  FALSE: 'false',\n  // The value entered by the user has failed validation.\n  TRUE: 'true',\n  // A grammatical error was detected.\n  GRAMMAR: 'grammar',\n  // A spelling error was detected.\n  SPELLING: 'spelling'\n};\n\n\n/**\n * ARIA state values for PressedValues.\n * @enum {string}\n */\ngoog.a11y.aria.PressedValues = {\n  // The element is pressed.\n  TRUE: 'true',\n  // The element supports being pressed but is not currently pressed.\n  FALSE: 'false',\n  // Indicates a mixed mode value for a tri-state toggle button.\n  MIXED: 'mixed',\n  // The element does not support being pressed.\n  UNDEFINED: 'undefined'\n};\n\n\n/**\n * ARIA state values for SelectedValues.\n * @enum {string}\n */\ngoog.a11y.aria.SelectedValues = {\n  // The selectable element is selected.\n  TRUE: 'true',\n  // The selectable element is not selected.\n  FALSE: 'false',\n  // The element is not selectable.\n  UNDEFINED: 'undefined'\n};\n","// Copyright 2012 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for detecting, adding and removing classes.  Prefer\n * this over goog.dom.classes for new code since it attempts to use classList\n * (DOMTokenList: http://dom.spec.whatwg.org/#domtokenlist) which is faster\n * and requires less code.\n *\n * Note: these utilities are meant to operate on HTMLElements\n * and may have unexpected behavior on elements with differing interfaces\n * (such as SVGElements).\n */\n\n\ngoog.provide('goog.dom.classlist');\n\ngoog.require('goog.array');\n\n\n/**\n * Override this define at build-time if you know your target supports it.\n * @define {boolean} Whether to use the classList property (DOMTokenList).\n */\ngoog.define('goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST', false);\n\n\n/**\n * Gets an array-like object of class names on an element.\n * @param {Element} element DOM node to get the classes of.\n * @return {!IArrayLike<?>} Class names on `element`.\n */\ngoog.dom.classlist.get = function(element) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    return element.classList;\n  }\n\n  var className = element.className;\n  // Some types of elements don't have a className in IE (e.g. iframes).\n  // Furthermore, in Firefox, className is not a string when the element is\n  // an SVG element.\n  return goog.isString(className) && className.match(/\\S+/g) || [];\n};\n\n\n/**\n * Sets the entire class name of an element.\n * @param {Element} element DOM node to set class of.\n * @param {string} className Class name(s) to apply to element.\n */\ngoog.dom.classlist.set = function(element, className) {\n  element.className = className;\n};\n\n\n/**\n * Returns true if an element has a class.  This method may throw a DOM\n * exception for an invalid or empty class name if DOMTokenList is used.\n * @param {Element} element DOM node to test.\n * @param {string} className Class name to test for.\n * @return {boolean} Whether element has the class.\n */\ngoog.dom.classlist.contains = function(element, className) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    return element.classList.contains(className);\n  }\n  return goog.array.contains(goog.dom.classlist.get(element), className);\n};\n\n\n/**\n * Adds a class to an element.  Does not add multiples of class names.  This\n * method may throw a DOM exception for an invalid or empty class name if\n * DOMTokenList is used.\n * @param {Element} element DOM node to add class to.\n * @param {string} className Class name to add.\n */\ngoog.dom.classlist.add = function(element, className) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    element.classList.add(className);\n    return;\n  }\n\n  if (!goog.dom.classlist.contains(element, className)) {\n    // Ensure we add a space if this is not the first class name added.\n    element.className +=\n        element.className.length > 0 ? (' ' + className) : className;\n  }\n};\n\n\n/**\n * Convenience method to add a number of class names at once.\n * @param {Element} element The element to which to add classes.\n * @param {IArrayLike<string>} classesToAdd An array-like object\n * containing a collection of class names to add to the element.\n * This method may throw a DOM exception if classesToAdd contains invalid\n * or empty class names.\n */\ngoog.dom.classlist.addAll = function(element, classesToAdd) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    goog.array.forEach(classesToAdd, function(className) {\n      goog.dom.classlist.add(element, className);\n    });\n    return;\n  }\n\n  var classMap = {};\n\n  // Get all current class names into a map.\n  goog.array.forEach(goog.dom.classlist.get(element), function(className) {\n    classMap[className] = true;\n  });\n\n  // Add new class names to the map.\n  goog.array.forEach(\n      classesToAdd, function(className) { classMap[className] = true; });\n\n  // Flatten the keys of the map into the className.\n  element.className = '';\n  for (var className in classMap) {\n    element.className +=\n        element.className.length > 0 ? (' ' + className) : className;\n  }\n};\n\n\n/**\n * Removes a class from an element.  This method may throw a DOM exception\n * for an invalid or empty class name if DOMTokenList is used.\n * @param {Element} element DOM node to remove class from.\n * @param {string} className Class name to remove.\n */\ngoog.dom.classlist.remove = function(element, className) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    element.classList.remove(className);\n    return;\n  }\n\n  if (goog.dom.classlist.contains(element, className)) {\n    // Filter out the class name.\n    element.className = goog.array\n                            .filter(\n                                goog.dom.classlist.get(element),\n                                function(c) { return c != className; })\n                            .join(' ');\n  }\n};\n\n\n/**\n * Removes a set of classes from an element.  Prefer this call to\n * repeatedly calling `goog.dom.classlist.remove` if you want to remove\n * a large set of class names at once.\n * @param {Element} element The element from which to remove classes.\n * @param {IArrayLike<string>} classesToRemove An array-like object\n * containing a collection of class names to remove from the element.\n * This method may throw a DOM exception if classesToRemove contains invalid\n * or empty class names.\n */\ngoog.dom.classlist.removeAll = function(element, classesToRemove) {\n  if (goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST || element.classList) {\n    goog.array.forEach(classesToRemove, function(className) {\n      goog.dom.classlist.remove(element, className);\n    });\n    return;\n  }\n  // Filter out those classes in classesToRemove.\n  element.className =\n      goog.array\n          .filter(\n              goog.dom.classlist.get(element),\n              function(className) {\n                // If this class is not one we are trying to remove,\n                // add it to the array of new class names.\n                return !goog.array.contains(classesToRemove, className);\n              })\n          .join(' ');\n};\n\n\n/**\n * Adds or removes a class depending on the enabled argument.  This method\n * may throw a DOM exception for an invalid or empty class name if DOMTokenList\n * is used.\n * @param {Element} element DOM node to add or remove the class on.\n * @param {string} className Class name to add or remove.\n * @param {boolean} enabled Whether to add or remove the class (true adds,\n *     false removes).\n */\ngoog.dom.classlist.enable = function(element, className, enabled) {\n  if (enabled) {\n    goog.dom.classlist.add(element, className);\n  } else {\n    goog.dom.classlist.remove(element, className);\n  }\n};\n\n\n/**\n * Adds or removes a set of classes depending on the enabled argument.  This\n * method may throw a DOM exception for an invalid or empty class name if\n * DOMTokenList is used.\n * @param {!Element} element DOM node to add or remove the class on.\n * @param {?IArrayLike<string>} classesToEnable An array-like object\n *     containing a collection of class names to add or remove from the element.\n * @param {boolean} enabled Whether to add or remove the classes (true adds,\n *     false removes).\n */\ngoog.dom.classlist.enableAll = function(element, classesToEnable, enabled) {\n  var f = enabled ? goog.dom.classlist.addAll : goog.dom.classlist.removeAll;\n  f(element, classesToEnable);\n};\n\n\n/**\n * Switches a class on an element from one to another without disturbing other\n * classes. If the fromClass isn't removed, the toClass won't be added.  This\n * method may throw a DOM exception if the class names are empty or invalid.\n * @param {Element} element DOM node to swap classes on.\n * @param {string} fromClass Class to remove.\n * @param {string} toClass Class to add.\n * @return {boolean} Whether classes were switched.\n */\ngoog.dom.classlist.swap = function(element, fromClass, toClass) {\n  if (goog.dom.classlist.contains(element, fromClass)) {\n    goog.dom.classlist.remove(element, fromClass);\n    goog.dom.classlist.add(element, toClass);\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * Removes a class if an element has it, and adds it the element doesn't have\n * it.  Won't affect other classes on the node.  This method may throw a DOM\n * exception if the class name is empty or invalid.\n * @param {Element} element DOM node to toggle class on.\n * @param {string} className Class to toggle.\n * @return {boolean} True if class was added, false if it was removed\n *     (in other words, whether element has the class after this function has\n *     been called).\n */\ngoog.dom.classlist.toggle = function(element, className) {\n  var add = !goog.dom.classlist.contains(element, className);\n  goog.dom.classlist.enable(element, className, add);\n  return add;\n};\n\n\n/**\n * Adds and removes a class of an element.  Unlike\n * {@link goog.dom.classlist.swap}, this method adds the classToAdd regardless\n * of whether the classToRemove was present and had been removed.  This method\n * may throw a DOM exception if the class names are empty or invalid.\n *\n * @param {Element} element DOM node to swap classes on.\n * @param {string} classToRemove Class to remove.\n * @param {string} classToAdd Class to add.\n */\ngoog.dom.classlist.addRemove = function(element, classToRemove, classToAdd) {\n  goog.dom.classlist.remove(element, classToRemove);\n  goog.dom.classlist.add(element, classToAdd);\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Constant declarations for common key codes.\n *\n * @author eae@google.com (Emil A Eklund)\n * @see ../demos/keyhandler.html\n */\n\ngoog.provide('goog.events.KeyCodes');\n\ngoog.require('goog.userAgent');\n\ngoog.forwardDeclare('goog.events.BrowserEvent');\n\n\n/**\n * Key codes for common characters.\n *\n * This list is not localized and therefore some of the key codes are not\n * correct for non US keyboard layouts. See comments below.\n *\n * @enum {number}\n */\ngoog.events.KeyCodes = {\n  WIN_KEY_FF_LINUX: 0,\n  MAC_ENTER: 3,\n  BACKSPACE: 8,\n  TAB: 9,\n  NUM_CENTER: 12,  // NUMLOCK on FF/Safari Mac\n  ENTER: 13,\n  SHIFT: 16,\n  CTRL: 17,\n  ALT: 18,\n  PAUSE: 19,\n  CAPS_LOCK: 20,\n  ESC: 27,\n  SPACE: 32,\n  PAGE_UP: 33,    // also NUM_NORTH_EAST\n  PAGE_DOWN: 34,  // also NUM_SOUTH_EAST\n  END: 35,        // also NUM_SOUTH_WEST\n  HOME: 36,       // also NUM_NORTH_WEST\n  LEFT: 37,       // also NUM_WEST\n  UP: 38,         // also NUM_NORTH\n  RIGHT: 39,      // also NUM_EAST\n  DOWN: 40,       // also NUM_SOUTH\n  PLUS_SIGN: 43,  // NOT numpad plus\n  PRINT_SCREEN: 44,\n  INSERT: 45,  // also NUM_INSERT\n  DELETE: 46,  // also NUM_DELETE\n  ZERO: 48,\n  ONE: 49,\n  TWO: 50,\n  THREE: 51,\n  FOUR: 52,\n  FIVE: 53,\n  SIX: 54,\n  SEVEN: 55,\n  EIGHT: 56,\n  NINE: 57,\n  FF_SEMICOLON: 59,   // Firefox (Gecko) fires this for semicolon instead of 186\n  FF_EQUALS: 61,      // Firefox (Gecko) fires this for equals instead of 187\n  FF_DASH: 173,       // Firefox (Gecko) fires this for dash instead of 189\n  QUESTION_MARK: 63,  // needs localization\n  AT_SIGN: 64,\n  A: 65,\n  B: 66,\n  C: 67,\n  D: 68,\n  E: 69,\n  F: 70,\n  G: 71,\n  H: 72,\n  I: 73,\n  J: 74,\n  K: 75,\n  L: 76,\n  M: 77,\n  N: 78,\n  O: 79,\n  P: 80,\n  Q: 81,\n  R: 82,\n  S: 83,\n  T: 84,\n  U: 85,\n  V: 86,\n  W: 87,\n  X: 88,\n  Y: 89,\n  Z: 90,\n  META: 91,  // WIN_KEY_LEFT\n  WIN_KEY_RIGHT: 92,\n  CONTEXT_MENU: 93,\n  NUM_ZERO: 96,\n  NUM_ONE: 97,\n  NUM_TWO: 98,\n  NUM_THREE: 99,\n  NUM_FOUR: 100,\n  NUM_FIVE: 101,\n  NUM_SIX: 102,\n  NUM_SEVEN: 103,\n  NUM_EIGHT: 104,\n  NUM_NINE: 105,\n  NUM_MULTIPLY: 106,\n  NUM_PLUS: 107,\n  NUM_MINUS: 109,\n  NUM_PERIOD: 110,\n  NUM_DIVISION: 111,\n  F1: 112,\n  F2: 113,\n  F3: 114,\n  F4: 115,\n  F5: 116,\n  F6: 117,\n  F7: 118,\n  F8: 119,\n  F9: 120,\n  F10: 121,\n  F11: 122,\n  F12: 123,\n  NUMLOCK: 144,\n  SCROLL_LOCK: 145,\n\n  // OS-specific media keys like volume controls and browser controls.\n  FIRST_MEDIA_KEY: 166,\n  LAST_MEDIA_KEY: 183,\n\n  SEMICOLON: 186,             // needs localization\n  DASH: 189,                  // needs localization\n  EQUALS: 187,                // needs localization\n  COMMA: 188,                 // needs localization\n  PERIOD: 190,                // needs localization\n  SLASH: 191,                 // needs localization\n  APOSTROPHE: 192,            // needs localization\n  TILDE: 192,                 // needs localization\n  SINGLE_QUOTE: 222,          // needs localization\n  OPEN_SQUARE_BRACKET: 219,   // needs localization\n  BACKSLASH: 220,             // needs localization\n  CLOSE_SQUARE_BRACKET: 221,  // needs localization\n  WIN_KEY: 224,\n  MAC_FF_META:\n      224,  // Firefox (Gecko) fires this for the meta key instead of 91\n  MAC_WK_CMD_LEFT: 91,   // WebKit Left Command key fired, same as META\n  MAC_WK_CMD_RIGHT: 93,  // WebKit Right Command key fired, different from META\n  WIN_IME: 229,\n\n  // \"Reserved for future use\". Some programs (e.g. the SlingPlayer 2.4 ActiveX\n  // control) fire this as a hacky way to disable screensavers.\n  VK_NONAME: 252,\n\n  // We've seen users whose machines fire this keycode at regular one\n  // second intervals. The common thread among these users is that\n  // they're all using Dell Inspiron laptops, so we suspect that this\n  // indicates a hardware/bios problem.\n  // http://en.community.dell.com/support-forums/laptop/f/3518/p/19285957/19523128.aspx\n  PHANTOM: 255\n};\n\n\n/**\n * Returns false if the event does not contain a text modifying key.\n *\n * When it returns true, the event might be text modifying. It is infeasible to\n * say for sure because of the many different keyboard layouts, so this method\n * errs on the side of assuming a key event is text-modifiable if we cannot be\n * certain it is not. As an example, it will return true for ctrl+a, though in\n * many standard keyboard layouts that key combination would mean \"select all\",\n * and not actually modify the text.\n *\n * @param {goog.events.BrowserEvent} e A key event.\n * @return {boolean} Whether it's a text modifying key.\n */\ngoog.events.KeyCodes.isTextModifyingKeyEvent = function(e) {\n  if (e.altKey && !e.ctrlKey || e.metaKey ||\n      // Function keys don't generate text\n      e.keyCode >= goog.events.KeyCodes.F1 &&\n          e.keyCode <= goog.events.KeyCodes.F12) {\n    return false;\n  }\n\n  // The following keys are quite harmless, even in combination with\n  // CTRL, ALT or SHIFT.\n  switch (e.keyCode) {\n    case goog.events.KeyCodes.ALT:\n    case goog.events.KeyCodes.CAPS_LOCK:\n    case goog.events.KeyCodes.CONTEXT_MENU:\n    case goog.events.KeyCodes.CTRL:\n    case goog.events.KeyCodes.DOWN:\n    case goog.events.KeyCodes.END:\n    case goog.events.KeyCodes.ESC:\n    case goog.events.KeyCodes.HOME:\n    case goog.events.KeyCodes.INSERT:\n    case goog.events.KeyCodes.LEFT:\n    case goog.events.KeyCodes.MAC_FF_META:\n    case goog.events.KeyCodes.META:\n    case goog.events.KeyCodes.NUMLOCK:\n    case goog.events.KeyCodes.NUM_CENTER:\n    case goog.events.KeyCodes.PAGE_DOWN:\n    case goog.events.KeyCodes.PAGE_UP:\n    case goog.events.KeyCodes.PAUSE:\n    case goog.events.KeyCodes.PHANTOM:\n    case goog.events.KeyCodes.PRINT_SCREEN:\n    case goog.events.KeyCodes.RIGHT:\n    case goog.events.KeyCodes.SCROLL_LOCK:\n    case goog.events.KeyCodes.SHIFT:\n    case goog.events.KeyCodes.UP:\n    case goog.events.KeyCodes.VK_NONAME:\n    case goog.events.KeyCodes.WIN_KEY:\n    case goog.events.KeyCodes.WIN_KEY_RIGHT:\n      return false;\n    case goog.events.KeyCodes.WIN_KEY_FF_LINUX:\n      return !goog.userAgent.GECKO;\n    default:\n      return e.keyCode < goog.events.KeyCodes.FIRST_MEDIA_KEY ||\n          e.keyCode > goog.events.KeyCodes.LAST_MEDIA_KEY;\n  }\n};\n\n\n/**\n * Returns true if the key fires a keypress event in the current browser.\n *\n * Accoridng to MSDN [1] IE only fires keypress events for the following keys:\n * - Letters: A - Z (uppercase and lowercase)\n * - Numerals: 0 - 9\n * - Symbols: ! @ # $ % ^ & * ( ) _ - + = < [ ] { } , . / ? \\ | ' ` \" ~\n * - System: ESC, SPACEBAR, ENTER\n *\n * That's not entirely correct though, for instance there's no distinction\n * between upper and lower case letters.\n *\n * [1] http://msdn2.microsoft.com/en-us/library/ms536939(VS.85).aspx)\n *\n * Safari is similar to IE, but does not fire keypress for ESC.\n *\n * Additionally, IE6 does not fire keydown or keypress events for letters when\n * the control or alt keys are held down and the shift key is not. IE7 does\n * fire keydown in these cases, though, but not keypress.\n *\n * @param {number} keyCode A key code.\n * @param {number=} opt_heldKeyCode Key code of a currently-held key.\n * @param {boolean=} opt_shiftKey Whether the shift key is held down.\n * @param {boolean=} opt_ctrlKey Whether the control key is held down.\n * @param {boolean=} opt_altKey Whether the alt key is held down.\n * @param {boolean=} opt_metaKey Whether the meta key is held down.\n * @return {boolean} Whether it's a key that fires a keypress event.\n */\ngoog.events.KeyCodes.firesKeyPressEvent = function(\n    keyCode, opt_heldKeyCode, opt_shiftKey, opt_ctrlKey, opt_altKey,\n    opt_metaKey) {\n  if (goog.userAgent.WEBKIT && !goog.userAgent.isVersionOrHigher('525')) {\n    return true;\n  }\n\n  if (goog.userAgent.MAC && opt_altKey) {\n    return goog.events.KeyCodes.isCharacterKey(keyCode);\n  }\n\n  // Alt but not AltGr which is represented as Alt+Ctrl.\n  if (opt_altKey && !opt_ctrlKey) {\n    return false;\n  }\n\n  // Saves Ctrl or Alt + key for IE and WebKit 525+, which won't fire keypress.\n  // WebKit prior to 525 won't get this far so no need to check the user agent.\n  // Gecko doesn't need to use the held key for modifiers, it just checks the\n  // ctrl/meta/alt/shiftKey fields.\n  if (!goog.userAgent.GECKO) {\n    if (goog.isNumber(opt_heldKeyCode)) {\n      opt_heldKeyCode = goog.events.KeyCodes.normalizeKeyCode(opt_heldKeyCode);\n    }\n    var heldKeyIsModifier = opt_heldKeyCode == goog.events.KeyCodes.CTRL ||\n        opt_heldKeyCode == goog.events.KeyCodes.ALT ||\n        goog.userAgent.MAC && opt_heldKeyCode == goog.events.KeyCodes.META;\n    // The Shift key blocks keypresses on Mac iff accompanied by another\n    // modifier.\n    var modifiedShiftKey = opt_heldKeyCode == goog.events.KeyCodes.SHIFT &&\n        (opt_ctrlKey || opt_metaKey);\n    if ((!opt_shiftKey || goog.userAgent.MAC) && heldKeyIsModifier ||\n        goog.userAgent.MAC && modifiedShiftKey) {\n      return false;\n    }\n  }\n\n  // Some keys with Ctrl/Shift do not issue keypress in WEBKIT.\n  if ((goog.userAgent.WEBKIT || goog.userAgent.EDGE) && opt_ctrlKey &&\n      opt_shiftKey) {\n    switch (keyCode) {\n      case goog.events.KeyCodes.BACKSLASH:\n      case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:\n      case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:\n      case goog.events.KeyCodes.TILDE:\n      case goog.events.KeyCodes.SEMICOLON:\n      case goog.events.KeyCodes.DASH:\n      case goog.events.KeyCodes.EQUALS:\n      case goog.events.KeyCodes.COMMA:\n      case goog.events.KeyCodes.PERIOD:\n      case goog.events.KeyCodes.SLASH:\n      case goog.events.KeyCodes.APOSTROPHE:\n      case goog.events.KeyCodes.SINGLE_QUOTE:\n        return false;\n    }\n  }\n\n  // When Ctrl+<somekey> is held in IE, it only fires a keypress once, but it\n  // continues to fire keydown events as the event repeats.\n  if (goog.userAgent.IE && opt_ctrlKey && opt_heldKeyCode == keyCode) {\n    return false;\n  }\n\n  switch (keyCode) {\n    case goog.events.KeyCodes.ENTER:\n      if (goog.userAgent.GECKO) {\n        // Only Enter, Shift + Enter, Ctrl + Enter causes keypress event on\n        // Firefox.\n        if (opt_metaKey || opt_altKey) {\n          return false;\n        }\n        return !(opt_shiftKey && opt_ctrlKey);\n      } else {\n        return true;\n      }\n    case goog.events.KeyCodes.ESC:\n      return !(\n          goog.userAgent.WEBKIT || goog.userAgent.EDGE || goog.userAgent.GECKO);\n  }\n\n  // Gecko won't fire a keypress event even when the key is a character key if\n  // ctrl, meta or alt are pressed. In all other cases, a keypress event is\n  // only fired when the key is a character.\n  if (goog.userAgent.GECKO && (opt_ctrlKey || opt_altKey || opt_metaKey)) {\n    return false;\n  } else {\n    return goog.events.KeyCodes.isCharacterKey(keyCode);\n  }\n};\n\n\n/**\n * Returns true if the key produces a character.\n * This does not cover characters on non-US keyboards (Russian, Hebrew, etc.).\n *\n * @param {number} keyCode A key code.\n * @return {boolean} Whether it's a character key.\n */\ngoog.events.KeyCodes.isCharacterKey = function(keyCode) {\n  if (keyCode >= goog.events.KeyCodes.ZERO &&\n      keyCode <= goog.events.KeyCodes.NINE) {\n    return true;\n  }\n\n  if (keyCode >= goog.events.KeyCodes.NUM_ZERO &&\n      keyCode <= goog.events.KeyCodes.NUM_MULTIPLY) {\n    return true;\n  }\n\n  if (keyCode >= goog.events.KeyCodes.A && keyCode <= goog.events.KeyCodes.Z) {\n    return true;\n  }\n\n  // Safari sends zero key code for non-latin characters.\n  if ((goog.userAgent.WEBKIT || goog.userAgent.EDGE) && keyCode == 0) {\n    return true;\n  }\n\n  switch (keyCode) {\n    case goog.events.KeyCodes.SPACE:\n    case goog.events.KeyCodes.PLUS_SIGN:\n    case goog.events.KeyCodes.QUESTION_MARK:\n    case goog.events.KeyCodes.AT_SIGN:\n    case goog.events.KeyCodes.NUM_PLUS:\n    case goog.events.KeyCodes.NUM_MINUS:\n    case goog.events.KeyCodes.NUM_PERIOD:\n    case goog.events.KeyCodes.NUM_DIVISION:\n    case goog.events.KeyCodes.SEMICOLON:\n    case goog.events.KeyCodes.FF_SEMICOLON:\n    case goog.events.KeyCodes.DASH:\n    case goog.events.KeyCodes.EQUALS:\n    case goog.events.KeyCodes.FF_EQUALS:\n    case goog.events.KeyCodes.COMMA:\n    case goog.events.KeyCodes.PERIOD:\n    case goog.events.KeyCodes.SLASH:\n    case goog.events.KeyCodes.APOSTROPHE:\n    case goog.events.KeyCodes.SINGLE_QUOTE:\n    case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:\n    case goog.events.KeyCodes.BACKSLASH:\n    case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:\n      return true;\n    default:\n      return false;\n  }\n};\n\n\n/**\n * Normalizes key codes from OS/Browser-specific value to the general one.\n * @param {number} keyCode The native key code.\n * @return {number} The normalized key code.\n */\ngoog.events.KeyCodes.normalizeKeyCode = function(keyCode) {\n  if (goog.userAgent.GECKO) {\n    return goog.events.KeyCodes.normalizeGeckoKeyCode(keyCode);\n  } else if (goog.userAgent.MAC && goog.userAgent.WEBKIT) {\n    return goog.events.KeyCodes.normalizeMacWebKitKeyCode(keyCode);\n  } else {\n    return keyCode;\n  }\n};\n\n\n/**\n * Normalizes key codes from their Gecko-specific value to the general one.\n * @param {number} keyCode The native key code.\n * @return {number} The normalized key code.\n */\ngoog.events.KeyCodes.normalizeGeckoKeyCode = function(keyCode) {\n  switch (keyCode) {\n    case goog.events.KeyCodes.FF_EQUALS:\n      return goog.events.KeyCodes.EQUALS;\n    case goog.events.KeyCodes.FF_SEMICOLON:\n      return goog.events.KeyCodes.SEMICOLON;\n    case goog.events.KeyCodes.FF_DASH:\n      return goog.events.KeyCodes.DASH;\n    case goog.events.KeyCodes.MAC_FF_META:\n      return goog.events.KeyCodes.META;\n    case goog.events.KeyCodes.WIN_KEY_FF_LINUX:\n      return goog.events.KeyCodes.WIN_KEY;\n    default:\n      return keyCode;\n  }\n};\n\n\n/**\n * Normalizes key codes from their Mac WebKit-specific value to the general one.\n * @param {number} keyCode The native key code.\n * @return {number} The normalized key code.\n */\ngoog.events.KeyCodes.normalizeMacWebKitKeyCode = function(keyCode) {\n  switch (keyCode) {\n    case goog.events.KeyCodes.MAC_WK_CMD_RIGHT:  // 93\n      return goog.events.KeyCodes.META;          // 91\n    default:\n      return keyCode;\n  }\n};\n","// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview This file contains a class for working with keyboard events\n * that repeat consistently across browsers and platforms. It also unifies the\n * key code so that it is the same in all browsers and platforms.\n *\n * Different web browsers have very different keyboard event handling. Most\n * importantly is that only certain browsers repeat keydown events:\n * IE, Opera, FF/Win32, and Safari 3 repeat keydown events.\n * FF/Mac and Safari 2 do not.\n *\n * For the purposes of this code, \"Safari 3\" means WebKit 525+, when WebKit\n * decided that they should try to match IE's key handling behavior.\n * Safari 3.0.4, which shipped with Leopard (WebKit 523), has the\n * Safari 2 behavior.\n *\n * Firefox, Safari, Opera prevent on keypress\n *\n * IE prevents on keydown\n *\n * Firefox does not fire keypress for shift, ctrl, alt\n * Firefox does fire keydown for shift, ctrl, alt, meta\n * Firefox does not repeat keydown for shift, ctrl, alt, meta\n *\n * Firefox does not fire keypress for up and down in an input\n *\n * Opera fires keypress for shift, ctrl, alt, meta\n * Opera does not repeat keypress for shift, ctrl, alt, meta\n *\n * Safari 2 and 3 do not fire keypress for shift, ctrl, alt\n * Safari 2 does not fire keydown for shift, ctrl, alt\n * Safari 3 *does* fire keydown for shift, ctrl, alt\n *\n * IE provides the keycode for keyup/down events and the charcode (in the\n * keycode field) for keypress.\n *\n * Mozilla provides the keycode for keyup/down and the charcode for keypress\n * unless it's a non text modifying key in which case the keycode is provided.\n *\n * Safari 3 provides the keycode and charcode for all events.\n *\n * Opera provides the keycode for keyup/down event and either the charcode or\n * the keycode (in the keycode field) for keypress events.\n *\n * Firefox x11 doesn't fire keydown events if a another key is already held down\n * until the first key is released. This can cause a key event to be fired with\n * a keyCode for the first key and a charCode for the second key.\n *\n * Safari in keypress\n *\n *        charCode keyCode which\n * ENTER:       13      13    13\n * F1:       63236   63236 63236\n * F8:       63243   63243 63243\n * ...\n * p:          112     112   112\n * P:           80      80    80\n *\n * Firefox, keypress:\n *\n *        charCode keyCode which\n * ENTER:        0      13    13\n * F1:           0     112     0\n * F8:           0     119     0\n * ...\n * p:          112       0   112\n * P:           80       0    80\n *\n * Opera, Mac+Win32, keypress:\n *\n *         charCode keyCode which\n * ENTER: undefined      13    13\n * F1:    undefined     112     0\n * F8:    undefined     119     0\n * ...\n * p:     undefined     112   112\n * P:     undefined      80    80\n *\n * IE7, keydown\n *\n *         charCode keyCode     which\n * ENTER: undefined      13 undefined\n * F1:    undefined     112 undefined\n * F8:    undefined     119 undefined\n * ...\n * p:     undefined      80 undefined\n * P:     undefined      80 undefined\n *\n * @author arv@google.com (Erik Arvidsson)\n * @author eae@google.com (Emil A Eklund)\n * @see ../demos/keyhandler.html\n */\n\ngoog.provide('goog.events.KeyEvent');\ngoog.provide('goog.events.KeyHandler');\ngoog.provide('goog.events.KeyHandler.EventType');\n\ngoog.require('goog.events');\ngoog.require('goog.events.BrowserEvent');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.events.EventType');\ngoog.require('goog.events.KeyCodes');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * A wrapper around an element that you want to listen to keyboard events on.\n * @param {Element|Document=} opt_element The element or document to listen on.\n * @param {boolean=} opt_capture Whether to listen for browser events in\n *     capture phase (defaults to false).\n * @constructor\n * @extends {goog.events.EventTarget}\n * @final\n */\ngoog.events.KeyHandler = function(opt_element, opt_capture) {\n  goog.events.EventTarget.call(this);\n\n  if (opt_element) {\n    this.attach(opt_element, opt_capture);\n  }\n};\ngoog.inherits(goog.events.KeyHandler, goog.events.EventTarget);\n\n\n/**\n * This is the element that we will listen to the real keyboard events on.\n * @type {Element|Document|null}\n * @private\n */\ngoog.events.KeyHandler.prototype.element_ = null;\n\n\n/**\n * The key for the key press listener.\n * @type {goog.events.Key}\n * @private\n */\ngoog.events.KeyHandler.prototype.keyPressKey_ = null;\n\n\n/**\n * The key for the key down listener.\n * @type {goog.events.Key}\n * @private\n */\ngoog.events.KeyHandler.prototype.keyDownKey_ = null;\n\n\n/**\n * The key for the key up listener.\n * @type {goog.events.Key}\n * @private\n */\ngoog.events.KeyHandler.prototype.keyUpKey_ = null;\n\n\n/**\n * Used to detect keyboard repeat events.\n * @private\n * @type {number}\n */\ngoog.events.KeyHandler.prototype.lastKey_ = -1;\n\n\n/**\n * Keycode recorded for key down events. As most browsers don't report the\n * keycode in the key press event we need to record it in the key down phase.\n * @private\n * @type {number}\n */\ngoog.events.KeyHandler.prototype.keyCode_ = -1;\n\n\n/**\n * Alt key recorded for key down events. FF on Mac does not report the alt key\n * flag in the key press event, we need to record it in the key down phase.\n * @type {boolean}\n * @private\n */\ngoog.events.KeyHandler.prototype.altKey_ = false;\n\n\n/**\n * Enum type for the events fired by the key handler\n * @enum {string}\n */\ngoog.events.KeyHandler.EventType = {\n  KEY: 'key'\n};\n\n\n/**\n * An enumeration of key codes that Safari 2 does incorrectly\n * @type {Object}\n * @private\n */\ngoog.events.KeyHandler.safariKey_ = {\n  '3': goog.events.KeyCodes.ENTER,             // 13\n  '12': goog.events.KeyCodes.NUMLOCK,          // 144\n  '63232': goog.events.KeyCodes.UP,            // 38\n  '63233': goog.events.KeyCodes.DOWN,          // 40\n  '63234': goog.events.KeyCodes.LEFT,          // 37\n  '63235': goog.events.KeyCodes.RIGHT,         // 39\n  '63236': goog.events.KeyCodes.F1,            // 112\n  '63237': goog.events.KeyCodes.F2,            // 113\n  '63238': goog.events.KeyCodes.F3,            // 114\n  '63239': goog.events.KeyCodes.F4,            // 115\n  '63240': goog.events.KeyCodes.F5,            // 116\n  '63241': goog.events.KeyCodes.F6,            // 117\n  '63242': goog.events.KeyCodes.F7,            // 118\n  '63243': goog.events.KeyCodes.F8,            // 119\n  '63244': goog.events.KeyCodes.F9,            // 120\n  '63245': goog.events.KeyCodes.F10,           // 121\n  '63246': goog.events.KeyCodes.F11,           // 122\n  '63247': goog.events.KeyCodes.F12,           // 123\n  '63248': goog.events.KeyCodes.PRINT_SCREEN,  // 44\n  '63272': goog.events.KeyCodes.DELETE,        // 46\n  '63273': goog.events.KeyCodes.HOME,          // 36\n  '63275': goog.events.KeyCodes.END,           // 35\n  '63276': goog.events.KeyCodes.PAGE_UP,       // 33\n  '63277': goog.events.KeyCodes.PAGE_DOWN,     // 34\n  '63289': goog.events.KeyCodes.NUMLOCK,       // 144\n  '63302': goog.events.KeyCodes.INSERT         // 45\n};\n\n\n/**\n * An enumeration of key identifiers currently part of the W3C draft for DOM3\n * and their mappings to keyCodes.\n * http://www.w3.org/TR/DOM-Level-3-Events/keyset.html#KeySet-Set\n * This is currently supported in Safari and should be platform independent.\n * @type {Object}\n * @private\n */\ngoog.events.KeyHandler.keyIdentifier_ = {\n  'Up': goog.events.KeyCodes.UP,               // 38\n  'Down': goog.events.KeyCodes.DOWN,           // 40\n  'Left': goog.events.KeyCodes.LEFT,           // 37\n  'Right': goog.events.KeyCodes.RIGHT,         // 39\n  'Enter': goog.events.KeyCodes.ENTER,         // 13\n  'F1': goog.events.KeyCodes.F1,               // 112\n  'F2': goog.events.KeyCodes.F2,               // 113\n  'F3': goog.events.KeyCodes.F3,               // 114\n  'F4': goog.events.KeyCodes.F4,               // 115\n  'F5': goog.events.KeyCodes.F5,               // 116\n  'F6': goog.events.KeyCodes.F6,               // 117\n  'F7': goog.events.KeyCodes.F7,               // 118\n  'F8': goog.events.KeyCodes.F8,               // 119\n  'F9': goog.events.KeyCodes.F9,               // 120\n  'F10': goog.events.KeyCodes.F10,             // 121\n  'F11': goog.events.KeyCodes.F11,             // 122\n  'F12': goog.events.KeyCodes.F12,             // 123\n  'U+007F': goog.events.KeyCodes.DELETE,       // 46\n  'Home': goog.events.KeyCodes.HOME,           // 36\n  'End': goog.events.KeyCodes.END,             // 35\n  'PageUp': goog.events.KeyCodes.PAGE_UP,      // 33\n  'PageDown': goog.events.KeyCodes.PAGE_DOWN,  // 34\n  'Insert': goog.events.KeyCodes.INSERT        // 45\n};\n\n\n/**\n * If true, the KeyEvent fires on keydown. Otherwise, it fires on keypress.\n *\n * @type {boolean}\n * @private\n */\ngoog.events.KeyHandler.USES_KEYDOWN_ =\n    !goog.userAgent.WEBKIT || goog.userAgent.isVersionOrHigher('525');\n\n\n/**\n * If true, the alt key flag is saved during the key down and reused when\n * handling the key press. FF on Mac does not set the alt flag in the key press\n * event.\n * @type {boolean}\n * @private\n */\ngoog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_ =\n    goog.userAgent.MAC && goog.userAgent.GECKO;\n\n\n/**\n * Records the keycode for browsers that only returns the keycode for key up/\n * down events. For browser/key combinations that doesn't trigger a key pressed\n * event it also fires the patched key event.\n * @param {goog.events.BrowserEvent} e The key down event.\n * @private\n */\ngoog.events.KeyHandler.prototype.handleKeyDown_ = function(e) {\n  // Ctrl-Tab and Alt-Tab can cause the focus to be moved to another window\n  // before we've caught a key-up event.  If the last-key was one of these we\n  // reset the state.\n  if (goog.userAgent.WEBKIT || goog.userAgent.EDGE) {\n    if (this.lastKey_ == goog.events.KeyCodes.CTRL && !e.ctrlKey ||\n        this.lastKey_ == goog.events.KeyCodes.ALT && !e.altKey ||\n        goog.userAgent.MAC && this.lastKey_ == goog.events.KeyCodes.META &&\n            !e.metaKey) {\n      this.resetState();\n    }\n  }\n\n  if (this.lastKey_ == -1) {\n    if (e.ctrlKey && e.keyCode != goog.events.KeyCodes.CTRL) {\n      this.lastKey_ = goog.events.KeyCodes.CTRL;\n    } else if (e.altKey && e.keyCode != goog.events.KeyCodes.ALT) {\n      this.lastKey_ = goog.events.KeyCodes.ALT;\n    } else if (e.metaKey && e.keyCode != goog.events.KeyCodes.META) {\n      this.lastKey_ = goog.events.KeyCodes.META;\n    }\n  }\n\n  if (goog.events.KeyHandler.USES_KEYDOWN_ &&\n      !goog.events.KeyCodes.firesKeyPressEvent(\n          e.keyCode, this.lastKey_, e.shiftKey, e.ctrlKey, e.altKey,\n          e.metaKey)) {\n    this.handleEvent(e);\n  } else {\n    this.keyCode_ = goog.events.KeyCodes.normalizeKeyCode(e.keyCode);\n    if (goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_) {\n      this.altKey_ = e.altKey;\n    }\n  }\n};\n\n\n/**\n * Resets the stored previous values. Needed to be called for webkit which will\n * not generate a key up for meta key operations. This should only be called\n * when having finished with repeat key possibilities.\n */\ngoog.events.KeyHandler.prototype.resetState = function() {\n  this.lastKey_ = -1;\n  this.keyCode_ = -1;\n};\n\n\n/**\n * Clears the stored previous key value, resetting the key repeat status. Uses\n * -1 because the Safari 3 Windows beta reports 0 for certain keys (like Home\n * and End.)\n * @param {goog.events.BrowserEvent} e The keyup event.\n * @private\n */\ngoog.events.KeyHandler.prototype.handleKeyup_ = function(e) {\n  this.resetState();\n  this.altKey_ = e.altKey;\n};\n\n\n/**\n * Handles the events on the element.\n * @param {goog.events.BrowserEvent} e  The keyboard event sent from the\n *     browser.\n */\ngoog.events.KeyHandler.prototype.handleEvent = function(e) {\n  var be = e.getBrowserEvent();\n  var keyCode, charCode;\n  var altKey = be.altKey;\n\n  // IE reports the character code in the keyCode field for keypress events.\n  // There are two exceptions however, Enter and Escape.\n  if (goog.userAgent.IE && e.type == goog.events.EventType.KEYPRESS) {\n    keyCode = this.keyCode_;\n    charCode = keyCode != goog.events.KeyCodes.ENTER &&\n            keyCode != goog.events.KeyCodes.ESC ?\n        be.keyCode :\n        0;\n\n    // Safari reports the character code in the keyCode field for keypress\n    // events but also has a charCode field.\n  } else if (\n      (goog.userAgent.WEBKIT || goog.userAgent.EDGE) &&\n      e.type == goog.events.EventType.KEYPRESS) {\n    keyCode = this.keyCode_;\n    charCode = be.charCode >= 0 && be.charCode < 63232 &&\n            goog.events.KeyCodes.isCharacterKey(keyCode) ?\n        be.charCode :\n        0;\n\n    // Opera reports the keycode or the character code in the keyCode field.\n  } else if (goog.userAgent.OPERA && !goog.userAgent.WEBKIT) {\n    keyCode = this.keyCode_;\n    charCode = goog.events.KeyCodes.isCharacterKey(keyCode) ? be.keyCode : 0;\n\n    // Mozilla reports the character code in the charCode field.\n  } else {\n    keyCode = be.keyCode || this.keyCode_;\n    charCode = be.charCode || 0;\n    if (goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_ &&\n        e.type == goog.events.EventType.KEYPRESS) {\n      altKey = this.altKey_;\n    }\n    // On the Mac, shift-/ triggers a question mark char code and no key code\n    // (WIN_KEY_FF_LINUX), so we synthesize the latter.\n    if (goog.userAgent.MAC && charCode == goog.events.KeyCodes.QUESTION_MARK &&\n        keyCode == goog.events.KeyCodes.WIN_KEY) {\n      keyCode = goog.events.KeyCodes.SLASH;\n    }\n  }\n\n  keyCode = goog.events.KeyCodes.normalizeKeyCode(keyCode);\n  var key = keyCode;\n\n  // Correct the key value for certain browser-specific quirks.\n  if (keyCode) {\n    if (keyCode >= 63232 && keyCode in goog.events.KeyHandler.safariKey_) {\n      // NOTE(nicksantos): Safari 3 has fixed this problem,\n      // this is only needed for Safari 2.\n      key = goog.events.KeyHandler.safariKey_[keyCode];\n    } else {\n      // Safari returns 25 for Shift+Tab instead of 9.\n      if (keyCode == 25 && e.shiftKey) {\n        key = 9;\n      }\n    }\n  } else if (\n      be.keyIdentifier &&\n      be.keyIdentifier in goog.events.KeyHandler.keyIdentifier_) {\n    // This is needed for Safari Windows because it currently doesn't give a\n    // keyCode/which for non printable keys.\n    key = goog.events.KeyHandler.keyIdentifier_[be.keyIdentifier];\n  }\n\n  // If this was a redundant keypress event, we ignore it to avoid double-firing\n  // an event as the event would've been handled by KEYDOWN. Gecko is currently\n  // in the process of removing keypress events for non-printable characters\n  // (https://bugzilla.mozilla.org/show_bug.cgi?id=968056) so we simulate this\n  // logic here for older Gecko versions which still fire the events.\n  if (goog.userAgent.GECKO && goog.events.KeyHandler.USES_KEYDOWN_ &&\n      e.type == goog.events.EventType.KEYPRESS &&\n      !goog.events.KeyCodes.firesKeyPressEvent(\n          key, this.lastKey_, e.shiftKey, e.ctrlKey, altKey, e.metaKey)) {\n    return;\n  }\n\n  // If we get the same keycode as a keydown/keypress without having seen a\n  // keyup event, then this event was caused by key repeat.\n  var repeat = key == this.lastKey_;\n  this.lastKey_ = key;\n\n  var event = new goog.events.KeyEvent(key, charCode, repeat, be);\n  event.altKey = altKey;\n  this.dispatchEvent(event);\n};\n\n\n/**\n * Returns the element listened on for the real keyboard events.\n * @return {Element|Document|null} The element listened on for the real\n *     keyboard events.\n */\ngoog.events.KeyHandler.prototype.getElement = function() {\n  return this.element_;\n};\n\n\n/**\n * Adds the proper key event listeners to the element.\n * @param {Element|Document} element The element to listen on.\n * @param {boolean=} opt_capture Whether to listen for browser events in\n *     capture phase (defaults to false).\n */\ngoog.events.KeyHandler.prototype.attach = function(element, opt_capture) {\n  if (this.keyUpKey_) {\n    this.detach();\n  }\n\n  this.element_ = element;\n\n  this.keyPressKey_ = goog.events.listen(\n      this.element_, goog.events.EventType.KEYPRESS, this, opt_capture);\n\n  // Most browsers (Safari 2 being the notable exception) doesn't include the\n  // keyCode in keypress events (IE has the char code in the keyCode field and\n  // Mozilla only included the keyCode if there's no charCode). Thus we have to\n  // listen for keydown to capture the keycode.\n  this.keyDownKey_ = goog.events.listen(\n      this.element_, goog.events.EventType.KEYDOWN, this.handleKeyDown_,\n      opt_capture, this);\n\n\n  this.keyUpKey_ = goog.events.listen(\n      this.element_, goog.events.EventType.KEYUP, this.handleKeyup_,\n      opt_capture, this);\n};\n\n\n/**\n * Removes the listeners that may exist.\n */\ngoog.events.KeyHandler.prototype.detach = function() {\n  if (this.keyPressKey_) {\n    goog.events.unlistenByKey(this.keyPressKey_);\n    goog.events.unlistenByKey(this.keyDownKey_);\n    goog.events.unlistenByKey(this.keyUpKey_);\n    this.keyPressKey_ = null;\n    this.keyDownKey_ = null;\n    this.keyUpKey_ = null;\n  }\n  this.element_ = null;\n  this.lastKey_ = -1;\n  this.keyCode_ = -1;\n};\n\n\n/** @override */\ngoog.events.KeyHandler.prototype.disposeInternal = function() {\n  goog.events.KeyHandler.superClass_.disposeInternal.call(this);\n  this.detach();\n};\n\n\n\n/**\n * This class is used for the goog.events.KeyHandler.EventType.KEY event and\n * it overrides the key code with the fixed key code.\n * @param {number} keyCode The adjusted key code.\n * @param {number} charCode The unicode character code.\n * @param {boolean} repeat Whether this event was generated by keyboard repeat.\n * @param {Event} browserEvent Browser event object.\n * @constructor\n * @extends {goog.events.BrowserEvent}\n * @final\n */\ngoog.events.KeyEvent = function(keyCode, charCode, repeat, browserEvent) {\n  goog.events.BrowserEvent.call(this, browserEvent);\n  this.type = goog.events.KeyHandler.EventType.KEY;\n\n  /**\n   * Keycode of key press.\n   * @type {number}\n   */\n  this.keyCode = keyCode;\n\n  /**\n   * Unicode character code.\n   * @type {number}\n   */\n  this.charCode = charCode;\n\n  /**\n   * True if this event was generated by keyboard auto-repeat (i.e., the user is\n   * holding the key down.)\n   * @type {boolean}\n   */\n  this.repeat = repeat;\n};\ngoog.inherits(goog.events.KeyEvent, goog.events.BrowserEvent);\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Zippy widget implementation.\n *\n * @author eae@google.com (Emil A Eklund)\n * @see ../demos/zippy.html\n */\n\ngoog.provide('goog.ui.Zippy');\ngoog.provide('goog.ui.Zippy.Events');\ngoog.provide('goog.ui.ZippyEvent');\n\ngoog.require('goog.a11y.aria');\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.a11y.aria.State');\ngoog.require('goog.dom');\ngoog.require('goog.dom.classlist');\ngoog.require('goog.events.Event');\ngoog.require('goog.events.EventHandler');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.events.EventType');\ngoog.require('goog.events.KeyCodes');\ngoog.require('goog.events.KeyHandler');\ngoog.require('goog.style');\n\n\n\n/**\n * Zippy widget. Expandable/collapsible container, clicking the header toggles\n * the visibility of the content.\n *\n * @extends {goog.events.EventTarget}\n * @param {Element|string|null} header Header element, either element\n *     reference, string id or null if no header exists.\n * @param {Element|string|function():Element=} opt_content Content element\n *     (if any), either element reference or string id.  If skipped, the caller\n *     should handle the TOGGLE event in its own way. If a function is passed,\n *     then if will be called to create the content element the first time the\n *     zippy is expanded.\n * @param {boolean=} opt_expanded Initial expanded/visibility state. If\n *     undefined, attempts to infer the state from the DOM. Setting visibility\n *     using one of the standard Soy templates guarantees correct inference.\n * @param {Element|string=} opt_expandedHeader Element to use as the header when\n *     the zippy is expanded.\n * @param {goog.dom.DomHelper=} opt_domHelper An optional DOM helper.\n * @param {goog.a11y.aria.Role<string>=} opt_role ARIA role, default TAB.\n * @constructor\n */\ngoog.ui.Zippy = function(\n    header, opt_content, opt_expanded, opt_expandedHeader, opt_domHelper,\n    opt_role) {\n  goog.ui.Zippy.base(this, 'constructor');\n\n  /**\n   * DomHelper used to interact with the document, allowing components to be\n   * created in a different window.\n   * @type {!goog.dom.DomHelper}\n   * @private\n   */\n  this.dom_ = opt_domHelper || goog.dom.getDomHelper();\n\n  /**\n   * Header element or null if no header exists.\n   * @type {Element}\n   * @private\n   */\n  this.elHeader_ = this.dom_.getElement(header) || null;\n\n  /**\n   * When present, the header to use when the zippy is expanded.\n   * @type {Element}\n   * @private\n   */\n  this.elExpandedHeader_ = this.dom_.getElement(opt_expandedHeader || null);\n\n  /**\n   * Function that will create the content element, or false if there is no such\n   * function.\n   * @type {?function():Element}\n   * @private\n   */\n  this.lazyCreateFunc_ = goog.isFunction(opt_content) ? opt_content : null;\n\n  /**\n   * ARIA role.\n   * @type {goog.a11y.aria.Role<string>}\n   * @private\n   */\n  this.role_ = opt_role || goog.a11y.aria.Role.TAB;\n\n  /**\n   * Content element.\n   * @type {Element}\n   * @private\n   */\n  this.elContent_ = this.lazyCreateFunc_ || !opt_content ?\n      null :\n      this.dom_.getElement(/** @type {!Element} */ (opt_content));\n\n  /**\n   * Expanded state.\n   * @type {boolean}\n   * @private\n   */\n  this.expanded_ = opt_expanded == true;\n  if (!goog.isDef(opt_expanded) && !this.lazyCreateFunc_) {\n    // For the dual caption case, we can get expanded_ from the visibility of\n    // the expandedHeader. For the single-caption case, we use the\n    // presence/absence of the relevant class. Using one of the standard Soy\n    // templates guarantees that this will work.\n    if (this.elExpandedHeader_) {\n      this.expanded_ = goog.style.isElementShown(this.elExpandedHeader_);\n    } else if (this.elHeader_) {\n      this.expanded_ = goog.dom.classlist.contains(\n          this.elHeader_, goog.getCssName('goog-zippy-expanded'));\n    }\n  }\n\n\n  /**\n   * A keyboard events handler. If there are two headers it is shared for both.\n   * @type {goog.events.EventHandler<!goog.ui.Zippy>}\n   * @private\n   */\n  this.keyboardEventHandler_ = new goog.events.EventHandler(this);\n\n  /**\n   * The keyhandler used for listening on most key events. This takes care of\n   * abstracting away some of the browser differences.\n   * @private {!goog.events.KeyHandler}\n   */\n  this.keyHandler_ = new goog.events.KeyHandler();\n\n  /**\n   * A mouse events handler. If there are two headers it is shared for both.\n   * @type {goog.events.EventHandler<!goog.ui.Zippy>}\n   * @private\n   */\n  this.mouseEventHandler_ = new goog.events.EventHandler(this);\n\n  var self = this;\n  function addHeaderEvents(el) {\n    if (el) {\n      el.tabIndex = 0;\n      goog.a11y.aria.setRole(el, self.getAriaRole());\n      goog.dom.classlist.add(el, goog.getCssName('goog-zippy-header'));\n      self.enableMouseEventsHandling_(el);\n      self.enableKeyboardEventsHandling_(el);\n    }\n  }\n  addHeaderEvents(this.elHeader_);\n  addHeaderEvents(this.elExpandedHeader_);\n\n  // initialize based on expanded state\n  this.setExpanded(this.expanded_);\n};\ngoog.inherits(goog.ui.Zippy, goog.events.EventTarget);\ngoog.tagUnsealableClass(goog.ui.Zippy);\n\n\n/**\n * Constants for event names\n *\n * @const\n */\ngoog.ui.Zippy.Events = {\n  // Zippy will dispatch an ACTION event for user interaction. Mimics\n  // `goog.ui.Controls#performActionInternal` by first changing\n  // the toggle state and then dispatching an ACTION event.\n  ACTION: 'action',\n  // Zippy state is toggled from collapsed to expanded or vice versa.\n  TOGGLE: 'toggle'\n};\n\n\n/**\n * Whether to listen for and handle mouse events; defaults to true.\n * @type {boolean}\n * @private\n */\ngoog.ui.Zippy.prototype.handleMouseEvents_ = true;\n\n\n/**\n * Whether to listen for and handle key events; defaults to true.\n * @type {boolean}\n * @private\n */\ngoog.ui.Zippy.prototype.handleKeyEvents_ = true;\n\n\n/** @override */\ngoog.ui.Zippy.prototype.disposeInternal = function() {\n  goog.ui.Zippy.base(this, 'disposeInternal');\n  goog.dispose(this.keyboardEventHandler_);\n  goog.dispose(this.keyHandler_);\n  goog.dispose(this.mouseEventHandler_);\n};\n\n\n/**\n * @return {goog.a11y.aria.Role} The ARIA role to be applied to Zippy element.\n */\ngoog.ui.Zippy.prototype.getAriaRole = function() {\n  return this.role_;\n};\n\n\n/**\n * @return {HTMLElement} The content element.\n */\ngoog.ui.Zippy.prototype.getContentElement = function() {\n  return /** @type {!HTMLElement} */ (this.elContent_);\n};\n\n\n/**\n * @return {Element} The visible header element.\n */\ngoog.ui.Zippy.prototype.getVisibleHeaderElement = function() {\n  var expandedHeader = this.elExpandedHeader_;\n  return expandedHeader && goog.style.isElementShown(expandedHeader) ?\n      expandedHeader :\n      this.elHeader_;\n};\n\n\n/**\n * Expands content pane.\n */\ngoog.ui.Zippy.prototype.expand = function() {\n  this.setExpanded(true);\n};\n\n\n/**\n * Collapses content pane.\n */\ngoog.ui.Zippy.prototype.collapse = function() {\n  this.setExpanded(false);\n};\n\n\n/**\n * Toggles expanded state.\n */\ngoog.ui.Zippy.prototype.toggle = function() {\n  this.setExpanded(!this.expanded_);\n};\n\n\n/**\n * Sets expanded state.\n *\n * @param {boolean} expanded Expanded/visibility state.\n */\ngoog.ui.Zippy.prototype.setExpanded = function(expanded) {\n  if (this.elContent_) {\n    // Hide the element, if one is provided.\n    goog.style.setElementShown(this.elContent_, expanded);\n  } else if (expanded && this.lazyCreateFunc_) {\n    // Assume that when the element is not hidden upon creation.\n    this.elContent_ = this.lazyCreateFunc_();\n  }\n  if (this.elContent_) {\n    goog.dom.classlist.add(\n        this.elContent_, goog.getCssName('goog-zippy-content'));\n  }\n\n  if (this.elExpandedHeader_) {\n    // Hide the show header and show the hide one.\n    goog.style.setElementShown(this.elHeader_, !expanded);\n    goog.style.setElementShown(this.elExpandedHeader_, expanded);\n  } else {\n    // Update header image, if any.\n    this.updateHeaderClassName(expanded);\n  }\n\n  this.setExpandedInternal(expanded);\n\n  // Fire toggle event\n  this.dispatchEvent(\n      new goog.ui.ZippyEvent(\n          goog.ui.Zippy.Events.TOGGLE, this, this.expanded_));\n};\n\n\n/**\n * Sets expanded internal state.\n *\n * @param {boolean} expanded Expanded/visibility state.\n * @protected\n */\ngoog.ui.Zippy.prototype.setExpandedInternal = function(expanded) {\n  this.expanded_ = expanded;\n};\n\n\n/**\n * @return {boolean} Whether the zippy is expanded.\n */\ngoog.ui.Zippy.prototype.isExpanded = function() {\n  return this.expanded_;\n};\n\n\n/**\n * Updates the header element's className and ARIA (accessibility) EXPANDED\n * state.\n *\n * @param {boolean} expanded Expanded/visibility state.\n * @protected\n */\ngoog.ui.Zippy.prototype.updateHeaderClassName = function(expanded) {\n  if (this.elHeader_) {\n    goog.dom.classlist.enable(\n        this.elHeader_, goog.getCssName('goog-zippy-expanded'), expanded);\n    goog.dom.classlist.enable(\n        this.elHeader_, goog.getCssName('goog-zippy-collapsed'), !expanded);\n    goog.a11y.aria.setState(\n        this.elHeader_, goog.a11y.aria.State.EXPANDED, expanded);\n  }\n};\n\n\n/**\n * @return {boolean} Whether the Zippy handles its own key events.\n */\ngoog.ui.Zippy.prototype.isHandleKeyEvents = function() {\n  return this.handleKeyEvents_;\n};\n\n\n/**\n * @return {boolean} Whether the Zippy handles its own mouse events.\n */\ngoog.ui.Zippy.prototype.isHandleMouseEvents = function() {\n  return this.handleMouseEvents_;\n};\n\n\n/**\n * Sets whether the Zippy handles it's own keyboard events.\n * @param {boolean} enable Whether the Zippy handles keyboard events.\n */\ngoog.ui.Zippy.prototype.setHandleKeyboardEvents = function(enable) {\n  if (this.handleKeyEvents_ != enable) {\n    this.handleKeyEvents_ = enable;\n    if (enable) {\n      this.enableKeyboardEventsHandling_(this.elHeader_);\n      this.enableKeyboardEventsHandling_(this.elExpandedHeader_);\n    } else {\n      this.keyboardEventHandler_.removeAll();\n      this.keyHandler_.detach();\n    }\n  }\n};\n\n\n/**\n * Sets whether the Zippy handles it's own mouse events.\n * @param {boolean} enable Whether the Zippy handles mouse events.\n */\ngoog.ui.Zippy.prototype.setHandleMouseEvents = function(enable) {\n  if (this.handleMouseEvents_ != enable) {\n    this.handleMouseEvents_ = enable;\n    if (enable) {\n      this.enableMouseEventsHandling_(this.elHeader_);\n      this.enableMouseEventsHandling_(this.elExpandedHeader_);\n    } else {\n      this.mouseEventHandler_.removeAll();\n    }\n  }\n};\n\n\n/**\n * Enables keyboard events handling for the passed header element.\n * @param {Element} header The header element.\n * @private\n */\ngoog.ui.Zippy.prototype.enableKeyboardEventsHandling_ = function(header) {\n  if (header) {\n    this.keyHandler_.attach(header);\n    this.keyboardEventHandler_.listen(\n        this.keyHandler_, goog.events.KeyHandler.EventType.KEY,\n        this.onHeaderKeyDown_);\n  }\n};\n\n\n/**\n * Enables mouse events handling for the passed header element.\n * @param {Element} header The header element.\n * @private\n */\ngoog.ui.Zippy.prototype.enableMouseEventsHandling_ = function(header) {\n  if (header) {\n    this.mouseEventHandler_.listen(\n        header, goog.events.EventType.CLICK, this.onHeaderClick_);\n  }\n};\n\n\n/**\n * KeyDown event handler for header element. Enter and space toggles expanded\n * state.\n *\n * @param {!goog.events.BrowserEvent} event KeyDown event.\n * @private\n */\ngoog.ui.Zippy.prototype.onHeaderKeyDown_ = function(event) {\n  if (event.keyCode == goog.events.KeyCodes.ENTER ||\n      event.keyCode == goog.events.KeyCodes.SPACE) {\n    this.toggle();\n    this.dispatchActionEvent_(event);\n\n    // Prevent enter key from submitting form.\n    event.preventDefault();\n\n    event.stopPropagation();\n  }\n};\n\n\n/**\n * Click event handler for header element.\n *\n * @param {!goog.events.BrowserEvent} event Click event.\n * @private\n */\ngoog.ui.Zippy.prototype.onHeaderClick_ = function(event) {\n  this.toggle();\n  this.dispatchActionEvent_(event);\n};\n\n\n/**\n * Dispatch an ACTION event whenever there is user interaction with the header.\n * Please note that after the zippy state change is completed a TOGGLE event\n * will be dispatched. However, the TOGGLE event is dispatch on every toggle,\n * including programmatic call to `#toggle`.\n * @param {!goog.events.BrowserEvent} triggeringEvent\n * @private\n */\ngoog.ui.Zippy.prototype.dispatchActionEvent_ = function(triggeringEvent) {\n  this.dispatchEvent(new goog.ui.ZippyEvent(\n      goog.ui.Zippy.Events.ACTION, this, this.expanded_, triggeringEvent));\n};\n\n\n\n/**\n * Object representing a zippy toggle event.\n *\n * @param {string} type Event type.\n * @param {goog.ui.Zippy} target Zippy widget initiating event.\n * @param {boolean} expanded Expanded state.\n * @param {!goog.events.BrowserEvent=} opt_triggeringEvent\n * @extends {goog.events.Event}\n * @constructor\n * @final\n */\ngoog.ui.ZippyEvent = function(type, target, expanded, opt_triggeringEvent) {\n  goog.ui.ZippyEvent.base(this, 'constructor', type, target);\n\n  /**\n   * The expanded state.\n   * @type {boolean}\n   */\n  this.expanded = expanded;\n\n  /**\n   * For ACTION events, the key or mouse event that triggered this event, if\n   * there was one.\n   * @type {?goog.events.BrowserEvent}\n   */\n  this.triggeringEvent = opt_triggeringEvent || null;\n};\ngoog.inherits(goog.ui.ZippyEvent, goog.events.Event);\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for element styles.\n *\n * @author arv@google.com (Erik Arvidsson)\n * @author eae@google.com (Emil A Eklund)\n * @see ../demos/inline_block_quirks.html\n * @see ../demos/inline_block_standards.html\n * @see ../demos/style_viewport.html\n */\n\ngoog.provide('goog.style');\n\n\ngoog.require('goog.array');\ngoog.require('goog.asserts');\ngoog.require('goog.dom');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.dom.vendor');\ngoog.require('goog.html.SafeStyleSheet');\ngoog.require('goog.math.Box');\ngoog.require('goog.math.Coordinate');\ngoog.require('goog.math.Rect');\ngoog.require('goog.math.Size');\ngoog.require('goog.object');\ngoog.require('goog.reflect');\ngoog.require('goog.string');\ngoog.require('goog.userAgent');\n\ngoog.forwardDeclare('goog.events.Event');\n\n\n/**\n * Sets a style value on an element.\n *\n * This function is not indended to patch issues in the browser's style\n * handling, but to allow easy programmatic access to setting dash-separated\n * style properties.  An example is setting a batch of properties from a data\n * object without overwriting old styles.  When possible, use native APIs:\n * elem.style.propertyKey = 'value' or (if obliterating old styles is fine)\n * elem.style.cssText = 'property1: value1; property2: value2'.\n *\n * @param {Element} element The element to change.\n * @param {string|Object} style If a string, a style name. If an object, a hash\n *     of style names to style values.\n * @param {string|number|boolean=} opt_value If style was a string, then this\n *     should be the value.\n */\ngoog.style.setStyle = function(element, style, opt_value) {\n  if (goog.isString(style)) {\n    goog.style.setStyle_(element, opt_value, style);\n  } else {\n    for (var key in style) {\n      goog.style.setStyle_(element, style[key], key);\n    }\n  }\n};\n\n\n/**\n * Sets a style value on an element, with parameters swapped to work with\n * `goog.object.forEach()`. Prepends a vendor-specific prefix when\n * necessary.\n * @param {Element} element The element to change.\n * @param {string|number|boolean|undefined} value Style value.\n * @param {string} style Style name.\n * @private\n */\ngoog.style.setStyle_ = function(element, value, style) {\n  var propertyName = goog.style.getVendorJsStyleName_(element, style);\n\n  if (propertyName) {\n    // TODO(johnlenz): coerce to string?\n    element.style[propertyName] = /** @type {?} */ (value);\n  }\n};\n\n\n/**\n * Style name cache that stores previous property name lookups.\n *\n * This is used by setStyle to speed up property lookups, entries look like:\n *   { StyleName: ActualPropertyName }\n *\n * @private {!Object<string, string>}\n */\ngoog.style.styleNameCache_ = {};\n\n\n/**\n * Returns the style property name in camel-case. If it does not exist and a\n * vendor-specific version of the property does exist, then return the vendor-\n * specific property name instead.\n * @param {Element} element The element to change.\n * @param {string} style Style name.\n * @return {string} Vendor-specific style.\n * @private\n */\ngoog.style.getVendorJsStyleName_ = function(element, style) {\n  var propertyName = goog.style.styleNameCache_[style];\n  if (!propertyName) {\n    var camelStyle = goog.string.toCamelCase(style);\n    propertyName = camelStyle;\n\n    if (element.style[camelStyle] === undefined) {\n      var prefixedStyle = goog.dom.vendor.getVendorJsPrefix() +\n          goog.string.toTitleCase(camelStyle);\n\n      if (element.style[prefixedStyle] !== undefined) {\n        propertyName = prefixedStyle;\n      }\n    }\n    goog.style.styleNameCache_[style] = propertyName;\n  }\n\n  return propertyName;\n};\n\n\n/**\n * Returns the style property name in CSS notation. If it does not exist and a\n * vendor-specific version of the property does exist, then return the vendor-\n * specific property name instead.\n * @param {Element} element The element to change.\n * @param {string} style Style name.\n * @return {string} Vendor-specific style.\n * @private\n */\ngoog.style.getVendorStyleName_ = function(element, style) {\n  var camelStyle = goog.string.toCamelCase(style);\n\n  if (element.style[camelStyle] === undefined) {\n    var prefixedStyle = goog.dom.vendor.getVendorJsPrefix() +\n        goog.string.toTitleCase(camelStyle);\n\n    if (element.style[prefixedStyle] !== undefined) {\n      return goog.dom.vendor.getVendorPrefix() + '-' + style;\n    }\n  }\n\n  return style;\n};\n\n\n/**\n * Retrieves an explicitly-set style value of a node. This returns '' if there\n * isn't a style attribute on the element or if this style property has not been\n * explicitly set in script.\n *\n * @param {Element} element Element to get style of.\n * @param {string} property Property to get, css-style (if you have a camel-case\n * property, use element.style[style]).\n * @return {string} Style value.\n */\ngoog.style.getStyle = function(element, property) {\n  // element.style is '' for well-known properties which are unset.\n  // For for browser specific styles as 'filter' is undefined\n  // so we need to return '' explicitly to make it consistent across\n  // browsers.\n  var styleValue = element.style[goog.string.toCamelCase(property)];\n\n  // Using typeof here because of a bug in Safari 5.1, where this value\n  // was undefined, but === undefined returned false.\n  if (typeof(styleValue) !== 'undefined') {\n    return styleValue;\n  }\n\n  return element.style[goog.style.getVendorJsStyleName_(element, property)] ||\n      '';\n};\n\n\n/**\n * Retrieves a computed style value of a node. It returns empty string if the\n * value cannot be computed (which will be the case in Internet Explorer) or\n * \"none\" if the property requested is an SVG one and it has not been\n * explicitly set (firefox and webkit).\n *\n * @param {Element} element Element to get style of.\n * @param {string} property Property to get (camel-case).\n * @return {string} Style value.\n */\ngoog.style.getComputedStyle = function(element, property) {\n  var doc = goog.dom.getOwnerDocument(element);\n  if (doc.defaultView && doc.defaultView.getComputedStyle) {\n    var styles = doc.defaultView.getComputedStyle(element, null);\n    if (styles) {\n      // element.style[..] is undefined for browser specific styles\n      // as 'filter'.\n      return styles[property] || styles.getPropertyValue(property) || '';\n    }\n  }\n\n  return '';\n};\n\n\n/**\n * Gets the cascaded style value of a node, or null if the value cannot be\n * computed (only Internet Explorer can do this).\n *\n * @param {Element} element Element to get style of.\n * @param {string} style Property to get (camel-case).\n * @return {string} Style value.\n */\ngoog.style.getCascadedStyle = function(element, style) {\n  // TODO(nicksantos): This should be documented to return null. #fixTypes\n  return /** @type {string} */ (\n      element.currentStyle ? element.currentStyle[style] : null);\n};\n\n\n/**\n * Cross-browser pseudo get computed style. It returns the computed style where\n * available. If not available it tries the cascaded style value (IE\n * currentStyle) and in worst case the inline style value.  It shouldn't be\n * called directly, see http://wiki/Main/ComputedStyleVsCascadedStyle for\n * discussion.\n *\n * @param {Element} element Element to get style of.\n * @param {string} style Property to get (must be camelCase, not css-style.).\n * @return {string} Style value.\n * @private\n */\ngoog.style.getStyle_ = function(element, style) {\n  return goog.style.getComputedStyle(element, style) ||\n      goog.style.getCascadedStyle(element, style) ||\n      (element.style && element.style[style]);\n};\n\n\n/**\n * Retrieves the computed value of the box-sizing CSS attribute.\n * Browser support: http://caniuse.com/css3-boxsizing.\n * @param {!Element} element The element whose box-sizing to get.\n * @return {?string} 'content-box', 'border-box' or 'padding-box'. null if\n *     box-sizing is not supported (IE7 and below).\n */\ngoog.style.getComputedBoxSizing = function(element) {\n  return goog.style.getStyle_(element, 'boxSizing') ||\n      goog.style.getStyle_(element, 'MozBoxSizing') ||\n      goog.style.getStyle_(element, 'WebkitBoxSizing') || null;\n};\n\n\n/**\n * Retrieves the computed value of the position CSS attribute.\n * @param {Element} element The element to get the position of.\n * @return {string} Position value.\n */\ngoog.style.getComputedPosition = function(element) {\n  return goog.style.getStyle_(element, 'position');\n};\n\n\n/**\n * Retrieves the computed background color string for a given element. The\n * string returned is suitable for assigning to another element's\n * background-color, but is not guaranteed to be in any particular string\n * format. Accessing the color in a numeric form may not be possible in all\n * browsers or with all input.\n *\n * If the background color for the element is defined as a hexadecimal value,\n * the resulting string can be parsed by goog.color.parse in all supported\n * browsers.\n *\n * Whether named colors like \"red\" or \"lightblue\" get translated into a\n * format which can be parsed is browser dependent. Calling this function on\n * transparent elements will return \"transparent\" in most browsers or\n * \"rgba(0, 0, 0, 0)\" in WebKit.\n * @param {Element} element The element to get the background color of.\n * @return {string} The computed string value of the background color.\n */\ngoog.style.getBackgroundColor = function(element) {\n  return goog.style.getStyle_(element, 'backgroundColor');\n};\n\n\n/**\n * Retrieves the computed value of the overflow-x CSS attribute.\n * @param {Element} element The element to get the overflow-x of.\n * @return {string} The computed string value of the overflow-x attribute.\n */\ngoog.style.getComputedOverflowX = function(element) {\n  return goog.style.getStyle_(element, 'overflowX');\n};\n\n\n/**\n * Retrieves the computed value of the overflow-y CSS attribute.\n * @param {Element} element The element to get the overflow-y of.\n * @return {string} The computed string value of the overflow-y attribute.\n */\ngoog.style.getComputedOverflowY = function(element) {\n  return goog.style.getStyle_(element, 'overflowY');\n};\n\n\n/**\n * Retrieves the computed value of the z-index CSS attribute.\n * @param {Element} element The element to get the z-index of.\n * @return {string|number} The computed value of the z-index attribute.\n */\ngoog.style.getComputedZIndex = function(element) {\n  return goog.style.getStyle_(element, 'zIndex');\n};\n\n\n/**\n * Retrieves the computed value of the text-align CSS attribute.\n * @param {Element} element The element to get the text-align of.\n * @return {string} The computed string value of the text-align attribute.\n */\ngoog.style.getComputedTextAlign = function(element) {\n  return goog.style.getStyle_(element, 'textAlign');\n};\n\n\n/**\n * Retrieves the computed value of the cursor CSS attribute.\n * @param {Element} element The element to get the cursor of.\n * @return {string} The computed string value of the cursor attribute.\n */\ngoog.style.getComputedCursor = function(element) {\n  return goog.style.getStyle_(element, 'cursor');\n};\n\n\n/**\n * Retrieves the computed value of the CSS transform attribute.\n * @param {Element} element The element to get the transform of.\n * @return {string} The computed string representation of the transform matrix.\n */\ngoog.style.getComputedTransform = function(element) {\n  var property = goog.style.getVendorStyleName_(element, 'transform');\n  return goog.style.getStyle_(element, property) ||\n      goog.style.getStyle_(element, 'transform');\n};\n\n\n/**\n * Sets the top/left values of an element.  If no unit is specified in the\n * argument then it will add px. The second argument is required if the first\n * argument is a string or number and is ignored if the first argument\n * is a coordinate.\n * @param {Element} el Element to move.\n * @param {string|number|goog.math.Coordinate} arg1 Left position or coordinate.\n * @param {string|number=} opt_arg2 Top position.\n */\ngoog.style.setPosition = function(el, arg1, opt_arg2) {\n  var x, y;\n\n  if (arg1 instanceof goog.math.Coordinate) {\n    x = arg1.x;\n    y = arg1.y;\n  } else {\n    x = arg1;\n    y = opt_arg2;\n  }\n\n  el.style.left = goog.style.getPixelStyleValue_(\n      /** @type {number|string} */ (x), false);\n  el.style.top = goog.style.getPixelStyleValue_(\n      /** @type {number|string} */ (y), false);\n};\n\n\n/**\n * Gets the offsetLeft and offsetTop properties of an element and returns them\n * in a Coordinate object\n * @param {Element} element Element.\n * @return {!goog.math.Coordinate} The position.\n */\ngoog.style.getPosition = function(element) {\n  return new goog.math.Coordinate(\n      /** @type {!HTMLElement} */ (element).offsetLeft,\n      /** @type {!HTMLElement} */ (element).offsetTop);\n};\n\n\n/**\n * Returns the viewport element for a particular document\n * @param {Node=} opt_node DOM node (Document is OK) to get the viewport element\n *     of.\n * @return {Element} document.documentElement or document.body.\n */\ngoog.style.getClientViewportElement = function(opt_node) {\n  var doc;\n  if (opt_node) {\n    doc = goog.dom.getOwnerDocument(opt_node);\n  } else {\n    doc = goog.dom.getDocument();\n  }\n\n  // In old IE versions the document.body represented the viewport\n  if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(9) &&\n      !goog.dom.getDomHelper(doc).isCss1CompatMode()) {\n    return doc.body;\n  }\n  return doc.documentElement;\n};\n\n\n/**\n * Calculates the viewport coordinates relative to the page/document\n * containing the node. The viewport may be the browser viewport for\n * non-iframe document, or the iframe container for iframe'd document.\n * @param {!Document} doc The document to use as the reference point.\n * @return {!goog.math.Coordinate} The page offset of the viewport.\n */\ngoog.style.getViewportPageOffset = function(doc) {\n  var body = doc.body;\n  var documentElement = doc.documentElement;\n  var scrollLeft = body.scrollLeft || documentElement.scrollLeft;\n  var scrollTop = body.scrollTop || documentElement.scrollTop;\n  return new goog.math.Coordinate(scrollLeft, scrollTop);\n};\n\n\n/**\n * Gets the client rectangle of the DOM element.\n *\n * getBoundingClientRect is part of a new CSS object model draft (with a\n * long-time presence in IE), replacing the error-prone parent offset\n * computation and the now-deprecated Gecko getBoxObjectFor.\n *\n * This utility patches common browser bugs in getBoundingClientRect. It\n * will fail if getBoundingClientRect is unsupported.\n *\n * If the element is not in the DOM, the result is undefined, and an error may\n * be thrown depending on user agent.\n *\n * @param {!Element} el The element whose bounding rectangle is being queried.\n * @return {Object} A native bounding rectangle with numerical left, top,\n *     right, and bottom.  Reported by Firefox to be of object type ClientRect.\n * @private\n */\ngoog.style.getBoundingClientRect_ = function(el) {\n  var rect;\n  try {\n    rect = el.getBoundingClientRect();\n  } catch (e) {\n    // In IE < 9, calling getBoundingClientRect on an orphan element raises an\n    // \"Unspecified Error\". All other browsers return zeros.\n    return {'left': 0, 'top': 0, 'right': 0, 'bottom': 0};\n  }\n\n  // Patch the result in IE only, so that this function can be inlined if\n  // compiled for non-IE.\n  if (goog.userAgent.IE && el.ownerDocument.body) {\n    // In IE, most of the time, 2 extra pixels are added to the top and left\n    // due to the implicit 2-pixel inset border.  In IE6/7 quirks mode and\n    // IE6 standards mode, this border can be overridden by setting the\n    // document element's border to zero -- thus, we cannot rely on the\n    // offset always being 2 pixels.\n\n    // In quirks mode, the offset can be determined by querying the body's\n    // clientLeft/clientTop, but in standards mode, it is found by querying\n    // the document element's clientLeft/clientTop.  Since we already called\n    // getBoundingClientRect we have already forced a reflow, so it is not\n    // too expensive just to query them all.\n\n    // See: http://msdn.microsoft.com/en-us/library/ms536433(VS.85).aspx\n    var doc = el.ownerDocument;\n    rect.left -= doc.documentElement.clientLeft + doc.body.clientLeft;\n    rect.top -= doc.documentElement.clientTop + doc.body.clientTop;\n  }\n  return rect;\n};\n\n\n/**\n * Returns the first parent that could affect the position of a given element.\n * @param {Element} element The element to get the offset parent for.\n * @return {Element} The first offset parent or null if one cannot be found.\n */\ngoog.style.getOffsetParent = function(element) {\n  // element.offsetParent does the right thing in IE7 and below.  In other\n  // browsers it only includes elements with position absolute, relative or\n  // fixed, not elements with overflow set to auto or scroll.\n  if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(8)) {\n    goog.asserts.assert(element && 'offsetParent' in element);\n    return element.offsetParent;\n  }\n\n  var doc = goog.dom.getOwnerDocument(element);\n  var positionStyle = goog.style.getStyle_(element, 'position');\n  var skipStatic = positionStyle == 'fixed' || positionStyle == 'absolute';\n  for (var parent = element.parentNode; parent && parent != doc;\n       parent = parent.parentNode) {\n    // Skip shadowDOM roots.\n    if (parent.nodeType == goog.dom.NodeType.DOCUMENT_FRAGMENT && parent.host) {\n      // Cast because the assignment is not type safe, and without a cast we\n      // start typing parent loosely and get bad disambiguation.\n      parent = /** @type {!Element} */ (parent.host);\n    }\n    positionStyle =\n        goog.style.getStyle_(/** @type {!Element} */ (parent), 'position');\n    skipStatic = skipStatic && positionStyle == 'static' &&\n        parent != doc.documentElement && parent != doc.body;\n    if (!skipStatic &&\n        (parent.scrollWidth > parent.clientWidth ||\n         parent.scrollHeight > parent.clientHeight ||\n         positionStyle == 'fixed' || positionStyle == 'absolute' ||\n         positionStyle == 'relative')) {\n      return /** @type {!Element} */ (parent);\n    }\n  }\n  return null;\n};\n\n\n/**\n * Calculates and returns the visible rectangle for a given element. Returns a\n * box describing the visible portion of the nearest scrollable offset ancestor.\n * Coordinates are given relative to the document.\n *\n * @param {Element} element Element to get the visible rect for.\n * @return {goog.math.Box} Bounding elementBox describing the visible rect or\n *     null if scrollable ancestor isn't inside the visible viewport.\n */\ngoog.style.getVisibleRectForElement = function(element) {\n  var visibleRect = new goog.math.Box(0, Infinity, Infinity, 0);\n  var dom = goog.dom.getDomHelper(element);\n  var body = dom.getDocument().body;\n  var documentElement = dom.getDocument().documentElement;\n  var scrollEl = dom.getDocumentScrollElement();\n\n  // Determine the size of the visible rect by climbing the dom accounting for\n  // all scrollable containers.\n  for (var el = element; el = goog.style.getOffsetParent(el);) {\n    // clientWidth is zero for inline block elements in IE.\n    // on WEBKIT, body element can have clientHeight = 0 and scrollHeight > 0\n    if ((!goog.userAgent.IE || el.clientWidth != 0) &&\n        (!goog.userAgent.WEBKIT || el.clientHeight != 0 || el != body) &&\n        // body may have overflow set on it, yet we still get the entire\n        // viewport. In some browsers, el.offsetParent may be\n        // document.documentElement, so check for that too.\n        (el != body && el != documentElement &&\n         goog.style.getStyle_(el, 'overflow') != 'visible')) {\n      var pos = goog.style.getPageOffset(el);\n      var client = goog.style.getClientLeftTop(el);\n      pos.x += client.x;\n      pos.y += client.y;\n\n      visibleRect.top = Math.max(visibleRect.top, pos.y);\n      visibleRect.right = Math.min(visibleRect.right, pos.x + el.clientWidth);\n      visibleRect.bottom =\n          Math.min(visibleRect.bottom, pos.y + el.clientHeight);\n      visibleRect.left = Math.max(visibleRect.left, pos.x);\n    }\n  }\n\n  // Clip by window's viewport.\n  var scrollX = scrollEl.scrollLeft, scrollY = scrollEl.scrollTop;\n  visibleRect.left = Math.max(visibleRect.left, scrollX);\n  visibleRect.top = Math.max(visibleRect.top, scrollY);\n  var winSize = dom.getViewportSize();\n  visibleRect.right = Math.min(visibleRect.right, scrollX + winSize.width);\n  visibleRect.bottom = Math.min(visibleRect.bottom, scrollY + winSize.height);\n  return visibleRect.top >= 0 && visibleRect.left >= 0 &&\n          visibleRect.bottom > visibleRect.top &&\n          visibleRect.right > visibleRect.left ?\n      visibleRect :\n      null;\n};\n\n\n/**\n * Calculate the scroll position of `container` with the minimum amount so\n * that the content and the borders of the given `element` become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n *\n * @param {Element} element The element to make visible.\n * @param {Element=} opt_container The container to scroll. If not set, then the\n *     document scroll element will be used.\n * @param {boolean=} opt_center Whether to center the element in the container.\n *     Defaults to false.\n * @return {!goog.math.Coordinate} The new scroll position of the container,\n *     in form of goog.math.Coordinate(scrollLeft, scrollTop).\n */\ngoog.style.getContainerOffsetToScrollInto = function(\n    element, opt_container, opt_center) {\n  var container = opt_container || goog.dom.getDocumentScrollElement();\n  // Absolute position of the element's border's top left corner.\n  var elementPos = goog.style.getPageOffset(element);\n  // Absolute position of the container's border's top left corner.\n  var containerPos = goog.style.getPageOffset(container);\n  var containerBorder = goog.style.getBorderBox(container);\n  if (container == goog.dom.getDocumentScrollElement()) {\n    // The element position is calculated based on the page offset, and the\n    // document scroll element holds the scroll position within the page. We can\n    // use the scroll position to calculate the relative position from the\n    // element.\n    var relX = elementPos.x - container.scrollLeft;\n    var relY = elementPos.y - container.scrollTop;\n    if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(10)) {\n      // In older versions of IE getPageOffset(element) does not include the\n      // container border so it has to be added to accommodate.\n      relX += containerBorder.left;\n      relY += containerBorder.top;\n    }\n  } else {\n    // Relative pos. of the element's border box to the container's content box.\n    var relX = elementPos.x - containerPos.x - containerBorder.left;\n    var relY = elementPos.y - containerPos.y - containerBorder.top;\n  }\n  // How much the element can move in the container, i.e. the difference between\n  // the element's bottom-right-most and top-left-most position where it's\n  // fully visible.\n  var elementSize = goog.style.getSizeWithDisplay_(element);\n  var spaceX = container.clientWidth - elementSize.width;\n  var spaceY = container.clientHeight - elementSize.height;\n  var scrollLeft = container.scrollLeft;\n  var scrollTop = container.scrollTop;\n  if (opt_center) {\n    // All browsers round non-integer scroll positions down.\n    scrollLeft += relX - spaceX / 2;\n    scrollTop += relY - spaceY / 2;\n  } else {\n    // This formula was designed to give the correct scroll values in the\n    // following cases:\n    // - element is higher than container (spaceY < 0) => scroll down by relY\n    // - element is not higher that container (spaceY >= 0):\n    //   - it is above container (relY < 0) => scroll up by abs(relY)\n    //   - it is below container (relY > spaceY) => scroll down by relY - spaceY\n    //   - it is in the container => don't scroll\n    scrollLeft += Math.min(relX, Math.max(relX - spaceX, 0));\n    scrollTop += Math.min(relY, Math.max(relY - spaceY, 0));\n  }\n  return new goog.math.Coordinate(scrollLeft, scrollTop);\n};\n\n\n/**\n * Changes the scroll position of `container` with the minimum amount so\n * that the content and the borders of the given `element` become visible.\n * If the element is bigger than the container, its top left corner will be\n * aligned as close to the container's top left corner as possible.\n *\n * @param {Element} element The element to make visible.\n * @param {Element=} opt_container The container to scroll. If not set, then the\n *     document scroll element will be used.\n * @param {boolean=} opt_center Whether to center the element in the container.\n *     Defaults to false.\n */\ngoog.style.scrollIntoContainerView = function(\n    element, opt_container, opt_center) {\n  var container = opt_container || goog.dom.getDocumentScrollElement();\n  var offset =\n      goog.style.getContainerOffsetToScrollInto(element, container, opt_center);\n  container.scrollLeft = offset.x;\n  container.scrollTop = offset.y;\n};\n\n\n/**\n * Returns clientLeft (width of the left border and, if the directionality is\n * right to left, the vertical scrollbar) and clientTop as a coordinate object.\n *\n * @param {Element} el Element to get clientLeft for.\n * @return {!goog.math.Coordinate} Client left and top.\n */\ngoog.style.getClientLeftTop = function(el) {\n  return new goog.math.Coordinate(el.clientLeft, el.clientTop);\n};\n\n\n/**\n * Returns a Coordinate object relative to the top-left of the HTML document.\n * Implemented as a single function to save having to do two recursive loops in\n * opera and safari just to get both coordinates.  If you just want one value do\n * use goog.style.getPageOffsetLeft() and goog.style.getPageOffsetTop(), but\n * note if you call both those methods the tree will be analysed twice.\n *\n * @param {Element} el Element to get the page offset for.\n * @return {!goog.math.Coordinate} The page offset.\n */\ngoog.style.getPageOffset = function(el) {\n  var doc = goog.dom.getOwnerDocument(el);\n  // TODO(gboyer): Update the jsdoc in a way that doesn't break the universe.\n  goog.asserts.assertObject(el, 'Parameter is required');\n\n  // NOTE(arv): If element is hidden (display none or disconnected or any the\n  // ancestors are hidden) we get (0,0) by default but we still do the\n  // accumulation of scroll position.\n\n  // TODO(arv): Should we check if the node is disconnected and in that case\n  //            return (0,0)?\n\n  var pos = new goog.math.Coordinate(0, 0);\n  var viewportElement = goog.style.getClientViewportElement(doc);\n  if (el == viewportElement) {\n    // viewport is always at 0,0 as that defined the coordinate system for this\n    // function - this avoids special case checks in the code below\n    return pos;\n  }\n\n  var box = goog.style.getBoundingClientRect_(el);\n  // Must add the scroll coordinates in to get the absolute page offset\n  // of element since getBoundingClientRect returns relative coordinates to\n  // the viewport.\n  var scrollCoord = goog.dom.getDomHelper(doc).getDocumentScroll();\n  pos.x = box.left + scrollCoord.x;\n  pos.y = box.top + scrollCoord.y;\n\n  return pos;\n};\n\n\n/**\n * Returns the left coordinate of an element relative to the HTML document\n * @param {Element} el Elements.\n * @return {number} The left coordinate.\n */\ngoog.style.getPageOffsetLeft = function(el) {\n  return goog.style.getPageOffset(el).x;\n};\n\n\n/**\n * Returns the top coordinate of an element relative to the HTML document\n * @param {Element} el Elements.\n * @return {number} The top coordinate.\n */\ngoog.style.getPageOffsetTop = function(el) {\n  return goog.style.getPageOffset(el).y;\n};\n\n\n/**\n * Returns a Coordinate object relative to the top-left of an HTML document\n * in an ancestor frame of this element. Used for measuring the position of\n * an element inside a frame relative to a containing frame.\n *\n * @param {Element} el Element to get the page offset for.\n * @param {Window} relativeWin The window to measure relative to. If relativeWin\n *     is not in the ancestor frame chain of the element, we measure relative to\n *     the top-most window.\n * @return {!goog.math.Coordinate} The page offset.\n */\ngoog.style.getFramedPageOffset = function(el, relativeWin) {\n  var position = new goog.math.Coordinate(0, 0);\n\n  // Iterate up the ancestor frame chain, keeping track of the current window\n  // and the current element in that window.\n  var currentWin = goog.dom.getWindow(goog.dom.getOwnerDocument(el));\n\n  // MS Edge throws when accessing \"parent\" if el's containing iframe has been\n  // deleted.\n  if (!goog.reflect.canAccessProperty(currentWin, 'parent')) {\n    return position;\n  }\n\n  var currentEl = el;\n  do {\n    // if we're at the top window, we want to get the page offset.\n    // if we're at an inner frame, we only want to get the window position\n    // so that we can determine the actual page offset in the context of\n    // the outer window.\n    var offset = currentWin == relativeWin ?\n        goog.style.getPageOffset(currentEl) :\n        goog.style.getClientPositionForElement_(goog.asserts.assert(currentEl));\n\n    position.x += offset.x;\n    position.y += offset.y;\n  } while (currentWin && currentWin != relativeWin &&\n           currentWin != currentWin.parent &&\n           (currentEl = currentWin.frameElement) &&\n           (currentWin = currentWin.parent));\n\n  return position;\n};\n\n\n/**\n * Translates the specified rect relative to origBase page, for newBase page.\n * If origBase and newBase are the same, this function does nothing.\n *\n * @param {goog.math.Rect} rect The source rectangle relative to origBase page,\n *     and it will have the translated result.\n * @param {goog.dom.DomHelper} origBase The DomHelper for the input rectangle.\n * @param {goog.dom.DomHelper} newBase The DomHelper for the resultant\n *     coordinate.  This must be a DOM for an ancestor frame of origBase\n *     or the same as origBase.\n */\ngoog.style.translateRectForAnotherFrame = function(rect, origBase, newBase) {\n  if (origBase.getDocument() != newBase.getDocument()) {\n    var body = origBase.getDocument().body;\n    var pos = goog.style.getFramedPageOffset(body, newBase.getWindow());\n\n    // Adjust Body's margin.\n    pos = goog.math.Coordinate.difference(pos, goog.style.getPageOffset(body));\n\n    if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(9) &&\n        !origBase.isCss1CompatMode()) {\n      pos = goog.math.Coordinate.difference(pos, origBase.getDocumentScroll());\n    }\n\n    rect.left += pos.x;\n    rect.top += pos.y;\n  }\n};\n\n\n/**\n * Returns the position of an element relative to another element in the\n * document.  A relative to B\n * @param {Element|Event|goog.events.Event} a Element or mouse event whose\n *     position we're calculating.\n * @param {Element|Event|goog.events.Event} b Element or mouse event position\n *     is relative to.\n * @return {!goog.math.Coordinate} The relative position.\n */\ngoog.style.getRelativePosition = function(a, b) {\n  var ap = goog.style.getClientPosition(a);\n  var bp = goog.style.getClientPosition(b);\n  return new goog.math.Coordinate(ap.x - bp.x, ap.y - bp.y);\n};\n\n\n/**\n * Returns the position of the event or the element's border box relative to\n * the client viewport.\n * @param {!Element} el Element whose position to get.\n * @return {!goog.math.Coordinate} The position.\n * @private\n */\ngoog.style.getClientPositionForElement_ = function(el) {\n  var box = goog.style.getBoundingClientRect_(el);\n  return new goog.math.Coordinate(box.left, box.top);\n};\n\n\n/**\n * Returns the position of the event or the element's border box relative to\n * the client viewport. If an event is passed, and if this event is a \"touch\"\n * event, then the position of the first changedTouches will be returned.\n * @param {Element|Event|goog.events.Event} el Element or a mouse / touch event.\n * @return {!goog.math.Coordinate} The position.\n */\ngoog.style.getClientPosition = function(el) {\n  goog.asserts.assert(el);\n  if (el.nodeType == goog.dom.NodeType.ELEMENT) {\n    return goog.style.getClientPositionForElement_(\n        /** @type {!Element} */ (el));\n  } else {\n    var targetEvent = el.changedTouches ? el.changedTouches[0] : el;\n    return new goog.math.Coordinate(targetEvent.clientX, targetEvent.clientY);\n  }\n};\n\n\n/**\n * Moves an element to the given coordinates relative to the client viewport.\n * @param {Element} el Absolutely positioned element to set page offset for.\n *     It must be in the document.\n * @param {number|goog.math.Coordinate} x Left position of the element's margin\n *     box or a coordinate object.\n * @param {number=} opt_y Top position of the element's margin box.\n */\ngoog.style.setPageOffset = function(el, x, opt_y) {\n  // Get current pageoffset\n  var cur = goog.style.getPageOffset(el);\n\n  if (x instanceof goog.math.Coordinate) {\n    opt_y = x.y;\n    x = x.x;\n  }\n\n  // NOTE(arv): We cannot allow strings for x and y. We could but that would\n  // require us to manually transform between different units\n\n  // Work out deltas\n  var dx = goog.asserts.assertNumber(x) - cur.x;\n  var dy = Number(opt_y) - cur.y;\n\n  // Set position to current left/top + delta\n  goog.style.setPosition(\n      el, /** @type {!HTMLElement} */ (el).offsetLeft + dx,\n      /** @type {!HTMLElement} */ (el).offsetTop + dy);\n};\n\n\n/**\n * Sets the width/height values of an element.  If an argument is numeric,\n * or a goog.math.Size is passed, it is assumed to be pixels and will add\n * 'px' after converting it to an integer in string form. (This just sets the\n * CSS width and height properties so it might set content-box or border-box\n * size depending on the box model the browser is using.)\n *\n * @param {Element} element Element to set the size of.\n * @param {string|number|goog.math.Size} w Width of the element, or a\n *     size object.\n * @param {string|number=} opt_h Height of the element. Required if w is not a\n *     size object.\n */\ngoog.style.setSize = function(element, w, opt_h) {\n  var h;\n  if (w instanceof goog.math.Size) {\n    h = w.height;\n    w = w.width;\n  } else {\n    if (opt_h == undefined) {\n      throw new Error('missing height argument');\n    }\n    h = opt_h;\n  }\n\n  goog.style.setWidth(element, /** @type {string|number} */ (w));\n  goog.style.setHeight(element, h);\n};\n\n\n/**\n * Helper function to create a string to be set into a pixel-value style\n * property of an element. Can round to the nearest integer value.\n *\n * @param {string|number} value The style value to be used. If a number,\n *     'px' will be appended, otherwise the value will be applied directly.\n * @param {boolean} round Whether to round the nearest integer (if property\n *     is a number).\n * @return {string} The string value for the property.\n * @private\n */\ngoog.style.getPixelStyleValue_ = function(value, round) {\n  if (typeof value == 'number') {\n    value = (round ? Math.round(value) : value) + 'px';\n  }\n\n  return value;\n};\n\n\n/**\n * Set the height of an element.  Sets the element's style property.\n * @param {Element} element Element to set the height of.\n * @param {string|number} height The height value to set.  If a number, 'px'\n *     will be appended, otherwise the value will be applied directly.\n */\ngoog.style.setHeight = function(element, height) {\n  element.style.height = goog.style.getPixelStyleValue_(height, true);\n};\n\n\n/**\n * Set the width of an element.  Sets the element's style property.\n * @param {Element} element Element to set the width of.\n * @param {string|number} width The width value to set.  If a number, 'px'\n *     will be appended, otherwise the value will be applied directly.\n */\ngoog.style.setWidth = function(element, width) {\n  element.style.width = goog.style.getPixelStyleValue_(width, true);\n};\n\n\n/**\n * Gets the height and width of an element, even if its display is none.\n *\n * Specifically, this returns the height and width of the border box,\n * irrespective of the box model in effect.\n *\n * Note that this function does not take CSS transforms into account. Please see\n * `goog.style.getTransformedSize`.\n * @param {Element} element Element to get size of.\n * @return {!goog.math.Size} Object with width/height properties.\n */\ngoog.style.getSize = function(element) {\n  return goog.style.evaluateWithTemporaryDisplay_(\n      goog.style.getSizeWithDisplay_, /** @type {!Element} */ (element));\n};\n\n\n/**\n * Call `fn` on `element` such that `element`'s dimensions are\n * accurate when it's passed to `fn`.\n * @param {function(!Element): T} fn Function to call with `element` as\n *     an argument after temporarily changing `element`'s display such\n *     that its dimensions are accurate.\n * @param {!Element} element Element (which may have display none) to use as\n *     argument to `fn`.\n * @return {T} Value returned by calling `fn` with `element`.\n * @template T\n * @private\n */\ngoog.style.evaluateWithTemporaryDisplay_ = function(fn, element) {\n  if (goog.style.getStyle_(element, 'display') != 'none') {\n    return fn(element);\n  }\n\n  var style = element.style;\n  var originalDisplay = style.display;\n  var originalVisibility = style.visibility;\n  var originalPosition = style.position;\n\n  style.visibility = 'hidden';\n  style.position = 'absolute';\n  style.display = 'inline';\n\n  var retVal = fn(element);\n\n  style.display = originalDisplay;\n  style.position = originalPosition;\n  style.visibility = originalVisibility;\n\n  return retVal;\n};\n\n\n/**\n * Gets the height and width of an element when the display is not none.\n * @param {Element} element Element to get size of.\n * @return {!goog.math.Size} Object with width/height properties.\n * @private\n */\ngoog.style.getSizeWithDisplay_ = function(element) {\n  var offsetWidth = /** @type {!HTMLElement} */ (element).offsetWidth;\n  var offsetHeight = /** @type {!HTMLElement} */ (element).offsetHeight;\n  var webkitOffsetsZero =\n      goog.userAgent.WEBKIT && !offsetWidth && !offsetHeight;\n  if ((!goog.isDef(offsetWidth) || webkitOffsetsZero) &&\n      element.getBoundingClientRect) {\n    // Fall back to calling getBoundingClientRect when offsetWidth or\n    // offsetHeight are not defined, or when they are zero in WebKit browsers.\n    // This makes sure that we return for the correct size for SVG elements, but\n    // will still return 0 on Webkit prior to 534.8, see\n    // http://trac.webkit.org/changeset/67252.\n    var clientRect = goog.style.getBoundingClientRect_(element);\n    return new goog.math.Size(\n        clientRect.right - clientRect.left, clientRect.bottom - clientRect.top);\n  }\n  return new goog.math.Size(offsetWidth, offsetHeight);\n};\n\n\n/**\n * Gets the height and width of an element, post transform, even if its display\n * is none.\n *\n * This is like `goog.style.getSize`, except:\n * <ol>\n * <li>Takes webkitTransforms such as rotate and scale into account.\n * <li>Will return null if `element` doesn't respond to\n *     `getBoundingClientRect`.\n * <li>Currently doesn't make sense on non-WebKit browsers which don't support\n *    webkitTransforms.\n * </ol>\n * @param {!Element} element Element to get size of.\n * @return {goog.math.Size} Object with width/height properties.\n */\ngoog.style.getTransformedSize = function(element) {\n  if (!element.getBoundingClientRect) {\n    return null;\n  }\n\n  var clientRect = goog.style.evaluateWithTemporaryDisplay_(\n      goog.style.getBoundingClientRect_, element);\n  return new goog.math.Size(\n      clientRect.right - clientRect.left, clientRect.bottom - clientRect.top);\n};\n\n\n/**\n * Returns a bounding rectangle for a given element in page space.\n * @param {Element} element Element to get bounds of. Must not be display none.\n * @return {!goog.math.Rect} Bounding rectangle for the element.\n */\ngoog.style.getBounds = function(element) {\n  var o = goog.style.getPageOffset(element);\n  var s = goog.style.getSize(element);\n  return new goog.math.Rect(o.x, o.y, s.width, s.height);\n};\n\n\n/**\n * Converts a CSS selector in the form style-property to styleProperty.\n * @param {*} selector CSS Selector.\n * @return {string} Camel case selector.\n * @deprecated Use goog.string.toCamelCase instead.\n */\ngoog.style.toCamelCase = function(selector) {\n  return goog.string.toCamelCase(String(selector));\n};\n\n\n/**\n * Converts a CSS selector in the form styleProperty to style-property.\n * @param {string} selector Camel case selector.\n * @return {string} Selector cased.\n * @deprecated Use goog.string.toSelectorCase instead.\n */\ngoog.style.toSelectorCase = function(selector) {\n  return goog.string.toSelectorCase(selector);\n};\n\n\n/**\n * Gets the opacity of a node (x-browser). This gets the inline style opacity\n * of the node, and does not take into account the cascaded or the computed\n * style for this node.\n * @param {Element} el Element whose opacity has to be found.\n * @return {number|string} Opacity between 0 and 1 or an empty string {@code ''}\n *     if the opacity is not set.\n */\ngoog.style.getOpacity = function(el) {\n  goog.asserts.assert(el);\n  var style = el.style;\n  var result = '';\n  if ('opacity' in style) {\n    result = style.opacity;\n  } else if ('MozOpacity' in style) {\n    result = style.MozOpacity;\n  } else if ('filter' in style) {\n    var match = style.filter.match(/alpha\\(opacity=([\\d.]+)\\)/);\n    if (match) {\n      result = String(match[1] / 100);\n    }\n  }\n  return result == '' ? result : Number(result);\n};\n\n\n/**\n * Sets the opacity of a node (x-browser).\n * @param {Element} el Elements whose opacity has to be set.\n * @param {number|string} alpha Opacity between 0 and 1 or an empty string\n *     {@code ''} to clear the opacity.\n */\ngoog.style.setOpacity = function(el, alpha) {\n  goog.asserts.assert(el);\n  var style = el.style;\n  if ('opacity' in style) {\n    style.opacity = alpha;\n  } else if ('MozOpacity' in style) {\n    style.MozOpacity = alpha;\n  } else if ('filter' in style) {\n    // TODO(arv): Overwriting the filter might have undesired side effects.\n    if (alpha === '') {\n      style.filter = '';\n    } else {\n      style.filter = 'alpha(opacity=' + (Number(alpha) * 100) + ')';\n    }\n  }\n};\n\n\n/**\n * Sets the background of an element to a transparent image in a browser-\n * independent manner.\n *\n * This function does not support repeating backgrounds or alternate background\n * positions to match the behavior of Internet Explorer. It also does not\n * support sizingMethods other than crop since they cannot be replicated in\n * browsers other than Internet Explorer.\n *\n * @param {Element} el The element to set background on.\n * @param {string} src The image source URL.\n */\ngoog.style.setTransparentBackgroundImage = function(el, src) {\n  var style = el.style;\n  // It is safe to use the style.filter in IE only. In Safari 'filter' is in\n  // style object but access to style.filter causes it to throw an exception.\n  // Note: IE8 supports images with an alpha channel.\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('8')) {\n    // See TODO in setOpacity.\n    style.filter = 'progid:DXImageTransform.Microsoft.AlphaImageLoader(' +\n        'src=\"' + src + '\", sizingMethod=\"crop\")';\n  } else {\n    // Set style properties individually instead of using background shorthand\n    // to prevent overwriting a pre-existing background color.\n    style.backgroundImage = 'url(' + src + ')';\n    style.backgroundPosition = 'top left';\n    style.backgroundRepeat = 'no-repeat';\n  }\n};\n\n\n/**\n * Clears the background image of an element in a browser independent manner.\n * @param {Element} el The element to clear background image for.\n */\ngoog.style.clearTransparentBackgroundImage = function(el) {\n  var style = el.style;\n  if ('filter' in style) {\n    // See TODO in setOpacity.\n    style.filter = '';\n  } else {\n    // Set style properties individually instead of using background shorthand\n    // to prevent overwriting a pre-existing background color.\n    style.backgroundImage = 'none';\n  }\n};\n\n\n/**\n * Shows or hides an element from the page. Hiding the element is done by\n * setting the display property to \"none\", removing the element from the\n * rendering hierarchy so it takes up no space. To show the element, the default\n * inherited display property is restored (defined either in stylesheets or by\n * the browser's default style rules.)\n *\n * Caveat 1: if the inherited display property for the element is set to \"none\"\n * by the stylesheets, that is the property that will be restored by a call to\n * showElement(), effectively toggling the display between \"none\" and \"none\".\n *\n * Caveat 2: if the element display style is set inline (by setting either\n * element.style.display or a style attribute in the HTML), a call to\n * showElement will clear that setting and defer to the inherited style in the\n * stylesheet.\n * @param {Element} el Element to show or hide.\n * @param {*} display True to render the element in its default style,\n *     false to disable rendering the element.\n * @deprecated Use goog.style.setElementShown instead.\n */\ngoog.style.showElement = function(el, display) {\n  goog.style.setElementShown(el, display);\n};\n\n\n/**\n * Shows or hides an element from the page. Hiding the element is done by\n * setting the display property to \"none\", removing the element from the\n * rendering hierarchy so it takes up no space. To show the element, the default\n * inherited display property is restored (defined either in stylesheets or by\n * the browser's default style rules).\n *\n * Caveat 1: if the inherited display property for the element is set to \"none\"\n * by the stylesheets, that is the property that will be restored by a call to\n * setElementShown(), effectively toggling the display between \"none\" and\n * \"none\".\n *\n * Caveat 2: if the element display style is set inline (by setting either\n * element.style.display or a style attribute in the HTML), a call to\n * setElementShown will clear that setting and defer to the inherited style in\n * the stylesheet.\n * @param {Element} el Element to show or hide.\n * @param {*} isShown True to render the element in its default style,\n *     false to disable rendering the element.\n */\ngoog.style.setElementShown = function(el, isShown) {\n  el.style.display = isShown ? '' : 'none';\n};\n\n\n/**\n * Test whether the given element has been shown or hidden via a call to\n * {@link #setElementShown}.\n *\n * Note this is strictly a companion method for a call\n * to {@link #setElementShown} and the same caveats apply; in particular, this\n * method does not guarantee that the return value will be consistent with\n * whether or not the element is actually visible.\n *\n * @param {Element} el The element to test.\n * @return {boolean} Whether the element has been shown.\n * @see #setElementShown\n */\ngoog.style.isElementShown = function(el) {\n  return el.style.display != 'none';\n};\n\n\n/**\n * Installs the style sheet into the window that contains opt_node.  If\n * opt_node is null, the main window is used.\n * @param {!goog.html.SafeStyleSheet} safeStyleSheet The style sheet to install.\n * @param {?Node=} opt_node Node whose parent document should have the\n *     styles installed.\n * @return {!HTMLStyleElement|!StyleSheet} In IE<11, a StyleSheet object with no\n *     owning &lt;style&gt; tag (this is how IE creates style sheets).  In every\n *     other browser, a &lt;style&gt; element with an attached style.  This\n *     doesn't return a StyleSheet object so that setSafeStyleSheet can replace\n *     it (otherwise, if you pass a StyleSheet to setSafeStyleSheet, it will\n *     make a new StyleSheet and leave the original StyleSheet orphaned).\n */\ngoog.style.installSafeStyleSheet = function(safeStyleSheet, opt_node) {\n  var dh = goog.dom.getDomHelper(opt_node);\n\n  // IE < 11 requires createStyleSheet. Note that doc.createStyleSheet will be\n  // undefined as of IE 11.\n  var doc = dh.getDocument();\n  if (goog.userAgent.IE && doc.createStyleSheet) {\n    /** @type {(!HTMLStyleElement|!StyleSheet)} */\n    var styleSheet = doc.createStyleSheet();\n    goog.style.setSafeStyleSheet(styleSheet, safeStyleSheet);\n    return styleSheet;\n  } else {\n    var head = dh.getElementsByTagNameAndClass(goog.dom.TagName.HEAD)[0];\n\n    // In opera documents are not guaranteed to have a head element, thus we\n    // have to make sure one exists before using it.\n    if (!head) {\n      var body = dh.getElementsByTagNameAndClass(goog.dom.TagName.BODY)[0];\n      head = dh.createDom(goog.dom.TagName.HEAD);\n      body.parentNode.insertBefore(head, body);\n    }\n    var el = dh.createDom(goog.dom.TagName.STYLE);\n    // NOTE(user): Setting styles after the style element has been appended\n    // to the head results in a nasty Webkit bug in certain scenarios. Please\n    // refer to https://bugs.webkit.org/show_bug.cgi?id=26307 for additional\n    // details.\n    goog.style.setSafeStyleSheet(el, safeStyleSheet);\n    dh.appendChild(head, el);\n    return el;\n  }\n};\n\n\n/**\n * Removes the styles added by {@link #installStyles}.\n * @param {Element|StyleSheet} styleSheet The value returned by\n *     {@link #installStyles}.\n */\ngoog.style.uninstallStyles = function(styleSheet) {\n  var node = styleSheet.ownerNode || styleSheet.owningElement ||\n      /** @type {Element} */ (styleSheet);\n  goog.dom.removeNode(node);\n};\n\n\n/**\n * Sets the content of a style element.  The style element can be any valid\n * style element.  This element will have its content completely replaced by\n * the safeStyleSheet.\n * @param {!Element|!StyleSheet} element A stylesheet element as returned by\n *     installStyles.\n * @param {!goog.html.SafeStyleSheet} safeStyleSheet The new content of the\n *     stylesheet.\n */\ngoog.style.setSafeStyleSheet = function(element, safeStyleSheet) {\n  var stylesString = goog.html.SafeStyleSheet.unwrap(safeStyleSheet);\n  if (goog.userAgent.IE && goog.isDef(element.cssText)) {\n    // Adding the selectors individually caused the browser to hang if the\n    // selector was invalid or there were CSS comments.  Setting the cssText of\n    // the style node works fine and ignores CSS that IE doesn't understand.\n    // However IE >= 11 doesn't support cssText any more, so we make sure that\n    // cssText is a defined property and otherwise fall back to innerHTML.\n    element.cssText = stylesString;\n  } else {\n    // Setting textContent doesn't work in Safari, see b/29340337.\n    element.innerHTML = stylesString;\n  }\n};\n\n\n/**\n * Sets 'white-space: pre-wrap' for a node (x-browser).\n *\n * There are as many ways of specifying pre-wrap as there are browsers.\n *\n * CSS3/IE8: white-space: pre-wrap;\n * Mozilla:  white-space: -moz-pre-wrap;\n * Opera:    white-space: -o-pre-wrap;\n * IE6/7:    white-space: pre; word-wrap: break-word;\n *\n * @param {Element} el Element to enable pre-wrap for.\n */\ngoog.style.setPreWrap = function(el) {\n  var style = el.style;\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('8')) {\n    style.whiteSpace = 'pre';\n    style.wordWrap = 'break-word';\n  } else if (goog.userAgent.GECKO) {\n    style.whiteSpace = '-moz-pre-wrap';\n  } else {\n    style.whiteSpace = 'pre-wrap';\n  }\n};\n\n\n/**\n * Sets 'display: inline-block' for an element (cross-browser).\n * @param {Element} el Element to which the inline-block display style is to be\n *    applied.\n * @see ../demos/inline_block_quirks.html\n * @see ../demos/inline_block_standards.html\n */\ngoog.style.setInlineBlock = function(el) {\n  var style = el.style;\n  // Without position:relative, weirdness ensues.  Just accept it and move on.\n  style.position = 'relative';\n\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('8')) {\n    // IE8 supports inline-block so fall through to the else\n    // Zoom:1 forces hasLayout, display:inline gives inline behavior.\n    style.zoom = '1';\n    style.display = 'inline';\n  } else {\n    // Opera, Webkit, and Safari seem to do OK with the standard inline-block\n    // style.\n    style.display = 'inline-block';\n  }\n};\n\n\n/**\n * Returns true if the element is using right to left (rtl) direction.\n * @param {Element} el  The element to test.\n * @return {boolean} True for right to left, false for left to right.\n */\ngoog.style.isRightToLeft = function(el) {\n  return 'rtl' == goog.style.getStyle_(el, 'direction');\n};\n\n\n/**\n * The CSS style property corresponding to an element being\n * unselectable on the current browser platform (null if none).\n * Opera and IE instead use a DOM attribute 'unselectable'. MS Edge uses\n * the Webkit prefix.\n * @type {?string}\n * @private\n */\ngoog.style.unselectableStyle_ = goog.userAgent.GECKO ?\n    'MozUserSelect' :\n    goog.userAgent.WEBKIT || goog.userAgent.EDGE ? 'WebkitUserSelect' : null;\n\n\n/**\n * Returns true if the element is set to be unselectable, false otherwise.\n * Note that on some platforms (e.g. Mozilla), even if an element isn't set\n * to be unselectable, it will behave as such if any of its ancestors is\n * unselectable.\n * @param {Element} el  Element to check.\n * @return {boolean}  Whether the element is set to be unselectable.\n */\ngoog.style.isUnselectable = function(el) {\n  if (goog.style.unselectableStyle_) {\n    return el.style[goog.style.unselectableStyle_].toLowerCase() == 'none';\n  } else if (goog.userAgent.IE || goog.userAgent.OPERA) {\n    return el.getAttribute('unselectable') == 'on';\n  }\n  return false;\n};\n\n\n/**\n * Makes the element and its descendants selectable or unselectable.  Note\n * that on some platforms (e.g. Mozilla), even if an element isn't set to\n * be unselectable, it will behave as such if any of its ancestors is\n * unselectable.\n * @param {Element} el  The element to alter.\n * @param {boolean} unselectable  Whether the element and its descendants\n *     should be made unselectable.\n * @param {boolean=} opt_noRecurse  Whether to only alter the element's own\n *     selectable state, and leave its descendants alone; defaults to false.\n */\ngoog.style.setUnselectable = function(el, unselectable, opt_noRecurse) {\n  // TODO(attila): Do we need all of TR_DomUtil.makeUnselectable() in Closure?\n  var descendants = !opt_noRecurse ? el.getElementsByTagName('*') : null;\n  var name = goog.style.unselectableStyle_;\n  if (name) {\n    // Add/remove the appropriate CSS style to/from the element and its\n    // descendants.\n    var value = unselectable ? 'none' : '';\n    // MathML elements do not have a style property. Verify before setting.\n    if (el.style) {\n      el.style[name] = value;\n    }\n    if (descendants) {\n      for (var i = 0, descendant; descendant = descendants[i]; i++) {\n        if (descendant.style) {\n          descendant.style[name] = value;\n        }\n      }\n    }\n  } else if (goog.userAgent.IE || goog.userAgent.OPERA) {\n    // Toggle the 'unselectable' attribute on the element and its descendants.\n    var value = unselectable ? 'on' : '';\n    el.setAttribute('unselectable', value);\n    if (descendants) {\n      for (var i = 0, descendant; descendant = descendants[i]; i++) {\n        descendant.setAttribute('unselectable', value);\n      }\n    }\n  }\n};\n\n\n/**\n * Gets the border box size for an element.\n * @param {Element} element  The element to get the size for.\n * @return {!goog.math.Size} The border box size.\n */\ngoog.style.getBorderBoxSize = function(element) {\n  return new goog.math.Size(\n      /** @type {!HTMLElement} */ (element).offsetWidth,\n      /** @type {!HTMLElement} */ (element).offsetHeight);\n};\n\n\n/**\n * Sets the border box size of an element. This is potentially expensive in IE\n * if the document is CSS1Compat mode\n * @param {Element} element  The element to set the size on.\n * @param {goog.math.Size} size  The new size.\n */\ngoog.style.setBorderBoxSize = function(element, size) {\n  var doc = goog.dom.getOwnerDocument(element);\n  var isCss1CompatMode = goog.dom.getDomHelper(doc).isCss1CompatMode();\n\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('10') &&\n      (!isCss1CompatMode || !goog.userAgent.isVersionOrHigher('8'))) {\n    var style = element.style;\n    if (isCss1CompatMode) {\n      var paddingBox = goog.style.getPaddingBox(element);\n      var borderBox = goog.style.getBorderBox(element);\n      style.pixelWidth = size.width - borderBox.left - paddingBox.left -\n          paddingBox.right - borderBox.right;\n      style.pixelHeight = size.height - borderBox.top - paddingBox.top -\n          paddingBox.bottom - borderBox.bottom;\n    } else {\n      style.pixelWidth = size.width;\n      style.pixelHeight = size.height;\n    }\n  } else {\n    goog.style.setBoxSizingSize_(element, size, 'border-box');\n  }\n};\n\n\n/**\n * Gets the content box size for an element.  This is potentially expensive in\n * all browsers.\n * @param {Element} element  The element to get the size for.\n * @return {!goog.math.Size} The content box size.\n */\ngoog.style.getContentBoxSize = function(element) {\n  var doc = goog.dom.getOwnerDocument(element);\n  var ieCurrentStyle = goog.userAgent.IE && element.currentStyle;\n  if (ieCurrentStyle && goog.dom.getDomHelper(doc).isCss1CompatMode() &&\n      ieCurrentStyle.width != 'auto' && ieCurrentStyle.height != 'auto' &&\n      !ieCurrentStyle.boxSizing) {\n    // If IE in CSS1Compat mode than just use the width and height.\n    // If we have a boxSizing then fall back on measuring the borders etc.\n    var width = goog.style.getIePixelValue_(\n        element, /** @type {string} */ (ieCurrentStyle.width), 'width',\n        'pixelWidth');\n    var height = goog.style.getIePixelValue_(\n        element, /** @type {string} */ (ieCurrentStyle.height), 'height',\n        'pixelHeight');\n    return new goog.math.Size(width, height);\n  } else {\n    var borderBoxSize = goog.style.getBorderBoxSize(element);\n    var paddingBox = goog.style.getPaddingBox(element);\n    var borderBox = goog.style.getBorderBox(element);\n    return new goog.math.Size(\n        borderBoxSize.width - borderBox.left - paddingBox.left -\n            paddingBox.right - borderBox.right,\n        borderBoxSize.height - borderBox.top - paddingBox.top -\n            paddingBox.bottom - borderBox.bottom);\n  }\n};\n\n\n/**\n * Sets the content box size of an element. This is potentially expensive in IE\n * if the document is BackCompat mode.\n * @param {Element} element  The element to set the size on.\n * @param {goog.math.Size} size  The new size.\n */\ngoog.style.setContentBoxSize = function(element, size) {\n  var doc = goog.dom.getOwnerDocument(element);\n  var isCss1CompatMode = goog.dom.getDomHelper(doc).isCss1CompatMode();\n  if (goog.userAgent.IE && !goog.userAgent.isVersionOrHigher('10') &&\n      (!isCss1CompatMode || !goog.userAgent.isVersionOrHigher('8'))) {\n    var style = element.style;\n    if (isCss1CompatMode) {\n      style.pixelWidth = size.width;\n      style.pixelHeight = size.height;\n    } else {\n      var paddingBox = goog.style.getPaddingBox(element);\n      var borderBox = goog.style.getBorderBox(element);\n      style.pixelWidth = size.width + borderBox.left + paddingBox.left +\n          paddingBox.right + borderBox.right;\n      style.pixelHeight = size.height + borderBox.top + paddingBox.top +\n          paddingBox.bottom + borderBox.bottom;\n    }\n  } else {\n    goog.style.setBoxSizingSize_(element, size, 'content-box');\n  }\n};\n\n\n/**\n * Helper function that sets the box sizing as well as the width and height\n * @param {Element} element  The element to set the size on.\n * @param {goog.math.Size} size  The new size to set.\n * @param {string} boxSizing  The box-sizing value.\n * @private\n */\ngoog.style.setBoxSizingSize_ = function(element, size, boxSizing) {\n  var style = element.style;\n  if (goog.userAgent.GECKO) {\n    style.MozBoxSizing = boxSizing;\n  } else if (goog.userAgent.WEBKIT) {\n    style.WebkitBoxSizing = boxSizing;\n  } else {\n    // Includes IE8 and Opera 9.50+\n    style.boxSizing = boxSizing;\n  }\n\n  // Setting this to a negative value will throw an exception on IE\n  // (and doesn't do anything different than setting it to 0).\n  style.width = Math.max(size.width, 0) + 'px';\n  style.height = Math.max(size.height, 0) + 'px';\n};\n\n\n/**\n * IE specific function that converts a non pixel unit to pixels.\n * @param {Element} element  The element to convert the value for.\n * @param {string} value  The current value as a string. The value must not be\n *     ''.\n * @param {string} name  The CSS property name to use for the converstion. This\n *     should be 'left', 'top', 'width' or 'height'.\n * @param {string} pixelName  The CSS pixel property name to use to get the\n *     value in pixels.\n * @return {number} The value in pixels.\n * @private\n */\ngoog.style.getIePixelValue_ = function(element, value, name, pixelName) {\n  // Try if we already have a pixel value. IE does not do half pixels so we\n  // only check if it matches a number followed by 'px'.\n  if (/^\\d+px?$/.test(value)) {\n    return parseInt(value, 10);\n  } else {\n    var oldStyleValue = element.style[name];\n    var oldRuntimeValue = element.runtimeStyle[name];\n    // set runtime style to prevent changes\n    element.runtimeStyle[name] = element.currentStyle[name];\n    element.style[name] = value;\n    var pixelValue = element.style[pixelName];\n    // restore\n    element.style[name] = oldStyleValue;\n    element.runtimeStyle[name] = oldRuntimeValue;\n    return +pixelValue;\n  }\n};\n\n\n/**\n * Helper function for getting the pixel padding or margin for IE.\n * @param {Element} element  The element to get the padding for.\n * @param {string} propName  The property name.\n * @return {number} The pixel padding.\n * @private\n */\ngoog.style.getIePixelDistance_ = function(element, propName) {\n  var value = goog.style.getCascadedStyle(element, propName);\n  return value ?\n      goog.style.getIePixelValue_(element, value, 'left', 'pixelLeft') :\n      0;\n};\n\n\n/**\n * Gets the computed paddings or margins (on all sides) in pixels.\n * @param {Element} element  The element to get the padding for.\n * @param {string} stylePrefix  Pass 'padding' to retrieve the padding box,\n *     or 'margin' to retrieve the margin box.\n * @return {!goog.math.Box} The computed paddings or margins.\n * @private\n */\ngoog.style.getBox_ = function(element, stylePrefix) {\n  if (goog.userAgent.IE) {\n    var left = goog.style.getIePixelDistance_(element, stylePrefix + 'Left');\n    var right = goog.style.getIePixelDistance_(element, stylePrefix + 'Right');\n    var top = goog.style.getIePixelDistance_(element, stylePrefix + 'Top');\n    var bottom =\n        goog.style.getIePixelDistance_(element, stylePrefix + 'Bottom');\n    return new goog.math.Box(top, right, bottom, left);\n  } else {\n    // On non-IE browsers, getComputedStyle is always non-null.\n    var left = goog.style.getComputedStyle(element, stylePrefix + 'Left');\n    var right = goog.style.getComputedStyle(element, stylePrefix + 'Right');\n    var top = goog.style.getComputedStyle(element, stylePrefix + 'Top');\n    var bottom = goog.style.getComputedStyle(element, stylePrefix + 'Bottom');\n\n    // NOTE(arv): Gecko can return floating point numbers for the computed\n    // style values.\n    return new goog.math.Box(\n        parseFloat(top), parseFloat(right), parseFloat(bottom),\n        parseFloat(left));\n  }\n};\n\n\n/**\n * Gets the computed paddings (on all sides) in pixels.\n * @param {Element} element  The element to get the padding for.\n * @return {!goog.math.Box} The computed paddings.\n */\ngoog.style.getPaddingBox = function(element) {\n  return goog.style.getBox_(element, 'padding');\n};\n\n\n/**\n * Gets the computed margins (on all sides) in pixels.\n * @param {Element} element  The element to get the margins for.\n * @return {!goog.math.Box} The computed margins.\n */\ngoog.style.getMarginBox = function(element) {\n  return goog.style.getBox_(element, 'margin');\n};\n\n\n/**\n * A map used to map the border width keywords to a pixel width.\n * @type {!Object}\n * @private\n */\ngoog.style.ieBorderWidthKeywords_ = {\n  'thin': 2,\n  'medium': 4,\n  'thick': 6\n};\n\n\n/**\n * Helper function for IE to get the pixel border.\n * @param {Element} element  The element to get the pixel border for.\n * @param {string} prop  The part of the property name.\n * @return {number} The value in pixels.\n * @private\n */\ngoog.style.getIePixelBorder_ = function(element, prop) {\n  if (goog.style.getCascadedStyle(element, prop + 'Style') == 'none') {\n    return 0;\n  }\n  var width = goog.style.getCascadedStyle(element, prop + 'Width');\n  if (width in goog.style.ieBorderWidthKeywords_) {\n    return goog.style.ieBorderWidthKeywords_[width];\n  }\n  return goog.style.getIePixelValue_(element, width, 'left', 'pixelLeft');\n};\n\n\n/**\n * Gets the computed border widths (on all sides) in pixels\n * @param {Element} element  The element to get the border widths for.\n * @return {!goog.math.Box} The computed border widths.\n */\ngoog.style.getBorderBox = function(element) {\n  if (goog.userAgent.IE && !goog.userAgent.isDocumentModeOrHigher(9)) {\n    var left = goog.style.getIePixelBorder_(element, 'borderLeft');\n    var right = goog.style.getIePixelBorder_(element, 'borderRight');\n    var top = goog.style.getIePixelBorder_(element, 'borderTop');\n    var bottom = goog.style.getIePixelBorder_(element, 'borderBottom');\n    return new goog.math.Box(top, right, bottom, left);\n  } else {\n    // On non-IE browsers, getComputedStyle is always non-null.\n    var left = goog.style.getComputedStyle(element, 'borderLeftWidth');\n    var right = goog.style.getComputedStyle(element, 'borderRightWidth');\n    var top = goog.style.getComputedStyle(element, 'borderTopWidth');\n    var bottom = goog.style.getComputedStyle(element, 'borderBottomWidth');\n\n    return new goog.math.Box(\n        parseFloat(top), parseFloat(right), parseFloat(bottom),\n        parseFloat(left));\n  }\n};\n\n\n/**\n * Returns the font face applied to a given node. Opera and IE should return\n * the font actually displayed. Firefox returns the author's most-preferred\n * font (whether the browser is capable of displaying it or not.)\n * @param {Element} el  The element whose font family is returned.\n * @return {string} The font family applied to el.\n */\ngoog.style.getFontFamily = function(el) {\n  var doc = goog.dom.getOwnerDocument(el);\n  var font = '';\n  // The moveToElementText method from the TextRange only works if the element\n  // is attached to the owner document.\n  if (doc.body.createTextRange && goog.dom.contains(doc, el)) {\n    var range = doc.body.createTextRange();\n    range.moveToElementText(el);\n\n    try {\n      font = range.queryCommandValue('FontName');\n    } catch (e) {\n      // This is a workaround for a awkward exception.\n      // On some IE, there is an exception coming from it.\n      // The error description from this exception is:\n      // This window has already been registered as a drop target\n      // This is bogus description, likely due to a bug in ie.\n      font = '';\n    }\n  }\n  if (!font) {\n    // Note if for some reason IE can't derive FontName with a TextRange, we\n    // fallback to using currentStyle\n    font = goog.style.getStyle_(el, 'fontFamily');\n  }\n\n  // Firefox returns the applied font-family string (author's list of\n  // preferred fonts.) We want to return the most-preferred font, in lieu of\n  // the *actually* applied font.\n  var fontsArray = font.split(',');\n  if (fontsArray.length > 1) font = fontsArray[0];\n\n  // Sanitize for x-browser consistency:\n  // Strip quotes because browsers aren't consistent with how they're\n  // applied; Opera always encloses, Firefox sometimes, and IE never.\n  return goog.string.stripQuotes(font, '\"\\'');\n};\n\n\n/**\n * Regular expression used for getLengthUnits.\n * @type {RegExp}\n * @private\n */\ngoog.style.lengthUnitRegex_ = /[^\\d]+$/;\n\n\n/**\n * Returns the units used for a CSS length measurement.\n * @param {string} value  A CSS length quantity.\n * @return {?string} The units of measurement.\n */\ngoog.style.getLengthUnits = function(value) {\n  var units = value.match(goog.style.lengthUnitRegex_);\n  return units && units[0] || null;\n};\n\n\n/**\n * Map of absolute CSS length units\n * @type {!Object}\n * @private\n */\ngoog.style.ABSOLUTE_CSS_LENGTH_UNITS_ = {\n  'cm': 1,\n  'in': 1,\n  'mm': 1,\n  'pc': 1,\n  'pt': 1\n};\n\n\n/**\n * Map of relative CSS length units that can be accurately converted to px\n * font-size values using getIePixelValue_. Only units that are defined in\n * relation to a font size are convertible (%, small, etc. are not).\n * @type {!Object}\n * @private\n */\ngoog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_ = {\n  'em': 1,\n  'ex': 1\n};\n\n\n/**\n * Returns the font size, in pixels, of text in an element.\n * @param {Element} el  The element whose font size is returned.\n * @return {number} The font size (in pixels).\n */\ngoog.style.getFontSize = function(el) {\n  var fontSize = goog.style.getStyle_(el, 'fontSize');\n  var sizeUnits = goog.style.getLengthUnits(fontSize);\n  if (fontSize && 'px' == sizeUnits) {\n    // NOTE(user): This could be parseFloat instead, but IE doesn't return\n    // decimal fractions in getStyle_ and Firefox reports the fractions, but\n    // ignores them when rendering. Interestingly enough, when we force the\n    // issue and size something to e.g., 50% of 25px, the browsers round in\n    // opposite directions with Firefox reporting 12px and IE 13px. I punt.\n    return parseInt(fontSize, 10);\n  }\n\n  // In IE, we can convert absolute length units to a px value using\n  // goog.style.getIePixelValue_. Units defined in relation to a font size\n  // (em, ex) are applied relative to the element's parentNode and can also\n  // be converted.\n  if (goog.userAgent.IE) {\n    if (String(sizeUnits) in goog.style.ABSOLUTE_CSS_LENGTH_UNITS_) {\n      return goog.style.getIePixelValue_(el, fontSize, 'left', 'pixelLeft');\n    } else if (\n        el.parentNode && el.parentNode.nodeType == goog.dom.NodeType.ELEMENT &&\n        String(sizeUnits) in goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_) {\n      // Check the parent size - if it is the same it means the relative size\n      // value is inherited and we therefore don't want to count it twice.  If\n      // it is different, this element either has explicit style or has a CSS\n      // rule applying to it.\n      var parentElement = /** @type {!Element} */ (el.parentNode);\n      var parentSize = goog.style.getStyle_(parentElement, 'fontSize');\n      return goog.style.getIePixelValue_(\n          parentElement, fontSize == parentSize ? '1em' : fontSize, 'left',\n          'pixelLeft');\n    }\n  }\n\n  // Sometimes we can't cleanly find the font size (some units relative to a\n  // node's parent's font size are difficult: %, smaller et al), so we create\n  // an invisible, absolutely-positioned span sized to be the height of an 'M'\n  // rendered in its parent's (i.e., our target element's) font size. This is\n  // the definition of CSS's font size attribute.\n  var sizeElement = goog.dom.createDom(goog.dom.TagName.SPAN, {\n    'style': 'visibility:hidden;position:absolute;' +\n        'line-height:0;padding:0;margin:0;border:0;height:1em;'\n  });\n  goog.dom.appendChild(el, sizeElement);\n  fontSize = sizeElement.offsetHeight;\n  goog.dom.removeNode(sizeElement);\n\n  return fontSize;\n};\n\n\n/**\n * Parses a style attribute value.  Converts CSS property names to camel case.\n * @param {string} value The style attribute value.\n * @return {!Object} Map of CSS properties to string values.\n */\ngoog.style.parseStyleAttribute = function(value) {\n  var result = {};\n  goog.array.forEach(value.split(/\\s*;\\s*/), function(pair) {\n    var keyValue = pair.match(/\\s*([\\w-]+)\\s*\\:(.+)/);\n    if (keyValue) {\n      var styleName = keyValue[1];\n      var styleValue = goog.string.trim(keyValue[2]);\n      result[goog.string.toCamelCase(styleName.toLowerCase())] = styleValue;\n    }\n  });\n  return result;\n};\n\n\n/**\n * Reverse of parseStyleAttribute; that is, takes a style object and returns the\n * corresponding attribute value.  Converts camel case property names to proper\n * CSS selector names.\n * @param {Object} obj Map of CSS properties to values.\n * @return {string} The style attribute value.\n */\ngoog.style.toStyleAttribute = function(obj) {\n  var buffer = [];\n  goog.object.forEach(obj, function(value, key) {\n    buffer.push(goog.string.toSelectorCase(key), ':', value, ';');\n  });\n  return buffer.join('');\n};\n\n\n/**\n * Sets CSS float property on an element.\n * @param {Element} el The element to set float property on.\n * @param {string} value The value of float CSS property to set on this element.\n */\ngoog.style.setFloat = function(el, value) {\n  el.style[goog.userAgent.IE ? 'styleFloat' : 'cssFloat'] = value;\n};\n\n\n/**\n * Gets value of explicitly-set float CSS property on an element.\n * @param {Element} el The element to get float property of.\n * @return {string} The value of explicitly-set float CSS property on this\n *     element.\n */\ngoog.style.getFloat = function(el) {\n  return el.style[goog.userAgent.IE ? 'styleFloat' : 'cssFloat'] || '';\n};\n\n\n/**\n * Returns the scroll bar width (represents the width of both horizontal\n * and vertical scroll).\n *\n * @param {string=} opt_className An optional class name (or names) to apply\n *     to the invisible div created to measure the scrollbar. This is necessary\n *     if some scrollbars are styled differently than others.\n * @return {number} The scroll bar width in px.\n */\ngoog.style.getScrollbarWidth = function(opt_className) {\n  // Add two hidden divs.  The child div is larger than the parent and\n  // forces scrollbars to appear on it.\n  // Using overflow:scroll does not work consistently with scrollbars that\n  // are styled with ::-webkit-scrollbar.\n  var outerDiv = goog.dom.createElement(goog.dom.TagName.DIV);\n  if (opt_className) {\n    outerDiv.className = opt_className;\n  }\n  outerDiv.style.cssText = 'overflow:auto;' +\n      'position:absolute;top:0;width:100px;height:100px';\n  var innerDiv = goog.dom.createElement(goog.dom.TagName.DIV);\n  goog.style.setSize(innerDiv, '200px', '200px');\n  outerDiv.appendChild(innerDiv);\n  goog.dom.appendChild(goog.dom.getDocument().body, outerDiv);\n  var width = outerDiv.offsetWidth - outerDiv.clientWidth;\n  goog.dom.removeNode(outerDiv);\n  return width;\n};\n\n\n/**\n * Regular expression to extract x and y translation components from a CSS\n * transform Matrix representation.\n *\n * @type {!RegExp}\n * @const\n * @private\n */\ngoog.style.MATRIX_TRANSLATION_REGEX_ = new RegExp(\n    'matrix\\\\([0-9\\\\.\\\\-]+, [0-9\\\\.\\\\-]+, ' +\n    '[0-9\\\\.\\\\-]+, [0-9\\\\.\\\\-]+, ' +\n    '([0-9\\\\.\\\\-]+)p?x?, ([0-9\\\\.\\\\-]+)p?x?\\\\)');\n\n\n/**\n * Returns the x,y translation component of any CSS transforms applied to the\n * element, in pixels.\n *\n * @param {!Element} element The element to get the translation of.\n * @return {!goog.math.Coordinate} The CSS translation of the element in px.\n */\ngoog.style.getCssTranslation = function(element) {\n  var transform = goog.style.getComputedTransform(element);\n  if (!transform) {\n    return new goog.math.Coordinate(0, 0);\n  }\n  var matches = transform.match(goog.style.MATRIX_TRANSLATION_REGEX_);\n  if (!matches) {\n    return new goog.math.Coordinate(0, 0);\n  }\n  return new goog.math.Coordinate(\n      parseFloat(matches[1]), parseFloat(matches[2]));\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Animated zippy widget implementation.\n *\n * @author eae@google.com (Emil A Eklund)\n * @see ../demos/zippy.html\n */\n\ngoog.provide('goog.ui.AnimatedZippy');\n\ngoog.require('goog.a11y.aria.Role');\ngoog.require('goog.dom');\ngoog.require('goog.dom.TagName');\ngoog.require('goog.events');\ngoog.require('goog.fx.Animation');\ngoog.require('goog.fx.Transition');\ngoog.require('goog.fx.easing');\ngoog.require('goog.ui.Zippy');\ngoog.require('goog.ui.ZippyEvent');\n\n\n\n/**\n * Zippy widget. Expandable/collapsible container, clicking the header toggles\n * the visibility of the content.\n *\n * @param {Element|string|null} header Header element, either element\n *     reference, string id or null if no header exists.\n * @param {Element|string} content Content element, either element reference or\n *     string id.\n * @param {boolean=} opt_expanded Initial expanded/visibility state. Defaults to\n *     false.\n * @param {goog.dom.DomHelper=} opt_domHelper An optional DOM helper.\n * @param {goog.a11y.aria.Role<string>=} opt_role ARIA role, default TAB.\n * @constructor\n * @extends {goog.ui.Zippy}\n */\ngoog.ui.AnimatedZippy = function(\n    header, content, opt_expanded, opt_domHelper, opt_role) {\n  var domHelper = opt_domHelper || goog.dom.getDomHelper();\n\n  // Create wrapper element and move content into it.\n  var elWrapper =\n      domHelper.createDom(goog.dom.TagName.DIV, {'style': 'overflow:hidden'});\n  var elContent = domHelper.getElement(content);\n  elContent.parentNode.replaceChild(elWrapper, elContent);\n  elWrapper.appendChild(elContent);\n\n  /**\n   * Content wrapper, used for animation.\n   * @type {Element}\n   * @private\n   */\n  this.elWrapper_ = elWrapper;\n\n  /**\n   * Reference to animation or null if animation is not active.\n   * @type {goog.fx.Animation}\n   * @private\n   */\n  this.anim_ = null;\n\n  // Call constructor of super class.\n  goog.ui.Zippy.call(\n      this, header, elContent, opt_expanded, undefined, domHelper, opt_role);\n\n  // Set initial state.\n  // NOTE: Set the class names as well otherwise animated zippys\n  // start with empty class names.\n  var expanded = this.isExpanded();\n  this.elWrapper_.style.display = expanded ? '' : 'none';\n  this.updateHeaderClassName(expanded);\n};\ngoog.inherits(goog.ui.AnimatedZippy, goog.ui.Zippy);\ngoog.tagUnsealableClass(goog.ui.AnimatedZippy);\n\n\n/**\n * Constants for event names.\n *\n * @const\n */\ngoog.ui.AnimatedZippy.Events = {\n  // The beginning of the animation when the zippy state toggles.\n  TOGGLE_ANIMATION_BEGIN: goog.events.getUniqueId('toggleanimationbegin'),\n  // The end of the animation when the zippy state toggles.\n  TOGGLE_ANIMATION_END: goog.events.getUniqueId('toggleanimationend')\n};\n\n\n/**\n * Duration of expand/collapse animation, in milliseconds.\n * @type {number}\n */\ngoog.ui.AnimatedZippy.prototype.animationDuration = 500;\n\n\n/**\n * Acceleration function for expand/collapse animation.\n * @type {!Function}\n */\ngoog.ui.AnimatedZippy.prototype.animationAcceleration = goog.fx.easing.easeOut;\n\n\n/**\n * @return {boolean} Whether the zippy is in the process of being expanded or\n *     collapsed.\n */\ngoog.ui.AnimatedZippy.prototype.isBusy = function() {\n  return this.anim_ != null;\n};\n\n\n/**\n * Sets expanded state.\n *\n * @param {boolean} expanded Expanded/visibility state.\n * @override\n */\ngoog.ui.AnimatedZippy.prototype.setExpanded = function(expanded) {\n  if (this.isExpanded() == expanded && !this.anim_) {\n    return;\n  }\n\n  // Reset display property of wrapper to allow content element to be\n  // measured.\n  if (this.elWrapper_.style.display == 'none') {\n    this.elWrapper_.style.display = '';\n  }\n\n  // Measure content element.\n  var h = this.getContentElement().offsetHeight;\n\n  // Stop active animation (if any) and determine starting height.\n  var startH = 0;\n  if (this.anim_) {\n    expanded = this.isExpanded();\n    goog.events.removeAll(this.anim_);\n    this.anim_.stop(false);\n\n    var marginTop = parseInt(this.getContentElement().style.marginTop, 10);\n    startH = h - Math.abs(marginTop);\n  } else {\n    startH = expanded ? 0 : h;\n  }\n\n  // Updates header class name after the animation has been stopped.\n  this.updateHeaderClassName(expanded);\n\n  // Set up expand/collapse animation.\n  this.anim_ = new goog.fx.Animation(\n      [0, startH], [0, expanded ? h : 0], this.animationDuration,\n      this.animationAcceleration);\n\n  var events = [\n    goog.fx.Transition.EventType.BEGIN, goog.fx.Animation.EventType.ANIMATE,\n    goog.fx.Transition.EventType.END\n  ];\n  goog.events.listen(this.anim_, events, this.onAnimate_, false, this);\n  goog.events.listen(\n      this.anim_, goog.fx.Transition.EventType.BEGIN,\n      goog.bind(this.onAnimationBegin_, this, expanded));\n  goog.events.listen(\n      this.anim_, goog.fx.Transition.EventType.END,\n      goog.bind(this.onAnimationCompleted_, this, expanded));\n\n  // Start animation.\n  this.anim_.play(false);\n};\n\n\n/**\n * Called during animation\n *\n * @param {goog.events.Event} e The event.\n * @private\n */\ngoog.ui.AnimatedZippy.prototype.onAnimate_ = function(e) {\n  var contentElement = this.getContentElement();\n  var h = contentElement.offsetHeight;\n  contentElement.style.marginTop = (e.y - h) + 'px';\n};\n\n\n/**\n * Called once the expand/collapse animation has started.\n *\n * @param {boolean} expanding Expanded/visibility state.\n * @private\n */\ngoog.ui.AnimatedZippy.prototype.onAnimationBegin_ = function(expanding) {\n  this.dispatchEvent(new goog.ui.ZippyEvent(\n      goog.ui.AnimatedZippy.Events.TOGGLE_ANIMATION_BEGIN, this, expanding));\n};\n\n\n/**\n * Called once the expand/collapse animation has completed.\n *\n * @param {boolean} expanded Expanded/visibility state.\n * @private\n */\ngoog.ui.AnimatedZippy.prototype.onAnimationCompleted_ = function(expanded) {\n  // Fix wrong end position if the content has changed during the animation.\n  if (expanded) {\n    this.getContentElement().style.marginTop = '0';\n  }\n\n  goog.events.removeAll(/** @type {!goog.fx.Animation} */ (this.anim_));\n  this.setExpandedInternal(expanded);\n  this.anim_ = null;\n\n  if (!expanded) {\n    this.elWrapper_.style.display = 'none';\n  }\n\n  // Fire toggle event.\n  this.dispatchEvent(\n      new goog.ui.ZippyEvent(goog.ui.Zippy.Events.TOGGLE, this, expanded));\n  this.dispatchEvent(new goog.ui.ZippyEvent(\n      goog.ui.AnimatedZippy.Events.TOGGLE_ANIMATION_END, this, expanded));\n};\n","// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Easing functions for animations.\n *\n * @author arv@google.com (Erik Arvidsson)\n */\n\ngoog.provide('goog.fx.easing');\n\n\n/**\n * Ease in - Start slow and speed up.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n */\ngoog.fx.easing.easeIn = function(t) {\n  return goog.fx.easing.easeInInternal_(t, 3);\n};\n\n\n/**\n * Ease in with specifiable exponent.\n * @param {number} t Input between 0 and 1.\n * @param {number} exp Ease exponent.\n * @return {number} Output between 0 and 1.\n * @private\n */\ngoog.fx.easing.easeInInternal_ = function(t, exp) {\n  return Math.pow(t, exp);\n};\n\n\n/**\n * Ease out - Start fastest and slows to a stop.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n */\ngoog.fx.easing.easeOut = function(t) {\n  return goog.fx.easing.easeOutInternal_(t, 3);\n};\n\n\n/**\n * Ease out with specifiable exponent.\n * @param {number} t Input between 0 and 1.\n * @param {number} exp Ease exponent.\n * @return {number} Output between 0 and 1.\n * @private\n */\ngoog.fx.easing.easeOutInternal_ = function(t, exp) {\n  return 1 - goog.fx.easing.easeInInternal_(1 - t, exp);\n};\n\n\n/**\n * Ease out long - Start fastest and slows to a stop with a long ease.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n */\ngoog.fx.easing.easeOutLong = function(t) {\n  return goog.fx.easing.easeOutInternal_(t, 4);\n};\n\n\n/**\n * Ease in and out - Start slow, speed up, then slow down.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n */\ngoog.fx.easing.inAndOut = function(t) {\n  return 3 * t * t - 2 * t * t * t;\n};\n","// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Generator for unique element IDs.\n *\n */\n\ngoog.provide('goog.ui.IdGenerator');\n\n\n\n/**\n * Creates a new id generator.\n * @constructor\n * @final\n */\ngoog.ui.IdGenerator = function() {};\ngoog.addSingletonGetter(goog.ui.IdGenerator);\n\n\n/**\n * Next unique ID to use\n * @type {number}\n * @private\n */\ngoog.ui.IdGenerator.prototype.nextId_ = 0;\n\n\n/**\n * Random ID prefix to help avoid collisions with other closure JavaScript on\n * the same page that may initialize its own IdGenerator singleton.\n * @type {string}\n * @private\n */\ngoog.ui.IdGenerator.prototype.idPrefix_ = '';\n\n\n/**\n * Sets the ID prefix for this singleton. This is a temporary workaround to be\n * backwards compatible with code relying on the undocumented, but consistent,\n * behavior. In the future this will be removed and the prefix will be set to\n * a randomly generated string.\n * @param {string} idPrefix\n */\ngoog.ui.IdGenerator.prototype.setIdPrefix = function(idPrefix) {\n  this.idPrefix_ = idPrefix;\n};\n\n\n/**\n * Gets the next unique ID.\n * @return {string} The next unique identifier.\n */\ngoog.ui.IdGenerator.prototype.getNextUniqueId = function() {\n  return this.idPrefix_ + ':' + (this.nextId_++).toString(36);\n};\n","/* eslint-env browser */\n/* global goog */\n// \u003c!-- start production --\u003e\ngoog.require('goog.dom')\ngoog.require('goog.dom.TagName')\ngoog.require('goog.net.XhrIo')\ngoog.require('goog.format.JsonPrettyPrinter')\ngoog.require('goog.html.SafeHtml')\ngoog.require('goog.events.FileDropHandler')\ngoog.require('goog.ui.AnimatedZippy')\ngoog.require('goog.ui.ProgressBar')\n// \u003c!-- end production --\u003e\n\nimport upload from './upload.js'\n\nfunction sayHi(data) {\n  const div = goog.dom.createDom(goog.dom.TagName.DIV, {\n    style: 'background-color:#EEE',\n  }, data)\n  goog.dom.appendChild(document.body, div)\n}\n\nconst fileInput = document.getElementById('file')\nconst btn = document.querySelector('#btn')\n\nconst dropZone = goog.dom.getElement('drop-zone')\nnew goog.events.FileDropHandler(dropZone, true)\ngoog.events.listen(dropZone, 'drop', (e) => {\n  const { files } = e.getBrowserEvent().dataTransfer\n  fileInput.files = files\n})\nconst dragEnter = (e) => {\n  addClass(e.target, 'DragActive')\n}\nconst dragLeave = (e) => {\n  removeClass(e.target, 'DragActive')\n}\nconst drop = (e) => {\n  removeClass(e.target, 'DragActive')\n}\nconst removeClass = (el, className) => {\n  const current = el.className.split(' ').map(a => a.trim())\n  const newClasses = current.filter(a => a != className)\n  el.className = newClasses.join(' ')\n}\nconst addClass = (el, className) => {\n  const current = el.className.split(' ').map(a => a.trim())\n  el.className = [...current, className].join(' ')\n}\ngoog.events.listen(dropZone, 'dragenter', dragEnter)\ngoog.events.listen(dropZone, 'dragleave', dragLeave)\ngoog.events.listen(dropZone, 'drop', drop)\n\nbtn.onclick = async () => {\n  const [file] = fileInput.files\n  if (!file) return\n  upload(file)\n}"],
"names":["$jscomp.arrayIteratorImpl","$jscomp.global","$jscomp.defineProperty","$jscomp.polyfill","$jscomp.makeIterator","$jscomp.initSymbol","$jscomp.Symbol","$jscomp.SYMBOL_PREFIX","$jscomp.iteratorPrototype","$jscomp.initSymbolIterator","$jscomp.generator.Context","$jscomp.asyncExecutePromiseGenerator","$jscomp.generator.Generator_","$jscomp.generator.Engine_","IGNORE","encode","file","$jscomp.asyncExecutePromiseGeneratorProgram","Promise","r","reader","FileReader","addEventListener","result","readAsDataURL","upload","el","pb","res","dem","f","mapHolder","add","lat","long","Lat","Long","la","lo","map","address","re","transformOrigin","transform","html","style","src","img","header","metadata","id","goog.isString","element","document","getElementById","visibility","goog.ui.ProgressBar","inDocument_","Error","ALREADY_RENDERED","element_","createDom","insertBefore","dom_","document_","body","appendChild","parent_","enterDocument","upload2","percent","rangeModel_","value","Math","round","value_","maximum_","minimum_","dispatchEvent","CHANGE","getElement","setValueState_","goog.format.JsonPrettyPrinter.SafeHtmlDelimiters","lineBreak","goog.html.SafeHtml.BR","space","goog.format.JsonPrettyPrinter","forEach","p","goog.dom.createDom","goog.dom.TagName.DIV","parseFloat","toFixed","goog.dom.TagName.IMG","length","goog.dom.TagName.EM","filter","a","join","exif2css","format","$jscomp.arrayFromIterable","innerHTML","goog.dom.TagName.H2","goog.ui.AnimatedZippy","progressCallback","j","xhr","XMLHttpRequest","fd","FormData","append","open","onprogress","xhr.upload.onprogress","e","ceil","percentComplete","loaded","total","onload","xhr.onload","status","js","JSON","parse","response","err","message","send","goog.global","val","goog.nullFunction","goog.typeOf","s","Array","Object","className","prototype","toString","call","splice","propertyIsEnumerable","goog.isArray","goog.isArrayLike","type","goog.isFunction","goog.isObject","goog.UID_PROPERTY_","random","goog.uidCounter_","goog.bindNative_","fn","selfObj","var_args","apply","bind","arguments","goog.bindJs_","boundArgs","slice","newArgs","unshift","goog.bind","Function","indexOf","goog.bind.apply","goog.now","Date","now","goog.inherits","childCtor","parentCtor","tempCtor","superClass_","constructor","base","childCtor.base","me","methodName","args","i","goog.debug.Error","opt_msg","captureStackTrace","stack","String","name","goog.asserts.AssertionError","messagePattern","messageArgs","splitParts","split","returnString","subLast","sub","goog.debug.Error.call","goog.asserts.fail","opt_message","goog.array.indexOf","arr","obj","opt_fromIndex","fromIndex","goog.array.forEach","opt_obj","l","arr2","goog.array.filter","resLength","goog.array.map","goog.array.remove","rv","goog.array.toArray","object","goog.string.trim","trim","str","exec","goog.string.htmlEscape","goog.string.ALL_RE_.test","test","replace","goog.string.AMP_RE_","goog.string.LT_RE_","goog.string.GT_RE_","goog.string.QUOT_RE_","goog.string.SINGLE_QUOTE_RE_","goog.string.NULL_RE_","goog.string.ALL_RE_","goog.string.repeat","repeat","string","goog.string.compareElements_","left","right","goog.labs.userAgent.util.userAgent_","navigator","goog.global.navigator","userAgent","goog.object.forEach","key","goog.object.isEmpty","goog.fx.anim.activeAnimations_","goog.object.PROTOTYPE_FIELDS_","goog.object.extend","target","source","goog.object.PROTOTYPE_FIELDS_.length","hasOwnProperty","goog.reflect.sinkValue","x","goog.reflect.cache","valueFn","cacheObj","goog.userAgent.isVersionOrHigherCache_","goog.userAgent.OPERA","goog.userAgent.IE","goog.userAgent.EDGE","goog.userAgent.GECKO","toLowerCase","subString","goog.userAgent.WEBKIT","goog.userAgent.MAC","goog.userAgent.getDocumentMode_","doc","undefined","goog.userAgent.VERSION","version","goog.userAgent.getVersionRegexResult_","docMode","goog.userAgent.isVersionOrHigher","order","v1Subs","v2Subs","subCount","max","subIdx","v1Sub","v2Sub","v1Comp","v2Comp","v1CompNum","parseInt","v2CompNum","mode","CAN_ADD_NAME_OR_TYPE_ATTRIBUTES","Number","goog.userAgent.DOCUMENT_MODE","goog.dom.tags.VOID_TAGS_","goog.string.Const","opt_token","opt_content","stringConstValueWithSecurityContract__googStringSecurityPrivate_","goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_","STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_","goog.string.Const.TYPE_MARKER_","implementsGoogStringTypedString","getTypedStringValue","goog.string.Const.prototype.getTypedStringValue","goog.string.Const.prototype.toString","goog.string.Const.unwrap","stringConst","goog.html.TrustedResourceUrl","TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","goog.html.TrustedResourceUrl.prototype","goog.html.TrustedResourceUrl.prototype.getTypedStringValue","privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_","implementsGoogI18nBidiDirectionalString","getDirection","goog.html.TrustedResourceUrl.prototype.getDirection","LTR","goog.html.TrustedResourceUrl.prototype.toString","goog.html.SafeUrl","privateDoNotAccessOrElseSafeHtmlWrappedValue_","SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","goog.html.SafeUrl.prototype","goog.html.SafeUrl.prototype.getTypedStringValue","goog.html.SafeUrl.prototype.getDirection","goog.html.SafeUrl.prototype.toString","goog.html.SafeUrl.unwrap","safeUrl","goog.html.SAFE_URL_PATTERN_","goog.html.SafeUrl.sanitize","url","goog.html.SAFE_URL_PATTERN_.test","goog.html.SafeUrl.INNOCUOUS_STRING","goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse","goog.html.SafeStyle","privateDoNotAccessOrElseSafeStyleWrappedValue_","SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","goog.html.SafeStyle.prototype.getTypedStringValue","goog.html.SafeStyle.prototype.toString","goog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_","initSecurityPrivateDoNotAccessOrElse_","goog.html.SafeStyle.EMPTY","goog.html.SafeStyle.sanitizePropertyValue_","goog.html.SafeStyle.sanitizePropertyValueString_","valueWithoutFunctions","goog.html.SafeStyle.FUNCTIONS_RE_","goog.html.SafeStyle.URL_RE_","goog.html.SafeStyle.VALUE_RE_.test","goog.html.SafeStyle.COMMENT_RE_.test","goog.html.SafeStyle.INNOCUOUS_STRING","outsideDouble","outsideSingle","c","charAt","goog.html.SafeStyle.hasBalancedSquareBrackets_","goog.html.SafeStyle.VALUE_ALLOWED_CHARS_","goog.html.SafeStyle.sanitizeUrl_","outside","tokenRe","goog.html.SafeStyle.VALUE_RE_","RegExp","goog.html.SafeStyle.COMMENT_RE_","match","before","after","quote","start","inside","sanitized","goog.html.SafeHtml","SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_","dir_","goog.html.SafeHtml.prototype","goog.html.SafeHtml.prototype.getDirection","goog.html.SafeHtml.prototype.getTypedStringValue","goog.html.SafeHtml.prototype.toString","goog.html.SafeHtml.unwrap","safeHtml","goog.html.SafeHtml.VALID_NAMES_IN_TAG_","goog.html.SafeHtml.URL_ATTRIBUTES_","goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_","goog.dom.TagName.APPLET","goog.dom.TagName.BASE","goog.dom.TagName.EMBED","goog.dom.TagName.IFRAME","goog.dom.TagName.LINK","goog.dom.TagName.MATH","goog.dom.TagName.META","goog.dom.TagName.OBJECT","goog.dom.TagName.SCRIPT","goog.dom.TagName.STYLE","goog.dom.TagName.SVG","goog.dom.TagName.TEMPLATE","goog.html.SafeHtml.create","opt_attributes","goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test","tagName","dir","content","goog.html.SafeHtml.concat","dirAttribute","NEUTRAL","addArgument","argument","textIsObject","textAsString","htmlDir","goog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_","goog.dom.setProperties","properties","cssText","htmlFor","goog.dom.DIRECT_ATTRIBUTE_MAP_.hasOwnProperty","setAttribute","goog.dom.DIRECT_ATTRIBUTE_MAP_","lastIndexOf","prefix","goog.dom.createDom_","attributes","goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES","tagNameArr","push","clone","createElement","goog.dom.append_","parent","childHandler","child","createTextNode","startIndex","arg","nodeType","item","goog.dom.DomHelper","goog.global.document","goog.dom.DomHelper.prototype.getElement","goog.dom.DomHelper.prototype.createDom","goog.Disposable","goog.Disposable.MONITORING_MODE","goog.Disposable.MonitoringMode.OFF","OFF","goog.debug.freezeInternal_","freeze","HAS_W3C_EVENT_SUPPORT","SET_KEY_CODE_TO_PREVENT_DEFAULT","PASSIVE_EVENTS","goog.global.addEventListener","defineProperty","passive","options","get","goog.global.removeEventListener","removeEventListener","purify","goog.events.Event","opt_target","currentTarget","propagationStopped_","returnValue_","stopPropagation","goog.events.Event.prototype.stopPropagation","preventDefault","goog.events.Event.prototype.preventDefault","goog.events.BrowserEvent","opt_e","opt_currentTarget","goog.events.Event.call","goog.events.BrowserEvent.base","relatedTarget","button","screenY","screenX","clientY","clientX","keyCode","metaKey","shiftKey","altKey","ctrlKey","pointerId","pointerType","event_","init","relevantTouch","changedTouches","srcElement","MOUSEOVER","fromElement","MOUSEOUT","toElement","pageX","pageY","goog.events.BrowserEvent.IE_POINTER_TYPE_MAP","defaultPrevented","TOUCH","PEN","MOUSE","goog.events.BrowserEvent.prototype.stopPropagation","goog.events.BrowserEvent.superClass_.stopPropagation.call","cancelBubble","goog.events.BrowserEvent.prototype.preventDefault","goog.events.BrowserEvent.superClass_.preventDefault.call","be","returnValue","goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT","VK_F1","VK_F12","ex","goog.events.Listenable.IMPLEMENTED_BY_PROP","goog.events.Listenable.isImplementedBy","goog.events.ListenableKey.counter_","goog.events.Listener","listener","capture","opt_handler","proxy","handler","removed","callOnce","goog.events.Listener.prototype.markAsRemoved","goog.events.ListenerMap","listeners","typeCount_","goog.events.ListenerMap.prototype.add","opt_useCapture","opt_listenerScope","typeStr","listenerArray","index","goog.events.ListenerMap.findListenerIndex_","listenerObj","goog.events.ListenerMap.prototype.removeByKey","markAsRemoved","goog.events.LISTENER_MAP_PROP_","goog.events.onStringMap_","goog.events.listenerCountEstimate_","goog.events.listen","opt_options","once","goog.events.listenOnce","goog.events.wrapListener","eventTargetListeners_","goog.events.listen_","listenerMap","goog.events.getListenerMap_","goog.events.getProxy","goog.events.BrowserFeature.PASSIVE_EVENTS","attachEvent","goog.events.getOnString_","addListener","removeListener","proxyCallbackFunction","goog.events.handleBrowserEvent_","goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT","eventObject","v","goog.events.unlisten","goog.events.unlistenByKey","removeByKey","detachEvent","goog.events.removeAll","count","concat","goog.events.onString_","goog.events.fireListeners_","retval","goog.events.fireListener","listenerFn","listenerHandler","opt_evt","parts","cur","ieEvent","evt","useReturnValue","ancestors","parentNode","goog.events.LISTENER_WRAPPER_PROP_","handleEvent","goog.events.EventTarget","goog.Disposable.call","actualEventTarget_","parentEventTarget_","setParentEventTarget","goog.events.EventTarget.prototype.setParentEventTarget","goog.events.EventTarget.prototype.removeEventListener","opt_capture","opt_handlerScope","goog.events.EventTarget.prototype.dispatchEvent","ancestorsTree","ancestor","getParentEventTarget","oldEvent","opt_ancestorsTree","fireListeners","goog.events.EventTarget.prototype.fireListeners","unlistenByKey","goog.json.Serializer","goog.json.Serializer.prototype.serialize","sb","serializeInternal","goog.json.Serializer.prototype.serializeInternal","sep","serializeArray","Boolean","valueOf","serializeString_","serializeObject_","isFinite","isNaN","goog.json.Serializer.charToJsonCharCache_","goog.json.Serializer.charsToReplace_","goog.json.Serializer.prototype.serializeString_","charCodeAt","substr","goog.debug.LogRecord","level","msg","loggerName","reset","opt_time","opt_sequenceNumber","exception_","goog.debug.LogRecord.nextSequenceNumber_","goog.debug.LogRecord.prototype.reset","goog.debug.Logger","name_","children_","level_","goog.debug.Logger.Level","goog.debug.Logger.Level.prototype.toString","goog.debug.Logger.Level.CONFIG","goog.debug.Logger.Level.FINE","goog.debug.Logger.Level.FINER","goog.debug.Logger.Level.FINEST","goog.debug.Logger.prototype.getEffectiveLevel","getEffectiveLevel","log","goog.debug.Logger.prototype.log","opt_exception","isLoggable","logRecord","doLogRecord_","goog.debug.LogManager.loggers_","goog.debug.LogManager.rootLogger_","goog.debug.LogManager.getLogger","goog.debug.Logger.ROOT_LOGGER_NAME","goog.debug.LogManager.rootLogger_.setLevel","ret","logger","lastDotIndex","leafName","parentLogger","parentName","goog.log.log","goog.string.format","formatString","template","shift","formatRe","replacerDemuxer","flags","width","dotp","precision","offset","wholeString","goog.string.format.demuxes_","replacement","sign","abs","padCount","paddingChar","opt_delimiters","delimiters_","goog.format.JsonPrettyPrinter.TextDelimiters","jsonSerializer_","goog.format.JsonPrettyPrinter.prototype.format","json","outputBuffer","printObject_","format_","output","buffer","goog.format.JsonPrettyPrinter.prototype.printObject_","indent","typeOf","serialize","printValue_","formatValue","arrayStart","propertySeparator","printSpaces_","arrayEnd","objectStart","propertyCount","printName_","formatName","nameValueSeparator","objectEnd","goog.format.JsonPrettyPrinter.TextDelimiters.prototype.formatName","goog.format.JsonPrettyPrinter.TextDelimiters.prototype.formatValue","preValue","goog.format.JsonPrettyPrinter.SafeHtmlDelimiters.prototype.formatName","classes","goog.format.JsonPrettyPrinter.SafeHtmlDelimiters.prototype.formatValue","getValueCssName","goog.format.JsonPrettyPrinter.SafeHtmlDelimiters.prototype.getValueCssName","goog.events.EventHandler","opt_scope","handler_","keys_","goog.events.EventHandler.typeArray_","goog.events.EventHandler.prototype.listen","opt_fn","self","goog.events.EventHandler.prototype.handleEvent","goog.events.FileDropHandler","opt_preventDropOutside","goog.events.EventTarget.call","eventHandler_","DOCUMENT","ownerDocument","listen","DRAGENTER","onDocDragEnter_","DRAGOVER","onDocDragOver_","onElemDragOver_","DROP","onElemDrop_","goog.events.FileDropHandler.prototype","dndContainsFiles_","goog_events_FileDropHandler_prototype$logger_","goog.events.FileDropHandler.prototype.onDocDragEnter_","logger_","dt","dataTransfer","types","files","goog.events.FileDropHandler.prototype.onDocDragOver_","dropEffect","goog.events.FileDropHandler.prototype.onElemDragOver_","effectAllowed","goog.events.FileDropHandler.prototype.onElemDrop_","dispatch_","event","goog.fx.TransitionBase","goog.fx.TransitionBase.base","state_","goog.fx.TransitionBase.State.STOPPED","endTime","startTime","STOPPED","dispatchAnimationEvent","goog.fx.TransitionBase.prototype.dispatchAnimationEvent","goog.async.Delay","opt_interval","goog.async.Delay.base","listener_","interval_","callback_","doAction_","id_","goog.async.Delay.prototype.start","stop","goog.global.clearTimeout","clearTimeout","goog.Timer.MAX_TIMEOUT_","opt_delay","goog.Timer.INVALID_TIMEOUT_ID_","goog.global.setTimeout","setTimeout","goog.async.Delay.prototype.doAction_","goog.fx.anim.animationDelay_","goog.fx.anim.unregisterAnimation","animation","uid","goog.fx.anim.animationDelay_.stop","isActive","goog.fx.anim.requestAnimationFrame_","goog.fx.anim.cycleAnimations_","goog.async.AnimationDelay.TIMEOUT","delay","anim","cycle","goog.fx.Animation","end","duration","opt_acc","goog.fx.TransitionBase.call","goog.fx.Animation.base","startPoint","endPoint","accel_","coords","progress","goog.fx.Animation.prototype.cycle","updateCoords_","setStateStopped","onFinish","FINISH","onEnd","END","PLAYING","isPlaying","onAnimate","ANIMATE","goog.fx.Animation.prototype.updateCoords_","t","goog.fx.Animation.prototype.dispatchAnimationEvent","goog.fx.AnimationEvent","goog.fx.AnimationEvent.base","y","goog.a11y.aria.setState","stateName","attrStateName","goog.a11y.aria.ARIA_PREFIX_","goog.a11y.aria.DefaultStateValueMap_","ATOMIC","AUTOCOMPLETE","DROPEFFECT","HASPOPUP","LIVE","MULTILINE","MULTISELECTABLE","ORIENTATION","READONLY","RELEVANT","REQUIRED","SORT","BUSY","DISABLED","HIDDEN","INVALID","defaultValueMap","removeAttribute","goog.dom.classlist.get","classList","goog.dom.classlist.contains","contains","goog.dom.classlist.add","goog.dom.classlist.remove","remove","goog.events.KeyCodes.firesKeyPressEvent","opt_heldKeyCode","opt_shiftKey","opt_ctrlKey","opt_altKey","opt_metaKey","goog.events.KeyCodes.isCharacterKey","goog.events.KeyCodes.normalizeKeyCode","heldKeyIsModifier","CTRL","ALT","META","SHIFT","BACKSLASH","OPEN_SQUARE_BRACKET","CLOSE_SQUARE_BRACKET","TILDE","SEMICOLON","DASH","EQUALS","COMMA","PERIOD","SLASH","APOSTROPHE","SINGLE_QUOTE","ENTER","ESC","ZERO","NINE","NUM_ZERO","NUM_MULTIPLY","A","Z","SPACE","PLUS_SIGN","QUESTION_MARK","AT_SIGN","NUM_PLUS","NUM_MINUS","NUM_PERIOD","NUM_DIVISION","FF_SEMICOLON","FF_EQUALS","MAC_WK_CMD_RIGHT","goog.events.KeyCodes.normalizeGeckoKeyCode","FF_DASH","MAC_FF_META","WIN_KEY_FF_LINUX","WIN_KEY","goog.events.KeyHandler","opt_element","attach","goog.events.KeyHandler.prototype","goog_events_KeyHandler_prototype$element_","keyPressKey_","keyDownKey_","keyUpKey_","lastKey_","keyCode_","altKey_","goog.events.KeyHandler.safariKey_","NUMLOCK","UP","DOWN","LEFT","RIGHT","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","PRINT_SCREEN","DELETE","HOME","PAGE_UP","PAGE_DOWN","INSERT","goog.events.KeyHandler.keyIdentifier_","goog.events.KeyHandler.USES_KEYDOWN_","goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_","handleKeyDown_","goog.events.KeyHandler.prototype.handleKeyDown_","resetState","handleKeyup_","goog.events.KeyHandler.prototype.handleKeyup_","goog.events.KeyHandler.prototype.handleEvent","KEYPRESS","charCode","keyIdentifier","goog.events.KeyEvent","goog.events.KeyHandler.prototype.getElement","goog.events.KeyHandler.prototype.attach","detach","KEYDOWN","KEYUP","browserEvent","goog.events.BrowserEvent.call","KEY","goog.ui.Zippy","opt_expanded","opt_expandedHeader","opt_domHelper","opt_role","addHeaderEvents","tabIndex","role_","roleName","goog.a11y.aria.ROLE_ATTRIBUTE_","mouseEventHandler_","CLICK","onHeaderClick_","keyHandler_","keyboardEventHandler_","onHeaderKeyDown_","goog.ui.Zippy.base","goog.dom.defaultDomHelper_","elHeader_","elExpandedHeader_","lazyCreateFunc_","TAB","elContent_","expanded_","display","setExpanded","goog.ui.Zippy.prototype.setExpanded","expanded","updateHeaderClassName","setExpandedInternal","goog.ui.ZippyEvent","TOGGLE","goog.ui.Zippy.prototype.updateHeaderClassName","EXPANDED","goog.ui.Zippy.prototype.onHeaderKeyDown_","toggle","dispatchActionEvent_","ACTION","goog.ui.Zippy.prototype.onHeaderClick_","goog.ui.ZippyEvent.base","domHelper","elWrapper","elContent","replaceChild","elWrapper_","anim_","goog.ui.Zippy.call","isExpanded","goog.ui.AnimatedZippy.prototype","animationAcceleration","goog.fx.easing.easeOut","pow","exp","goog.ui.AnimatedZippy.prototype.setExpanded","h","getContentElement","offsetHeight","onStop","STOP","startH","marginTop","animationDuration","events","BEGIN","onAnimate_","onAnimationBegin_","onAnimationCompleted_","isStopped","PAUSED","isPaused","onBegin","onPlay","PLAY","onResume","RESUME","setStatePlaying","goog.ui.AnimatedZippy.prototype.onAnimate_","contentElement","goog.ui.AnimatedZippy.prototype.onAnimationBegin_","expanding","TOGGLE_ANIMATION_BEGIN","goog.ui.AnimatedZippy.prototype.onAnimationCompleted_","TOGGLE_ANIMATION_END","goog.ui.IdGenerator","instance_","getInstance","ctor.getInstance","nextId_","goog.ui.Component","goog.ui.Component.prototype","idGenerator_","goog.ui.IdGenerator.getInstance","goog.ui.Component.prototype.getElement","goog.ui.Component.prototype.setParentEventTarget","NOT_SUPPORTED","goog.ui.Component.superClass_.setParentEventTarget.call","goog_ui_Component_prototype$createDom","goog.ui.Component.prototype.createDom","goog.ui.Component.prototype.enterDocument","exitDocument","goog.ui.Component.prototype.exitDocument","removeChild","goog.ui.Component.prototype.removeChild","opt_unrender","childIndex_","node","PARENT_UNABLE_TO_BE_SET","NOT_OUR_CHILD","goog.ui.RangeModel","goog.ui.Component.call","handleChange_","goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_","VERTICAL","HORIZONTAL","goog.ui.ProgressBar.prototype","goog.ui.ProgressBar.prototype.createDom","thumbElement_","createThumb_","setElementInternal","getDomHelper","setMinimumState_","setMaximumState_","goog.ui.ProgressBar.prototype.enterDocument","goog.ui.ProgressBar.superClass_.enterDocument.call","attachEvents_","RESIZE","updateUi_","goog.ui.ProgressBar.prototype.exitDocument","goog.ui.ProgressBar.superClass_.exitDocument.call","detachEvents_","goog.ui.ProgressBar.prototype.setValueState_","getValue","goog.ui.ProgressBar.prototype.handleChange_","goog.ui.ProgressBar.prototype.updateUi_","size","fileInput","btn","querySelector","dropZone","removeClass","newClasses","current","addClass","dragEnter","dragLeave","drop","onclick","btn.onclick"]
}
